import {n,t}from'./chunk-DKWUOuB5.js';import {aM as En$1,az as X,D,M,dS as jr,bt as Zh,T as Ou,aA as Vu,aB as Bu,bH as Bh,ch as ve,S as Su,J as it,X as Uu,b2 as le,cp as Fu,bG as Li,w as wt,a1 as x,a2 as w$1,E,O,r as Hu,dT as p,aP as R,a0 as at,d9 as VR,ci as qe$1,cj as rr,ai as i$1,aI as q$1,C,k,av as Je,dw as we$1,F,aj as dr,h as hO,bi as qo,P as Pp,l as EE,L as LI,b as Lp,y as cE,e as eO,c as aE,ao as EO,N as NO,A as AO,R as RO,d6 as He,bZ as Fe,ca as x$1,aO as K,be as ru,dU as yg,bp as qi,dV as og,bX as mg,dW as z,dX as A,G as p$1,aH as mr,q as U,Q as p$2,bB as ge,Z as Zw,I as Ih,aK as tC,aX as my,aZ as Cu,a as MI,aD as GO,aE as ZO,bv as _k,u as ui,_ as zt,bJ as c,bL as $,bK as a,bo as le$1,B,aJ as Jw,t as m,aL as cn$1,ad as _O,v as FE,m as PO,au as kO,f as MO,aW as Xu,bY as ar,a9 as Gw,ba as iC,cB as gm,K as KO,bR as K$1,b0 as bE,H as HE,W,co as c$1,al as jR,aU as Vy,da as cd,cz as ar$1,ab as Ty,aQ as hd,dg,cA as gd,dh as tb,dc as Cd,cs as x$2,a3 as An$1,a4 as Ge,a5 as yn$1,a7 as Mn$1,a8 as Tt,d7 as qE,ap as CO,as as wO,d8 as jO,ar as bO,d as jp,V as Vp,b3 as YO,ae as $O,$ as $p,bk as qI,ax as Pb,ay as v$2,bf as lc,af as FR,ag as kR,n as lv,c1 as JR,Y as YR,de as VO,b6 as Ye}from'./main-4LN5YMRF.js';import {Y,v as v$1}from'./chunk-CxyxnPw1.js';function o(r){return typeof r=="boolean"}var T=function(i){return i.COVER="cover-map",i.SP="sales-points",i}(T||{}),v=function(i){return i.MOBILE="mobile",i.INTERNET="internet",i}(v||{});var rn=new Map([["2g",{index:10,text:"\u0413\u043E\u043B\u043E\u0441 \u0438 2G",tilesUrlParam:"2g",checked:false,type:v.MOBILE,disabled:false,color:"#FF530040"}],["3g",{index:20,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 3G",tilesUrlParam:"3g",checked:false,type:v.MOBILE,disabled:false,color:"#71B0FAA8"}],["4g",{index:30,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 4G",tilesUrlParam:"lte",checked:true,type:v.MOBILE,disabled:false,color:"#3171BEA6"}]]),ln=new Map([["i2g",{index:40,text:"\u0413\u043E\u043B\u043E\u0441 \u0438 2G",checked:false,type:v.INTERNET,disabled:true}],["i3g",{index:50,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 3G",checked:false,type:v.INTERNET,disabled:true}],["i4g",{index:60,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 4G",tilesUrlParam:"lte",checked:true,type:v.INTERNET,disabled:false}]]);new Map([["exc",{text:"\u0417\u0430\u043C\u0435\u043D\u0430 \u0441\u0438\u043C-\u043A\u0430\u0440\u0442",checked:false,type:v.MOBILE,disabled:false}],["eexc",{text:"\u0417\u0430\u043C\u0435\u043D\u0430 eSIM",checked:false,type:v.MOBILE,disabled:false}],["edit",{text:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u0430\u0441\u043F\u043E\u0440\u0442\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445",checked:false,type:v.MOBILE,disabled:false}],["corp",{text:"\u041A\u043E\u0440\u043F\u043E\u0440\u0430\u0442\u0438\u0432\u043D\u043E\u0435 \u043E\u0431\u0441\u043B\u0443\u0436\u0438\u0432\u0430\u043D\u0438\u0435",checked:false,type:v.MOBILE,disabled:false}],["connect",{text:"\u041A\u0443\u043F\u0438\u0442\u044C \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443",checked:false,type:v.MOBILE,disabled:false}],["econnect",{text:"\u041A\u0443\u043F\u0438\u0442\u044C eSIM",checked:false,type:v.MOBILE,disabled:false}],["buy",{text:"\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u0438 \u043F\u043E \u0441\u0447\u0435\u0442\u0443",checked:false,type:v.MOBILE,disabled:false}],["mnp",{text:"\u041F\u0435\u0440\u0435\u043D\u043E\u0441 \u043D\u043E\u043C\u0435\u0440\u0430 \u0432 Yota",checked:false,type:v.MOBILE,disabled:false}],["all",{text:"\u041F\u043E \u0432\u0441\u0435\u043C \u0432\u043E\u043F\u0440\u043E\u0441\u0430\u043C",checked:false,type:v.MOBILE,disabled:false}],["confirm",{text:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u043F\u0430\u0441\u043F\u043E\u0440\u0442\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445",checked:false,type:v.MOBILE,disabled:false}]]);new Map([["idiag",{text:"\u0417\u0430\u043C\u0435\u043D\u0430 \u0438 \u0434\u0438\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u043A\u0430",checked:false,type:v.INTERNET,disabled:true}],["iedit",{text:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u0430\u0441\u043F\u043E\u0440\u0442\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445",checked:false,type:v.INTERNET,disabled:true}],["icorp",{text:"\u041A\u043E\u0440\u043F\u043E\u0440\u0430\u0442\u0438\u0432\u043D\u043E\u0435 \u043E\u0431\u0441\u043B\u0443\u0436\u0438\u0432\u0430\u043D\u0438\u0435",checked:false,type:v.INTERNET,disabled:true}],["iconnect",{text:"\u041A\u0443\u043F\u0438\u0442\u044C \u043C\u043E\u0434\u0435\u043C",checked:false,type:v.INTERNET,disabled:true}],["ibuy",{text:"\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u0438 \u043F\u043E \u0441\u0447\u0435\u0442\u0443",checked:false,type:v.INTERNET,disabled:true}],["iall",{text:"\u041F\u043E \u0432\u0441\u0435\u043C \u0432\u043E\u043F\u0440\u043E\u0441\u0430\u043C",checked:false,type:v.INTERNET,disabled:true}]]);var cn=(()=>{class i{constructor(){this._salesPointsService=D(He);}getSalesPoints(e){return this._salesPointsService.getSalesPoints(e).pipe(le(t=>t?.salePoints||[]),Li(()=>[]))}getFunctions(e){return this._salesPointsService.getFunctions({functionType:e})}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var qe=(()=>{class i{constructor(e,t,n){this._document=t,this._isBrowser=ru(n);let o={lang:"ru_RU"};this._config=w$1(w$1({},o),e);}load(){if(!this._isBrowser)return yg;if(window.ymaps)return Fe(ymaps.ready()).pipe(le(()=>ymaps));this._script||(this._script=this._createScript(),this._document.body.appendChild(this._script));let e=qi(this._script,"load").pipe(Bu(()=>Fe(ymaps.ready())),le(()=>ymaps)),t=qi(this._script,"error").pipe(Bu(og));return mg(e,t).pipe(wt(1))}_createScript(){let e=this._document.createElement("script");return e.type="text/javascript",e.src=this._getScriptSource(this._config),e.id="yandexMapsApiScript",e.async=true,e.defer=true,e}_getScriptSource(e){let l=e,{enterprise:t,version:n="2.1.15"}=l,o=z(l,["enterprise","version"]),s=this._convertConfigIntoQueryParams(o);return `https://${t?"enterprise.":""}api-maps.yandex.ru/${n}/?${s}`}_convertConfigIntoQueryParams(e){return Object.entries(e).map(([t,n])=>`${t}=${n}`).join("&")}static{this.\u0275fac=function(t){return new(t||i)(K(A,8),K(dr),K(lc))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var _n=(()=>{class i{constructor(e,t){this._ngZone=e,this._yaApiLoaderService=t;}geocode(e,t){return this._yaApiLoaderService.load().pipe(Bu(()=>Fe(ymaps.geocode(e,t))),Bu(n=>new x$1(o=>{this._ngZone.run(()=>{o.next(n),o.complete();});})))}static{this.\u0275fac=function(t){return new(t||i)(K(we$1),K(qe))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var q=(()=>{class i{constructor(){this.currentState$=new En$1({modeTabIndex:0,coverTabIndex:0,salesPointsTabIndex:0,showFilters:false,showListView:false,maxLayerZoom:13,tabMode:true}),this.readyFilters=new En$1(false),this.selectedSalePoint$=new En$1(null),this.showOverlayFilters$=new En$1(false),this._searchSubject$=new X,this._suggestSubject$=new X,this._searchValue$=new En$1(""),this._searchResult$=new En$1([]),this.bannerIntersection$=new En$1(false),this._analyticsFacadeService=D(M),this.sharedSearchValue$=this.searchValue$.pipe(jr()),this.sharedSearchResult$=this.searchResult$.pipe(jr()),this._salesPointsApiService=D(cn),this.boundsChanged$=new X,this.salesPointsResult$=Zh([this.currentState$.pipe(Ou((e,t)=>e.modeTabIndex===t.modeTabIndex&&e.salesPointsTabIndex===t.salesPointsTabIndex&&e.yotaPoints===t.yotaPoints&&e.partnerPoints===t.partnerPoints)),this.boundsChanged$.pipe(Vu(null))]).pipe(Bu(([e])=>{if(e?.modeTabIndex===1&&this._map?.getBounds()){let[t$1,n$1]=this._map.getBounds(),o=this.salesPointsTabs[e.salesPointsTabIndex].filter,s=e.salesPointsTabIndex===0?n.Voice:n.Modem,l=[...o.values()].filter(h=>h.checked).map(h=>h.id)||[],r=[];e?.yotaPoints&&r.push(t.Yota),e?.partnerPoints&&r.push(t.Partner);let u={upperLatitude:t$1[0],lowerLatitude:n$1[0],upperLongitude:t$1[1],lowerLongitude:n$1[1],functionType:s,types:r,functionIds:l};return this._salesPointsApiService.getSalesPoints(u)}else return Bh([])}),jr()),this._map=null,this._mapLayerIndex=0,this._foundPoint=null,this._coverMobileFilters=rn,this._coverInternetFilters=ln,this._salesPointsMobileFilters=new Map,this._salesPointsInternetFilters=new Map,this.coverTabs=new Array({label:"\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C",filter:this._coverMobileFilters,layers:new Map},{label:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442",filter:this._coverInternetFilters,layers:new Map}),this.salesPointsTabs=new Array({label:"\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C",filter:this._salesPointsMobileFilters,layers:new Map},{label:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442",filter:this._salesPointsInternetFilters,layers:new Map}),this.modeTabs=new Array({label:"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F",tabs:this.coverTabs,type:T.COVER,tabsLabel:"\u0424\u0438\u043B\u044C\u0442\u0440 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F"},{label:"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436",tabs:this.salesPointsTabs,type:T.SP,tabsLabel:"\u0424\u0438\u043B\u044C\u0442\u0440\u043E\u0432\u0430\u0442\u044C"}),this.banners$=new En$1([]),this._yaGeocoderService=D(_n),this._http=D(ve);}get searchValue$(){return this._searchValue$.pipe(Su(256),it(e=>e?.length>1),Uu(e=>{this._suggest(e);}))}set searchValue(e){this._searchValue$.next(e);}get searchResult$(){return this._searchResult$}set searchResult(e){this._searchResult$.next(e);}set map(e){this._map=e,this._mapLayerIndex=this._map.layers.getAll()[0]?.options.get("zIndex"),this.currentState$.value?.modeTabIndex===1&&this.boundsChanged$.next();}getSpFilter(){this._salesPointsApiService.getFunctions(n.Voice).pipe(Bu(e=>this._salesPointsApiService.getFunctions(n.Modem).pipe(le(t=>[...e,...t]))),Fu(()=>{this.readyFilters.next(true);}),Li(e=>Bh([])),wt(1)).subscribe(e=>{e.length&&e.forEach(t=>{let n$1=x(w$1({},t),{type:v.MOBILE,disabled:false,checked:false,text:t.name});t.type===n.Modem?(n$1.type=v.INTERNET,this._salesPointsInternetFilters.set(t.code,n$1)):this._salesPointsMobileFilters.set(t.code,n$1);});});}setFilter(e,t,n=false){let o;n?o=this.salesPointsTabs[this.currentState$.value.salesPointsTabIndex].filter:o=this.coverTabs[this.currentState$.value.coverTabIndex].filter;let s=o.get(t);if(s){s.checked=e.checked;let r=this.getCurrentModeType()==T.COVER?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${r}/${s.text}/${s.checked}`},O.FILTERS);}this.updateLayers();}getCurrentModeType(){return this.modeTabs[this.currentState$.value.modeTabIndex].type}getCurrentFilterTab(){let e=this.modeTabs[this.currentState$.value.modeTabIndex],t=e.type===T.COVER?this.currentState$.value.coverTabIndex:this.currentState$.value.salesPointsTabIndex;return e.tabs[t]}changeModeTab(e){let t=this.modeTabs[this.currentState$.value.modeTabIndex].tabs;for(let n of t)this._clearTabLayers(n.layers);this.currentState$.next(x(w$1({},this.currentState$.value),{modeTabIndex:e})),this.updateLayers(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${e===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436"}`},O.CLICK_MAP_MODE);}changeFilterTab(e){let t=this.getCurrentFilterTab();this._clearTabLayers(t.layers),this.getCurrentModeType()===T.COVER?this.currentState$.next(x(w$1({},this.currentState$.value),{coverTabIndex:e})):this.currentState$.next(x(w$1({},this.currentState$.value),{salesPointsTabIndex:e})),this.updateLayers();let n=this.getCurrentFilterTab().label,s=this.getCurrentModeType()===T.COVER?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${s}/${n}`},O.CLICK_MAP_SERVICE_TYPE);}updateLayers(){if(!this._map||this.getCurrentModeType()!==T.COVER)return;let t=this.getCurrentFilterTab(),n=t.filter,o=[],s=this.currentState$.value.maxLayerZoom??13,l=this._coverMobileFilters.get("4g")?.tilesURL||"",r=this._mapLayerIndex;for(let u of n.values()){let h=u,k=h.checked;!h.disabled&&k&&h.tilesUrlParam&&(o.push(h.tilesUrlParam),r=Math.max(r,this._mapLayerIndex+h.index));}if(o.length>0){let u=o.join(","),h=t.layers.get(u);if(t.layers.forEach((k,Me)=>{Me!==u&&(this._map?.layers.remove(k),t.layers.delete(Me));}),!h){let k=`${l}${u}&yota`;h=this._createLayer(r,k,s),t.layers.set(u,h);}this._map.layers.add(h),h.addedToMap=true;}else this._map.geoObjects.removeAll(),t.layers.forEach(u=>{this._map?.layers.remove(u);}),t.layers.clear();this.boundsChanged$.next();}selectPoint(e){return this._map?(this._map.setCenter([e.latitude,e.longitude],25),this.boundsChanged$.next(),this.salesPointsResult$):Bh([])}_clearTabLayers(e){for(let[,t]of e)t.addedToMap&&(this._map?.layers.remove(t),t.addedToMap=false);}_createLayer(e,t,n){let o=new ymaps.Layer("",{tileTransparent:true,zIndex:e});return o.getTileUrl=(s,l)=>{let r=Math.min(l,n);return t.replace("%z",String(Math.min(r,15))).replace("%x",String(s[0])).replace("%y",String(s[1]))},o.getTileSize=s=>{let l=8;n<s&&(l=8+s-n);let r=Math.pow(2,l);return [r,r]},o}geoSearch(e,t){if(this._searchSubject$.next(true),!e||!e.trim())return;this._foundPoint&&this._map?.geoObjects.remove(this._foundPoint);let n=" \xB7 ";if(e.includes(n)){let o=e.split(n)[1];o&&(e=o);}t=x(w$1({},t),{results:1,boundedBy:this._map?.getBounds()}),this._yaGeocoderService.geocode(e,t).pipe(le(o=>{let s=o?.metaData?.geocoder?.found;if(!s)return [];let l=[];this._foundPoint=o.geoObjects.get(0);for(let r=0;r<s;r++){let u=o.geoObjects.get(r);u&&l.push({name:u.properties.getAll().text,cords:u.geometry.getCoordinates()});}return this._foundPoint&&(this._map?.geoObjects.add(this._foundPoint),this._map?.setBounds(this._foundPoint.properties.get("boundedBy"))),l}),Hu(this._searchSubject$)).subscribe();}getBannerCategory(){let e=this.getCurrentFilterTab().label,t=this.getCurrentModeType();return e==="\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C"&&t===T.COVER?"COVERAGE_MOBILE":e==="\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C"&&t===T.SP?"SALES_POINTS_MOBILE":e==="\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442"&&t===T.COVER?"COVERAGE_INTERNET":e==="\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442"&&t===T.SP?"SALES_POINTS_INTERNET":null}_suggest(e){if(this._suggestSubject$.next(true),!e||!e.trim()){this.searchResult=[];return}let t={part:e,ll:this._map?.getCenter().reverse().join()+","||"",search_type:"all",bases:"geo,biz,transit",spn:"2.399139%2C0.624969",results:10,highlight:"0",fullpath:"1",sep:"0",v:9,lang:"ru_RU"};this._yaSuggest(t).pipe(le(n=>{let{results:o}=n,s="business",l=[s,"toponym"];o=o?.filter(h=>l.includes(h.type)&&!h.group&&h.subtitle?.text);let r=o?.map(h=>{let k=h?.subtitle?.text||"";return {type:h?.type,data:h?.type===s?k:h?.text||"",title:h?.title?.text||"",subtitle:k}});return r=((h,k)=>{if(!h)return [];let Me=fe=>fe[k];return [...h.reduce((fe,Ce)=>{let Je=Ce==null?Ce:Me(Ce);return fe.has(Je)||fe.set(Je,Ce),fe},new Map).values()]})(r,"subtitle"),r}),Hu(this._suggestSubject$)).subscribe(n=>this.searchResult=n);}_yaSuggest(e){let t=new p("https://suggest-maps.yandex.ru","/suggest-geo","get");e&&(t.query("lang",e.lang,{}),t.query("bases",e.bases,{}),t.query("search_type",e.search_type,{}),t.query("ll",e.ll,{}),t.query("spn",e.spn,{}),t.query("highlight",e.highlight,{}),t.query("fullpath",e.fullpath,{}),t.query("sep",e.sep,{}),t.query("v",e.v,{}),t.query("results",e.results,{}),t.query("part",e.part,{}));let n=t.build({accept:"application/javascript"});return this._http.jsonp(n.urlWithParams+"&search_type=street","callback").pipe(Li(()=>this.searchResult=[]))}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var Ue=B(K$1());var yn=["desktop"],fn=["mobile"],Cn=["mobileImage"];function vn(i,a){i&1&&bE(0);}function xn(i,a){i&1&&bE(0);}function Sn(i,a){if(i&1){let e=_O();Pp(0,"div",18)(1,"a",19),FE("click",function(){FR(e);let n=MO(2);return kR(n.cardClick())}),PO(2),Lp()();}if(i&2){let e=MO(2);eO(),aE("href",e.banner==null?null:e.banner.uri,lv),eO(),HE(e.banner==null?null:e.banner.urlText);}}function On(i,a){if(i&1){let e=_O();Pp(0,"div",12)(1,"div",13)(2,"div",14),PO(3),Lp(),Pp(4,"button",10),FE("click",function(){FR(e);let n=MO();return kR(n.closeBanner())}),Pp(5,"y-icon",11),PO(6,"cross"),Lp()()(),Pp(7,"p",15),PO(8),Lp(),LI(9,Sn,3,2,"div",16),EE(10,"img",17),Lp();}if(i&2){let e=MO();eO(3),HE(e.banner==null?null:e.banner.title),eO(5),HE(e.banner==null?null:e.banner.subTitle),eO(),aE("ngIf",e.banner==null?null:e.banner.urlText),eO(),aE("src",e.banner==null?null:e.banner.pictureDesktopUri,lv);}}var ye=class i extends p$1{onGlobalClick(a){this.mobile.nativeElement.contains(a.target)||this._isDesktop()||this.mobileCardOpen&&this.hideMobileCard();}constructor(){super(),this.banner=null,this.analyticsEvents=E,this.analyticsActions=O,this._bannerOpened=false,this.mobileCardOpen=false,this._animationDuration=500,this._lifeTime=7,this._mobileImageTranslateX=-120,this._mobileCardTranslateX=-375,this._desktopCardTranslateX=-370,this._localstorageKey="yota_mapBanner_expires",this._yaCombinedService=D(q),this._analyticsFacadeService=D(M),this._breakpointObserver=D(U),this._bannersInteractionService=D(c),this._cdr=D(ui),$.isLocalStorageAvailable()&&localStorage.getItem(this._bannersInteractionService.getLocalStorageKey(a.Cookies))&&this._bannersInteractionService.setAvailability(a.Map,true,0);}ngOnInit(){this._initIntersectionBannerLogic();}closeBannerImage(){this._setExpirationDate(),le$1({targets:this.mobileImage.nativeElement,translateX:this._mobileImageTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}}),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/\u041A\u0440\u0435\u0441\u0442\u0438\u043A`},O.BANNER_CLOSE);}getBanner(){let a=this._yaCombinedService.getBannerCategory(),e=this._yaCombinedService.banners$.value.find(t=>t.category===a);return e||null}closeBanner(){this.mobileCardOpen=false,this._isDesktop()?le$1({targets:this.desktop.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack"}):le$1({targets:this.mobile.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack"}),this._setExpirationDate(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/\u041A\u0440\u0435\u0441\u0442\u0438\u043A`},O.BANNER_CLOSE);}openMobileCard(){this.mobileCardOpen||(this.mobileCardOpen=true,this.mobile.nativeElement.style.transform="translateX(0)",le$1.timeline().add({targets:this.mobileImage.nativeElement,opacity:0,duration:300,easing:"linear",complete:()=>this.mobileImage.nativeElement.style.transform=`translateX(${this._mobileImageTranslateX}px)`}).add({targets:this.mobile.nativeElement,opacity:1,duration:300,easing:"linear"},0),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/icon`},O.CLOSED_BANNER_CLICK));}hideMobileCard(){this.mobileCardOpen&&(this.mobileCardOpen=false,this.mobileImage.nativeElement.style.transform="translateX(-0)",le$1.timeline().add({targets:this.mobileImage.nativeElement,opacity:1,duration:300,autoplay:false,easing:"linear",complete:()=>this.mobile.nativeElement.style.transform=`translateX(${this._mobileCardTranslateX}px)`}).add({targets:this.mobile.nativeElement,opacity:0,duration:300,easing:"linear"},0));}cardClick(){this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/${this.banner?.urlText}`},O.BANNER_LINK);}_hideBanner(){this._getExpirationDate()&&!this._bannerHidingExpired()||(this._isDesktop()?le$1({targets:this.desktop.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}}):this._hideBannerMobile());}_hideBannerMobile(){let a=this.mobile.nativeElement.style.opacity==="1";this.mobileCardOpen=false,a?le$1({targets:this.mobile.nativeElement,translateX:this._mobileCardTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}}):le$1({targets:this.mobileImage.nativeElement,translateX:this._mobileImageTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}});}_changeBanner(a){this._setLocalStorageKey(a.category),this._isDesktop()?this._changeBannerDesktop(a):this._changeBannerMobile(a);}_changeBannerMobile(a){let e=getComputedStyle(this.mobileImage.nativeElement),o=new WebKitCSSMatrix(e.transform).m41===0,s=this.mobile.nativeElement.style.opacity==="1",l=le$1.timeline({autoplay:false});if(s?(this.mobileCardOpen=false,l.add({targets:this.mobile.nativeElement,translateX:this._mobileCardTranslateX,duration:this._animationDuration,easing:"easeInBack",autoplay:false,complete:()=>{this.banner=a,this.mobile.nativeElement.style.opacity=0,this.mobileImage.nativeElement.style.opacity=1,this._cdr.markForCheck();}})):(this.mobileImage.nativeElement.style.opacity=o?1:0,l.add({targets:this.mobileImage.nativeElement,translateX:this._mobileImageTranslateX,autoplay:false,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=a,this.mobileImage.nativeElement.style.opacity=1,this._cdr.markForCheck();}})),this._bannerHidingExpired()){let r={targets:this.mobileImage.nativeElement,translateX:0,duration:this._animationDuration,easing:"easeOutBack"};l.add(r,"+=400"),localStorage.removeItem(this._localstorageKey),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/icon`},O.CLOSED_BANNER_SHOW);}l.play();}_initIntersectionBannerLogic(){Zh([this._yaCombinedService.currentState$.pipe(Bu(()=>this._yaCombinedService.bannerIntersection$)),this._bannersInteractionService.getBannerAvailability$(a.Map)]).pipe(Hu(this._onDestroy$)).subscribe(([a,e])=>{if(!a||!e)return;let t=this.getBanner();!(this.banner?.category!==t?.category)||le$1.running?.length>0||(this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{t?this._bannerOpened?this._changeBanner(t):this._showBannerFirstTime(t):this._hideBanner(),this._cdr.markForCheck();},200));});}_changeBannerDesktop(a){let e=getComputedStyle(this.desktop.nativeElement),o=new WebKitCSSMatrix(e.transform).m41===0;this.desktop.nativeElement.style.opacity=o?1:0;let s=le$1.timeline({autoplay:false}).add({targets:this.desktop.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=a,this.desktop.nativeElement.style.opacity=1,this._cdr.markForCheck();}});if(this._bannerHidingExpired()){let l={targets:this.desktop.nativeElement,translateX:0,duration:this._animationDuration,easing:"easeOutBack"};s.add(l,"+=400"),localStorage.removeItem(this._localstorageKey),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}`},O.DESKTOP_BANNER_SHOW);}s.play();}_getExpirationDate(){let a=localStorage.getItem(this._localstorageKey);return a?(0, Ue.default)(JSON.parse(a)):null}_setExpirationDate(){let a=(0, Ue.default)().add(this._lifeTime,"day");localStorage.setItem(this._localstorageKey,JSON.stringify(a));}_setLocalStorageKey(a){let e=a||this.banner?.category;this._localstorageKey=`yota_mapBanner_${e}_expires`;}_bannerHidingExpired(){let a=this._getExpirationDate();return a?(0, Ue.default)().isAfter(a):true}_isDesktop(){return this._breakpointObserver.isMatched(["(min-width: 992px)"])}_showBannerFirstTime(a){this.banner=a,this._setLocalStorageKey(),this._bannerHidingExpired()&&(this._isDesktop()?this._showBannerFirstTimeDesktop():this._showBannerFirstTimeMobile(),this._bannerOpened=true);}_showBannerFirstTimeMobile(){le$1.timeline().add({targets:this.mobileImage.nativeElement,translateX:[-120,0],autoplay:false,duration:this._animationDuration,easing:"easeOutBack"}).play(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/icon`},O.CLOSED_BANNER_SHOW);}_showBannerFirstTimeDesktop(){le$1.timeline().add({targets:this.desktop.nativeElement,translateX:[-370,0],autoplay:false,duration:this._animationDuration,easing:"easeOutBack"}).play(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}`},O.DESKTOP_BANNER_SHOW);}static{this.\u0275fac=function(e){return new(e||i)};}static{this.\u0275cmp=hO({type:i,selectors:[["yota-map-banner"]],viewQuery:function(e,t){if(e&1&&(NO(yn,7),NO(fn,7),NO(Cn,7)),e&2){let n;AO(n=RO())&&(t.desktop=n.first),AO(n=RO())&&(t.mobile=n.first),AO(n=RO())&&(t.mobileImage=n.first);}},hostBindings:function(e,t){e&1&&FE("mousedown",function(o){return t.onGlobalClick(o)},false,JR);},features:[MI],decls:15,vars:3,consts:[["desktop",""],["mobile",""],["mobileImage",""],["card",""],[1,"desktop-card"],[4,"ngTemplateOutlet"],[1,"mobile-card"],[1,"mobile-image"],[1,"closed"],["alt","banner",1,"closed__image",3,"click","src"],["y-button-icon","","type","button",3,"click"],[1,"close-button"],[1,"card"],[1,"header"],[1,"title"],[1,"text"],["class","action",4,"ngIf"],["alt","banner",1,"image",3,"src"],[1,"action"],["yotaRelativeLinkHandler","",1,"link",3,"click","href"]],template:function(e,t){if(e&1){let n=_O();Pp(0,"div",4,0),LI(2,vn,1,0,"ng-container",5),Lp(),Pp(3,"div",6,1),LI(5,xn,1,0,"ng-container",5),Lp(),Pp(6,"div",7,2)(8,"div",8)(9,"img",9),FE("click",function(){return FR(n),kR(t.openMobileCard())}),Lp(),Pp(10,"button",10),FE("click",function(){return FR(n),kR(t.closeBannerImage())}),Pp(11,"y-icon",11),PO(12,"cross"),Lp()()()(),LI(13,On,11,4,"ng-template",null,3,KO);}if(e&2){let n=kO(14);eO(2),aE("ngTemplateOutlet",n),eO(3),aE("ngTemplateOutlet",n),eO(4),aE("src",t.banner==null?null:t.banner.pictureMobileUri,lv);}},dependencies:[Jw,Zw,m,cn$1,zt],styles:["[_nghost-%COMP%]{display:block;width:0;height:100%;position:absolute;bottom:0;left:0}.desktop-card[_ngcontent-%COMP%]{z-index:2;position:absolute;bottom:32px;left:32px;transform:translate(-370px)}.mobile-card[_ngcontent-%COMP%]{position:absolute;top:90px;left:30px;opacity:0;transform:translate(-375px)}.mobile-image[_ngcontent-%COMP%]{z-index:1;position:absolute;left:30px;top:100px;transform:translate(-120px)}.mobile-image[_ngcontent-%COMP%]   .closed[_ngcontent-%COMP%]{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:flex-start;min-width:80px}.mobile-image[_ngcontent-%COMP%]   .closed__image[_ngcontent-%COMP%]{height:84px}.card[_ngcontent-%COMP%]{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;flex-direction:column;width:320px;min-height:167px;border-radius:20px;background:#fff;padding:16px}@media (max-width: 992px){.card[_ngcontent-%COMP%]{width:335px;min-height:132px}}.header[_ngcontent-%COMP%]{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:space-between;align-items:flex-start}.title[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:700}.close-button[_ngcontent-%COMP%]{color:#ceced5}.text[_ngcontent-%COMP%]{max-width:146px;margin-top:4px;font-size:14px;line-height:16px;font-weight:400;color:#434c5e}.action[_ngcontent-%COMP%]{margin-top:auto}.action[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{font-size:14px;line-height:18px;font-weight:500;color:#00aeef}.image[_ngcontent-%COMP%]{width:132px;height:132px;position:absolute;bottom:0;right:16px}@media (max-width: 992px){.image[_ngcontent-%COMP%]{width:100px;height:100px}}"],changeDetection:0});}};Pb([v$2],ye.prototype,"_initIntersectionBannerLogic",null);var Xe=class{constructor(){this._uniqueIds=new WeakMap,this._lastid=0;}get(a){return this._uniqueIds.has(a)||this._uniqueIds.set(a,this._lastid++),this._uniqueIds.get(a)}};var Qe=class{constructor(a){this._ngZone=a,this._pending=[],this._listeners=[],this._targetStream=new En$1(void 0);}getLazyEmitter(a){return this._targetStream.pipe(Bu(e=>{let t=new x$1(n=>{if(!e){this._pending.push({observable:t,observer:n});return}let o=l=>{let r={event:l,target:e,ymaps};this._ngZone.run(()=>n.next(r));},s=e.events.add(a,o);return this._listeners.push({name:a,callback:o,manager:s}),()=>s.remove(a,o)});return t}))}setTarget(a){let e=this._targetStream.value;a!==e&&(e&&(this._clearListeners(),this._pending=[]),this._targetStream.next(a),this._pending.forEach(t=>t.observable.subscribe(t.observer)),this._pending=[]);}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete();}_clearListeners(){this._listeners.forEach(a=>{let{name:e,callback:t,manager:n}=a;n.remove(e,t);}),this._listeners=[];}};var mn=()=>`f${Date.now().toString(16)}`;function wn(i,a){if(i&1){let e=_O();Pp(0,"yota-field-state",8),FE("clear",function(){FR(e);let n=MO();return kR(n.clear())}),Lp();}if(i&2){let e=MO(),t=kO(7);aE("state",e.controlState.CLEAR)("inputControl",t);}}function Mn(i,a){if(i&1&&(Pp(0,"div",10),PO(1),Lp()),i&2){let e=MO().$implicit;eO(),$p(" ",e.subtitle," ");}}function kn(i,a){if(i&1&&(Pp(0,"y-option-bordered",7),EE(1,"div",9),GO(2,"yHighlight"),LI(3,Mn,2,1,"div",10),Lp()),i&2){let e=a.$implicit,t=MO();aE("value",e),eO(),aE("innerHtml",YO(2,3,e.title,t.search.value),YR),eO(2),EO(e.subtitle?3:-1);}}var dn=(()=>{class i extends p$1{constructor(){super(...arguments),this._yaCombinedService=D(q),this.search=new W("",{nonNullable:true}),this.controlState=c$1,this.options$=this._yaCombinedService.sharedSearchResult$,this.handleSelect=VR();}ngOnInit(){this.search.valueChanges.pipe(Ou(),it(e=>typeof e=="string"),Hu(this._onDestroy$)).subscribe(e=>{this._yaCombinedService.searchValue=e;}),this._yaCombinedService.sharedSearchValue$.pipe(Hu(this._onDestroy$)).subscribe();}onSelect(e){this.search.setValue(e.title,{emitEvent:false}),this.handleSelect.emit(e),this._yaCombinedService.geoSearch(e.data),this._closePanel();}clear(){this.search.setValue(""),this._yaCombinedService.searchResult=[],setTimeout(()=>this._closePanel());}displayFn(e){return e?.title||""}_closePanel(){this.inputRef.nativeElement.blur(),this.autocompleteDirRef?.closePanel();}static{this.\u0275fac=(()=>{let e;return function(n){return (e||(e=jR(i)))(n||i)}})();}static{this.\u0275cmp=hO({type:i,selectors:[["yota-ya-search"]],viewQuery:function(t,n){if(t&1&&(NO(dg,5),NO(Ty,5,Je)),t&2){let o;AO(o=RO())&&(n.autocompleteDirRef=o.first),AO(o=RO())&&(n.inputRef=o.first);}},outputs:{handleSelect:"handleSelect"},features:[MI],decls:13,vars:6,consts:[["inputRef","yInput"],["autocompleteRef","yAutocompleteBordered"],[1,"yota-ya-search"],["yPrefix","","svgIcon","search-outline",1,"yota-ya-search-icon"],["yInput","","type","text","id","combined-map-autocomplete",1,"yota-ya-search__autocomplete-input",3,"keyup.enter","formControl","yAutocompleteBordered"],["ySuffix","",3,"state","inputControl"],[3,"optionSelected"],[1,"yota-ya-search__option",3,"value"],["ySuffix","",3,"clear","state","inputControl"],[1,"yota-ya-search__option-title",3,"innerHtml"],[1,"yota-ya-search__option-subtitle","y-accent"]],template:function(t,n){if(t&1){let o=_O();Pp(0,"y-form-field-bordered",2)(1,"y-label"),PO(2,"\u0412\u0432\u0435\u0434\u0438 \u0433\u043E\u0440\u043E\u0434, \u0430\u0434\u0440\u0435\u0441, \u0440\u0430\u0439\u043E\u043D \u0438\u043B\u0438 \u0422\u0426"),Lp(),EE(3,"y-icon",3),qE(4),GO(5,"async"),Pp(6,"input",4,0),FE("keyup.enter",function(){FR(o);let l=VO(4);return kR(l!=null&&l.length?n.onSelect(l[0]):null)}),Lp(),LI(8,wn,1,2,"yota-field-state",5),Pp(9,"y-autocomplete-bordered",6,1),FE("optionSelected",function(l){return FR(o),kR(n.onSelect(l.option.value))}),CO(11,kn,4,6,"y-option-bordered",7,wO),Lp()();}if(t&2){let o=kO(7),s=kO(10);eO(4);let l=jO(ZO(5,3,n.options$));eO(2),aE("formControl",n.search)("yAutocompleteBordered",s),eO(2),EO(o.focused&&o.value?8:-1),eO(3),bO(l);}},dependencies:[tC,Vy,cd,ar$1,Ty,hd,dg,gd,tb,Cd,zt,x$2,An$1,Ge,yn$1,Mn$1,Tt],styles:["[_nghost-%COMP%]   .yota-ya-search[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .yota-ya-search__autocomplete-input[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .yota-ya-search__clear-icon[_ngcontent-%COMP%]{font-size:12px}[_nghost-%COMP%]   .yota-ya-search[_ngcontent-%COMP%]     input.yota-ya-search__autocomplete-input::placeholder{all:unset!important;color:#b9c2cb!important}@media (max-width: 480px){[_nghost-%COMP%]   .yota-ya-search[_ngcontent-%COMP%]     input.yota-ya-search__autocomplete-input::placeholder{font-size:14px!important}}[_nghost-%COMP%]   .yota-ya-search-icon[_ngcontent-%COMP%]{width:24px;height:24px}  .y-option.yota-ya-search__option{padding:12px}  .y-option.yota-ya-search__option .y-option-text{display:flex;flex-direction:column;gap:12px}  .y-option.yota-ya-search__option .yota-ya-search__option-subtitle{font-size:12px}"],changeDetection:0});}}return i})();var Pn=["spList"],Tn=i=>({"b-combined-map__coverage-filter-button_active":i});function In(i,a){i&1&&bE(0);}function En(i,a){if(i&1&&(Pp(0,"div",11),LI(1,In,1,0,"ng-container",12),Lp()),i&2){MO(2);let e=kO(8);eO(),aE("ngTemplateOutlet",e);}}function Ln(i,a){i&1&&bE(0);}function $n(i,a){if(i&1&&(Pp(0,"div",11),LI(1,Ln,1,0,"ng-container",12),Lp()),i&2){MO(2);let e=kO(10);eO(),aE("ngTemplateOutlet",e);}}function Bn(i,a){if(i&1&&LI(0,En,2,1,"div",10)(1,$n,2,1,"div",10),i&2){let e=MO(2).ngIf,t=MO();aE("ngIf",t.modeTabs[e.modeTabIndex].type===t.modeTypes.COVER),eO(),aE("ngIf",t.modeTabs[e.modeTabIndex].type===t.modeTypes.SP);}}function Fn(i,a){if(i&1){let e=_O();Pp(0,"div",18)(1,"p"),PO(2),Lp(),Pp(3,"y-switch",19),FE("change",function(n){let o=FR(e).$implicit,s=MO(5);return kR(s.setFilter(n,o.key))}),Lp()();}if(i&2){let e=a.$implicit;eO(2),HE(e.value.text),eO(),aE("checked",e.value.checked)("disabled",e.value.disabled)("activeBgColor",e.value.color);}}function Yn(i,a){if(i&1&&(Pp(0,"y-tab",15)(1,"div",16),LI(2,Fn,4,4,"div",17),GO(3,"keyvalue"),Lp()()),i&2){let e=a.$implicit;aE("label",e.label),eO(2),aE("ngForOf",ZO(3,2,e.filter));}}function Dn(i,a){if(i&1){let e=_O();Pp(0,"y-tab-group",13),FE("selectedTabChange",function(n){FR(e);let o=MO(3);return kR(o.changeFilterTab(n.index))}),LI(1,Yn,4,4,"y-tab",14),Lp();}if(i&2){let e=MO(2).ngIf,t=MO();aE("selectedIndex",e.coverTabIndex),eO(),aE("ngForOf",t.coverTabs);}}function An(i,a){if(i&1){let e=_O();Pp(0,"div",18)(1,"p"),PO(2),Lp(),Pp(3,"y-switch",20),FE("change",function(n){let o=FR(e).$implicit,s=MO(5);return kR(s.setFilter(n,o.key,true))}),Lp()();}if(i&2){let e=a.$implicit;eO(2),HE(e.value.text),eO(),aE("checked",e.value.checked)("disabled",e.value.disabled);}}function Rn(i,a){if(i&1&&(Pp(0,"y-tab",15)(1,"div",16),LI(2,An,4,3,"div",17),GO(3,"keyvalue"),Lp()()),i&2){let e=a.$implicit;aE("label",e.label),eO(2),aE("ngForOf",ZO(3,2,e.filter));}}function Vn(i,a){if(i&1){let e=_O();Pp(0,"y-tab-group",13),FE("selectedTabChange",function(n){FR(e);let o=MO(3);return kR(o.changeFilterTab(n.index))}),LI(1,Rn,4,4,"y-tab",14),Lp();}if(i&2){let e=MO(2).ngIf,t=MO();aE("selectedIndex",e.salesPointsTabIndex),eO(),aE("ngForOf",t.salesPointsTabs);}}function jn(i,a){if(i&1){let e=_O();jp(0),Pp(1,"button",6),FE("click",function(){FR(e);let n=MO().ngIf,o=MO();return kR(o.toggleFilter(!n.showFilters))}),Pp(2,"span",7),PO(3),Lp(),Pp(4,"y-icon",8),PO(5,"angle_down"),Lp()(),LI(6,Bn,2,2,"ng-template",9)(7,Dn,2,2,"ng-template",null,0,KO)(9,Vn,2,2,"ng-template",null,1,KO),Vp();}if(i&2){let e=MO().ngIf,t=MO();eO(),aE("ngClass",$O(3,Tn,e.showFilters)),eO(2),HE(t.modeTabs[e.modeTabIndex].tabsLabel),eO(3),aE("ngIf",e.showFilters);}}function Nn(i,a){if(i&1){let e=_O();Pp(0,"button",23),FE("click",function(){FR(e);let n=MO(3);return kR(n.toggleListView(true))}),Pp(1,"span",7),PO(2,"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u043F\u0438\u0441\u043A\u043E\u043C"),Lp()();}}function zn(i,a){if(i&1&&(Pp(0,"div",33),PO(1),Lp()),i&2){let e=MO().$implicit;eO(),$p(" ",e.address," ");}}function Zn(i,a){if(i&1&&(Pp(0,"div",34),PO(1),Lp()),i&2){let e=MO().$implicit;eO(),$p(" ",e.howToFind," ");}}function qn(i,a){if(i&1&&(Pp(0,"div",35),PO(1),Lp()),i&2){let e=MO().$implicit;eO(),$p(" ",e.workingTime," ");}}function Un(i,a){if(i&1&&(Pp(0,"div",36),PO(1),Lp()),i&2){let e=a.$implicit;eO(),$p(" ",e.name," ");}}function Xn(i,a){if(i&1){let e=_O();Pp(0,"li",26),FE("click",function(){let n=FR(e).$implicit,o=MO(4);return kR(o.selectPoint(n))}),Pp(1,"div",27),PO(2),Lp(),LI(3,zn,2,1,"div",28)(4,Zn,2,1,"div",29)(5,qn,2,1,"div",30),Pp(6,"div",31),LI(7,Un,2,1,"div",32),Lp()();}if(i&2){let e=a.$implicit;qI("data-code",e.code),eO(2),$p(" ",e.name," "),eO(),aE("ngIf",e.address),eO(),aE("ngIf",e.howToFind),eO(),aE("ngIf",e.workingTime),eO(2),aE("ngForOf",e.functions);}}function Qn(i,a){if(i&1&&(Pp(0,"ul",24,2),LI(2,Xn,8,6,"li",25),Lp()),i&2){let e=MO(3);eO(2),aE("ngForOf",e.salePoints);}}function Gn(i,a){if(i&1&&(jp(0),LI(1,Nn,3,0,"button",21)(2,Qn,3,1,"ul",22),Vp()),i&2){let e=MO().ngIf;eO(),aE("ngIf",e.showFilters&&!e.showListView),eO(),aE("ngIf",e.showListView);}}function Hn(i,a){if(i&1){let e=_O();jp(0),Pp(1,"yota-ya-search",5),FE("handleSelect",function(n){FR(e);let o=MO();return kR(o.handleSelect(n))}),Lp(),LI(2,jn,11,5,"ng-container",4)(3,Gn,3,2,"ng-container",4),Vp();}if(i&2){let e=a.ngIf,t=MO();eO(2),aE("ngIf",e.tabMode),eO(),aE("ngIf",t.modeTabs[e.modeTabIndex].type===t.modeTypes.SP);}}var We=(()=>{class i{constructor(e,t,n,o){this._document=e,this._dialogData=t,this._renderer=n,this._cdr=o,this.modeTypes=T,this._yaCombinedService=D(q),this._breakpointObserver=D(U),this._analyticsFacadeService=D(M),this._destroy$=new X,this.currentState$=this._yaCombinedService.currentState$,this.modeTabs=this._yaCombinedService.modeTabs,this.coverTabs=this._yaCombinedService.coverTabs,this.salesPointsTabs=this._yaCombinedService.salesPointsTabs,this.salePoints=[],this.isMobile=false,this._yaCombinedService.salesPointsResult$.pipe(Hu(this._destroy$)).subscribe(s=>{this.salePoints=s,this._cdr.markForCheck();}),this._breakpointObserver.observe("(max-width: 950px)").pipe(Hu(this._destroy$)).subscribe(s=>this.isMobile=s.matches);}ngAfterViewInit(){this._dialogData?.isSwiped&&this._initSwipeToDialog();}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete();}changeFilterTab(e){this._yaCombinedService.changeFilterTab(e);}setFilter(e,t,n=false){this._yaCombinedService.setFilter(e,t,n),this._yaCombinedService.boundsChanged$.next();}toggleFilter(e){let t=x(w$1({},this._yaCombinedService.currentState$.value),{showFilters:e});e&&(t.showListView=false),this._yaCombinedService.currentState$.next(t);let n=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${n}/\u0424\u0438\u043B\u044C\u0442\u0440 \u043F\u043E \u0443\u0441\u043B\u0443\u0433\u0430\u043C/${e?"\u041E\u0422\u041A\u0420":"\u0417\u0410\u041A\u0420"}`},O.CLICK_MAP_SERVICES_COLLAPSE);}toggleListView(e){let t=this._yaCombinedService.currentState$.value.showFilters;this._yaCombinedService.currentState$.next(x(w$1({},this._yaCombinedService.currentState$.value),{showFilters:e?false:t,showListView:e})),e&&this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F / \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u043F\u0438\u0441\u043A\u043E\u043C"},O.CLICK_MAP_SHOW_LIST_BOX);}selectPoint(e){this.isMobile&&(this.toggleFilter(false),this.toggleListView(false));let t=this._yaCombinedService.selectedSalePoint$.getValue();t?.code===e.code||t?.latitude===e.latitude&&t.longitude===e.longitude||this._yaCombinedService.selectPoint(e).pipe(wt(1),Uu(n=>{this.salePoints=n,this._cdr.markForCheck();}),Uu(()=>{this._yaCombinedService.selectedSalePoint$.next(e);})).subscribe(()=>{if(this.spList?.nativeElement){let n=this.spList.nativeElement.querySelector(`[data-code=${e?.code}]`);n&&this.spList.nativeElement.scrollTo({top:n.offsetTop,behavior:"smooth"});}});}_initSwipeToDialog(){this._addSwipeToDialog();}_addSwipeToDialog(){let e=this._document?.querySelector("#y-combined-content"),t=this._createSwipeElement();this._renderer.appendChild(e,t),this._initListeners(t,e);let n=e?.closest(".cdk-global-overlay-wrapper")??null;n&&this._setStyles(n,{"z-index":"999"});}_initListeners(e,t){let n=qi(e,"touchstart").pipe(Uu(()=>{this._renderer.setStyle(t,"box-shadow","0 -5px 5px rgba(0, 0, 0, 0.1)");}),le(r=>r.touches[0].clientY)),o$1=qi(e,"touchmove").pipe(Uu(r=>{r.preventDefault();})),s=qi(e,"touchend").pipe(Uu(()=>{this._renderer.removeStyle(t,"box-shadow");}),le(r=>r.changedTouches[0].clientY)),l=n.pipe(Bu(r=>s.pipe(le(u=>r>u+20))));mg(l,o$1).pipe(Su(100),Hu(this._destroy$)).subscribe(r=>{let u=this.currentState$.value.showListView;o(r)&&!u?this.toggleFilter(r):this.toggleListView(false);});}_setStyles(e,t){for(let n in t)this._renderer.setStyle(e,n,t[n]);}_createSwipeElement(){let e={position:"absolute",top:"0",left:"0",height:"65px",width:"100%",opacity:"0"},t=this._renderer.createElement("div");return this._setStyles(t,e),t}handleSelect(e){let t=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${t}/${e.title}/${e.subtitle}`},O.ADDRESS_SELECT);}static{this.\u0275fac=function(t){return new(t||i)(k(dr),k(Xu,8),k(ar),k(ui))};}static{this.\u0275cmp=hO({type:i,selectors:[["yota-ya-combined-content"]],viewQuery:function(t,n){if(t&1&&NO(Pn,5),t&2){let o;AO(o=RO())&&(n.spList=o.first);}},decls:3,vars:3,consts:[["coverageTabs",""],["spTabs",""],["spList",""],[1,"b-combined-map__mode-content"],[4,"ngIf"],[3,"handleSelect"],["y-button-icon","",1,"y-button-icon","b-combined-map__coverage-filter-button",3,"click","ngClass"],[1,"y-link-pseudo"],["color","primary"],[3,"ngIf"],["class","b-combined-map-coverage-filter__drop-panel",4,"ngIf"],[1,"b-combined-map-coverage-filter__drop-panel"],[4,"ngTemplateOutlet"],["y-stretch-tabs","","animationDuration","0ms",1,"b-combined-map-tabs",3,"selectedTabChange","selectedIndex"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[1,"b-combined-map-tabs__body"],["class","b-combined-map-tabs__tab-content",4,"ngFor","ngForOf"],[1,"b-combined-map-tabs__tab-content"],[1,"trialTariff__toggle",3,"change","checked","disabled","activeBgColor"],[1,"trialTariff__toggle",3,"change","checked","disabled"],["y-button-icon","","class","y-button-icon b-combined-map__coverage-filter-button",3,"click",4,"ngIf"],["class","sp-list",4,"ngIf"],["y-button-icon","",1,"y-button-icon","b-combined-map__coverage-filter-button",3,"click"],[1,"sp-list"],["class","sp-list__item",3,"click",4,"ngFor","ngForOf"],[1,"sp-list__item",3,"click"],[1,"sp-list__item-title"],["class","sp-list__item-address",4,"ngIf"],["class","sp-list__item-description",4,"ngIf"],["class","sp-list__item-work-time",4,"ngIf"],[1,"sp-list__item-functions"],["class","sp-list__item-function",4,"ngFor","ngForOf"],[1,"sp-list__item-address"],[1,"sp-list__item-description"],[1,"sp-list__item-work-time"],[1,"sp-list__item-function"]],template:function(t,n){t&1&&(Pp(0,"div",3),LI(1,Hn,4,2,"ng-container",4),GO(2,"async"),Lp()),t&2&&(eO(),aE("ngIf",ZO(2,1,n.currentState$)));},dependencies:[Zw,dn,Gw,Jw,Ih,tC,iC,cn$1,zt,my,Cu,gm],styles:["[_nghost-%COMP%]   .b-combined-map__coverage-filter-button[_ngcontent-%COMP%]{display:flex;gap:8px;margin:10px auto}[_nghost-%COMP%]   .b-combined-map__coverage-filter-button[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{will-change:auto;font-size:8px;transition:transform .2ms}[_nghost-%COMP%]   .b-combined-map__coverage-filter-button_active[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}[_nghost-%COMP%]   .b-combined-map-tabs[_ngcontent-%COMP%]  .y-tab-label{min-width:50%}[_nghost-%COMP%]   .b-combined-map-tabs__body[_ngcontent-%COMP%]{padding-top:35px}[_nghost-%COMP%]   .b-combined-map-tabs__tab-content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;margin-bottom:7px}[_nghost-%COMP%]   .b-combined-map-tabs__tab-content.disabled[_ngcontent-%COMP%]{color:#d9dce1}.sp-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;max-height:356px;margin:0 -24px;position:relative}.sp-list__item[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:15px 24px;gap:12px;cursor:pointer}.sp-list__item[_ngcontent-%COMP%]:hover{background-color:#f4fbfe}.sp-list__item-title[_ngcontent-%COMP%], .sp-list__item-address[_ngcontent-%COMP%], .sp-list__item-work-time[_ngcontent-%COMP%], .sp-list__item-description[_ngcontent-%COMP%]{font-size:16px;font-weight:700;line-height:22px;text-overflow:ellipsis}.sp-list__item-description[_ngcontent-%COMP%]{color:#a1a5ae;text-overflow:ellipsis}.sp-list__item-address[_ngcontent-%COMP%], .sp-list__item-work-time[_ngcontent-%COMP%], .sp-list__item-description[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.sp-list__item-description[_ngcontent-%COMP%]{color:#a1a5ae}.sp-list__item-functions[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:8px}.sp-list__item-function[_ngcontent-%COMP%]{display:inline-flex;padding:0 4px;border-radius:4px;color:#a1a5ae;background-color:#f8f8f8;font-size:12px;line-height:24px;vertical-align:middle}"],changeDetection:0});}}return i})();var Kn=["overlayContent"];function Wn(i,a){if(i&1&&EE(0,"y-tab",9),i&2){let e=a.$implicit;aE("label",e.label);}}function Jn(i,a){if(i&1&&(jp(0),LI(1,Wn,1,1,"y-tab",8),Vp()),i&2){let e=MO(2);eO(),aE("ngForOf",e.modeTabs);}}function ei(i,a){if(i&1&&EE(0,"y-tab",9),i&2){let e=MO().ngIf,t=MO();aE("label",t.modeTabs[e.modeTabIndex].label);}}function ti(i,a){if(i&1){let e=_O();Pp(0,"y-tab-group",6),FE("selectedTabChange",function(n){FR(e);let o=MO();return kR(o.changeModeTab(n.index))}),LI(1,Jn,2,1,"ng-container",7)(2,ei,1,1,"ng-template",null,0,KO),Lp();}if(i&2){let e=a.ngIf,t=kO(3);cE("solo-tab",e.splitMode),aE("selectedIndex",e.modeTabIndex),eO(),aE("ngIf",!e.splitMode)("ngIfElse",t);}}function ni(i,a){i&1&&(Pp(0,"div",10),EE(1,"yota-ya-combined-content"),Lp());}var we=class i extends p$1{set map$(a){this._map$=a;}constructor(a){super(),this._overlay=a,this._map$=new X,this._dialogService=D(mr),this._yaCombinedService=D(q),this._breakpointObserver=D(U),this.currentState$=this._yaCombinedService.currentState$,this.modeTabs=this._yaCombinedService.modeTabs,this.isDesktop$=this._breakpointObserver.observe(["(min-width: 993px)"]).pipe(le(e=>e.matches),Uu(e=>{this._isDesktop=e,e?this._toggleOverlay(e):this._yaCombinedService.showOverlayFilters$.getValue()&&this._dialogRef?.getState()!==0&&this._toggleOverlay(false);})),this.showCombinedPanel=true,this._isDesktop=true,this._yaCombinedService.getSpFilter(),this._yaCombinedService.showOverlayFilters$.pipe(it(()=>!this._isDesktop),Hu(this._onDestroy$)).subscribe(e=>{this._toggleOverlay(!e);});}ngOnInit(){this._map$.pipe(it(Boolean),wt(1),Hu(this._onDestroy$)).subscribe(()=>C(this,null,function*(){if(!ymaps.Layer)try{yield ymaps.modules.require(["Layer"],a=>{ymaps.Layer=a;});}catch(a){console.error("ymaps.Layer error: ",a);}this._yaCombinedService.updateLayers();}));}changeModeTab(a){this._yaCombinedService.changeModeTab(a);}_toggleOverlay(a){if(!this.showCombinedPanel||a){p$2.closeDialog(this._dialogRef);return}this._dialogRef=this._dialogService.open(We,{id:"y-combined-content",panelClass:["y-dialog-bottom","y-combined-content-dialog"],disableClose:false,hasBackdrop:false,scrollStrategy:this._overlay.scrollStrategies.reposition(),data:{isSwiped:true},restoreFocus:false});}static{this.\u0275fac=function(e){return new(e||i)(k(ge))};}static{this.\u0275cmp=hO({type:i,selectors:[["yota-ya-combined"]],viewQuery:function(e,t){if(e&1&&NO(Kn,5,Ye),e&2){let n;AO(n=RO())&&(t.overlayContentTemplate=n.first);}},inputs:{map$:"map$",showCombinedPanel:"showCombinedPanel"},features:[MI],decls:7,vars:6,consts:[["soloTab",""],[1,"b-combined-map__wrapper"],[1,"b-combined-map__form"],[1,"b-combined-map__modes-body"],["class","y-background-primary","y-stretch-tabs","","animationDuration","0ms",3,"selectedIndex","solo-tab","selectedTabChange",4,"ngIf"],["class","b-combined-map__modes-content",4,"ngIf"],["y-stretch-tabs","","animationDuration","0ms",1,"y-background-primary",3,"selectedTabChange","selectedIndex"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[1,"b-combined-map__modes-content"]],template:function(e,t){e&1&&(Pp(0,"div",1)(1,"div",2)(2,"div",3),LI(3,ti,4,5,"y-tab-group",4),GO(4,"async"),LI(5,ni,2,0,"div",5),GO(6,"async"),Lp()()()),e&2&&(eO(3),aE("ngIf",ZO(4,2,t.currentState$)),eO(2),aE("ngIf",ZO(6,4,t.isDesktop$)));},dependencies:[Zw,Ih,We,tC,my,Cu],styles:["[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-header{width:100%}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-header>.y-tab-label-container>.y-tab-list .y-tab-labels>.y-tab-label{background-color:#00aeef;color:#fff}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-header>.y-tab-label-container>.y-tab-list .y-tab-labels>.y-tab-label-active{background-color:#fff;color:#434c5d}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-body-wrapper, [_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-body-content{overflow:initial}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-body.y-tab-body-active{overflow:initial}[_nghost-%COMP%]     .y-tab-group.solo-tab .y-tab-header .y-tab-label{cursor:default!important}.b-combined-map__wrapper[_ngcontent-%COMP%]{position:absolute;top:calc(20px + -1 * var(--sales-points-margin-top, 0px));left:40px;display:flex;max-height:calc(100% - 40px);overflow:hidden}.b-combined-map__form[_ngcontent-%COMP%]{max-height:100%;width:360px;border-radius:5px;background-color:#fff;box-shadow:0 4px 12px #dbe1eb66;overflow:auto}.b-combined-map__modes-content[_ngcontent-%COMP%]{padding:16px 24px}@media (max-width: 992px){.b-combined-map__wrapper[_ngcontent-%COMP%]{width:calc(100vw - 80px);max-height:48px;overflow:hidden}.b-combined-map__form[_ngcontent-%COMP%]{width:100%}}@media (max-width: 480px){.b-combined-map__wrapper[_ngcontent-%COMP%]{width:calc(100vw - 32px);left:16px}}  .y-combined-content-dialog{transition:transform .2s ease}  body.header-has-under-panel .y-combined-content-dialog{transform:translateY(100%)!important}"],changeDetection:0});}};Pb([v$2],we.prototype,"_toggleOverlay",null);function ii(i,a){if(i&1){let e=_O();Pp(0,"div",1)(1,"div",2),FE("click",function(){FR(e);let n=MO();return kR(n.fullscreen())}),EE(2,"y-icon",3),Lp(),Pp(3,"div",4)(4,"div",5),FE("click",function(){FR(e);let n=MO();return kR(n.zoomIn())}),EE(5,"y-icon",6),Lp(),Pp(6,"div",5),FE("click",function(){FR(e);let n=MO();return kR(n.zoomOut())}),EE(7,"y-icon",7),Lp()(),Pp(8,"div",2),FE("click",function(){FR(e);let n=MO();return kR(n.setLocateUser())}),EE(9,"y-icon",8),Lp()();}if(i&2){let e=MO();eO(),aE("hidden",!e.controls.has("fullscreen")),eO(),aE("svgIcon",e.isFullscreen()?"map-fullscreen-off":"map-fullscreen-on"),eO(),aE("hidden",!e.controls.has("zoom")),eO(5),aE("hidden",!e.controls.has("locate"));}}var un=(()=>{class i extends p$1{constructor(e,t){super(),this._yaMapComponent=e,this._cdr=t,this.zoomIn$=new at,this.zoomOut$=new at,this.fullscreen$=new at,this.userCoordinates=new at,this._map=null,this._userMarker=void 0,this._userCoordinates=null,this._analyticsFacadeService=D(M),this._yaCombinedService=D(q),this._map$=new X;}set map$(e){this._map$=e;}ngOnInit(){this._map$.pipe(it(Boolean),wt(1),Hu(this._onDestroy$)).subscribe(e=>{this._map=e,this._cdr.markForCheck();});}zoomIn(){if(this._map){let e=this._map.getZoom()+1;this._map.setZoom(e,{checkZoomRange:true});let t=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${t}/\u0412\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043A\u0430\u0440\u0442\u043E\u0439/\u0423\u0432\u0435\u043B\u0438\u0447\u0438\u0442\u044C`},O.CLICK_MAP_CONTROLS);}}zoomOut(){if(this._map){let e=this._map.getZoom()-1;this._map.setZoom(e,{checkZoomRange:true});let t=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${t}/\u0412\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043A\u0430\u0440\u0442\u043E\u0439/\u0423\u043C\u0435\u043D\u044C\u0448\u0438\u0442\u044C`},O.CLICK_MAP_CONTROLS);}}fullscreen(){if(this._map){let e=this._map.options.get("isFullscreen");this._map.options.set("isFullscreen",!e),this.fullscreen$.emit(!e);}}isFullscreen(){return !!this._map?.options.get("isFullscreen")}setLocateUser(){let e=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${e}/\u0412\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043A\u0430\u0440\u0442\u043E\u0439/\u0421\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0435 \u043C\u0435\u0441\u0442\u043E\u043F\u043E\u043B\u043E\u0436\u0435\u043D\u0438\u0435`},O.CLICK_MAP_CONTROLS),ymaps.geolocation.get({}).then(t=>{this._map&&(this._userMarker&&this._map.geoObjects.remove(this._userMarker),this._userMarker=t.geoObjects.get(0),this._userCoordinates=t.geoObjects.get(0).geometry.getCoordinates(),this.userCoordinates.emit(this._userCoordinates),this._userCoordinates&&(this._userMarker=new ymaps.Placemark(this._userCoordinates,{},{iconLayout:"default#image",iconImageSize:[48,48],iconImageHref:"assets/images/ymap/marker-user.svg"}),this._userMarker.events.add("click",()=>this._moveToCoordinates(this._userCoordinates)),this._map.geoObjects.add(this._userMarker),this._moveToCoordinates(this._userCoordinates)));}).catch(t=>{_k.error(t);});}_moveToCoordinates(e){this._map&&this._map.setCenter(e,this._map.getZoom(),{duration:300});}static{this.\u0275fac=function(t){return new(t||i)(k(hn),k(ui))};}static{this.\u0275cmp=hO({type:i,selectors:[["yota-ya-control"]],inputs:{controls:"controls",map$:"map$"},outputs:{zoomIn$:"zoomIn$",zoomOut$:"zoomOut$",fullscreen$:"fullscreen$",userCoordinates:"userCoordinates"},features:[MI],decls:1,vars:1,consts:[["class","b-map__controls",4,"ngIf"],[1,"b-map__controls"],[1,"b-map__control","scale-edge",3,"click","hidden"],[3,"svgIcon"],[1,"b-map__controls-middle",3,"hidden"],[1,"b-map__control","scale-middle",3,"click"],["svgIcon","map-plus"],["svgIcon","map-minus"],["svgIcon","map-arrow-compass"]],template:function(t,n){t&1&&LI(0,ii,10,4,"div",0),t&2&&aE("ngIf",n.controls);},dependencies:[Zw,zt],styles:[".b-map__controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-between;position:absolute;gap:72px;width:48px;top:calc(50% - 165px);right:38px}.b-map__controls-middle[_ngcontent-%COMP%]{height:90px;width:100%;border:0 solid #ffffff;border-radius:9px;overflow:hidden;box-shadow:0 11px 9px #00000008}.b-map__controls-middle[_ngcontent-%COMP%]   .b-map__control[_ngcontent-%COMP%]{box-shadow:none}.b-map__control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#fff;box-shadow:0 11px 9px #00000008;transition:all .3s ease-in;cursor:pointer}@media (hover: hover){.b-map__control[_ngcontent-%COMP%]:hover{opacity:.8}}@media (hover: none){.b-map__control[_ngcontent-%COMP%]:active{opacity:.8}}.b-map__control[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{width:20px;height:20px}.b-map__control.scale-middle[_ngcontent-%COMP%]{width:48px;height:45px}.b-map__control.scale-middle[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{width:14px;height:14px}.b-map__control.scale-edge[_ngcontent-%COMP%]{width:48px;height:48px;border:0 solid #ffffff;border-radius:50%}"],changeDetection:0});}}return i})();var ai=["container"];function si(i,a){if(i&1&&EE(0,"yota-ya-combined",4),i&2){let e=MO();aE("map$",e.sharedMap$)("hidden",!e.showCombinedPanel)("showCombinedPanel",e.showCombinedPanel);}}function ri(i,a){if(i&1){let e=_O();Pp(0,"yota-ya-control",6),FE("fullscreen$",function(n){FR(e);let o=MO();return kR(o.setFullscreen(n))}),Lp();}if(i&2){let e=MO();aE("controls",e.getControls)("map$",e.sharedMap$);}}function li(i,a){i&1&&EE(0,"yota-map-banner");}var hn=(()=>{class i{set balloonOrderUrl(e){this._balloonOrderUrl=e;}set balloonOrderText(e){this._balloonOrderText=e;}constructor(e,t,n,o,s){this._el=e,this._ngZone=t,this._yaApiLoaderService=n,this._document=s,this.map$=new En$1(null),this.isMonochrome=true,this.isFullscreen=false,this.hidePlacemarksWithoutGood=false,this.center=[0,0],this.zoom=10,this.ready=new at,this.showCombined=true,this.showControls=true,this.isCombined=true,this.getControls=new Set(["fullscreen","locate","zoom"]),this.showCombinedPanel=true,this.hasBanner=true,this.isBannerOpen=false,this.isOrderMap=false,this.centerBalloonManual=false,this.pickupButtonText="\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C",this.pickupErrorText="\u0417\u0434\u0435\u0441\u044C \u0442\u043E\u0432\u0430\u0440 \u0443\u0436\u0435 \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0441\u044F, <br> \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443 \u043F\u0440\u043E\u0434\u0430\u0436",this.salePointSelected=VR(),this._yaCombinedService=D(q),this._sanitizer=D(qe$1),this._iconRegistry=D(rr),this._window=D(i$1),this.sharedMap$=this.map$.pipe(it(Boolean),Uu(l=>this._yaCombinedService.map=l),jr()),this._destroy$=new X,this._eventManager=new Qe(this._ngZone),this._balloonOrderUrl="voice/order-sim",this._balloonOrderText="\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443",this.actionbegin=this._eventManager.getLazyEmitter("actionbegin"),this.actionbreak=this._eventManager.getLazyEmitter("actionbreak"),this.actionend=this._eventManager.getLazyEmitter("actionend"),this.actiontick=this._eventManager.getLazyEmitter("actiontick"),this.actiontickcomplete=this._eventManager.getLazyEmitter("actiontickcomplete"),this.balloonclose=this._eventManager.getLazyEmitter("balloonclose"),this.balloonopen=this._eventManager.getLazyEmitter("balloonopen"),this.boundschange=this._eventManager.getLazyEmitter("boundschange"),this.yaclick=this._eventManager.getLazyEmitter("click"),this.yacontextmenu=this._eventManager.getLazyEmitter("contextmenu"),this.yadblclick=this._eventManager.getLazyEmitter("dblclick"),this.destroy=this._eventManager.getLazyEmitter("destroy"),this.hintclose=this._eventManager.getLazyEmitter("hintclose"),this.hintopen=this._eventManager.getLazyEmitter("hintopen"),this.marginchange=this._eventManager.getLazyEmitter("marginchange"),this.yamousedown=this._eventManager.getLazyEmitter("mousedown"),this.yamouseenter=this._eventManager.getLazyEmitter("mouseenter"),this.yamouseleave=this._eventManager.getLazyEmitter("mouseleave"),this.yamousemove=this._eventManager.getLazyEmitter("mousemove"),this.yamouseup=this._eventManager.getLazyEmitter("mouseup"),this.multitouchend=this._eventManager.getLazyEmitter("multitouchend"),this.multitouchmove=this._eventManager.getLazyEmitter("multitouchmove"),this.multitouchstart=this._eventManager.getLazyEmitter("multitouchstart"),this.optionschange=this._eventManager.getLazyEmitter("optionschange"),this.sizechange=this._eventManager.getLazyEmitter("sizechange"),this.typechange=this._eventManager.getLazyEmitter("typechange"),this.yawheel=this._eventManager.getLazyEmitter("wheel"),this._salesPointsSubject$=new X,this._placemarkTemplate=`<div class="ya-map__placemark">
          <svg width="26" height="35" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 35s13-14.626 13-21.875C26 5.876 20.18 0 13 0S0 5.876 0 13.125 13 35 13 35z" fill="#00AEEF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13 19a6 6 0 100-12 6 6 0 000 12z" fill="#fff"/></svg>
</div>`,this._placemarkActiveTemplate=`<div class="ya-map__placemark ya-map__placemark_active">
          <svg width="26" height="35" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 35s13-14.626 13-21.875C26 5.876 20.18 0 13 0S0 5.876 0 13.125 13 35 13 35z" fill="#434C5D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13 19a6 6 0 100-12 6 6 0 000 12z" fill="#fff"/></svg>
</div>`,this._functionsTemplate=`
        {% if geoObject.properties.functions %}
        <ul class="ya-map__balloon-pickup__functions">
            {% for function in geoObject.properties.functions %}
                <li class="ya-map__balloon-pickup__function">
                    {{function.name|raw}}
                </li>
            {% endfor %}
        </ul>
        {% endif %}
    `,this._functionsClusterTemplate=`
        {% if geoObject.properties.functions %}
        <ul class="ya-map__balloon-pickup__functions">
            {% for function in geoObject.properties.functions %}
                <li class="ya-map__balloon-pickup__function">
                    {{function.name|raw}}
                </li>
            {% endfor %}
        </ul>
        {% endif %}
    `,this._pickupButton=`
        <button class="y-button-secondary ya-map__balloon-pickup-select">
            ${this.pickupButtonText}
        </button>`,this._pickupClusterButton=`
        <button class="y-button-secondary ya-map__balloon-pickup-select" data-code="{{geoObject.properties.code}}">
            ${this.pickupButtonText}
        </button>`,this._pickupError=`
        <div class="ya-map__balloon-pickup-error">
            <svg class="ya-map__balloon-pickup-error__icon" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 20.5C17.1944 20.5 21 16.6944 21 12C21 7.30558 17.1944 3.5 12.5 3.5C7.80558 3.5 4 7.30558 4 12C4 16.6944 7.80558 20.5 12.5 20.5ZM12.5 22C18.0228 22 22.5 17.5228 22.5 12C22.5 6.47715 18.0228 2 12.5 2C6.97715 2 2.5 6.47715 2.5 12C2.5 17.5228 6.97715 22 12.5 22Z" fill="#00AEEF"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 11C13.0523 11 13.5 11.4477 13.5 12V16C13.5 16.5523 13.0523 17 12.5 17C11.9477 17 11.5 16.5523 11.5 16V12C11.5 11.4477 11.9477 11 12.5 11Z" fill="#00AEEF"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M13.75 8.25C13.75 8.94036 13.1904 9.5 12.5 9.5C11.8096 9.5 11.25 8.94036 11.25 8.25C11.25 7.55964 11.8096 7 12.5 7C13.1904 7 13.75 7.55964 13.75 8.25Z" fill="#00AEEF"/>
            </svg>
            <p class="ya-map__balloon-pickup-error__text">${this.pickupErrorText}</p>
        </div>`,this._pickupLoader='<div class="ya-map__balloon-ellipsis"><div></div><div></div><div></div><div></div></div>',this._uniqPointsSet=new Xe,this._triggerOverlayIntersecting=false,this._mapIntersecting=false,this.intersectionOverlayTriggerId="map-intersection-overlay-trigger",this._scrollZoomByUrl=true,this._maxZoom=18,this._minZoom=6,this._clusterOrderClass="ya-map__balloon ya-map__balloon_cluster ya-map__balloon_list ya-map__balloon_list_order",this._clusterMapClass="ya-map__balloon ya-map__balloon_cluster ya-map__balloon_list",this._analyticsFacadeService=D(M),this._router=D(q$1),this._initIcons(),this.setFullscreen(JSON.parse(o.snapshot.queryParams.fullscreen||"false")),this._scrollZoomByUrl=this._router.url.includes("e-sim")||this._router.url.includes("modem"),this._yaCombinedService.selectedSalePoint$.pipe(Hu(this._destroy$)).subscribe(l=>{if(!l){this.map$.value?.balloon.close();return}let r=this._clusterer.getGeoObjects().find(h=>h.properties.get("code")===l.code);if(!r)return;let u=this._clusterer.getObjectState(r);if(u.isClustered&&u.cluster)u.cluster.state.set("activeObject",r),this._clusterer.balloon.open(u.cluster);else {if(!r?.balloon||r.balloon.isOpen())return;this.map$.value?.balloon.isOpen&&this.map$.value.balloon.close(),r.balloon?.open(void 0,l,{shadow:true,layout:this._balloonLayout,contentLayout:this._balloonContentLayout,panelMaxMapArea:0});}}),this.yaclick.pipe(Hu(this._destroy$)).subscribe(()=>{this.bannerComponent?.hideMobileCard();});}get maxZoom(){return this._maxZoom}set maxZoom(e){e&&(this._maxZoom=e);}get minZoom(){return this._minZoom}set minZoom(e){e&&(this._minZoom=e);}set salePoints(e){e&&this._filterAndDisplaySalePoints(e);}set salePoints$(e){e.pipe(it(Boolean),Hu(this._destroy$)).subscribe(t=>{this._filterAndDisplaySalePoints(t);});}set controls(e){this.getControls=new Set(e);}set fullScreen(e){this.setFullscreen(e);}get _balloonTemplate(){return `<div class="ya-map__balloon-pickup">
                     <div class="ya-map__balloon-pickup__content">
                        <div class="ya-map__balloon-pickup__title">{{geoObject.properties.name|raw}}</div>
                        <div class="ya-map__balloon-pickup__location">
                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.address|raw}}</div>
                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.howToFind|raw}}</div>
                        </div>
                        <div class="ya-map__balloon-pickup__time">{{geoObject.properties.workingTime|raw}}</div>
                        ${this.isCombined?this._functionsTemplate:""}
                        <div class="ya-map__balloon-pickup__actions ya-map__balloon-pickup-select-show">
                        ${this.isCombined?this._combButton:this._pickupButton}
                        </div>

                         ${this._pickupLoader}
                         ${this._pickupError}
                    </div>
                </div>`}get _baloon(){return {template:this._balloonTemplate,layout:`<div class='ya-map__balloon'>
                        {% include options.contentLayout %}
                        <a class="ya-map__balloon-close"></a>
                     </div>`,clusterIconContentLayout:this._getClusterIcon(),tagsTemplate:"<div>Functions</div>"}}get _clusterBalloonTemplate(){return `<div class="ya-map__balloon-pickup">
                     <div class="ya-map__balloon-pickup__content">
                        <div class="ya-map__balloon-pickup__title">{{name|raw}}</div>
                        <div class="ya-map__balloon-pickup__location">
                          <div class="ya-map__balloon-pickup__address">{{address|raw}}</div>
                        </div>
                        <div class="ya-map__balloon-pickup__time">{{workingTime|raw}}</div>
                        ${this.isCombined?this._functionsTemplate:""}
                        <div class="ya-map__balloon-pickup__actions">
                        ${this.isCombined?this._combButton:this._pickupButton}
                        ${this._pickupClusterButton}
                        ${this._pickupLoader}
                        </div>
                    </div>
                </div>`}get _clusterBalloon(){return {template:"<div>TEST</div>",layout:`<div class="${this.isOrderMap?this._clusterOrderClass:this._clusterMapClass}">
                        <div class="${this.isOrderMap?"ya-map__balloon-wrapper ya-map__balloon-wrapper_order":"ya-map__balloon-wrapper"}">
                        <a class="ya-map__balloon-close"></a>
                        <div class="${this.isOrderMap?"ya-map__balloon-box":"ya-map__balloon-box ya-map__balloon-box_map"}">
                            {% for geoObject in properties.geoObjects %}
                                <div class="${this.isOrderMap?"ya-map__balloon-pickup ya-map__balloon-pickup_order":"ya-map__balloon-pickup"}">
                                     <div class="ya-map__balloon-pickup__content">
                                        <div class="ya-map__balloon-pickup__title">{{geoObject.properties.name|raw}}</div>
                                        <div class="ya-map__balloon-pickup__location">
                                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.address|raw}}</div>
                                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.howToFind|raw}}</div>
                                        </div>
                                        <div class="ya-map__balloon-pickup__time">{{geoObject.properties.workingTime|raw}}</div>
                                        ${this.isCombined?this._functionsClusterTemplate:""}
                                        ${this.isCombined?"":`<div class="ya-map__balloon-pickup__actions">${this._pickupClusterButton}
                                                 </div>`}
                                         ${this.isOrderMap?`${this._pickupLoader}  ${this._pickupError}`:""}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        </div>
                        ${this.isCombined?`<div class=${this.isOrderMap?"ya-map__balloon-pickup__actions ya-map__balloon-pickup__actions_hidden ":"ya-map__balloon-pickup__actions"}>${this._combButton}</div>`:""}
                     </div>`,clusterIconContentLayout:this._getClusterIcon(),clusterActiveIconContentLayout:this._getActiveClusterIcon(),tagsTemplate:"<div>Functions</div>"}}get _combButton(){return `<a href="${this._balloonOrderUrl}" class="${this.isOrderMap?"y-button-secondary ya-map__balloon-pickup-select":"y-button-secondary ya-map__balloon-pickup-select ya-map__balloon-pickup-select_map"}">${this._balloonOrderText}</a>`}ngOnChanges(e){let t=this.map$.value;if(t){let{center:n,zoom:o,state:s,options:l}=e;s&&this._setState(this._combineState(),t),n&&t.setCenter(n.currentValue),o&&t.setZoom(o.currentValue),l&&t.options.set(l.currentValue);}}ngAfterViewInit(){this._yaCombinedService.sharedSearchValue$.pipe(Hu(this._destroy$)).subscribe(e=>{let n=this._yaCombinedService.getCurrentModeType()==T.COVER?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${n}/${e}`},O.FIND_ADRESS);}),this._yaApiLoaderService.load().pipe(wt(1),Hu(this._destroy$)).subscribe(()=>C(this,null,function*(){let e=mn(),t=this._createMap(e);if(this._scrollZoomByUrl&&t.behaviors.disable("scrollZoom"),yield this._initTemplateFactory(),this.map$.next(t),this.map$.value){let n,o;this.map$.value.balloon.events.add("open",s=>{s.originalEvent.target?.options?.set("iconLayout",this._placemarkActiveIconLayout),n=s.originalEvent.target;let l;n?.properties?._data?.address?l=n?.properties?._data?.address:l=n.getClusters()[0]?.properties?._data?.geoObjects[0]?.properties?._data?.address,l&&this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436/${l}`},O.SELECT_SALE_POINT);let r=n.getClusters?n?.getClusters():[],u=n.balloon.getOverlaySync().getView().getPosition();o=r.find(h=>{let k=h.getOverlaySync().getView().getPosition();return k[0]===u[0]&&k[1]===u[1]}),s.originalEvent.target?.options?.set("iconLayout",this._placemarkActiveIconLayout),o?.options?.set("clusterIconLayout",this._clusterActiveIconContentLayout),this._centerBalloon();}).add("close",()=>{o?.options?.set("clusterIconLayout",this._clusterIconContentLayout),n?.options?.set("iconLayout",this._placemarkIconLayout),n=null,o=null;}),this.map$.value.geoObjects.events.add("click",s=>{let r=s.get("target").properties.get("geoObjects");Y(r)&&this.map$.value?.balloon.isOpen()&&this._yaCombinedService.selectedSalePoint$.next(null);});}this._eventManager.setTarget(t),this._ngZone.run(()=>this.ready.emit({ymaps,target:t}));})),this._initIntersectionOverlayTrigger(),this._initBannerIntersectionObserver();}ngOnDestroy(){clearTimeout(this._mapTimeout),this._eventManager.destroy(),this._destroy$.next(),this._destroy$.complete(),this._intersectionObserver?.disconnect();}setFullscreen(e){this.isFullscreen=e,this._router.navigate([],{queryParams:{fullscreen:this.isFullscreen},queryParamsHandling:"merge",skipLocationChange:true}).then(),this._mapTimeout=setTimeout(t=>{this.map$.value?.container.fitToViewport();});}displayBalloon(e){if(!this.map$.value)return;let t=e,n=[+t.latitude,+t.longitude];this.map$.value.balloon.open(n,t,{shadow:true,layout:this._balloonLayout,contentLayout:this._balloonContentLayout,panelMaxMapArea:0}).then(()=>{this._centerBalloon();});}_initTemplateFactory(){return C(this,null,function*(){ymaps.templateLayoutFactory||(yield ymaps.modules.require(["templateLayoutFactory"],e=>{ymaps.templateLayoutFactory=e;})),this._makeTemplate();})}_makeTemplate(){let e=this;e._balloonLayout=ymaps.templateLayoutFactory.createClass(this._baloon.layout,{build:function(){e._balloonLayout.superclass.build.call(this);let t=".ya-map__balloon",n=e._balloonLayout.superclass.getParentElement.call(this).querySelector(t),o=n?.querySelector(`${t}-close`),s=n?.querySelector(`${t}-pickup-select`);o?.addEventListener("click",ymaps.util.bind(this.onCloseClick,this)),s?.addEventListener("click",ymaps.util.bind(this.onSelectClick,this)),this.applyElementOffset();},clear:function(){let t=".ya-map__balloon",n=e._balloonLayout.superclass.getParentElement.call(this).querySelector(t),o=n?.querySelector(`${t}-close`),s=n?.querySelector(`${t}-pickup-select`);o?.removeEventListener("click",ymaps.util.bind(this.onCloseClick,this)),s?.removeEventListener("click",ymaps.util.bind(this.onSelectClick,this)),e._balloonLayout.superclass.clear.call(this);},onCloseClick:function(){this.events.fire("userclose"),e._yaCombinedService.selectedSalePoint$.next(null);},onSelectClick:function(){e._ngZone.run(()=>{e.salePointSelected.emit(this._data?.userData);});},applyElementOffset:function(){let n=e._balloonLayout.superclass.getParentElement.call(this).querySelector(".ya-map__balloon");n.style.left=-(n.offsetWidth/2)+"px",n.style.top=-(n.offsetHeight+14)+"px";}}),e._balloonContentLayout=ymaps.templateLayoutFactory.createClass(e._baloon.template),e._placemarkIconLayout=ymaps.templateLayoutFactory.createClass(e._placemarkTemplate,{build(){e._placemarkIconLayout.superclass.build.call(this),e._placemarkIconLayout.superclass.getParentElement.call(this).querySelector(".ya-map__placemark").setAttribute("data-points-codes",this._data?.properties?._data?.code);},clear(){e._placemarkIconLayout.superclass.clear.call(this);}}),e._placemarkActiveIconLayout=ymaps.templateLayoutFactory.createClass(e._placemarkActiveTemplate),e._clusterIconContentLayout=ymaps.templateLayoutFactory.createClass(e._clusterBalloon.clusterIconContentLayout,{build(){e._clusterIconContentLayout.superclass.build.call(this);let n=e._clusterBalloonLayout.superclass.getParentElement.call(this).querySelector(".ya-map__cluster-icon"),o=this._data?.properties?._data?.geoObjects.map(s=>s?.properties?._data?.code);n.setAttribute("data-points-codes",o?.join(","));},clear(){e._clusterIconContentLayout.superclass.clear.call(this);}}),e._clusterActiveIconContentLayout=ymaps.templateLayoutFactory.createClass(e._clusterBalloon.clusterActiveIconContentLayout,{build(){e._clusterIconContentLayout.superclass.build.call(this);},clear(){e._clusterIconContentLayout.superclass.clear.call(this);}}),e._clusterBalloonLayout=ymaps.templateLayoutFactory.createClass(e._clusterBalloon.layout,{build(){e._clusterBalloonLayout.superclass.build.call(this);let t=".ya-map__balloon",n=e._clusterBalloonLayout.superclass.getParentElement.call(this).querySelector(t),o=n?.querySelector(`${t}-close`),s=n?.querySelectorAll(`${t}-pickup-select`);o?.addEventListener("click",ymaps.util.bind(this.onCloseClick,this)),s.forEach(l=>{l?.addEventListener("click",ymaps.util.bind(this.onSelectClick,this));}),this.applyElementOffset();},clear(){e._clusterBalloonLayout.superclass.clear.call(this);},onSelectClick(t){let n=t.target.getAttribute("data-code");if(n){let o=this._data?.cluster?.properties?._data?.geoObjects.find(s=>s?.properties?._data?.code===n);o&&e.salePointSelected.emit(o.properties._data);}else {let o=this._data?.cluster?.properties?._data?.geoObjects[0]?.properties?._data;e.salePointSelected.emit(o);}},onCloseClick(t){e._ngZone.run(()=>{}),this.events.fire("userclose");},applyElementOffset:function(){let n=e._clusterBalloonLayout.superclass.getParentElement.call(this).querySelector(".ya-map__balloon");n.style.left=-(n.offsetWidth/2)+"px",n.style.top=-(n.offsetHeight+14)+"px";}});}_filterAndDisplaySalePoints(e=[]){let t={},n={};if(this._clusterer?.removeAll(),this._clusterer=this._createVisitedClusterer({clusterIconLayout:this._clusterIconContentLayout,clusterIconPane:"overlaps",minClusterSize:2,offset:[0,0],clusterHideIconOnBalloonOpen:false,geoObjectHideIconOnBalloonOpen:false,clusterOpenBalloonOnClick:true,gridSize:128,clusterDisableClickZoom:false,clusterBalloonLayout:this._clusterBalloonLayout}),e.forEach(o=>{let{code:s}=o;s&&(t[s]=o);}),!v$1(t)&&this.map$.value){let o=[];for(let l in t){let r=t[l],u=new ymaps.Placemark([r.latitude,r.longitude],r,{iconLayout:this._placemarkIconLayout,iconPane:"overlaps"});u.events.add("click",()=>{this._yaCombinedService.selectedSalePoint$.next(u.balloon.isOpen()?null:r);}),o.push(u),n[r.code]=u;}let s=o.filter(l=>{let r=l.properties.getAll().good;return r===null?true:r.remains!==0});this._clusterer.add(this.hidePlacemarksWithoutGood?s:o),this.map$.value.geoObjects.add(this._clusterer);}}_createVisitedClusterer(e){let t=new ymaps.Clusterer(e),n=t.createCluster.bind(t);return t.createCluster=(o,s)=>{let l=n(o,s);return s.map(u=>this._uniqPointsSet.get(u)).sort((u,h)=>u-h),l},t}_setState(e,t){let{behaviors:n,bounds:o,center:s,controls:l,margin:r,type:u,zoom:h}=e;n&&t.behaviors.enable(n),o&&t.setBounds(o),s&&t.setCenter(s),l&&l.forEach(k=>t.controls.add(k)),r&&t.margin.setDefaultMargin(r),u&&t.setType(u),h&&t.setZoom(h);}_createMap(e){return this.container.nativeElement.setAttribute("id",e),this.options=x(w$1({},this.options),{mapId:e,isMonochrome:this.isMonochrome,isFullscreen:this.isFullscreen,maxZoom:this.maxZoom,minZoom:this.minZoom,yandexMapDisablePoiInteractivity:true}),new ymaps.Map(e,this._combineState(),this.options||{})}_combineState(){let e=this.state||{};return x(w$1({},e),{center:this.center||e.center||[0,0],zoom:this.zoom??e.zoom??10,controls:[]})}_getClusterIcon(){return `<div class="ya-map__cluster-icon"
                    data-codes="1">
                    <svg width="26" height="35" viewBox="0 0 26 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M13 35C13 35 26 20.3737 26 13.125C26 5.87626 20.1797 0 13 0C5.8203 0 0 5.87626 0 13.125C0 20.3737 13 35 13 35Z" fill="#00AEEF"/>
                    </svg>
                    <span class="ya-map__cluster-icon__counter">{{properties.geoObjects.length}}</span>
                </div>`}_getActiveClusterIcon(){return `<div class="ya-map__cluster-icon ya-map__cluster-icon_active">
                    <svg width="26" height="35" viewBox="0 0 26 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M13 35C13 35 26 20.3737 26 13.125C26 5.87626 20.1797 0 13 0C5.8203 0 0 5.87626 0 13.125C0 20.3737 13 35 13 35Z" fill="#434C5D"/>
                    </svg>
                    <span class="ya-map__cluster-icon__counter">{{properties.geoObjects.length}}</span>
                </div>`}_createManager(e){let t=new ymaps.GeoObjectCollection;this.map$.value?.geoObjects.add(t);let o=this,s=ymaps.templateLayoutFactory.createClass(this._baloon.layout,{build:function(){s.superclass.build.call(this);let r=".ya-map__balloon";s.superclass.getParentElement.call(this).querySelector(r)?.querySelector(`${r}-close`)?.addEventListener("click",ymaps.util.bind(this.onCloseClick,this));},clear(){s.superclass.clear.call(this);},onCloseClick:function(r){r.preventDefault(),this.events.fire("userclose"),o.salePointSelected.emit(this.getData().properties.getAll());}}),l=ymaps.templateLayoutFactory.createClass(this._baloon.template);for(let r of e){let u=new ymaps.GeoObject({geometry:new ymaps.geometry.Point([+r.latitude,+r.longitude]),properties:r},{balloonLayout:s,balloonContentLayout:l});t.add(u);}}_centerBalloon(){if(this.centerBalloonManual)return;let e=this._document.querySelector(".ya-map__balloon, .ya-map__balloon-cluster");if(!e)return;let t=this.map$.value;if(!t)return;let n=e.getBoundingClientRect(),o={top:n.top+this._window.scrollY,left:n.left+this._window.scrollX},s=o.left+n.width/2,l=o.top+n.height/2,u=t.options.get("projection").fromGlobalPixels(t.converter.pageToGlobal([s,l]),t.getZoom());t.panTo(u,{flying:false,delay:0,duration:250});}_initIntersectionOverlayTrigger(){if(typeof IntersectionObserver<"u"){this._intersectionObserver?.disconnect(),this._intersectionObserver=new IntersectionObserver(t=>{t.forEach(o=>{o.target.id===this.intersectionOverlayTriggerId?this._triggerOverlayIntersecting=o.isIntersecting:this._mapIntersecting=o.isIntersecting;});let n=this._triggerOverlayIntersecting&&this._mapIntersecting;this._yaCombinedService.showOverlayFilters$.next(n);},{threshold:.5}),this._intersectionObserver.observe(this._el.nativeElement);let e=this._document.querySelector(`#${this.intersectionOverlayTriggerId}`);e&&this._intersectionObserver.observe(e);}}_initBannerIntersectionObserver(){typeof IntersectionObserver<"u"&&new IntersectionObserver(t=>{t.forEach(n=>{n.intersectionRatio>.9&&this._yaCombinedService.bannerIntersection$.next(true);});},{threshold:.9}).observe(this._el.nativeElement);}_initIcons(){[{name:"map-plus",path:"assets/images/ymap/plus.svg"},{name:"map-minus",path:"assets/images/ymap/minus.svg"},{name:"map-marker-user",path:"assets/images/ymap/marker-user.svg"},{name:"map-fullscreen-on",path:"assets/images/ymap/fullscreen-on.svg"},{name:"map-fullscreen-off",path:"assets/images/ymap/fullscreen-off.svg"},{name:"map-arrow-compass",path:"assets/images/ymap/arrow-compass.svg"}].forEach(t=>{this._iconRegistry.addSvgIcon(t.name,this._sanitizer.bypassSecurityTrustResourceUrl(t.path));});}static{this.\u0275fac=function(t){return new(t||i)(k(Je),k(we$1),k(qe),k(F),k(dr))};}static{this.\u0275cmp=hO({type:i,selectors:[["yota-map"]],viewQuery:function(t,n){if(t&1&&(NO(ai,5),NO(ye,5)),t&2){let o;AO(o=RO())&&(n.container=o.first),AO(o=RO())&&(n.bannerComponent=o.first);}},inputs:{isMonochrome:"isMonochrome",isFullscreen:"isFullscreen",hidePlacemarksWithoutGood:"hidePlacemarksWithoutGood",center:"center",zoom:"zoom",state:"state",options:"options",showCombined:"showCombined",showControls:"showControls",isCombined:"isCombined",getControls:"getControls",showCombinedPanel:"showCombinedPanel",hasBanner:"hasBanner",balloonOrderUrl:"balloonOrderUrl",balloonOrderText:"balloonOrderText",isOrderMap:"isOrderMap",centerBalloonManual:"centerBalloonManual",pickupButtonText:"pickupButtonText",pickupErrorText:"pickupErrorText",maxZoom:"maxZoom",minZoom:"minZoom",salePoints:"salePoints",salePoints$:"salePoints$",controls:"controls",fullScreen:"fullScreen"},outputs:{ready:"ready",salePointSelected:"salePointSelected",actionbegin:"actionbegin",actionbreak:"actionbreak",actionend:"actionend",actiontick:"actiontick",actiontickcomplete:"actiontickcomplete",balloonclose:"balloonclose",balloonopen:"balloonopen",boundschange:"boundschange",yaclick:"yaclick",yacontextmenu:"yacontextmenu",yadblclick:"yadblclick",destroy:"destroy",hintclose:"hintclose",hintopen:"hintopen",marginchange:"marginchange",yamousedown:"yamousedown",yamouseenter:"yamouseenter",yamouseleave:"yamouseleave",yamousemove:"yamousemove",yamouseup:"yamouseup",multitouchend:"multitouchend",multitouchmove:"multitouchmove",multitouchstart:"multitouchstart",optionschange:"optionschange",sizechange:"sizechange",typechange:"typechange",yawheel:"yawheel"},features:[qo],decls:7,vars:10,consts:[["container",""],[1,"b-map"],[3,"id"],[1,"container"],[3,"map$","hidden","showCombinedPanel"],[3,"controls","map$"],[3,"fullscreen$","controls","map$"]],template:function(t,n){t&1&&(Pp(0,"div",1),EE(1,"div",2)(2,"div",3,0),LI(4,si,1,3,"yota-ya-combined",4)(5,ri,1,2,"yota-ya-control",5)(6,li,1,0,"yota-map-banner"),Lp()),t&2&&(cE("fullscreen",n.isFullscreen),eO(),aE("id",n.intersectionOverlayTriggerId),eO(),cE("monochrome",n.isMonochrome)("fullscreen",n.isFullscreen),eO(2),EO(n.showCombined?4:-1),eO(),EO(n.showControls?5:-1),eO(),EO(n.hasBanner?6:-1));},dependencies:[we,un,ye],styles:[`[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]{display:block;position:relative;height:100%;width:100%}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]   .container.fullscreen[_ngcontent-%COMP%]{height:100vh;width:100vw}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]  [class*=map-copyrights]{display:none}[_nghost-%COMP%]   .b-map.fullscreen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;width:100vw;z-index:1}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .monochrome [class*=ymaps-2][class*=-inner-panes] [class*=ymaps-2][class*=-ground-pane]>ymaps:first-child{filter:url("data:image/svg+xml;utf8, <svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='matrix' values='0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0'/></filter></svg>#grayscale");-webkit-filter:grayscale(100%)}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon{position:relative;width:327px;background-color:#fff;top:-323.8px;left:-163.5px;border-radius:16px;overflow:hidden;padding:16px 0 16px 16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_cluster{padding:0}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-wrapper{overflow-y:auto;max-height:332px;padding:0 0 16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis{display:none;position:relative;left:50%;bottom:20px;transform:translate(-105%);width:40px;height:40px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis.ya-map__balloon-pickup-loader-show{display:inline-block}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div{position:absolute;top:33px;width:16px;height:16px;border-radius:50%;background:#00aeef;animation-timing-function:cubic-bezier(0,1,1,0);box-sizing:border-box}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(1){left:8px;animation:_ngcontent-%COMP%_lds-ellipsis1 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(2){left:8px;animation:_ngcontent-%COMP%_lds-ellipsis2 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(3){left:32px;animation:_ngcontent-%COMP%_lds-ellipsis2 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(4){left:56px;animation:_ngcontent-%COMP%_lds-ellipsis3 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon:not(.ya-map__balloon_list){padding:16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list_order{max-height:332px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list .ya-map__balloon-pickup-select{width:100%}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list .ya-map__balloon-pickup-select_map{margin:16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list::-webkit-scrollbar{width:6px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box{max-height:332px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box_map{padding:16px 0 16px 16px;overflow-y:unset}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box::-webkit-scrollbar{width:6px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup{display:flex;flex-direction:column;gap:20px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup_order{padding:16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error{border-radius:12px;border:1px solid #ff6b6e;padding:8px 12px;display:flex;gap:8px;display:none}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error.ya-map__balloon-pickup-error-show{display:flex}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error__icon{rotate:180deg}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error__icon path{fill:#ff6b6e}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error__text{color:#ff6b6e;font-size:12px;line-height:18px;font-weight:400}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__title{margin-bottom:4px;padding-right:32px;color:#434c5e;font-size:16px;line-height:22px;font-weight:600}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__location{margin:0 0 16px;padding-right:32px;color:#89909c;font-size:16px;line-height:24px;font-weight:400}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__time{margin:0 0 12px;padding-right:16px;color:#434c5e;font-size:16px;line-height:24px;font-weight:400}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__functions{display:flex;flex-direction:row;flex-wrap:wrap;gap:8px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__function{display:flex;align-items:center;justify-content:center;height:24px;padding:0 4px;border-radius:4px;color:#a1a5ae;background-color:#f8f8f8;font-size:12px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__actions{display:flex;justify-content:center}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__actions_hidden{display:none}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-select{border:none;display:flex;background-color:#e5f7fd;height:auto;width:100%;min-height:initial;min-width:initial;max-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-close{position:absolute;top:16px;right:16px;display:block;width:24px;height:24px;background:url(/assets/images/icons/close-light.svg) 100% no-repeat;background-size:24px 24px;cursor:pointer}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__cluster-icon{position:relative;display:flex;align-items:center;justify-content:center;width:26px;margin-top:8px;transform:translate(-13px)}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__cluster-icon__counter{position:absolute;top:15%;color:#fff;font-size:12px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__cluster-icon_active{transform:scale(1.5) translateY(-6px) translate(-9px)}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__placemark{margin-top:8px;transform:translate(-13px)}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__placemark_error svg path:first-child{fill:#bdc0c6}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__placemark_active{transform:scale(1.5) translateY(-6px) translate(-13px)}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__functions+.ya-map__balloon-pickup__actions{margin-top:16px}@keyframes _ngcontent-%COMP%_lds-ellipsis1{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_lds-ellipsis3{0%{transform:scale(1)}to{transform:scale(0)}}@keyframes _ngcontent-%COMP%_lds-ellipsis2{0%{transform:translate(0)}to{transform:translate(24px)}}`],changeDetection:0});}}return i})();
export{dn as d,hn as h,q};