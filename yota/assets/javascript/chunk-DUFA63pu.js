import {h as hn$1,d as dn$1}from'./chunk-DmWUUKq1.js';import {n,k}from'./chunk-CNoCOKQ_.js';import {r}from'./chunk-BNK4z9tR.js';import {D as D$1}from'./chunk-D9sMjN11.js';import {p as pt}from'./chunk-BqdQpYiq.js';import {N,O,t}from'./chunk-OwHDLoDr.js';import {D,ai as i$1,aM as En$1,aP as R,G as p,J as it,dS as jr$1,d1 as je,d0 as Pe,d4 as qe$1,e6 as de$1,d3 as Te,d6 as He,d2 as Ce,a1 as x,a2 as w$1,X as Uu,c5 as Ie,bH as Bh,b2 as le,bG as Li$1,e7 as gg,dV as og,al as jR,aO as K,aH as mr,W,az as X,bt as Zh,aA as Vu,e8 as R$1,w as wt,cp as Fu,cN as $,q as U,aI as q,T as Ou,r as Hu,bu as Ru,h as hO,aK as tC,_ as zt,a_ as ql,s as BO,a as MI,P as Pp,aD as GO,L as LI,m as PO,b as Lp,aq as vO,y as cE,aE as ZO,e as eO,ao as EO,H as HE,N as NO,A as AO,R as RO,cn as I,bx as Ie$1,aj as dr,M,E,O as O$1,Q as p$1,bN as ze$1,c4 as ze$2,u as ui,F,be as ru,bf as lc,co as c,S as Su,Z as Zw,I as Ih,a3 as An$1,ct as Dn$1,a4 as Ge,a5 as yn$1,cu as Cn$1,cv as ot,a7 as Mn$1,a8 as Tt,cw as Bt,cs as x$1,cA as gd,ab as Ty,cB as gm,ac as ld,cz as ar,an as ae,db as Ny,dc as Cd,aQ as hd,c as aE,k as k$1,bY as ar$1,bg as Hn$1,l as EE,ck as h$1,aV as Oi$1,aL as cn$1,v as FE,$ as $p,ad as _O,cP as TO,ag as kR,af as FR,cV as SO,z as Pc,d9 as VR,da as cd,au as kO,bn as HO,a0 as at$1,ap as CO,ar as bO,c0 as _r,c6 as mr$1,f as MO,cb as _,c_ as G$1,c$ as P,aB as Bu,dg,dh as tb,aU as Vy,dd as Rt$1,bk as qI,a6 as Jt,di as Jg,dj as Zg,cx as tu,aJ as Jw,K as KO,as as wO,a$ as QO,b3 as YO,cd as E$1,ce as v,cf as A,c8 as Dy,d as jp,V as Vp,cM as vn$1,b0 as bE,at as UO,ax as Pb,ay as v$1,cO as rC,bL as $$1,Y as YR,b6 as Ye,e9 as f,aR as cm,av as Je$1,n as lv,ea as K$1,ch as ve$1}from'./main-4LN5YMRF.js';import {u as ur,I as It}from'./chunk-D7oc2sSD.js';import {h}from'./chunk-Dy7C0KFS.js';import {n as n$1}from'./chunk-DjGbTwFD.js';import {y}from'./chunk-DMiT3hhT.js';var Rt=(()=>{class r{get device$(){return this._device$}get device(){return this._device$.value}constructor(e){this._localStorageService=e,this.cartDeviceKey="yotaCart-device",this._device$=new En$1(null),this._device$.next(this._localStorageService.getItemParsed(this.cartDeviceKey));}setDeviceId(e){let t=this._device$.getValue();t?this._setDevice(e?x(w$1({},t),{id:e}):null):this._setDevice(e?{id:e}:null);}setInfo(e){let t=this._device$.getValue();t?t=w$1(w$1({},t),e):t=w$1({},e),this._setDevice(t);}_setDevice(e){this._device$.next(e),e?this._localStorageService.setItemParsed(this.cartDeviceKey,e):this._localStorageService.removeItem(this.cartDeviceKey);}static{this.\u0275fac=function(t){return new(t||r)(K($$1))};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var at=class{};var Q=function(r){return r.CONTACT="CONTACT",r.RECEIVING="RECEIVING",r.PAYMENT="PAYMENT",r.BEAUTIFUL_NUMBER="BEAUTIFUL_NUMBER",r}(Q||{}),j=function(r){return r.DISABLE="DISABLE",r.ACTIVE="ACTIVE",r.WITH_DATA="WITH_DATA",r.HIDDEN="HIDDEN",r}(j||{});var we=function(r){return r[r.HIDDEN=0]="HIDDEN",r[r.NEXT=1]="NEXT",r[r.CONFIRM=2]="CONFIRM",r[r.CONFIRM_ORDER=3]="CONFIRM_ORDER",r}(we||{}),vt=function(r){return r.CARD="CARD_TO_COURIER",r.CASH="CASH",r}(vt||{}),At=function(r){return r.NO_REGION="NO_REGION",r.DEFAULT="DEFAULT",r.INVALID_PHONE="INVALID_PHONE",r.CANT_PICKUP="CANT_PICKUP",r}(At||{});var di=class{static restrictedAddress(o){return o.value?Object.keys(o.value).length<=0?{restrictedAddress:true}:!o.value?.street&&!o.value?.settlement?{restrictedStreetHouse:true}:o.value?.house?null:{restrictedHouse:true}:{restrictedAddress:true}}};function eo(r,o){if(r&1&&EE(0,"span",10),r&2){let e=MO(2);aE("innerHTML",e.enabledText,YR);}}function to(r,o){if(r&1&&(Pp(0,"span",11),PO(1),Lp()),r&2){let e=MO(2);eO(),$p(" ",e.disableText," ");}}function io(r,o){if(r&1&&(Pp(0,"span",8),LI(1,eo,1,1,"span",9)(2,to,2,1,"ng-template",null,0,KO),Lp()),r&2){let e=kO(3),t=MO();eO(),aE("ngIf",!t.disable)("ngIfElse",e);}}var _i=(()=>{class r extends p{constructor(){super(),this.disable=false;}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-order-radio-button"]],inputs:{label:"label",enabledText:"enabledText",disable:"disable",disableText:"disableText",control:"control",value:"value",id:"id",inputName:"inputName"},exportAs:["order-radio-button"],features:[MI],decls:8,vars:8,consts:[["disabled",""],[1,"order-radio-button"],["type","radio",1,"order-radio-button__input",3,"name","id","value","formControl"],[1,"order-radio-button__wrapper-radio-label",3,"for"],[1,"order-radio-button__top"],[1,"order-radio-button__radio-mark"],[1,"order-radio-button__radio-label"],["class","order-radio-button__sublabel-text",4,"ngIf"],[1,"order-radio-button__sublabel-text"],["class","order-radio-button__enabled-text",3,"innerHTML",4,"ngIf","ngIfElse"],[1,"order-radio-button__enabled-text",3,"innerHTML"],[1,"order-radio-button__disabled-text"]],template:function(t,i){t&1&&(Pp(0,"div",1),EE(1,"input",2),Pp(2,"label",3)(3,"div",4),EE(4,"span",5),Pp(5,"span",6),PO(6),Lp()(),LI(7,io,4,2,"span",7),Lp()()),t&2&&(qI("data-disabled",i.disable),eO(),aE("name",i.inputName)("id",i.id)("value",i.value)("formControl",i.control),eO(),aE("for",i.id),eO(4),HE(i.label),eO(),aE("ngIf",i.enabledText));},dependencies:[An$1,Ge,Rt$1,yn$1,Mn$1,Tt,Zw],styles:['.order-radio-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;height:100%}@media (max-width: 768px){.order-radio-button[_ngcontent-%COMP%]{width:100%}}.order-radio-button__input[_ngcontent-%COMP%]{visibility:hidden;display:none}.order-radio-button__input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{border-color:#00aeef}.order-radio-button__input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]   .order-radio-button__radio-mark[_ngcontent-%COMP%]:after{opacity:1}.order-radio-button__top[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:12px}.order-radio-button__wrapper-radio-label[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;height:100%;width:100%;padding:15px 32px;border-radius:16px;border:1px solid rgba(171,186,200,.3);cursor:pointer;row-gap:8px;font-size:16px;line-height:24px;font-weight:600}.order-radio-button__radio-label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:600}.order-radio-button__sublabel-text[_ngcontent-%COMP%]{color:#89909c;font-size:16px;line-height:24px;font-weight:400}.order-radio-button__radio-mark[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:20px;height:20px;border:1px solid #e3e4e7;border-radius:50%;background-color:transparent;flex-shrink:0}.order-radio-button__radio-mark[_ngcontent-%COMP%]:after{display:block;width:8px;height:8px;border-radius:50%;opacity:0;background-color:#00aeef;content:"";transition:opacity .3s ease}.order-radio-button[data-disabled=true][_ngcontent-%COMP%]{cursor:not-allowed;pointer-events:none}.order-radio-button[data-disabled=true][_ngcontent-%COMP%]   .order-radio-button__radio-label[_ngcontent-%COMP%]{color:#bdc0c6}@media (max-width: 768px){.order-radio-button__wrapper-radio-label[_ngcontent-%COMP%]{padding:16px}}'],changeDetection:0});}}return r})();var Ir=(()=>{class r extends p{constructor(){super(),this._orderAnalyticsService=D(re),this._orderStateService=D(he),this._cdr=D(ui),this.paymentForm=Je.paymentFormGroup,this.paymentMethodControl=Je.paymentFormGroup.controls.paymentMethod,this.paymentMethods=vt,this.availablePaymentTypes=G.receivingFormGroup.controls.timeSlotsTime.value?.availablePaymentTypes,this.radioButtonName="paymentType",this.radioButtonCardId="payment-form__card",this.radioButtonCashId="payment-form__cash",this._orderStateService.paymentStep.stepState$.pipe(it(e=>e===j.ACTIVE),Hu(this._onDestroy$)).subscribe(()=>this._orderAnalyticsService.onChoosePaymentType(this.paymentMethodControl.value)),this.paymentMethodControl.valueChanges.pipe(it(e=>this._orderStateService.currentState?.name===Q.PAYMENT),Hu(this._onDestroy$)).subscribe(e=>{e&&this._orderAnalyticsService.onChoosePaymentType(e);}),G.receivingFormGroup.controls.timeSlotsTime.valueChanges.pipe(Uu(e=>{this.availablePaymentTypes=e?.availablePaymentTypes;}),Hu(this._onDestroy$)).subscribe(()=>{this._cdr.markForCheck();});}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-payment-form"]],features:[MI],decls:6,vars:13,consts:[[1,"payment-form"],[1,"payment-form__title"],[1,"payment-form__row",3,"formGroup"],[3,"value","control","disable","label","id","inputName"],[3,"value","disable","control","label","id","inputName"]],template:function(t,i){t&1&&(Pp(0,"div",0)(1,"h2",1),PO(2,"\u0421\u043F\u043E\u0441\u043E\u0431 \u043E\u043F\u043B\u0430\u0442\u044B"),Lp(),Pp(3,"form",2),EE(4,"yota-order-radio-button",3)(5,"yota-order-radio-button",4),Lp()()),t&2&&(eO(3),aE("formGroup",i.paymentForm),eO(),aE("value",i.paymentMethods.CARD)("control",i.paymentMethodControl)("disable",!(i.availablePaymentTypes!=null&&i.availablePaymentTypes.includes(i.paymentMethods.CARD)))("label","\u041A\u0430\u0440\u0442\u043E\u0439 \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438")("id",i.radioButtonCardId)("inputName",i.radioButtonName),eO(),aE("value",i.paymentMethods.CASH)("disable",!(i.availablePaymentTypes!=null&&i.availablePaymentTypes.includes(i.paymentMethods.CASH)))("control",i.paymentMethodControl)("label","\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438 \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438")("id",i.radioButtonCashId)("inputName",i.radioButtonName));},dependencies:[An$1,Dn$1,Cn$1,Mn$1,Bt,_i],styles:[".payment-form__title[_ngcontent-%COMP%]{margin-bottom:24px;font-size:16px;line-height:22px;font-weight:600}.payment-form__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;column-gap:32px}@media (max-width: 768px){.payment-form__title[_ngcontent-%COMP%]{margin-bottom:16px}.payment-form__row[_ngcontent-%COMP%]{grid-template-columns:1fr;row-gap:16px}}"],changeDetection:0});}}return r})();var Je=class r extends at{static{this.paymentFormGroup=new I({paymentMethod:new W(vt.CARD,{nonNullable:true})});}constructor(o,e){super(),this._stepState$=o,this._transition=e,this.component=Ir,this.name=Q.PAYMENT,this.title="\u0421\u043F\u043E\u0441\u043E\u0431 \u043E\u043F\u043B\u0430\u0442\u044B",this.stepState$=this._stepState$,this.transitions=this._transition;}nextAction(){}getWriteData(){return r.paymentFormGroup.controls.paymentMethod.value===vt.CASH?"\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438":"\u041A\u0430\u0440\u0442\u043E\u0439"}showValidateErrors(){}setContext(){this.stateContext?.next({name:Q.PAYMENT,paymentMethods:r.paymentFormGroup.controls.paymentMethod.value});}getContext(){return this.stateContext?.value}getButtonState(){return we.CONFIRM_ORDER}};var he=class r extends p{get state(){return this._state$.getValue()}get currentState(){return this._state$.value.find(o=>o.stepState$.value===j.ACTIVE)}constructor(){super(),this.orderButtonState$=new En$1(we.NEXT),this.pickUpPoint$=new En$1(null),this.changeButtonState$=new X,this.calculateTotal$=new X,this.mnpPopup$=new X,this.openBeautifulPhoneNumberDialog$=new X,this.beautifulNumberStepAvailable$=new En$1(false),this.showExpiredNumbersPopup$=new X,this.expiredNumbers$=new En$1(null),this.isPersonalDataAgreed$=new En$1(false),this.isForeignCitizenship$=new En$1(false),this.cartFormGroup=new I({productCount:new W(1,{nonNullable:true,validators:[Ie$1.max(5),Ie$1.required]})}),this.contactStep=new oe(new En$1(j.ACTIVE),[{nextState:Q.BEAUTIFUL_NUMBER,condition:()=>this.beautifulNumberStepAvailable$.value&&oe.contactFormGroup.valid},{nextState:Q.RECEIVING,condition:()=>oe.contactFormGroup.valid}]),this.beautifulNumberStep=new te(new En$1(j.HIDDEN),[{nextState:Q.RECEIVING,condition:()=>te.beautifulNumberFormGroup.valid}]),this.receivingStep=new G(new En$1(j.DISABLE),[{nextState:Q.PAYMENT,condition:()=>{if(G.receivingFormGroup.controls.receivingWay.value===O.Delivery){let o=G.receivingFormGroup.get("timeSlotsTime")?.value;return o?o.isSamokat?!G.receivingFormGroup.hasError("samokatNotAvailable"):true:false}return !!this.pickUpPoint$.value}}],this.pickUpPoint$),this.paymentStep=new Je(new En$1(j.DISABLE),[]),this.totalPrice=0,this._initialState=[this.contactStep,this.beautifulNumberStep,this.receivingStep,this.paymentStep],this._orderAnalyticsService=D(re),this._cartService=D(Rt),this._storeService=D(D$1),this._document=D(dr),this._state$=new En$1(this._initialState),this.changeButtonState$.pipe(Hu(this._onDestroy$)).subscribe(()=>{this.orderButtonState$.next(this.currentState?.getButtonState()??we.NEXT);}),this.pickUpPoint$.pipe(Hu(this._onDestroy$)).subscribe(()=>{this.changeButtonState$.next();}),this.beautifulNumberStepAvailable$.pipe(Hu(this._onDestroy$)).subscribe(o=>{if(o){let e=this._cartService.device;if(this.beautifulNumberStep.stepState$.next(j.DISABLE),!e?.msisdn?.length){this.expiredNumbers$.next(null);return}let t=new Date;if(!e.expirationLockDate||!e.lockId||t>new Date(e.expirationLockDate)){this.expiredNumbers$.next(e.msisdn);let i={msisdn:[],expirationLockDate:null,lockId:null};this._cartService.setInfo(i),te.beautifulNumberFormGroup.controls.numbers.setValue([]),this.showExpiredNumbersPopup$.next();}else this.expiredNumbers$.next(null),this.beautifulNumberStep.stepState$.next(j.WITH_DATA),te.beautifulNumberFormGroup.controls.numbers.setValue(e.msisdn);}else this.beautifulNumberStep.stepState$.next(j.HIDDEN),te.beautifulNumberFormGroup.controls.numbers.setValue([]),this.expiredNumbers$.next(null);});}_getCategories$(){return this._storeService.fetchCategories$()}nextStep(o,e){let t=this.currentState?.transitions.find(n=>n.condition());if(this.currentState?.showValidateErrors(),!t)return;let i=this.state.find(n=>n.name===t.nextState);if(i&&i.stepState$.value!==j.HIDDEN){if(this._scrollToStep(i.name),i.name===Q.RECEIVING&&(oe.contactFormGroup.controls.mnp.value&&this.mnpPopup$.next(),setTimeout(()=>{this._scrollToStep(i.name);},750)),(i.name===Q.BEAUTIFUL_NUMBER||i.name===Q.RECEIVING)&&this._getCategories$().pipe(Hu(this._onDestroy$)).subscribe(n=>{this._orderAnalyticsService.categories$.next(n);}),i.name===Q.PAYMENT){let n;typeof G.receivingFormGroup.controls.address.value!="string"&&(n=G.receivingFormGroup.controls.address.value?.value),this._orderAnalyticsService.orderPaymentStep(e,o,n);}this._changeCurrentState(i);}}changeStateByStepName(o){let e=this.state.find(n=>n.name===o),t=this.currentState?.transitions.find(n=>n.condition()),i=this.currentState?.transitions.find(n=>n.nextState===o);if(e)if(i){if(!t){this.currentState?.showValidateErrors();return}oe.contactFormGroup.controls.mnp.value&&this.mnpPopup$.next(),this.setStep(e.name),(e.name===Q.BEAUTIFUL_NUMBER||e.name===Q.RECEIVING)&&this._getCategories$().pipe(Hu(this._onDestroy$)).subscribe(u=>{this._orderAnalyticsService.categories$.next(u);});}else {let n=this.state.findIndex(m=>m.name===this.currentState?.name),u=this.state.findIndex(m=>m.name===e.name);if(n<0||u<0||u>n&&!t)return;if(u<n){this.setStep(e.name);return}e.stepState$.getValue()===j.WITH_DATA&&this.setStep(e.name);}}resetOrder(o){this.pickUpPoint$.next(null),this.paymentStep.stepState$.next(j.DISABLE),this.receivingStep.stepState$.next(j.DISABLE),this.beautifulNumberStep.stepState$.next(this.beautifulNumberStepAvailable$.value?j.DISABLE:j.HIDDEN),G.receivingFormGroup.reset(),Je.paymentFormGroup.reset(),te.beautifulNumberFormGroup.reset(),o&&(this.contactStep.stepState$.next(j.ACTIVE),oe.contactFormGroup.reset(),this.cartFormGroup.reset(),this.changeButtonState$.next()),this.isPersonalDataAgreed$.next(false);}resetAfterActions(){this.pickUpPoint$.next(null),this.paymentStep.stepState$.next(j.DISABLE),this.receivingStep.stepState$.next(j.DISABLE),this.paymentStep.stepState$.next(j.DISABLE),Je.paymentFormGroup.reset();}setStep(o){let e=this.state.find(t=>t.name===o);e&&e.stepState$.value!==j.HIDDEN&&(this._scrollToStep(e.name),this._changeCurrentState(e));}isValidCurrentStep(){if(!this.currentState?.transitions.length)return  true;let o=this.currentState?.transitions.some(e=>e.condition());return o||this.currentState?.showValidateErrors(),o}_changeCurrentState(o){let e=this.state.filter(t=>t.name===this.currentState?.name);e&&e.map(t=>{t.stepState$.next(j.WITH_DATA);}),o.stepState$.next(j.ACTIVE),this.changeButtonState$.next();}_scrollToStep(o){let e=this._document.querySelector(`[data-step-name="${o}"]`);e&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center"});},0);}static{this.\u0275fac=function(e){return new(e||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}};Pb([v$1],he.prototype,"_scrollToStep",null);var no=["timeSlotTime"],ao=["timeSlotDate"],so=["srInstruction"];function lo(r,o){r&1&&(Pp(0,"div",11),EE(1,"y-spinner",12),Lp()),r&2&&(eO(),aE("diameter",40));}function co(r,o){if(r&1&&(Pp(0,"y-option-bordered",23)(1,"span",18),PO(2),Lp(),Pp(3,"span",19),PO(4),Lp()()),r&2){let e=o.$implicit;aE("value",e),eO(2),$p(" ",e.leftSide," "),eO(2),$p(" ",e.rightSide," ");}}function uo(r,o){if(r&1&&(Pp(0,"y-option-bordered",23),PO(1),Pp(2,"span",19),PO(3),Lp()()),r&2){let e=o.$implicit;aE("value",e),eO(),$p(" ",e.leftSide," "),eO(2),$p(" ",e.rightSide," ");}}function po(r,o){if(r&1&&(Pp(0,"y-error"),PO(1),Lp()),r&2){let e=o.ngIf;eO(),$p(" ",e," ");}}function mo(r,o){if(r&1){let e=_O();Pp(0,"y-form-field-bordered",16),FE("click",function(i){FR(e);let n=MO(5);return kR(n.openMobileTimeSlots(i))}),Pp(1,"y-label"),PO(2,"\u0412\u0440\u0435\u043C\u044F"),Lp(),Pp(3,"div",17),PO(4),Pp(5,"span",19),PO(6),Lp()(),Pp(7,"y-select-bordered",20),LI(8,uo,4,3,"y-option-bordered",21),Lp(),LI(9,po,2,1,"y-error",24),Lp();}if(r&2){let e=o.ngIf,t=MO(5);cE("has-long-error",t.timeSlotTimeControl.errors&&t.timeSlotTimeControl.errors.samokatUnavailable),eO(4),$p(" ",t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.leftSide," "),eO(2),$p(" ",t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.rightSide," "),eO(),aE("formControl",t.timeSlotTimeControl)("panelOpenable",!t.isMobile),eO(),aE("ngForOf",e),eO(),aE("ngIf",t.getTimeSlotsTimeErrorMessage(t.timeSlotTimeControl.errors));}}function _o(r,o){if(r&1){let e=_O();Pp(0,"div",15)(1,"y-form-field-bordered",16),FE("click",function(i){FR(e);let n=MO(4);return kR(n.openMobileTimeSlotsSearch(i))}),Pp(2,"y-label"),PO(3,"\u0414\u0430\u0442\u0430"),Lp(),Pp(4,"div",17)(5,"span",18),PO(6),Lp(),Pp(7,"span",19),PO(8),Lp()(),Pp(9,"y-select-bordered",20),LI(10,co,5,3,"y-option-bordered",21),Lp()(),LI(11,mo,10,8,"y-form-field-bordered",22),Lp();}if(r&2){let e=MO(3).ngIf,t=MO();eO(6),$p(" ",t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.leftSide," "),eO(2),$p(" ",t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.rightSide," "),eO(),aE("formControl",t.timeSlotDateControl)("panelOpenable",!t.isMobile),eO(),aE("ngForOf",e),eO(),aE("ngIf",t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.timeSlots);}}function ho(r,o){if(r&1){let e=_O();Pp(0,"div"),PO(1," \u0421\u0430\u043C\u043E\u043A\u0430\u0442 \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E \u0434\u043E\u0441\u0442\u0430\u0432\u0438\u0442 \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u0441 "),Pp(2,"a",26),FE("click",function(){FR(e);let i=MO(5);return kR(i.showSRInstruction())}),PO(3,"\u0441\u0430\u043C\u043E\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"),Lp()();}}function fo(r,o){if(r&1&&(Pp(0,"div",25),LI(1,ho,4,0,"div",24),Lp()),r&2){let e=MO(4);eO(),aE("ngIf",e.samokatAvailable);}}function go(r,o){if(r&1&&LI(0,_o,12,6,"div",13)(1,fo,2,1,"div",14),r&2){let e=MO(2).ngIf,t=MO();aE("ngIf",e.length>0),eO(),aE("ngIf",t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.isSamokat);}}function Co(r,o){if(r&1&&(Pp(0,"div",7)(1,"div",8)(2,"h2",9),PO(3,"\u0414\u0430\u0442\u0430 \u0438 \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438"),Lp(),LI(4,lo,2,1,"div",10),GO(5,"async"),LI(6,go,2,2,"ng-template",null,3,KO),Lp()()),r&2){let e=kO(7),t=MO(2);eO(4),aE("ngIf",ZO(5,2,t.loadingTimeSlots$))("ngIfElse",e);}}function vo(r,o){if(r&1){let e=_O();Pp(0,"div",30),FE("click",function(){let i=FR(e).$implicit,n=MO(3);return kR(n.mobileSelectDate(i))}),Pp(1,"span",18),PO(2),Lp(),Pp(3,"span",19),PO(4),Lp()();}if(r&2){let e=o.$implicit,t=MO(3);cE("time-slots__mobile-dialog-item_selected",(t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.leftSide)===e.leftSide),eO(2),$p(" ",e.leftSide," "),eO(2),$p(" ",e.rightSide," ");}}function bo(r,o){if(r&1&&(Pp(0,"div",27),EE(1,"y-icon",28),LI(2,vo,5,4,"div",29),Lp()),r&2){let e=MO().ngIf;eO(2),aE("ngForOf",e);}}function yo(r,o){if(r&1){let e=_O();Pp(0,"div",30),FE("click",function(){let i=FR(e).$implicit,n=MO(3);return kR(n.mobileSelectTime(i))}),PO(1),Pp(2,"span",19),PO(3),Lp()();}if(r&2){let e=o.$implicit,t=MO(3);cE("time-slots__mobile-dialog-item_selected",(t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.leftSide)===e.leftSide),eO(),$p(" ",e.leftSide," "),eO(2),$p(" ",e.rightSide," ");}}function So(r,o){if(r&1&&(Pp(0,"div",27),EE(1,"y-icon",28),LI(2,yo,4,4,"div",29),Lp()),r&2){let e=MO(2);eO(2),aE("ngForOf",e.timeSlotDateControl.value==null?null:e.timeSlotDateControl.value.timeSlots);}}function xo(r,o){if(r&1&&(Pp(0,"div",5),LI(1,Co,8,4,"div",6),GO(2,"async"),LI(3,bo,3,1,"ng-template",null,1,KO)(5,So,3,1,"ng-template",null,2,KO),Lp()),r&2){let e=MO();eO(),aE("ngIf",ZO(2,1,e.showSamokat$));}}function Eo(r,o){r&1&&(PO(0," \u0422\u0430\u043A\u0443\u044E \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u043D\u0443\u0436\u043D\u043E \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u0430\u043C\u043E\u0441\u0442\u043E\u044F\u0442\u0435\u043B\u044C\u043D\u043E \u2014 \u0432\u0441\u0435 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u044B \u043F\u043E\u0434\u043F\u0438\u0441\u044B\u0432\u0430\u044E\u0442\u0441\u044F \u0447\u0435\u0440\u0435\u0437 \u0413\u043E\u0441\u043A\u043B\u044E\u0447 \u0438 \u0413\u043E\u0441\u0443\u0441\u043B\u0443\u0433\u0438. "),EE(1,"br"),PO(2," \u041F\u043E\u043D\u0430\u0434\u043E\u0431\u0438\u0442\u0441\u044F \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u043D\u0430\u044F \u0443\u0447\u0435\u0442\u043D\u0430\u044F \u0437\u0430\u043F\u0438\u0441\u044C. "),EE(3,"br"),PO(4,` \u0415\u0441\u043B\u0438 \u0445\u043E\u0447\u0435\u0448\u044C \u043E\u0431\u044B\u0447\u043D\u0443\u044E \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443, \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u043E\u0439 \u0438\u043D\u0442\u0435\u0440\u0432\u0430\u043B \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u2014 \u043A\u0443\u0440\u044C\u0435\u0440 \u043F\u0440\u0438\u0435\u0434\u0435\u0442 \u0441 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u043C\u0438.
`));}var wr=(()=>{class r extends p{constructor(e,t,i,n,u,m,x,M){super(),this._orderStateService=e,this._orderDataService=t,this._orderApiService=i,this._dialogService=n,this._addressService=u,this._breakpointObserver=m,this._orderAnalyticsService=x,this._cdr=M,this.samokatPromoCodeAvailable=false,this._document=D(dr),this.timeSlotDateControl=G.receivingFormGroup.controls.timeSlotsSearch,this.timeSlotTimeControl=G.receivingFormGroup.controls.timeSlotsTime,this.timeSlotsTimeErrors=new Map([["samokatUnavailable","\u0421\u044E\u0434\u0430 \u0421\u0430\u043C\u043E\u043A\u0430\u0442 \u043D\u0435 \u0434\u043E\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442. \u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u043E\u0435 \u0432\u0440\u0435\u043C\u044F \u0434\u043B\u044F \u043E\u0431\u044B\u0447\u043D\u043E\u0439 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u043B\u0438\u0431\u043E \u0438\u0437\u043C\u0435\u043D\u0438 \u0430\u0434\u0440\u0435\u0441"]]),this.timeSlotSearch$=this._addressService.timeSlotSearch$.pipe(Uu(_=>{this._addressService.loadingTimeSlots$.next(false),_?.length&&_[0]?this.timeSlotDateControl.setValue(_[0]):this.timeSlotDateControl.reset();})),this.loadingTimeSlots$=this._addressService.loadingTimeSlots$.pipe(Uu(()=>{let _=this._document.querySelector(".time-slots__title");_&&setTimeout(()=>{_.scrollIntoView({behavior:"smooth",block:"center"});},0);})),this.showSamokat$=this._addressService.showSamokat$,this.isMobile=false,this.samokatAvailable=false,this._breakpointObserver.observe(["(max-width: 768px)"]).pipe(Hu(this._onDestroy$)).subscribe(_=>{this.isMobile=_.matches;}),Zh([this._orderApiService.isSamokatAvailability$,this.timeSlotTimeControl.valueChanges]).pipe(Hu(this._onDestroy$)).subscribe(([_,T])=>{if(!T)return;let O=T.isSamokat&&_?N.Samokat:N.Courier,q=T.isSamokat&&_?j.HIDDEN:j.DISABLE;this._orderDataService.deliveryType$.next(O),this._orderAnalyticsService.deliveryType$.next(O),this._orderStateService.paymentStep.stepState$.next(q),this._orderStateService.changeButtonState$.next(),this._orderStateService.calculateTotal$.next(),!_&&T.isSamokat?this.timeSlotTimeControl.setErrors({samokatUnavailable:true}):this.timeSlotTimeControl.setErrors(null);}),this.timeSlotDateControl.valueChanges.pipe(Ou(),Ru(1),Hu(this._onDestroy$)).subscribe(_=>{if(_&&_.timeSlots)this.timeSlotTimeControl.setValue(_?.timeSlots[0]);else {this.timeSlotTimeControl.reset();return}}),this._orderApiService.isSamokatAvailability$.pipe(Ru(1),Hu(this._onDestroy$)).subscribe(_=>{if(this.samokatAvailable=_,this.samokatAvailable){this.timeSlotTimeControl.setErrors(null),this._cdr.detectChanges();return}if(!this.samokatPromoCodeAvailable){let T=this._addressService.timeSlotSearch$.getValue(),O=T.find(q=>q.timeSlotUiItems?.some(ue=>ue.isSamokat));if(O){if(O.timeSlotUiItems=O.timeSlotUiItems?.filter(q=>!q.isSamokat),O.timeSlots=O.timeSlots?.filter(q=>!q.isSamokat),!O.timeSlotUiItems?.length){T=T.filter(q=>q.date!==O.date),T.length?(this._addressService.timeSlotSearch$.next(T),this.timeSlotDateControl.setValue(T[0])):(G.receivingFormGroup.controls.address.setErrors({timeSlots:true}),this._addressService.showSamokat$.next(false));return}this._addressService.timeSlotSearch$.next(T),this.timeSlotTimeControl.setValue(this.timeSlotDateControl.value.timeSlots[0]);}return}if(!this.timeSlotTimeControl.value?.isSamokat){this.timeSlotTimeControl.setErrors(null);return}this.timeSlotTimeControl.setErrors({samokatUnavailable:true}),this.timeSlotTimeControl.markAsTouched(),this._cdr.detectChanges();});}ngOnDestroy(){super.ngOnDestroy(),p$1.closeDialog(this._dialogRef);}openMobileTimeSlots(e){e.preventDefault(),this.isMobile&&(this._dialogRef=this._dialogService.open(this._timeDialogRef,{panelClass:["y-dialog-bottom","y-dialog-slim"],data:{panelClassOption:"bottom",panelTitle:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043C\u044F"}}));}openMobileTimeSlotsSearch(e){e.preventDefault(),this.isMobile&&(this._dialogRef=this._dialogService.open(this._dateDialogRef,{panelClass:["y-dialog-bottom","y-dialog-slim"],data:{panelClassOption:"bottom",panelTitle:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043C\u044F"}}));}mobileSelectTime(e){this.timeSlotTimeControl.setValue(e),p$1.closeDialog(this._dialogRef);}mobileSelectDate(e){this.timeSlotDateControl.setValue(e),p$1.closeDialog(this._dialogRef);}showSRInstruction(){this._dialogRef=this._dialogService.open(this._srInstruction);}getTimeSlotsTimeErrorMessage(e){if(e){let t=w$1({},e);for(let i of Object.keys(t)){let n=this.timeSlotsTimeErrors.get(i);if(n)return n}}return ""}static{this.\u0275fac=function(t){return new(t||r)(k$1(he),k$1(ve),k$1(Le),k$1(mr),k$1(bt),k$1(U),k$1(re),k$1(ui))};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-time-slots"]],viewQuery:function(t,i){if(t&1&&(NO(no,5,Ye),NO(ao,5,Ye),NO(so,5,Ye)),t&2){let n;AO(n=RO())&&(i._timeDialogRef=n.first),AO(n=RO())&&(i._dateDialogRef=n.first),AO(n=RO())&&(i._srInstruction=n.first);}},inputs:{samokatPromoCodeAvailable:"samokatPromoCodeAvailable"},features:[MI],decls:4,vars:3,consts:[["srInstruction",""],["timeSlotDate",""],["timeSlotTime",""],["timeSlotsRow",""],["class","time-slots",4,"ngIf"],[1,"time-slots"],["class","time-slots__container",4,"ngIf"],[1,"time-slots__container"],[1,"time-slots__inner"],[1,"time-slots__title"],["class","time-slots__loader",4,"ngIf","ngIfElse"],[1,"time-slots__loader"],[3,"diameter"],["class","time-slots__row",4,"ngIf"],["class","time-slots__samokat",4,"ngIf"],[1,"time-slots__row"],[1,"time-slots__input",3,"click"],[1,"time-slots__time-value"],[1,"time-slots__date"],[1,"time-slots__additional"],[3,"formControl","panelOpenable"],[3,"value",4,"ngFor","ngForOf"],["class","time-slots__input",3,"has-long-error","click",4,"ngIf"],[3,"value"],[4,"ngIf"],[1,"time-slots__samokat"],[1,"y-link-pseudo",3,"click"],[1,"time-slots__mobile-dialog"],["y-dialog-close","","svgIcon","close-light",1,"time-slots__mobile-dialog-close"],["class","time-slots__mobile-dialog-item",3,"time-slots__mobile-dialog-item_selected","click",4,"ngFor","ngForOf"],[1,"time-slots__mobile-dialog-item",3,"click"]],template:function(t,i){t&1&&(LI(0,xo,7,3,"div",4),GO(1,"async"),LI(2,Eo,5,0,"ng-template",null,0,KO)),t&2&&aE("ngIf",ZO(1,1,i.timeSlotSearch$));},dependencies:[Zw,An$1,yn$1,Mn$1,Tt,Ih,tC,ql,ar,gd,Cd,Ny,zt,Dy,ld],styles:["[_nghost-%COMP%]     .y-select-value{visibility:hidden}[_nghost-%COMP%]     .time-slots__row .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}[_nghost-%COMP%]     .time-slots__row .y-form-field-bordered .y-form-field-bordered-subscript-wrapper{top:100%}  .y-dialog-bottom .y-dialog-container>.time-slots__mobile-dialog-item{display:flex;height:58px;flex-direction:row;align-items:center}  .time-slots__mobile-dialog{min-height:250px}  .time-slots__mobile-dialog-close{width:24px;height:24px;margin-block:18px 20px;align-self:flex-end}  .time-slots__mobile-dialog-item{display:flex;align-items:center;column-gap:4px;padding:12px 8px;border-radius:12px;font-size:16px;line-height:24px;font-weight:400}  .time-slots__mobile-dialog-item_selected{background-color:#e5f7fd}.time-slots__inner[_ngcontent-%COMP%]{margin-top:26px}.time-slots__samokat[_ngcontent-%COMP%]{margin-top:8px;font-size:14px;line-height:18px;font-weight:400}.time-slots__title[_ngcontent-%COMP%]{margin-bottom:16px;font-size:16px;line-height:22px;font-weight:600}.time-slots__loader[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding-block:10px}.time-slots__row[_ngcontent-%COMP%]{display:flex;gap:12px 32px}@media (max-width: 768px){.time-slots__row[_ngcontent-%COMP%]{flex-direction:column}}.time-slots__input[_ngcontent-%COMP%]{width:100%}.time-slots__input.has-long-error[_ngcontent-%COMP%]{margin-bottom:24px}.time-slots__time-value[_ngcontent-%COMP%]{position:absolute;z-index:1}@media (max-width: 480px){.time-slots__input.has-long-error[_ngcontent-%COMP%]{margin-bottom:40px}}"],changeDetection:0});}}return r})();var Mo=["streetFieldInputRef"];function Do(r,o){if(r&1&&(Pp(0,"y-option-bordered",17)(1,"span"),PO(2),Lp()()),r&2){let e=o.$implicit;aE("value",e),eO(2),HE(e.value);}}function Oo(r,o){if(r&1&&(Pp(0,"y-error"),PO(1),Lp()),r&2){let e=o.ngIf;eO(),$p(" ",e," ");}}function No(r,o){if(r&1){let e=_O();Pp(0,"yota-field-state",7),FE("clear",function(){FR(e);let i=MO();return kR(i.clearEntranceField())}),Lp();}if(r&2){let e=MO(),t=kO(17);aE("state",e.controlState.CLEAR)("inputControl",t);}}function Po(r,o){if(r&1){let e=_O();Pp(0,"yota-field-state",7),FE("clear",function(){FR(e);let i=MO();return kR(i.clearFlatField())}),Lp();}if(r&2){let e=MO(),t=kO(23);aE("state",e.controlState.CLEAR)("inputControl",t);}}function Io(r,o){if(r&1){let e=_O();Pp(0,"div",18),FE("click",function(){FR(e);let i=MO();return kR(i.addComment())}),Pp(1,"div",19),EE(2,"y-icon",20),Lp(),PO(3,` \u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A\u0443\u0440\u044C\u0435\u0440\u0443
`),Lp();}r&2&&(eO(2),aE("svgIcon","plus-outline"));}function wo(r,o){if(r&1){let e=_O();Pp(0,"yota-field-state",7),FE("clear",function(){FR(e);let i=MO(2);return kR(i.clearCommentField())}),Lp();}if(r&2){MO();let e=kO(4),t=MO();aE("state",t.controlState.CLEAR)("inputControl",e);}}function To(r,o){if(r&1&&(Pp(0,"y-form-field-bordered",21)(1,"y-label"),PO(2,"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A\u0443\u0440\u044C\u0435\u0440\u0443"),Lp(),EE(3,"textarea",22,4),LI(5,wo,1,2,"yota-field-state",13),Lp()),r&2){let e=kO(4),t=MO();eO(3),aE("maxlength",512)("formControl",t.comment),eO(2),aE("ngIf",e.focused&&e.value);}}var Tr=(()=>{class r extends p{constructor(e,t$1,i,n,u,m,x){super(),this._orderStateService=e,this._addressService=t$1,this._orderDataService=i,this._orderApiService=n,this._renderer=u,this._orderAnalyticsService=m,this._cdr=x,this.samokatPromoCodeAvailable=false,this.addressControl=G.receivingFormGroup.controls.address,this.flat=G.receivingFormGroup.controls.flat,this.entrance=G.receivingFormGroup.controls.entrance,this.comment=G.receivingFormGroup.controls.comment,this.addressErrors=new Map([["required","\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["restrictedStreetHouse","\u0423\u043A\u0430\u0436\u0438 \u0443\u043B\u0438\u0446\u0443 \u0438 \u043D\u043E\u043C\u0435\u0440 \u0434\u043E\u043C\u0430"],["restrictedHouse","\u0423\u043A\u0430\u0436\u0438 \u043D\u043E\u043C\u0435\u0440 \u0434\u043E\u043C\u0430"],["restrictedAddress","\u041F\u043E\u0445\u043E\u0436\u0435, \u0442\u0430\u043A\u043E\u0433\u043E \u0430\u0434\u0440\u0435\u0441\u0430 \u043D\u0435\u0442. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439 \u0434\u0440\u0443\u0433\u043E\u0439 \u0438\u043B\u0438 \u043F\u0435\u0440\u0435\u043F\u0440\u043E\u0432\u0435\u0440\u044C \u0433\u043E\u0440\u043E\u0434"],["timeSlots","\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043F\u043E \u044D\u0442\u043E\u043C\u0443 \u0430\u0434\u0440\u0435\u0441\u0443 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0430, \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u043E\u0439 \u0441\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F"]]),this.showComment$=new En$1(false),this.addresses$=this._addressService.addresses$,this.analyticsActions=O$1,this.controlState=c,this._orderApiService.orderError$.pipe(Hu(this._onDestroy$)).subscribe(M=>{M===t.TimeSlotUnavailable&&(this.addressControl.setErrors({timeSlots:true}),this._addressService.showSamokat$.next(false),this._addressService.loadingTimeSlots$.next(false),this._addressService.timeSlotSearch$.next([]),this._cdr.markForCheck());}),this.addressControl.valueChanges.pipe(Su(300),Ou(),Bu(M=>!M||typeof M=="string"&&M.length<=2||typeof M!="string"&&!M?.house?(this._addressService.showSamokat$.next(false),this._addressService.timeSlotSearch$.next([]),this._addressService.addresses$.next([]),this._orderStateService.changeButtonState$.next(),Bh(M)):typeof M=="string"?(this._addressService.showSamokat$.next(false),this._addressService.timeSlotSearch$.next([]),this._orderStateService.changeButtonState$.next(),this._addressService.fetchAddress$(M).pipe(le(()=>M))):this._addressService.fetchTimeSlots$(M.fiasId).pipe(Bu(_=>{if(_?.length&&_[0].timeSlots){let T=_[0].timeSlots[0].isSamokat,O=te.beautifulNumberFormGroup.controls.numbers.value.length>0,q=this._orderStateService.isForeignCitizenship$.value,ue=M.qcGeo==="0"||M.qcGeo==="1";if(T&&!O&&!q&&ue)return this._orderApiService.getSamokatAvailability$().pipe(Uu(()=>{this._addressService.loadingTimeSlots$.next(false);}),le(()=>_))}return this._addressService.loadingTimeSlots$.next(false),Bh(_)}),Uu(()=>{this._addressService.showSamokat$.next(!this.addressControl.hasError("timeSlots")),this._orderStateService.calculateTotal$.next();}),le(()=>M))),Hu(this._onDestroy$)).subscribe();}addComment(){let e=G.receivingFormGroup.controls.address.hasError("timeSlots");G.receivingFormGroup.addControl("comment",new W("",{nonNullable:true})),this.comment=G.receivingFormGroup.controls.comment,this.showComment$.next(true),e&&G.receivingFormGroup.controls.address.setErrors({timeSlots:true}),setTimeout(()=>{this._renderer.selectRootElement("#commentInput")?.focus();},0);}displayAddress(){return e=>e?.value?e?.value:""}selectAddress(e){this.addresses$.next([]);}getAddressErrorMessage(e){if(e){let t=w$1({},e);for(let i of Object.keys(t)){let n=this.addressErrors.get(i);if(n)return n}}return ""}sendAnalytics(e){let t=this._orderDataService.orderMetaInfo$.value;this._orderAnalyticsService.enterFormField(e,t,this._orderDataService.orderRegion,this._orderDataService.orderCity);}handleBlurAddress(){let e=this.addresses$.getValue();e?.length&&typeof this.addressControl.value=="string"&&this.addressControl.setValue(e[0]);}clearStreetField(){this.addressControl.setValue(null);}clearFlatField(){this.flat.setValue(null);}clearEntranceField(){this.entrance.setValue(null);}clearCommentField(){this.comment?.setValue("");}get addressControlState(){return this.streetFieldInputRef?this.streetFieldInputRef.focused&&this.streetFieldInputRef.value.length?c.CLEAR:this.addressControl.touched?this.addressControl.errors?c.ERROR:c.SUCCESS:null:null}static{this.\u0275fac=function(t){return new(t||r)(k$1(he),k$1(bt),k$1(ve),k$1(Le),k$1(ar$1),k$1(re),k$1(ui))};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-receiving-form-delivery"]],viewQuery:function(t,i){if(t&1&&NO(Mo,5),t&2){let n;AO(n=RO())&&(i.streetFieldInputRef=n.first);}},inputs:{samokatPromoCodeAvailable:"samokatPromoCodeAvailable"},features:[MI],decls:29,vars:23,consts:[["streetInput","","streetFieldInputRef","yInput"],["autocompleteRef","yAutocompleteBordered"],["entranceFieldInputRef","yInput"],["flatFieldInputRef","yInput"],["commentFieldInputRef","yInput"],[1,"receiving-form__field"],["yInput","","type","text",3,"change","focusout","yAutocompleteBordered","formControl","required"],["ySuffix","",3,"clear","state","inputControl"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"receiving-form__row"],["yInput","",1,"receiving-form__input",3,"formControl","maxlength"],["ySuffix","",3,"state","inputControl","clear",4,"ngIf"],["class","receiving-form__add-comment",3,"click",4,"ngIf"],["class","receiving-form__comment",4,"ngIf"],[3,"samokatPromoCodeAvailable"],[3,"value"],[1,"receiving-form__add-comment",3,"click"],[1,"receiving-form__add-comment-button"],[1,"y-primary",3,"svgIcon"],[1,"receiving-form__comment"],["yInput","","id","commentInput","placeholder","\u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440, \u044D\u0442\u0430\u0436 \u0438\u043B\u0438 \u043A\u043E\u0434 \u0434\u043E\u043C\u043E\u0444\u043E\u043D\u0430","cdkTextareaAutosize","","wrap","soft","type","text",1,"receiving-form__input","receiving-form__input_comment",3,"maxlength","formControl"]],template:function(t,i){if(t&1){let n=_O();Pp(0,"y-form-field-bordered",5)(1,"y-label"),PO(2,"\u0423\u043B\u0438\u0446\u0430, \u0434\u043E\u043C"),Lp(),Pp(3,"input",6,0),FE("change",function(){return FR(n),kR(i.sendAnalytics(i.analyticsActions.ADDRESS_IS_VALID))})("focusout",function(){return FR(n),kR(i.handleBlurAddress())}),Lp(),Pp(6,"yota-field-state",7),FE("clear",function(){return FR(n),kR(i.clearStreetField())}),Lp(),Pp(7,"y-autocomplete-bordered",8,1),FE("optionSelected",function(m){FR(n);let x=kO(4);return i.selectAddress(m),kR(x.blur())}),LI(9,Do,3,2,"y-option-bordered",9),GO(10,"async"),Lp(),LI(11,Oo,2,1,"y-error",10),Lp(),Pp(12,"div",11)(13,"y-form-field-bordered",5)(14,"y-label"),PO(15,"\u041F\u043E\u0434\u044A\u0435\u0437\u0434"),Lp(),EE(16,"input",12,2),LI(18,No,1,2,"yota-field-state",13),Lp(),Pp(19,"y-form-field-bordered",5)(20,"y-label"),PO(21,"\u041A\u0432\u0430\u0440\u0442\u0438\u0440\u0430"),Lp(),EE(22,"input",12,3),LI(24,Po,1,2,"yota-field-state",13),Lp()(),LI(25,Io,4,1,"div",14),GO(26,"async"),LI(27,To,6,3,"y-form-field-bordered",15),EE(28,"yota-time-slots",16);}if(t&2){let n=kO(5),u=kO(8),m=kO(17),x=kO(23);cE("tall-error",i.addressControl.getError("timeSlots")||i.addressControl.getError("restrictedAddress")&&!i.addressControl.getError("required")),eO(3),aE("yAutocompleteBordered",u)("formControl",i.addressControl)("required",true),eO(3),aE("state",i.addressControlState)("inputControl",n),eO(),aE("displayWith",i.displayAddress()),eO(2),aE("ngForOf",ZO(10,19,i.addresses$)),eO(2),aE("ngIf",i.getAddressErrorMessage(i.addressControl.errors)),eO(5),aE("formControl",i.entrance)("maxlength",5),eO(2),aE("ngIf",m.focused&&m.value),eO(4),aE("formControl",i.flat)("maxlength",10),eO(2),aE("ngIf",x.focused&&x.value),eO(),aE("ngIf",ZO(26,21,i.showComment$)===false&&!(i.comment!=null&&i.comment.touched)),eO(2),aE("ngIf",i.comment),eO(),aE("samokatPromoCodeAvailable",i.samokatPromoCodeAvailable);}},dependencies:[An$1,Ge,yn$1,ot,Jt,Mn$1,Tt,x$1,Ih,Zw,Jg,Zg,wr,tC,ar,gd,Ty,dg,tb,Cd,zt,ld,hd],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]     .receiving-form__comment.y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}[_nghost-%COMP%]     .receiving-form__comment.y-form-field-bordered .y-form-field-bordered-infix{height:auto}[_nghost-%COMP%]     .receiving-form__row .y-input-element{min-width:initial}.receiving-form__row[_ngcontent-%COMP%]{display:flex;column-gap:32px;margin-top:10px}.receiving-form__field[_ngcontent-%COMP%]{width:100%}.receiving-form__field.tall-error[_ngcontent-%COMP%]{padding-bottom:16px}.receiving-form__input_comment[_ngcontent-%COMP%]{resize:none}.receiving-form__add-comment[_ngcontent-%COMP%]{display:flex;align-items:center;width:fit-content;column-gap:12px;margin-top:8px;color:#00aeef;cursor:pointer;font-size:14px;line-height:18px;font-weight:600}.receiving-form__add-comment-button[_ngcontent-%COMP%]{width:24px;height:24px;min-width:24px;min-height:24px}.receiving-form__comment[_ngcontent-%COMP%]{margin-top:8px}@media (max-width: 768px){.receiving-form__row[_ngcontent-%COMP%]{column-gap:12px}}"],changeDetection:0});}}return r})();function ko(r,o){if(r&1){let e=_O();Pp(0,"yota-field-state",11),FE("clear",function(){FR(e);let i=MO(2);return kR(i.clearSearchField())}),Lp();}if(r&2){MO();let e=kO(5),t=MO();aE("state",t.controlState.CLEAR)("inputControl",e);}}function $o(r,o){if(r&1&&(Pp(0,"y-form-field-bordered")(1,"y-label"),PO(2,"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u043C\u0435\u0442\u0440\u043E, \u0443\u043B\u0438\u0446\u0435 \u0438 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044E"),Lp(),EE(3,"y-icon",8)(4,"input",9,0),LI(6,ko,1,2,"yota-field-state",10),Lp()),r&2){let e=kO(5),t=MO();eO(3),aE("svgIcon","search-outline"),eO(),aE("formControl",t.searchControl),eO(2),aE("ngIf",e.focused&&e.value);}}function Ro(r,o){r&1&&EE(0,"yota-ya-search");}var fi=(()=>{class r extends p{constructor(){super(),this.listControl=new W(ze.ON_MAP),this._orderAnalyticsService=D(re),this._changeDetectorRef=D(ui),this.searchListType=ze,this.controlState=c;}ngAfterViewInit(){this.listControl.valueChanges.pipe(Hu(this._onDestroy$)).subscribe(e=>{e&&this._orderAnalyticsService.onChooseSearchList(e),this._changeDetectorRef.markForCheck();});}clearSearchField(){this.searchControl.setValue("");}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-order-choose-point"]],inputs:{searchControl:"searchControl",listControl:"listControl"},features:[MI],decls:11,vars:6,consts:[["searchFieldInputRef","yInput"],[1,"order-choose-point"],[1,"order-choose-point__search"],[4,"ngIf"],[1,"order-choose-point__mode"],[1,"order-choose-point__mode-type"],["type","radio","name","searchListType","id","mapRadio",1,"order-choose-point__radio",3,"formControl","value"],["type","radio","name","searchListType","id","listRadio",1,"order-choose-point__radio",3,"formControl","value"],["yPrefix","",1,"order-choose-point__search-icon",3,"svgIcon"],["yInput","","type","text",3,"formControl"],["ySuffix","",3,"state","inputControl","clear",4,"ngIf"],["ySuffix","",3,"clear","state","inputControl"]],template:function(t,i){t&1&&(Pp(0,"div",1)(1,"div",2),LI(2,$o,7,3,"y-form-field-bordered",3)(3,Ro,1,0,"yota-ya-search",3),Lp(),Pp(4,"div",4)(5,"label",5),PO(6,"\u041A\u0430\u0440\u0442\u0430 "),EE(7,"input",6),Lp(),Pp(8,"label",5),PO(9,"\u0421\u043F\u0438\u0441\u043E\u043A "),EE(10,"input",7),Lp()()()),t&2&&(eO(2),aE("ngIf",i.listControl.value===i.searchListType.LIST),eO(),aE("ngIf",i.listControl.value===i.searchListType.ON_MAP),eO(4),aE("formControl",i.listControl)("value",i.searchListType.ON_MAP),eO(3),aE("formControl",i.listControl)("value",i.searchListType.LIST));},dependencies:[Zw,An$1,Ge,Rt$1,yn$1,Mn$1,Tt,x$1,dn$1,ar,cd,gd,zt,Ty,hd],styles:['[_nghost-%COMP%]  .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}.order-choose-point[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;align-items:center;column-gap:32px}.order-choose-point__search[_ngcontent-%COMP%]{display:block}.order-choose-point__search-list[_ngcontent-%COMP%]{max-height:540px;padding-right:20px;overflow-y:auto}.order-choose-point__search-icon[_ngcontent-%COMP%]{width:24px;height:24px}.order-choose-point__mode[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:1;position:relative}.order-choose-point__mode[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;width:100%;height:2px;border-radius:12px;background-color:#e2e9f0;z-index:1}.order-choose-point__mode-type[_ngcontent-%COMP%]{white-space:nowrap;padding:16px 12px;position:relative;overflow:hidden;cursor:pointer;font-size:14px;line-height:18px;font-weight:500}.order-choose-point__mode-type[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;width:100%;height:2px;border-radius:12px;right:-100%;background-color:#00aeef;z-index:2;transition:left .15s ease-in,right .15s ease-in}.order-choose-point__mode-type[_ngcontent-%COMP%]:last-child:after{left:-100%}.order-choose-point__mode-type[_ngcontent-%COMP%]:has(.order-choose-point__radio:checked){color:#00aeef}.order-choose-point__mode-type[_ngcontent-%COMP%]:has(.order-choose-point__radio:checked):after{right:0}.order-choose-point__mode-type[_ngcontent-%COMP%]:has(.order-choose-point__radio:checked):last-child:after{left:0}.order-choose-point__radio[_ngcontent-%COMP%]{visibility:hidden;position:absolute}@media (max-width: 768px){.order-choose-point[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:0;padding:8px 16px 0;border-radius:20px;overflow:hidden}.order-choose-point__search[_ngcontent-%COMP%]{width:100%}.order-choose-point__mode[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;width:100%}.order-choose-point__mode-type[_ngcontent-%COMP%]{text-align:center}}'],changeDetection:0});}}return r})();var gi=(()=>{class r{constructor(){this._errorList$=new En$1([]),this.errorList$=this._errorList$.asObservable(),this.errorPlacemarks=new Set,this.showError$=new En$1(false);}get errorList(){return this._errorList$.value}addErrorClusterPlacemarks(e){this.errorPlacemarks.add(e);}setError(e){this._errorList$.next([...this._errorList$.getValue(),e]);}isPlacemarkError(e){return e.length>1?this.errorPlacemarks.has(e.join(",")):this._errorList$.getValue().includes(e[0])}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac});}}return r})();function Fo(r,o){if(r&1&&(EE(0,"p",14),GO(1,"yHighlight")),r&2){let e=MO();aE("innerHTML",YO(1,1,e.store.address,e.searchString),YR);}}function Bo(r,o){if(r&1&&(Pp(0,"p",15),PO(1),Lp()),r&2){let e=MO();eO(),$p(" ",e.store.howToFind," ");}}function Lo(r,o){r&1&&bE(0);}function Vo(r,o){if(r&1&&(jp(0),LI(1,Lo,1,0,"ng-container",16),Vp()),r&2){MO();let e=kO(18);eO(),aE("ngTemplateOutlet",e);}}function Uo(r,o){r&1&&bE(0);}function Go(r,o){if(r&1&&(jp(0),LI(1,Uo,1,0,"ng-container",16),Vp()),r&2){MO(2);let e=kO(20);eO(),aE("ngTemplateOutlet",e);}}function Ho(r,o){r&1&&bE(0);}function Yo(r,o){if(r&1&&(jp(0),LI(1,Ho,1,0,"ng-container",16),Vp()),r&2){MO(2);let e=kO(22);eO(),aE("ngTemplateOutlet",e);}}function jo(r,o){if(r&1&&(Pp(0,"div",17),LI(1,Go,2,1,"ng-container",12),GO(2,"async"),LI(3,Yo,2,1,"ng-container",12),GO(4,"async"),Lp()),r&2){let e=MO();eO(),aE("ngIf",ZO(2,2,e.isLoading$)),eO(2),aE("ngIf",ZO(4,4,e.isActionsAvailable$));}}function zo(r,o){r&1&&(Pp(0,"div",18),EE(1,"y-icon",19),Pp(2,"p",20),PO(3," \u0417\u0434\u0435\u0441\u044C \u0442\u043E\u0432\u0430\u0440 \u0443\u0436\u0435 \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0441\u044F, "),EE(4,"br"),PO(5," \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443 \u043F\u0440\u043E\u0434\u0430\u0436 "),Lp()()),r&2&&(eO(),aE("svgIcon","info-outline"));}function qo(r,o){r&1&&(Pp(0,"div",21),EE(1,"div")(2,"div")(3,"div")(4,"div"),Lp());}function Wo(r,o){if(r&1){let e=_O();Pp(0,"button",24),FE("click",function(){FR(e);let i=MO(2);return kR(i.selectPickUpPoint())}),PO(1," \u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C "),Lp();}}function Ko(r,o){if(r&1){let e=_O();Pp(0,"div",25),FE("click",function(){FR(e);let i=MO(2);return kR(i.changePickUpPoint())}),PO(1," \u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C "),Lp();}}function Qo(r,o){if(r&1&&LI(0,Wo,2,0,"button",22)(1,Ko,2,0,"div",23),r&2){let e=MO();aE("ngIf",!e.selected),eO(),aE("ngIf",e.selected);}}var Ci=(()=>{class r extends p{constructor(){super(...arguments),this.isHidden=false,this.selected=false,this.handleChange=new at$1,this._orderStateService=D(he),this._orderAnalyticsService=D(re),this._orderApiService=D(Le),this._dialogService=D(mr),this._orderDataService=D(ve),this._breakpointObserver=D(U),this._orderErrorService=D(gi),this._isMobile=false,this.isLoading$=new En$1(false),this.isPickupError$=new En$1(false),this.orderMetaInfo$=this._orderDataService.orderMetaInfo$,this.maxCount=this.orderMetaInfo$.value?.cityData.good.maxOrderCount||5,this.userCartCount=this._orderStateService.cartFormGroup.controls.productCount,this.isActionsAvailable$=Zh([this.isLoading$,this.isPickupError$]).pipe(le(([e,t])=>!e&&!t));}_setError(e){this.isPickupError$.next(true),this._orderErrorService.setError(e?.code||"");}getGoodSalesPoints(e){this.isPickupError$.next(false),this.isLoading$.next(true),this._orderErrorService.showError$.next(false);let t=this._orderDataService.orderMetaInfo$.value;this._orderApiService.getGoodSalesPoints$({goodId:e?.good?.id,codeSalesPoint:e?.code}).pipe(Li$1(i=>{let n=i.message===At.CANT_PICKUP;return e?.good?.remains===-1||n?(this._setError(e),og(()=>i)):(this.isLoading$.next(false),Bh(null))}),Fu(()=>{this.isLoading$.next(false);}),Hu(this._onDestroy$)).subscribe(i=>{if(i){if(t&&i?.remains&&t.cityData.good.maxOrderCount!==2&&i.remains>1&&(t.cityData.good.maxOrderCount=2,this._orderDataService.orderMetaInfo=t),i.remains&&i.remains>0&&i.remains<=this.userCartCount.value){t&&(t.cityData.good.maxOrderCount=i.remains,this._orderDataService.orderMetaInfo=t),this.userCartCount.setValue(i.remains),this._orderErrorService.showError$.next(true),this._orderStateService.pickUpPoint$.next(this.store);return}i?.remains&&i?.remains>=this.userCartCount.value&&(this._orderStateService.pickUpPoint$.next(this.store),this._dialogService.closeAllDialogs());}});}selectPickUpPoint(){this.getGoodSalesPoints(this.store),this._sendEcommerceOnSelect();}_sendEcommerceOnSelect(){this._orderAnalyticsService.pickUpHereEvent(this.orderMetaInfo$.value);}changePickUpPoint(){this._orderStateService.pickUpPoint$.next(null),this._isMobile&&this.handleChange.emit();}ngOnInit(){this.selected&&this._breakpointObserver.observe(["(max-width: 768px)"]).pipe(Hu(this._onDestroy$)).subscribe(e=>{this._isMobile=e.matches;}),this._orderErrorService.errorList$.pipe(Hu(this._onDestroy$)).subscribe(e=>{e.includes(this.store?.code)&&this.isPickupError$.next(true);});}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-order-search-list-item"]],inputs:{store:"store",searchString:"searchString",code:"code",isHidden:"isHidden",selected:"selected"},outputs:{handleChange:"handleChange"},features:[MI],decls:23,vars:21,consts:[["pickupError",""],["loader",""],["orderActions",""],[1,"order-search-list-item"],["svgIcon","marker-rounded",1,"order-search-list-item__icon"],[1,"order-search-list-item__content"],[1,"order-search-list-item__title",3,"innerHTML"],[1,"order-search-list-item__location"],["class","order-search-list-item__address",3,"innerHTML",4,"ngIf"],[1,"order-search-list-item__description"],["class","order-search-list-item__hint",4,"ngIf"],[1,"order-search-list-item__time"],[4,"ngIf"],["class","order-search-list-item__action",4,"ngIf"],[1,"order-search-list-item__address",3,"innerHTML"],[1,"order-search-list-item__hint"],[4,"ngTemplateOutlet"],[1,"order-search-list-item__action"],[1,"order-search-list-item__pickup-error"],[1,"order-search-list-item__pickup-error-icon",3,"svgIcon"],[1,"order-search-list-item__pickup-error__text"],[1,"lds-ellipsis"],["class","order-search-list-item__action-select y-button-secondary",3,"click",4,"ngIf"],["class","order-search-list-item__action-change",3,"click",4,"ngIf"],[1,"order-search-list-item__action-select","y-button-secondary",3,"click"],[1,"order-search-list-item__action-change",3,"click"]],template:function(t,i){t&1&&(Pp(0,"div",3),EE(1,"y-icon",4),Pp(2,"div",5),EE(3,"div",6),GO(4,"yHighlight"),Pp(5,"div",7),LI(6,Fo,2,4,"p",8),Pp(7,"p",9),PO(8),Lp(),LI(9,Bo,2,1,"p",10),Lp(),Pp(10,"div",11),PO(11),Lp(),LI(12,Vo,2,1,"ng-container",12),GO(13,"async"),Lp(),LI(14,jo,5,6,"div",13),GO(15,"async"),GO(16,"async"),Lp(),LI(17,zo,6,1,"ng-template",null,0,KO)(19,qo,5,0,"ng-template",null,1,KO)(21,Qo,2,2,"ng-template",null,2,KO)),t&2&&(cE("selected",i.selected)("hidden",i.isHidden),qI("data-code",i.code),eO(3),aE("innerHTML",YO(4,12,i.store.name,i.searchString),YR),eO(3),aE("ngIf",i.store.address),eO(2),HE(i.store.mall),eO(),aE("ngIf",i.store.howToFind),eO(2),HE(i.store.workingTime),eO(),aE("ngIf",ZO(13,15,i.isPickupError$)),eO(2),aE("ngIf",ZO(15,17,i.isLoading$)||ZO(16,19,i.isActionsAvailable$)));},dependencies:[Zw,Jw,tC,zt,Vy],styles:['.order-search-list-item[_ngcontent-%COMP%]{display:grid;grid-template-areas:"icon content action";grid-template-columns:auto 1fr auto;column-gap:8px;padding-inline:20px}.order-search-list-item__pickup-error[_ngcontent-%COMP%]{border-radius:12px;border:1px solid #ff6b6e;padding:7px 12px;display:flex;gap:8px;max-width:312px}.order-search-list-item__pickup-error-icon[_ngcontent-%COMP%]{rotate:180deg;width:24px;height:24px}.order-search-list-item__pickup-error-icon[_ngcontent-%COMP%]     svg path{fill:#ff6b6e}.order-search-list-item__pickup-error__text[_ngcontent-%COMP%]{color:#ff6b6e;font-size:12px;line-height:18px;font-weight:400}.order-search-list-item.selected[_ngcontent-%COMP%]{padding-inline:0}.order-search-list-item.hidden[_ngcontent-%COMP%]{display:none}.order-search-list-item__icon[_ngcontent-%COMP%]{grid-area:icon;width:24px;height:24px}.order-search-list-item__content[_ngcontent-%COMP%]{grid-area:content;display:flex;flex-direction:column;row-gap:8px}.order-search-list-item__title[_ngcontent-%COMP%]{font-size:16px;line-height:22px;font-weight:600}.order-search-list-item__location[_ngcontent-%COMP%]{color:#89909c;font-size:16px;line-height:24px;font-weight:400}.order-search-list-item__address[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}.order-search-list-item__hint[_ngcontent-%COMP%]:first-letter{text-transform:uppercase}.order-search-list-item__action[_ngcontent-%COMP%]{grid-area:action}.order-search-list-item__action-select[_ngcontent-%COMP%]{min-width:164px;border:none;background-color:#e5f7fd;height:auto;width:auto;min-height:initial;min-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}.order-search-list-item__action-change[_ngcontent-%COMP%]{color:#00aeef;text-decoration:underline dotted;text-decoration-thickness:auto;text-underline-offset:4px;cursor:pointer;font-size:16px;line-height:24px;font-weight:400}@media (max-width: 768px){.order-search-list-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:8px;padding-inline:0}.order-search-list-item.selected[_ngcontent-%COMP%]{display:grid;grid-template-areas:"icon content" "icon action";grid-template-columns:auto 1fr;grid-template-rows:1fr auto}.order-search-list-item[_ngcontent-%COMP%]:not(.selected) > .order-search-list-item__icon[_ngcontent-%COMP%]{display:none}.order-search-list-item__pickup-error[_ngcontent-%COMP%]{margin-bottom:-4px}}.lds-ellipsis[_ngcontent-%COMP%]{display:block;position:relative;margin-inline:50px;width:64px;height:48px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;margin-block:auto;width:16px;height:16px;border-radius:50%;background:#00aeef;animation-timing-function:cubic-bezier(0,1,1,0);animation:_ngcontent-%COMP%_lds-ellipsis-center .6s infinite}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{animation-name:_ngcontent-%COMP%_lds-ellipsis-first}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:0}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:24px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4){left:48px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{animation-name:_ngcontent-%COMP%_lds-ellipsis-last}@media (max-width: 768px){.lds-ellipsis[_ngcontent-%COMP%]{margin-inline:auto}}@keyframes _ngcontent-%COMP%_lds-ellipsis-first{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_lds-ellipsis-center{0%{transform:translate(0)}to{transform:translate(24px)}}@keyframes _ngcontent-%COMP%_lds-ellipsis-last{0%{transform:scale(1)}to{transform:scale(0)}}'],changeDetection:0});}}return r})();var Xo=["*"],Jo=()=>["name","address"];function Zo(r,o){if(r&1&&EE(0,"yota-order-search-list-item",9),r&2){let e=o.$implicit,t=MO(3);aE("searchString",t.searchControl.value)("store",e);}}function en(r,o){if(r&1&&(Pp(0,"div",7),LI(1,Zo,1,2,"yota-order-search-list-item",8),Lp()),r&2){let e=o.ngIf;eO(),aE("ngForOf",e);}}function tn(r,o){if(r&1&&(jp(0),LI(1,en,2,1,"div",6),GO(2,"searchSubstring"),Vp()),r&2){let e=MO();eO(),aE("ngIf",QO(2,1,e.stores,HO(5,Jo),e.searchControl.value));}}var kr=(()=>{class r extends p{constructor(){super(),this.stores=[],this._orderAnalyticsService=D(re),this.searchControl=new W("",{nonNullable:true}),this.listControl=new W(ze.ON_MAP),this.searchListType=ze,this.controlState=c,this.listControl.valueChanges.pipe(it(Boolean),Hu(this._onDestroy$)).subscribe(e=>{this._orderAnalyticsService.onChooseSearchList(e);});}clearSearchField(){this.searchControl.setValue("");}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-order-mobile-map"]],inputs:{stores:"stores"},features:[MI],ngContentSelectors:Xo,decls:7,vars:5,consts:[[1,"order-mobile-map"],[1,"order-mobile-map__wrapper",3,"hidden"],["y-dialog-close","","svgIcon","close-light",1,"order-mobile-map__close"],[1,"order-mobile-map__search",3,"searchControl","listControl"],[1,"order-mobile-map__stores",3,"hidden"],[4,"ngIf"],["class","order-mobile-map__stores-list",4,"ngIf"],[1,"order-mobile-map__stores-list"],[3,"searchString","store",4,"ngFor","ngForOf"],[3,"searchString","store"]],template:function(t,i){t&1&&(TO(),Pp(0,"div",0)(1,"div",1),SO(2),Lp(),EE(3,"y-icon",2)(4,"yota-order-choose-point",3),Pp(5,"div",4),LI(6,tn,3,6,"ng-container",5),Lp()()),t&2&&(eO(),aE("hidden",i.listControl.value!==i.searchListType.ON_MAP),eO(3),aE("searchControl",i.searchControl)("listControl",i.listControl),eO(),aE("hidden",i.listControl.value!==i.searchListType.LIST),eO(),aE("ngIf",i.stores));},dependencies:[fi,Zw,Ih,Ci,y,Dy,zt],styles:["[_nghost-%COMP%]  .order-choose-point{position:relative;background-color:#fff;box-shadow:0 4px 20px #f6f6f6}[_nghost-%COMP%]  .order-mobile-map__stores .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}  .y-dialog-mobile-map .y-dialog-container{padding:16px}  .y-dialog-mobile-map .y-dialog-container .b-map__controls{top:224px;row-gap:36px}.order-mobile-map[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:auto auto 1fr;max-height:100%;height:100%;justify-items:flex-end;background-color:#fff}.order-mobile-map__close[_ngcontent-%COMP%]{width:32px;height:32px;align-self:flex-end;margin-bottom:16px;z-index:1;cursor:pointer}.order-mobile-map__wrapper[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100vh;width:100vw}.order-mobile-map__search[_ngcontent-%COMP%]{width:100%}.order-mobile-map__stores[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;max-height:100%;overflow:hidden;margin-top:16px}.order-mobile-map__stores-title[_ngcontent-%COMP%]{padding-block:18px 20px;text-align:center;font-size:18px;line-height:24px;font-weight:600}.order-mobile-map__stores-close[_ngcontent-%COMP%]{width:24px;height:24px;position:absolute;top:18px;right:0}.order-mobile-map__stores-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:20px;max-height:100%;overflow-y:auto;padding-right:2px}.order-mobile-map__stores-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.order-mobile-map__stores-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}.order-mobile-map__stores-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}.order-mobile-map__search-icon[_ngcontent-%COMP%]{width:24px;height:24px}"],changeDetection:0});}}return r})();var rn=["modalMapComponent"],on=["map"],nn=()=>["name","address"],an=(r,o)=>[r,o];function sn(r,o){if(r&1){let e=_O();Pp(0,"yota-order-search-list-item",7),FE("handleChange",function(){FR(e);let i=MO();return kR(i.openMobileMap())}),Lp();}if(r&2){let e=o.ngIf;aE("selected",true)("store",e);}}function ln(r,o){r&1&&bE(0);}function cn(r,o){if(r&1&&EE(0,"yota-order-search-list-item",20),r&2){let e=o.$implicit,t=MO(5);aE("searchString",t.searchControl.value)("store",e)("code",e.code)("isHidden",(e.good==null?null:e.good.remains)===0);}}function un(r,o){if(r&1&&(Pp(0,"div",12),LI(1,cn,1,4,"yota-order-search-list-item",19),Lp()),r&2){let e=MO().ngIf,t=MO(3);eO(),aE("ngForOf",e)("ngForTrackBy",t.trackStoreByFn);}}function pn(r,o){if(r&1&&(Pp(0,"div"),LI(1,un,2,2,"div",18),Lp()),r&2){let e=o.ngIf;MO();let t=kO(4);eO(),aE("ngIf",e.length)("ngIfElse",t);}}function mn(r,o){r&1&&(Pp(0,"div",21),PO(1," \u041D\u0435 \u043D\u0430\u0448\u043B\u0438 \u043F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438."),EE(2,"br"),PO(3," \u041F\u0440\u043E\u0432\u0435\u0440\u044C, \u0442\u043E\u0442 \u043B\u0438 \u0432\u044B\u0431\u0440\u0430\u043D \u0433\u043E\u0440\u043E\u0434 \u2014 \u0438\u043B\u0438 \u0432\u0432\u0435\u0434\u0438 \u0434\u0440\u0443\u0433\u043E\u0439 \u0430\u0434\u0440\u0435\u0441 "),Lp());}function dn(r,o){if(r&1&&(jp(0),LI(1,pn,2,2,"div",17),GO(2,"searchSubstring"),LI(3,mn,4,0,"ng-template",null,3,KO),Vp()),r&2){let e=o.ngIf,t=MO(2);eO(),aE("ngIf",QO(2,1,e,HO(5,nn),t.searchControl.value));}}function _n(r,o){if(r&1){let e=_O();Pp(0,"div",8)(1,"button",9),FE("click",function(){FR(e);let i=MO();return kR(i.openMobileMap())}),PO(2," \u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438 "),Lp()(),Pp(3,"div",10),EE(4,"yota-order-choose-point",11),Pp(5,"div",12),jp(6,13),Pp(7,"div",14),LI(8,ln,1,0,"ng-container",15),Lp(),Pp(9,"div",16),LI(10,dn,5,6,"ng-container",17),GO(11,"async"),Lp(),Vp(),Lp()();}if(r&2){let e=MO(),t=kO(6);eO(4),aE("searchControl",e.searchControl)("listControl",e.listControl),eO(2),aE("ngSwitch",e.listControl.value),eO(),aE("hidden",e.listControl.value!==e.searchListType.ON_MAP),eO(),aE("ngTemplateOutlet",t),eO(),aE("hidden",e.listControl.value!==e.searchListType.LIST),eO(),aE("ngIf",ZO(11,7,e.storesCombine$));}}function hn(r,o){if(r&1){let e=_O();Pp(0,"yota-map",23,4),GO(2,"async"),FE("ready",function(i){FR(e);let n=MO(2);return kR(n.mapReady$.next(!!i))})("salePointSelected",function(i){FR(e);let n=MO(2);return kR(n.selectPickUpPoint(i))})("balloonopen",function(i){FR(e);let n=kO(1),u=MO(2);return kR(u.onBalloonOpen(i,n))})("balloonclose",function(i){FR(e);let n=MO(2);return kR(n.onBalloonClose(i))})("boundschange",function(){FR(e);let i=MO(2);return kR(i.showErrorPlacemarks())})("actionend",function(){FR(e);let i=MO(2);return kR(i.showErrorPlacemarks())})("yawheel",function(){FR(e);let i=MO(2);return kR(i.showErrorPlacemarks())}),PO(3," >"),Lp();}if(r&2){let e=MO(2);aE("isMonochrome",true)("hidePlacemarksWithoutGood",true)("isOrderMap",true)("center",UO(11,an,e.meta.cityData.city.latitude,e.meta.cityData.city.longitude))("zoom",12)("controls",e.mapControls)("showCombined",false)("salePoints",ZO(2,9,e.storesCombine$))("isCombined",false);}}function fn(r,o){if(r&1&&LI(0,hn,4,14,"yota-map",22),r&2){let e=MO();aE("ngIf",e.meta);}}function gn(r,o){r&1&&bE(0);}function Cn(r,o){if(r&1&&(Pp(0,"yota-order-mobile-map",24),GO(1,"async"),LI(2,gn,1,0,"ng-container",15),Lp()),r&2){let e=MO(),t=kO(6);aE("stores",ZO(1,2,e.storesCombine$)),eO(2),aE("ngTemplateOutlet",t);}}var $r=(()=>{class r extends p{hidePickupButton(e){if(e===-1)return;let t=this._document.querySelectorAll(".ya-map__balloon-pickup__actions");t.length!==0&&t[e].classList.add("ya-map__balloon-pickup__actions_hidden");}toggleLoader(e){if(e===-1)return;let t=this._document.querySelectorAll(".ya-map__balloon-ellipsis");t.length!==0&&(t[e].classList.contains("ya-map__balloon-pickup-loader-show")?t[e].classList.remove("ya-map__balloon-pickup-loader-show"):t[e].classList.add("ya-map__balloon-pickup-loader-show"));}toggleError(e){if(e===-1)return;let t=this._document.querySelectorAll(".ya-map__balloon-pickup-error");t.length!==0&&(t[e].classList.contains("ya-map__balloon-pickup-error-show")?t[e].classList.remove("ya-map__balloon-pickup-error-show"):t[e].classList.add("ya-map__balloon-pickup-error-show"));}getGoodSalesPoints(e){let t=this.currentOpenPickupCodes.indexOf(e?.code||"");this.hidePickupButton(t),this.toggleLoader(t),this._orderErrorService.showError$.next(false);let i=this._orderDataService.orderMetaInfo$.value;this._orderApiService.getGoodSalesPoints$({goodId:e?.good?.id,codeSalesPoint:e?.code}).pipe(Li$1(n=>{let u=n.message===At.CANT_PICKUP;return e?.good?.remains===-1||u?(this.toggleError(t),this.currentOpenPickupCodes.length>1&&this._orderErrorService.addErrorClusterPlacemarks(this.currentOpenPickupCodes.join(",")),this._orderErrorService.setError(e?.code||At.CANT_PICKUP),og(()=>n)):(this.toggleLoader(t),Bh(null))}),Fu(()=>{this.toggleLoader(t);}),Hu(this._onDestroy$)).subscribe(n=>{if(n){if(i&&n.remains&&i.cityData.good.maxOrderCount!==2&&n.remains>1&&(i.cityData.good.maxOrderCount=2,this._orderDataService.orderMetaInfo=i),n.remains&&n.remains>0&&n.remains<=this.userCartCount.value){i&&(i.cityData.good.maxOrderCount=n.remains,this._orderDataService.orderMetaInfo=i),this.userCartCount.setValue(n.remains),this._orderErrorService.showError$.next(true),this._orderStateService.pickUpPoint$.next(e);return}n?.remains&&n?.remains>=this.userCartCount.value&&(this._orderStateService.pickUpPoint$.next(e),p$1.closeDialog(this._mapDialogRef));}});}constructor(e,t,i,n,u,m,x$1,M){super(),this._orderStateService=e,this._addressService=t,this._orderDataService=i,this._orderApiService=n,this._dialogService=u,this._orderAnalyticsService=m,this._breakpointObserver=x$1,this._orderErrorService=M,this.searchControl=new W("",{nonNullable:true}),this.listControl=new W(ze.ON_MAP),this.searchListType=ze,this.isMobile=false,this.orderMetaInfo$=this._orderDataService.orderMetaInfo$,this.maxCount=this.orderMetaInfo$.value?.cityData.good.maxOrderCount||5,this.userCartCount=this._orderStateService.cartFormGroup.controls.productCount,this.currentOpenPickupCodes=[],this.eventDataCode=null,this._document=D(dr),this.selectedPickUp$=this._orderStateService.pickUpPoint$.pipe(Uu(_=>{_&&this._orderApiService.loadingOrder$.next(false);})),this.mapControls=["zoom","locate"],this._mnpState$=this._orderDataService.contactState$.pipe(Su(64),Ou((_,T)=>!_?.mnp&&!T?.mnp?false:_?.mnp===T?.mnp),le(_=>_?.mnp)),this.stores$=Zh([this._mnpState$,te.beautifulNumberFormGroup.controls.numbers.valueChanges.pipe(Vu(te.beautifulNumberFormGroup.controls.numbers.value),le(_=>!!_.length),Ou()),oe.contactFormGroup.controls.citizenship.valueChanges.pipe(Vu(oe.contactFormGroup.controls.citizenship.value),Ou((_,T)=>{let O=q=>q==="\u0420\u043E\u0441\u0441\u0438\u044F";return O(_)===O(T)}))]).pipe(Bu(_=>this.mapReady$.pipe(it(Boolean),le(()=>_))),Uu(()=>this._orderApiService.loadingOrder$.next(true)),Bu(([_,T])=>this._addressService.getSalePoints$(!!_,T,this._addressService.isNonResident).pipe(le(O=>O))),Li$1(()=>Bh([])),Uu(()=>this._orderApiService.loadingOrder$.next(false)),jr$1()),this.storesCombine$=Zh([this._orderAnalyticsService.goodCount$,this.stores$]).pipe(le(([_,T])=>T.filter(O=>!O.good?.remains||O.good?.remains>-1&&O.good?.remains<_?null:x(w$1({},O),{code:O.code})))),this.mapReady$=new En$1(false),this.listControl.valueChanges.pipe(Hu(this._onDestroy$)).subscribe(_=>{_&&this._orderAnalyticsService.onChooseSearchList(_);}),this._breakpointObserver.observe(["(max-width: 768px)"]).pipe(Hu(this._onDestroy$)).subscribe(_=>{this.isMobile=_.matches;});}openMobileMap(){this._mapDialogRef=this._dialogService.open(this.modalMapComponent,{panelClass:["y-dialog-fullscreen","y-dialog-mobile-map"]});}sendAnalytics(e){this._orderAnalyticsService.enterFormField(e,this.orderMetaInfo$.value);}selectPickUpPoint(e){this.eventDataCode=null,this.getGoodSalesPoints(e),this._sendEcommerceOnSelect();}_sendEcommerceOnSelect(){this._orderAnalyticsService.pickUpHereEvent(this.orderMetaInfo$.value);}onBalloonClose(e){setTimeout(()=>{this.eventDataCode=null;let t=e.event.get("target").properties?._data?.code,i=e.event.get("target").balloon._propertiesDataManger?._sourceDataManager?._data.geoObjects.map(m=>m.properties._data.code),n;t?n=`[data-points-codes="${t}"]`:n=`[data-points-codes="${i.join(",")}"]`;let u=this._document.querySelector(n);u&&this._orderErrorService.isPlacemarkError(t?[t]:i)&&u.classList.add("ya-map__placemark_error");},0);}showErrorPlacemarks(){this._orderErrorService.errorList.forEach(e=>{let t=`[data-points-codes="${e}"]`,i=this._document.querySelector(t);i&&this._orderErrorService.isPlacemarkError([e])&&i.classList.add("ya-map__placemark_error");}),setTimeout(()=>{for(let e of this._orderErrorService.errorPlacemarks){let t=`[data-points-codes="${e}"]`,i=this._document.querySelector(t);if(!i)return;i.classList.add("ya-map__placemark_error");}},5);}showPickupActions(){let t=this._document.querySelector(".ya-map__balloon-pickup")?.querySelectorAll(".ya-map__balloon-pickup__actions");t&&t.forEach(i=>{i.classList.add("ya-map__balloon-pickup-select-show");});}onBalloonOpen(e,t){let i=e.event.get("target")?.geometry?.getCoordinates();if(this.eventDataCode||(this.eventDataCode=e.event.get("target")?.properties?._data.code,this.currentOpenPickupCodes=[e.event.get("target").properties?._data.code]),this.eventDataCode||(this.currentOpenPickupCodes=e.event.get("target").balloon._propertiesDataManger?._sourceDataManager?._data.geoObjects.map(_=>_.properties._data.code)),this._orderErrorService.errorList.forEach(_=>{let T=this.currentOpenPickupCodes.indexOf(_);this.hidePickupButton(T),this.toggleError(T);}),!t||!i)return;let n=t.map$.value;if(!n)return;let u=[...i],m=n.getBounds()[0][0],M=n.getBounds()[1][0]-m;u[0]=u[0]+M/2-M/(this.isMobile?10:5),n.panTo(u,{duration:250,timingFunction:"ease-in"});}trackStoreByFn(e,t){return t.code}static{this.\u0275fac=function(t){return new(t||r)(k$1(he),k$1(bt),k$1(ve),k$1(Le),k$1(mr),k$1(re),k$1(U),k$1(gi))};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-receiving-form-pickup"]],viewQuery:function(t,i){if(t&1&&(NO(rn,5,Ye),NO(on,5)),t&2){let n;AO(n=RO())&&(i.modalMapComponent=n.first),AO(n=RO())&&(i.mapComponent=n.first);}},inputs:{meta:"meta"},features:[MI],decls:9,vars:4,consts:[["selectedView",""],["orderMap",""],["modalMapComponent",""],["searchEmpty",""],["map",""],[1,"receiving-form__search"],[3,"selected","store","handleChange",4,"ngIf","ngIfElse"],[3,"handleChange","selected","store"],[1,"receiving-form__search-container","receiving-form__search-container_mobile"],["type","button",1,"receiving-form__open-map-button","y-button-secondary",3,"click"],[1,"receiving-form__search-container"],[3,"searchControl","listControl"],[1,"receiving-form__search-list"],[3,"ngSwitch"],[1,"receiving-form__search-map",3,"hidden"],[4,"ngTemplateOutlet"],[3,"hidden"],[4,"ngIf"],["class","receiving-form__search-list",4,"ngIf","ngIfElse"],[3,"searchString","store","code","isHidden",4,"ngFor","ngForOf","ngForTrackBy"],[3,"searchString","store","code","isHidden"],[1,"receiving-form__search-empty"],[3,"isMonochrome","hidePlacemarksWithoutGood","isOrderMap","center","zoom","controls","showCombined","salePoints","isCombined","ready","salePointSelected","balloonopen","balloonclose","boundschange","actionend","yawheel",4,"ngIf"],[3,"ready","salePointSelected","balloonopen","balloonclose","boundschange","actionend","yawheel","isMonochrome","hidePlacemarksWithoutGood","isOrderMap","center","zoom","controls","showCombined","salePoints","isCombined"],[3,"stores"]],template:function(t,i){if(t&1&&(Pp(0,"div",5),LI(1,sn,1,2,"yota-order-search-list-item",6),GO(2,"async"),LI(3,_n,12,9,"ng-template",null,0,KO),Lp(),LI(5,fn,1,1,"ng-template",null,1,KO)(7,Cn,3,4,"ng-template",null,2,KO)),t&2){let n=kO(4);eO(),aE("ngIf",ZO(2,2,i.selectedPickUp$))("ngIfElse",n);}},dependencies:[Zw,Ci,fi,tu,Jw,Ih,hn$1,kr,tC,y],styles:[".receiving-form__search[_ngcontent-%COMP%]{display:block}.receiving-form__search-map[_ngcontent-%COMP%]{height:540px;border-radius:16px;border:1px solid rgba(171,186,200,.3);overflow:hidden}.receiving-form__search-list[_ngcontent-%COMP%]{max-height:540px;min-height:37px;overflow-y:auto;display:flex;flex-direction:column;row-gap:16px}.receiving-form__search-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.receiving-form__search-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}.receiving-form__search-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}.receiving-form__search-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:24px}@media (max-width: 768px){.receiving-form__search-container[_ngcontent-%COMP%]{display:none}}.receiving-form__search-container_mobile[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.receiving-form__search-container_mobile[_ngcontent-%COMP%]{display:block}}.receiving-form__open-map-button[_ngcontent-%COMP%]{border:none;background-color:#e5f7fd;height:auto;width:100%;min-height:initial;min-width:initial;max-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}"],changeDetection:0});}}return r})();var vn=()=>["/map"],bn=()=>({mode:"sales"});function yn(r,o){if(r&1&&(Pp(0,"div",18),EE(1,"yota-receiving-form-pickup",19),Lp()),r&2){let e=MO(3).ngIf;eO(),aE("meta",e);}}function Sn(r,o){if(r&1&&(jp(0),Pp(1,"div",11)(2,"div",12),EE(3,"yota-order-radio-button",13,1),Lp(),Pp(5,"div",12),EE(6,"yota-order-radio-button",14),Lp()(),Pp(7,"div",15),EE(8,"yota-receiving-form-delivery",16),Lp(),LI(9,yn,2,1,"div",17),Vp()),r&2){let e=MO(2).ngIf,t=MO();eO(3),aE("value",t.receivingWay.Delivery)("control",t.deliveryTypeControl)("label","\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C")("id",t.radioButtonCourierId)("enabledText",e.cityData.orderDeliveryInfo.shortConditions)("disableText","\u0412 \u044D\u0442\u043E\u043C \u0433\u043E\u0440\u043E\u0434\u0435 \u043F\u043E\u043A\u0430 \u043D\u0435 \u0434\u043E\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u043C. \u041C\u043E\u0436\u0435\u0448\u044C \u0437\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0432 \u043F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438")("inputName",t.radioButtonName)("disable",!(!(e==null||e.dmsData==null||e.dmsData.nomenclature==null)&&e.dmsData.nomenclature.deliveryAvailable)||t.foreignCitizenship),eO(3),aE("value",t.receivingWay.Pickup)("control",t.deliveryTypeControl)("id",t.radioButtonPickUpId)("label","\u041F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438")("enabledText","\u041F\u043E\u0434\u0433\u043E\u0442\u043E\u0432\u0438\u043C \u0437\u0430\u043A\u0430\u0437 \u0447\u0435\u0440\u0435\u0437 30 \u043C\u0438\u043D\u0443\u0442, \u0437\u0430\u0431\u0440\u0430\u0442\u044C \u043C\u043E\u0436\u043D\u043E \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 7 \u0434\u043D\u0435\u0439")("disableText","\u041A \u0441\u043E\u0436\u0430\u043B\u0435\u043D\u0438\u044E, \u0441\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437 \u0432 \u0442\u0432\u043E\u0435\u043C \u0433\u043E\u0440\u043E\u0434\u0435 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D")("inputName",t.radioButtonName)("disable",!(!(e==null||e.dmsData==null||e.dmsData.nomenclature==null)&&e.dmsData.nomenclature.pickupAvailable)),eO(),aE("hidden",t.deliveryTypeControl.value!==t.receivingWay.Delivery),eO(),aE("samokatPromoCodeAvailable",t.samokatPromoCodeAvailable),eO(),aE("ngIf",t.deliveryTypeControl.value===t.receivingWay.Pickup);}}function xn(r,o){r&1&&(Pp(0,"p",20),PO(1," \u041C\u044B \u043F\u043E\u043A\u0430 \u043D\u0435 \u043E\u0444\u043E\u0440\u043C\u043B\u044F\u0435\u043C \u0437\u0430\u043A\u0430\u0437\u044B \u0432 \u0432\u0430\u0448\u0435\u043C \u043D\u0430\u0441\u0435\u043B\u0435\u043D\u043D\u043E\u043C \u043F\u0443\u043D\u043A\u0442\u0435. "),EE(2,"br"),PO(3," \u0412\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0441\u0442\u0438 \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u0432 \u0431\u043B\u0438\u0436\u0430\u0439\u0448\u0435\u0439 \u0442\u043E\u0447\u043A\u0435 \u043F\u0440\u043E\u0434\u0430\u0436. "),Lp(),Pp(4,"a",21),PO(5,"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436"),Lp()),r&2&&(eO(4),aE("routerLink",HO(2,vn))("queryParams",HO(3,bn)));}function En(r,o){if(r&1&&(Pp(0,"form",9),LI(1,Sn,10,19,"ng-container",10)(2,xn,6,4,"ng-template",null,0,KO),Lp()),r&2){let e=kO(3),t=MO().ngIf,i=MO();aE("formGroup",i.formGroup),eO(),aE("ngIf",(t==null||t.dmsData==null||t.dmsData.nomenclature==null?null:t.dmsData.nomenclature.deliveryAvailable)&&!i.foreignCitizenship||(t==null||t.dmsData==null||t.dmsData.nomenclature==null?null:t.dmsData.nomenclature.pickupAvailable))("ngIfElse",e);}}function Mn(r,o){if(r&1){let e=_O();Pp(0,"div",3)(1,"div",4)(2,"span",5),PO(3,"\u0421\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0432"),Lp(),Pp(4,"span",6),FE("click",function(i){return FR(e),MO().changeCity(),kR(i.stopPropagation())}),PO(5),EE(6,"y-icon",7),Lp()(),LI(7,En,4,3,"form",8),Lp();}if(r&2){let e=o.ngIf,t=MO();eO(5),$p(" ",t.getCityName(e)," "),eO(2),aE("ngIf",t.formGroup);}}var ze=function(r){return r.ON_MAP="ON_MAP",r.LIST="LIST",r}(ze||{}),Rr=(()=>{class r extends p{constructor(e,t,i,n,u){super(),this._orderStateService=e,this._orderDataService=t,this._renderer=i,this._orderAnalyticsService=n,this._cdr=u,this.samokatPromoCodeAvailable=false,this.foreignCitizenship=false,this.formGroup=G.receivingFormGroup,this.deliveryTypeControl=G.receivingFormGroup.controls.receivingWay,this.analyticsActions=O$1,this.receivingWay=O,this.orderMetaInfo$=this._orderDataService.orderMetaInfo$.pipe(jr$1()),this.hasSelectedBeautifulNumber$=te.beautifulNumberFormGroup.controls.numbers.valueChanges.pipe(Vu([]),le(m=>!!m.length)),this._currentReceivingWay=O.Delivery,this.radioButtonName="deliveryType",this.radioButtonCourierId="receiving-form__delivery-courier",this.radioButtonPickUpId="receiving-form__delivery-pick-up",this._analyticsFacadeService=D(M),this._window=D(i$1),this._orderStateService.receivingStep.stepState$.pipe(it(m=>m===j.ACTIVE),Ru(100),it(()=>this.deliveryTypeControl.value===O.Delivery),Hu(this._onDestroy$)).subscribe(()=>{this._orderAnalyticsService.clickDelivery(this._orderDataService.orderMetaInfo$.value);}),Zh([this.orderMetaInfo$.pipe(le(m=>m?.dmsData?.nomenclature),it(Boolean)),this._orderStateService.receivingStep.stepState$]).pipe(Hu(this._onDestroy$)).subscribe(([m,x])=>{x===j.ACTIVE&&(m.deliveryAvailable&&this.deliveryTypeControl.value===this.receivingWay.Delivery&&!this.foreignCitizenship?this.deliveryTypeControl.setValue(O.Delivery):this.deliveryTypeControl.setValue(O.Pickup));}),this.deliveryTypeControl.valueChanges.pipe(Hu(this._onDestroy$)).subscribe(m=>{if(m===O.Delivery&&!G.receivingFormGroup.controls.timeSlotsTime.value?.isSamokat?this._orderStateService.paymentStep.stepState$.next(j.DISABLE):m===O.Pickup&&this._orderStateService.paymentStep.stepState$.next(j.HIDDEN),this._orderAnalyticsService.receivingWay$.next(m),this._currentReceivingWay!==m){this._currentReceivingWay=m;let x=this._orderDataService.orderMetaInfo$.value;this._orderAnalyticsService.clickDelivery(x);}this._orderStateService.calculateTotal$.next(),this._orderStateService.changeButtonState$.next(),this._cdr.markForCheck();});}getCityName(e){return e?.dmsData?.settlement||e?.dmsData?.city}changeCity(){this._orderStateService.changeStateByStepName(Q.CONTACT),setTimeout(()=>{this._renderer.selectRootElement("#order-autocomplete")?.focus();},0);}onClickStoreLink(e){e.preventDefault();let i=G.receivingFormGroup.controls.receivingWay.value,u=[i===O.Delivery&&this._orderDataService.deliveryType$.value===N.Samokat?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 30 \u043C\u0438\u043D\u0443\u0442":"\u041E\u0431\u044B\u0447\u043D\u0430\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430",i===O.Delivery?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C":"\u041F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438",this._orderDataService.orderMetaInfo$.value?.cityData?.good?.name,"\u0438\u043D\u0442\u0435\u0440\u043D\u0435\u0442-\u043C\u0430\u0433\u0430\u0437\u0438\u043D\u0435",this._orderDataService.orderRegion,this._orderDataService.orderCity,this._orderDataService.orderMetaInfo$.value?.cityData?.good?.id];this._analyticsFacadeService.pushDataLayer({event:E.NAVIGATIONS,event_param:u.join("/")},O$1.CLICK_BACK_TO_STORE);let m=e.target.href;p$1.isIframe()?this._window.parent.location.href=m:this._window.location.href=m;}static{this.\u0275fac=function(t){return new(t||r)(k$1(he),k$1(ve),k$1(ar$1),k$1(re),k$1(ui))};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-receiving-form"]],inputs:{samokatPromoCodeAvailable:"samokatPromoCodeAvailable",foreignCitizenship:"foreignCitizenship"},features:[MI],decls:2,vars:3,consts:[["notAvailable",""],["courierRadioButton",""],["class","receiving-form",4,"ngIf"],[1,"receiving-form"],[1,"receiving-form__title"],[1,"receiving-form__city-prefix"],[1,"receiving-form__city",3,"click"],["svgIcon","edit-outline",1,"receiving-form__title-icon"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngIf","ngIfElse"],[1,"receiving-form__radio-container"],[1,"receiving-form__radio-button"],[3,"value","control","label","id","enabledText","disableText","inputName","disable"],[3,"value","control","id","label","enabledText","disableText","inputName","disable"],[1,"receiving-form__content",3,"hidden"],[3,"samokatPromoCodeAvailable"],["class","receiving-form__content",4,"ngIf"],[1,"receiving-form__content"],[3,"meta"],[1,"g-text","y-mb-32"],[1,"y-button","y-button-medium","custom-button",3,"routerLink","queryParams"]],template:function(t,i){t&1&&(LI(0,Mn,8,2,"div",2),GO(1,"async")),t&2&&aE("ngIf",ZO(1,1,i.orderMetaInfo$));},dependencies:[Zw,An$1,Dn$1,Cn$1,Mn$1,Bt,_i,Tr,$r,tC,zt,Hn$1],styles:["[_nghost-%COMP%]     .y-form-field-infix{width:100%}[_nghost-%COMP%]     .y-tab-label{width:300px}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{border:none;border-bottom:1px solid #b9c2cb;border-radius:0}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element:focus{border-bottom:1px solid #00aeef}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper span.ng-star-inserted, [_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{padding-left:0;padding-top:0}[_nghost-%COMP%]     .y-form-field label.dynamic-control__label{font-size:12px;margin-bottom:5px}.receiving-form__title[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;column-gap:8px;margin-bottom:24px;font-size:16px;line-height:22px;font-weight:600}.receiving-form__title-icon[_ngcontent-%COMP%]{color:#00aeef;cursor:pointer;width:24px;height:24px}.receiving-form__city-prefix[_ngcontent-%COMP%]{white-space:nowrap}.receiving-form__city[_ngcontent-%COMP%]{position:relative;color:#00aeef;cursor:pointer;display:flex;align-items:center;column-gap:8px}.receiving-form__row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:16px}.receiving-form__field[_ngcontent-%COMP%]{width:100%}.receiving-form__input[_ngcontent-%COMP%]{width:100%;padding-bottom:10px}.receiving-form__input_comment[_ngcontent-%COMP%]{resize:none}.receiving-form__content[_ngcontent-%COMP%]{margin-top:40px}.receiving-form__radio-container[_ngcontent-%COMP%]{display:flex;column-gap:32px}.receiving-form__radio-button[_ngcontent-%COMP%]{width:100%}@media (max-width: 768px){.receiving-form__title[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;row-gap:8px}.receiving-form__radio-container[_ngcontent-%COMP%]{flex-direction:column;row-gap:12px}.receiving-form__content[_ngcontent-%COMP%]{margin-top:24px}}.custom-button[_ngcontent-%COMP%]{text-transform:none}"],changeDetection:0});}}return r})();function vi({timeSlotsTime:r,timeSlotsSearch:o}){let e=r.value?.startTime,t=r.value?.endTime,i=o.value?.date;return i?{deliveryFrom:Ar(i)+" "+(e??"")+":00",deliveryTo:Ar(i)+" "+(t??"")+":00"}:{deliveryFrom:"",deliveryTo:""}}function Ar(r){let o=new Date(r),e=o.toLocaleString("default",{year:"numeric"}),t=o.toLocaleString("default",{month:"2-digit"}),i=o.toLocaleString("default",{day:"2-digit"});return e+"-"+t+"-"+i}var G=class r extends at{static{this.receivingFormGroup=new I({receivingWay:new W(O.Delivery,{nonNullable:true}),address:new W(null,[Ie$1.required,di.restrictedAddress]),entrance:new W("",{nonNullable:true,validators:[Ie$1.maxLength(5)]}),flat:new W("",{nonNullable:true,validators:[Ie$1.maxLength(10)]}),timeSlotsSearch:new W(null),timeSlotsTime:new W(null)});}static{this.foreignCitizenship$=new En$1(false);}constructor(o,e,t){super(),this._stepState$=o,this._transitions=e,this._pickUpPoint$=t,this.component=Rr,this.title="\u0421\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F",this.name=Q.RECEIVING,this.stepState$=this._stepState$,this.transitions=this._transitions;}nextAction(){}getWriteData(){let o,e="";if(r.receivingFormGroup.controls.receivingWay.value===O.Delivery){o="\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430",e+=o;let t=r.receivingFormGroup.controls.flat.value,i=r.receivingFormGroup.controls.address.value;typeof i!="string"&&i?.unrestrictedValue&&(e+=`<span>${i.unrestrictedValue} ${t?"\u043A\u0432."+t:""}</span>`);let n,u=r.receivingFormGroup.controls.timeSlotsSearch.value?.date,m=r.receivingFormGroup.controls.timeSlotsTime.value,x=m?.leftSide,M=m?.rightSide?.replace(/\D*/g,"");if(u){n=new Date(u);let _=new Intl.DateTimeFormat("ru",{month:"long",day:"numeric"});e+=`<span>${_.format(n)}, ${x}, ${M!=="0"?M+" \u20BD":"\u0411\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"}</span>`;}}else {o="\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437",e+=o;let t=this._pickUpPoint$.value;t&&(e+=`<strong>${t.name}</strong>`,e+=`<span>${t.address}</span>`);}return e}showValidateErrors(){r.receivingFormGroup.valid||(r.receivingFormGroup.controls.address.markAsTouched(),r.receivingFormGroup.controls.address.hasError("timeSlots")||r.receivingFormGroup.controls.address.updateValueAndValidity({onlySelf:true}));}setContext(){let o=r.receivingFormGroup.controls,{deliveryFrom:e,deliveryTo:t}=vi(o);o.address.value&&typeof o.address.value!="string"&&this.stateContext?.next({address:o.address.value,deliveryFrom:e,deliveryTo:t,deliveryType:o.receivingWay.value,entrance:o.entrance.value,flat:o.entrance.value,name:Q.PAYMENT});}getContext(){return this.stateContext?.value}getButtonState(){let o=we.NEXT;return r.receivingFormGroup.controls.receivingWay.value===O.Pickup?this._pickUpPoint$.value?o=we.CONFIRM:o=we.HIDDEN:r.receivingFormGroup.controls.receivingWay.value===O.Delivery&&(r.foreignCitizenship$.value?o=we.HIDDEN:r.receivingFormGroup.controls.timeSlotsTime.value?.isSamokat&&(o=we.CONFIRM_ORDER)),o}};function Ti(r,o){let e,t;return G$1(o.date)?(e="\u0421\u0435\u0433\u043E\u0434\u043D\u044F",t=`(${r.transform(o.date,"d MMMM","ru")}, ${r.transform(o.date,"EE","ru")})`):P(o.date)?(e="\u0417\u0430\u0432\u0442\u0440\u0430",t=`(${r.transform(o.date,"d MMMM","ru")}, ${r.transform(o.date,"EE","ru")})`):(e=r.transform(o.date,"d MMMM","ru"),t=r.transform(o.date,"(EE)","ru")),x(w$1({},o),{leftSide:e,rightSide:t,timeSlots:o.timeSlotUiItems?.map(i=>Dn(i))})}function Dn(r){return x(w$1({},r),{leftSide:r.isSamokat?"\u0411\u043B\u0438\u0436\u0430\u0439\u0448\u0438\u0435 30 \u043C\u0438\u043D\u0443\u0442":`${r.startTime} - ${r.endTime}`,rightSide:`(${r.minimumDeliveryCost} \u20BD)`})}var bt=(()=>{class r{constructor(e,t,i){this._orderStateService=e,this._orderApiService=t,this._orderDataService=i,this.addresses$=new En$1([]),this.loadingTimeSlots$=new En$1(false),this.timeSlotSearch$=new En$1([]),this.addressName$=new En$1(""),this.showSamokat$=new En$1(false),this._stores$=new En$1(null),this._storesCache=new Map;}get stores$(){return this._stores$.pipe(jr$1())}fetchAddress$(e){let t=this._orderDataService.orderMetaInfo$.value,i=this._orderDataService.orderSettings;return !t||!i?(this.addresses$.next([]),Bh()):this._orderApiService.getAddresses$({fiasCode:t.cityData.city.fiasCode,address:e}).pipe(le(n=>{this.addresses$.next(n);}),Li$1(()=>(this.addresses$.next([]),Bh())))}fetchTimeSlots$(e){let t$1=this._orderDataService.orderMetaInfo$.value,i=this._orderDataService.orderSettings,n=this._orderDataService.contactState,u=te.beautifulNumberFormGroup.controls.numbers.value.length>0;if(!t$1)return Bh([]);let m=new rC("RU");return this.loadingTimeSlots$.next(true),this.showSamokat$.next(true),this._orderApiService.getTimeSlots$({b2b:i.commerceType==="b2b",count:this._orderStateService.cartFormGroup.controls.productCount.value,fiasId:e,goodOutsideNumber:t$1.cityData.good.outsideNumber,mnp:!!n?.mnp,sr:false,withPNumbers:u}).pipe(le(x=>{let M=[];if(Array.isArray(x)){let _=[],T;t$1.dmsData.nomenclatures[0].samokatDelivery&&!u&&!this._orderStateService.isForeignCitizenship$.value&&(T=this._getSamokatTimeSlot()),_=x.sort((q,ue)=>q.date>ue.date?1:q.date<ue.date?-1:0);let O=G$1(x[0]?.date);T&&T?.timeSlotUiItems?.length&&O?_[0].timeSlotUiItems?.unshift(T.timeSlotUiItems[0]):T&&!O&&_?.unshift(T),M=_.map(q=>Ti(m,q)),this.timeSlotSearch$.next(M);}return M}),Li$1(x=>{let M=[],_=[],T;return t$1.dmsData.nomenclatures[0].samokatDelivery&&!u&&(T=this._getSamokatTimeSlot()),T?(M.push(T),_=M.map(O=>Ti(m,O)),this.timeSlotSearch$.next(_),this.showSamokat$.next(true),Bh(_)):(this.timeSlotSearch$.next([]),this._orderApiService.setReturnError(x,t.TimeSlotUnavailable),ze$1)}))}resetAddress(){this.addresses$.next([]),this.timeSlotSearch$.next([]),this.showSamokat$.next(false);}get isReceivingWayEqualDelivery(){return G.receivingFormGroup.controls.receivingWay.value===O.Delivery}get isNonResident(){return oe.contactFormGroup.controls.citizenship.value!=="\u0420\u043E\u0441\u0441\u0438\u044F"&&!!this._orderDataService.orderSettings.nonResidentRestriction}resetAddressAfterActions(e=true){if(e){this._reset();return}let i=!!this._orderDataService.orderMetaInfo$.value?.dmsData?.nomenclatures?.[0]?.samokatDelivery;!e&&i&&this.isReceivingWayEqualDelivery&&this._reset();}_reset(){this.resetAddress(),this._orderStateService.resetAfterActions(),G.receivingFormGroup.reset();}getSalePoints$(e,t$1,i){let n=this._orderDataService.orderMetaInfo$.value;if(!n?.cityData.good.id)return Bh([]);let u=n.cityData.good.id.toString(),m=n.cityData.city.fiasCode.toString(),x=u+m+e.toString()+t$1.toString()+i.toString(),M=x+"true";if(this._storesCache.has(x)){let _=this._storesCache.get(x);if(!_?.length){let T=w$1({},this._orderDataService.orderMetaInfo$.value);T?.dmsData&&(T.dmsData.nomenclature.pickupAvailable=false,this._orderDataService.orderMetaInfo=T),this._orderApiService.orderError$.next(t.SalesPointReceivingFailed);}return Bh(_||[])}return !i&&this._storesCache.has(M)&&this._storesCache.delete(M),this._orderApiService.getSalesPoints$({goodId:parseInt(u,10),fiasCode:m,withMnpOnly:e,withPNumbers:t$1,withBIO:i}).pipe(le(_=>_||[]),Uu(_=>{this._storesCache.set(x,_);}))}_getSamokatTimeSlot(){let e=this._orderDataService.contactState;return {date:new Date().toISOString(),timeSlotUiItems:[{minimumDeliveryCost:0,mnp:!!e?.mnp,b2b:false,sr:false,isSamokat:true,availablePaymentTypes:[],itemCountDTOs:[]}]}}static{this.\u0275fac=function(t){return new(t||r)(K(he),K(Le),K(ve))};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();function ki(r){return r?.replace(/-/g,"")}function On(r,o){if(r&1&&(Pp(0,"div",11),EE(1,"span",12),GO(2,"yHighlight"),Lp()),r&2){let e=MO().$implicit;MO();let t=kO(4);eO(),aE("innerHTML",YO(2,1,e.value,t.value),YR);}}function Nn(r,o){if(r&1&&(Pp(0,"y-option-bordered",9),LI(1,On,3,4,"div",10),Lp()),r&2){let e=o.$implicit;aE("value",e),eO(),aE("ngIf",e.value);}}function Pn(r,o){if(r&1){let e=_O();Pp(0,"y-form-field-bordered",4)(1,"y-label"),PO(2),Lp(),Pp(3,"input",5,0),FE("focusin",function(){FR(e);let i=MO();return kR(i.handleFocusIn())})("focusout",function(){FR(e);let i=MO();return kR(i.handleFocusOut())})("keyup.enter",function(){FR(e);let i=MO();return kR(i.handleEnter())}),Lp(),Pp(5,"yota-field-state",6),GO(6,"async"),FE("clear",function(){FR(e);let i=MO();return kR(i.clearAutocompleteField())}),Lp(),Pp(7,"y-autocomplete-bordered",7,1),FE("optionSelected",function(i){FR(e);let n=MO();return kR(n.onSelect(i))})("closed",function(){FR(e);let i=MO();return kR(i.onClosed())}),LI(9,Nn,2,2,"y-option-bordered",8),Lp()();}if(r&2){let e=kO(4),t=kO(8),i=MO();aE("staticLabel",true),eO(2),HE(i.label),eO(),aE("yAutocompleteBordered",t)("formControl",i.regionControl)("yAutocompleteBorderedPosition","below")("required",true),eO(2),aE("state",e.focused&&e.value.length?i.controlState.CLEAR:ZO(6,10,i.autocompleteFieldState$))("inputControl",e),eO(2),aE("displayWith",i.displayWith()),eO(2),aE("ngForOf",i.searchCity);}}var $i=(()=>{class r extends p{constructor(e,t,i,n){super(),this._changeDetectorRef=e,this._orderApiService=t,this._orderDataService=i,this._analyticsFacadeService=n,this.regionControl=oe.contactFormGroup.controls.region,this._selectOption=new at$1,this.searchCity=[],this.selectedCity=null,this.fromFocus=false,this.autocompleteFieldState$=new En$1(null),this.controlState=c,this.autocompleteErrorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]]),this._cityFiasIdChanged$=new X,this._isAutocompleteFocused$=new En$1(false),this.selectedCity=typeof this.regionControl.value=="object"?this.regionControl.value:null,this.regionControl.valueChanges.pipe(le(u=>{if(this.autocompleteFieldState$.next(u?c.SUCCESS:null),typeof u!="string")return "";let m=f.convert(u);return this.regionControl.setValue(m,{emitEvent:false}),this.regionControl.markAsTouched(),this._changeDetectorRef.markForCheck(),m}),Su(256),Ou((u,m)=>this.fromFocus?false:u===m),Uu(()=>this.fromFocus=false),Bu(u=>this._orderDataService.orderMetaInfo$.pipe(le(m=>({value:u,fiasCode:m?.cityData?.city?.fiasCode})))),Bu(({value:u,fiasCode:m})=>(u=u.trim(),u.length>2&&this._orderDataService.orderSettings&&this._orderDataService.orderMetaInfo$.value?this._orderApiService.getCities$({address:u}).pipe(le(x=>x?.filter(M=>M.fiasId.replaceAll("-","")!==m)),Hu(this._onDestroy$),Li$1(()=>Bh(new Array))):Bh(new Array))),Hu(this._onDestroy$)).subscribe(u=>{this.searchCity=u?.map(m=>x(w$1({},m),{fiasCode:ki(m.fiasId),name:this.getCityName(m),kladrId:m.kladrId}))??[],this._changeDetectorRef.markForCheck();}),this._cityFiasIdChanged$.pipe(it(()=>!!this._orderDataService.orderSettings&&!!this._orderDataService.orderMetaInfo$.value),Ou(),Ie(u=>this._orderApiService.searchByCode$({code:u,goodOutsideNumber:this._orderDataService.orderMetaInfo$.value.cityData.good.outsideNumber,legalForm:this._orderDataService.orderSettings.commerceType}).pipe(Li$1(()=>Bh(new Array)))),Hu(this._onDestroy$)).subscribe(u=>{if(u.length){let m={fiasCode:ki(u[0].fiasId),name:this.getCityName(u[0]),kladrId:u[0].kladrId,dmsData:w$1({},u[0])};this.selectedCity=m,this.regionControl.setValue(m),this._selectOption.emit(m),this._changeDetectorRef.markForCheck(),this.closePanel();}}),this._isAutocompleteFocused$.pipe(Su(512),it(u=>!u),Hu(this._onDestroy$)).subscribe(()=>{if(!this.regionControl.value||typeof this.regionControl.value=="string"){let u=this._orderDataService.orderMetaInfo$.value?.cityData?.city,m=this._orderDataService.orderMetaInfo$.value?.dmsData,x=this.getCityName(m);this.regionControl.setValue({fiasCode:u?.fiasCode,name:x,fullName:u?.fullName},{emitEvent:false}),this.autocompleteFieldState$.next(c.SUCCESS);}});}onSelect(e){if(!this._orderDataService.orderSettings||!this._orderDataService.orderMetaInfo$.value)return;let t="";this.selectedCity&&(t=`${this.selectedCity?.name} \u043D\u0430 ${e.option.value.name}`),this._analyticsFacadeService.pushDataLayer({event:E.ECOMMERCE,event_param:t},O$1.ORDER_CITY_SELECT),this._cityFiasIdChanged$.next(e.option.value.fiasId);}displayWith(){return e=>typeof e=="string"?e:e?.name?e.name:""}closePanel(){this.inputRef.nativeElement.blur(),this.autocompleteDirRef?.closePanel();}openPanel(){this.inputRef.nativeElement.focus(),this.autocompleteDirRef?.openPanel();}togglePanel(e){e.stopPropagation(),this.autocompleteDirRef.autocomplete.isOpen?this.closePanel():this.openPanel();}ngOnInit(){this._orderDataService.orderMetaInfo$.pipe(it(Boolean),wt(1),Hu(this._onDestroy$)).subscribe(e=>{if(e){let t={fiasCode:e.cityData.city.fiasCode,name:e.cityData.city.name};this.regionControl.setValue(t),this.selectedCity=t;}this.selectedCity&&this.autocompleteFieldState$.next(c.SUCCESS);});}onClosed(){this.searchCity=[],this.regionControl.setValue(this.selectedCity);}handleFocusIn(){let e=typeof this.regionControl?.value=="string"?this.regionControl?.value:this.regionControl?.value?.name;this.fromFocus=true,this._isAutocompleteFocused$.next(true),this.regionControl.setValue(e||"");}handleFocusOut(){this._isAutocompleteFocused$.next(false);}getCityName(e){let t=e?.settlement?.trim().length?e?.settlement:e?.city,i=e.region;if(t===i)return t;let n;return (e?.area||e?.cityDistrict)&&(n=e?.area||e?.cityDistrict),`${t} (${i}${n?", "+n:""})`}handleEnter(){if(this.searchCity.length){let e=this.searchCity[0];this.onSelect({option:{value:e}});}}getAutocompleteErrorMessage(){let e=w$1({},this.regionControl.errors);if(!e)return "";for(let t of Object.keys(e)){let i=this.autocompleteErrorMessages.get(t);if(i)return i}return ""}clearAutocompleteField(){this.searchCity=[],this.regionControl.setValue("");}static{this.\u0275fac=function(t){return new(t||r)(k$1(ui),k$1(Le),k$1(ve),k$1(M))};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-order-autocomplete"]],viewQuery:function(t,i){if(t&1&&(NO(cm,5),NO(Ty,5,Je$1)),t&2){let n;AO(n=RO())&&(i.autocompleteDirRef=n.first),AO(n=RO())&&(i.inputRef=n.first);}},inputs:{label:"label"},outputs:{_selectOption:"_selectOption"},features:[MI],decls:2,vars:1,consts:[["inputRef","yInput"],["autocompleteRef","yAutocompleteBordered"],[1,"order-autocomplete"],["class","order-autocomplete__form-field",3,"staticLabel",4,"ngIf"],[1,"order-autocomplete__form-field",3,"staticLabel"],["type","text","id","order-autocomplete","yInput","",1,"order-autocomplete__input",3,"focusin","focusout","keyup.enter","yAutocompleteBordered","formControl","yAutocompleteBorderedPosition","required"],["ySuffix","",1,"order-autocomplete__state",3,"clear","state","inputControl"],[1,"order-autocomplete__dropdown",3,"optionSelected","closed","displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","order-autocomplete__option",4,"ngIf"],[1,"order-autocomplete__option"],[3,"innerHTML"]],template:function(t,i){t&1&&(Pp(0,"div",2),LI(1,Pn,10,12,"y-form-field-bordered",3),Lp()),t&2&&(eO(),aE("ngIf",i.regionControl));},dependencies:[Zw,An$1,Ge,yn$1,ot,Mn$1,Tt,x$1,Ih,tC,ar,gd,Ty,dg,tb,Cd,Vy,hd],styles:["[_nghost-%COMP%]  .y-form-field-bordered.y-form-field-bordered-invalid .y-form-field-bordered-flex{border-color:#eaeef4}[_nghost-%COMP%]  .y-form-field-bordered.y-form-field-bordered-invalid.y-focused .y-form-field-bordered-flex{border-color:#00aeef}  .y-autocomplete-bordered-panel.order-autocomplete__dropdown{max-height:368px}@media (max-width: 768px){  .y-autocomplete-bordered-panel.order-autocomplete__dropdown{max-height:312px}}.order-autocomplete[_ngcontent-%COMP%]{position:relative;margin-bottom:15px;background-color:transparent}.order-autocomplete__form-field[_ngcontent-%COMP%]{width:100%}.order-autocomplete__option[_ngcontent-%COMP%]{display:flex;align-items:center;margin-block:4px;font-size:16px;line-height:24px}"],changeDetection:0});}}return r})();var yt=class r{static getTotalCost(o){return o.reduce((e,t)=>e+t.category,0)}static sortPhoneNumbers(o,e,t,i=2){let n=[],u={},m=e.filter(_=>_.selected).map(_=>_.value),x=o.filter(_=>m.length?m.includes(_.category):true);if(t.length>4){let _=x.length;for(;_--;){let T=x[_],O=r.isSubsequenceWithMismatch(T.value.substring(3),t);O.match?T.replaceIndexes=O.replaceIndexes:x.splice(_,1);}}else x=x.filter(_=>_.value.substring(3).includes(t)),x.forEach(_=>_.replaceIndexes=[]);for(let _ of x)u[_.category]||(u[_.category]=[]),u[_.category].push(_);let M=true;for(;M;){M=false;for(let _ of e){if(!_.selected&&m.length)continue;let T=u[_.value]||[];for(let O=0;O<i;O++)T.length>0&&(n.push(T.shift()),M=M||T.length>0);}}return n}static isSubsequenceWithMismatch(o,e){let t=o.length,i=e.length,n=i>=6?2:1;for(let u=0;u<=t-i;u++){let m=o.substring(u,u+i);if(r.levenshteinDistance(m,e)<=n){let M=[];for(let _=0;_<m.length;_++)m[_]!=e[_]&&M.push(_);return {match:true,startIndex:u,endIndex:u+i-1,replaceIndexes:M}}}return {match:false}}static levenshteinDistance(o,e){let t=Array.from({length:o.length+1},()=>Array(e.length+1).fill(0));for(let i=0;i<=o.length;i++)t[i][0]=i;for(let i=0;i<=e.length;i++)t[0][i]=i;for(let i=1;i<=o.length;i++)for(let n=1;n<=e.length;n++){let u=o[i-1]===e[n-1]?0:1;t[i][n]=Math.min(t[i-1][n]+1,t[i][n-1]+1,t[i-1][n-1]+u);}return t[o.length][e.length]}};var de=function(r){return r.NO_INTERNET="NO_INTERNET",r.NO_INTERNET_TECHNICAL="NO_INTERNET_TECHNICAL",r.NUMBERS_EXPIRED="NUMBERS_EXPIRED",r.NO_NUMBERS_BY_SEARCH="NO_NUMBERS_BY_SEARCH",r.NO_NUMBERS_BY_CATEGORY="NO_NUMBERS_BY_CATEGORY",r.EMPTY="EMPTY",r}(de||{}),B=function(r){return r.LOADING_MORE_NUMBERS="LOADING_MORE_NUMBERS",r.LOADED_MORE_NUMBERS="LOADED_MORE_NUMBERS",r.BOOKING_NUMBER="BOOKING_NUMBER",r.BOOKED_NUMBER="BOOKED_NUMBER",r.CANCELLING_NUMBER="CANCELLING_NUMBER",r.CANCELLED_NUMBER="CANCELLED_NUMBER",r.MAX_COUNT_SELECTED="MAX_COUNT_SELECTED",r.NUMBER_ALREADY_RESERVED="NUMBER_ALREADY_RESERVED",r.NO_MORE_NUMBERS_BY_SEARCH="NO_MORE_NUMBERS_BY_SEARCH",r.NO_MORE_NUMBERS_BY_CATEGORY="NO_MORE_NUMBERS_BY_CATEGORY",r.NO_MORE_NUMBERS_AT_ALL="NO_MORE_NUMBERS_AT_ALL",r.COMMON_ERROR="COMMON_ERROR",r.CANCEL_REMOVE_BY_RADIO_MODE="CANCEL_REMOVE_BY_RADIO_MODE",r}(B||{}),Et=function(r){return r.CONFIRM_BUTTON="CONFIRM_BUTTON",r.CROSS_BUTTON="CROSS_BUTTON",r.BACKDROP="BACKDROP",r.ERROR_BUTTON="ERROR_BUTTON",r}(Et||{}),bi=function(r){return r.CAPTCHA="CAPTCHA",r}(bi||{});var xe=(()=>{class r extends h$1{constructor(){super(...arguments),this._analyticsService=D(M);}toggleCategory(e,t){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this._concatParams(e,t?"\u0412\u043A\u043B":"\u0412\u044B\u043A\u043B")},O$1.SELECT_NUMBER_DIALOG_CLICK_CHIP);}toggleNumber(e,t,i){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this._concatParams(e.toString(),t?"\u0412\u043A\u043B":"\u0412\u044B\u043A\u043B",i.toString())},O$1.SELECT_NUMBER_DIALOG_CLICK_NUMBER);}toggleExpand(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_CLICK_EXPAND);}deleteNumberFromCart(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this._concatParams("\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440",e.toString())},O$1.SELECT_NUMBER_DIALOG_DELETE_FROM_CART);}revertDeletedNumber(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this._concatParams("\u041D\u043E\u043C\u0435\u0440 \u0443\u0434\u0430\u043B\u0435\u043D",e)},O$1.SELECT_NUMBER_DIALOG_REVERT_CANCEL);}lockNumberSuccess(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_LOCK_SUCCESS);}lockNumberFailed(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_LOCK_FAILED);}maxCountSelected(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_MAX_COUNT_SELECTED);}closeDialogManual(e,t){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this._concatParams(e,t)},O$1.SELECT_NUMBER_DIALOG_CLOSE_MANUAL);}loadMoreButtonClick(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_CLICK_LOAD_MORE);}clickScrollToTop(){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:"\u0421\u0442\u0440\u0435\u043B\u043A\u0430 \u0432\u0432\u0435\u0440\u0445"},O$1.SELECT_NUMBER_DIALOG_CLICK_UP_BUTTON);}captchaOpen(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_OPEN);}captchaConfirm(){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C"},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_CONFIRM);}captchaFailed(){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:"\u041A\u0430\u043F\u0447\u0430 \u0432\u0432\u0435\u0434\u0435\u043D\u0430 \u043D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E"},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_FAILED);}captchaClose(e,t){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this._concatParams(e,t)},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_CLOSE);}errorTechnical(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_TECHNICAL_ERROR);}errorTechnicalClickButton(e){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this._concatParams("\u041F\u043E\u043A\u0430 \u0432\u044B\u0431\u043E\u0440 \u043D\u043E\u043C\u0435\u0440\u043E\u0432 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D \u043F\u043E \u0442\u0435\u0445\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u043C \u043F\u0440\u0438\u0447\u0438\u043D\u0430\u043C. ",e)},O$1.SELECT_NUMBER_DIALOG_TECHNICAL_ERROR_CLICK_BUTTON);}errorCommon(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_COMMON_ERROR);}errorCommonClickButton(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:this._concatParams("\u0412\u0440\u0435\u043C\u044F \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u043E",e)},O$1.SELECT_NUMBER_DIALOG_COMMON_ERROR_CLICK_BUTTON);}errorSearch(e,t,i){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:this._concatParams(t,i,e.join(", "))},O$1.SELECT_NUMBER_DIALOG_SEARCH_ERROR);}errorSearchClickLoadMore(){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:"\u0421\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C. \u041D\u0430\u0436\u043C\u0438 \u043A\u043D\u043E\u043F\u043A\u0443, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A / \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0440\u0443\u0433\u0438\u0435 \u043D\u043E\u043C\u0435\u0440\u0430"},O$1.SELECT_NUMBER_DIALOG_CLICK_LOAD_MORE_BY_ERROR);}errorSearchPopup(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.SELECT_NUMBER_DIALOG_SEARCH_ERROR_POPUP);}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var Fr=(()=>{class r extends p{constructor(){super(...arguments),this._selectNumberService=D(De),this._analyticsService=D(xe),this.buttonText="\u0412\u0435\u0440\u043D\u0443\u0442\u044C";}revertNumber(){this._analyticsService.revertDeletedNumber(this.buttonText),this._selectNumberService.toggleNumber(this.number);}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-revert-popup"]],inputs:{number:"number"},features:[MI],decls:3,vars:1,consts:[[1,"y-link-pseudo",3,"click"]],template:function(t,i){t&1&&(PO(0,`\u041D\u043E\u043C\u0435\u0440 \u0443\u0434\u0430\u043B\u0435\u043D.
`),Pp(1,"span",0),FE("click",function(){return i.revertNumber()}),PO(2),Lp()),t&2&&(eO(2),$p(" ",i.buttonText,`
`));},encapsulation:2,changeDetection:0});}}return r})();var Br=(()=>{class r{constructor(){this._popupService=D(pt),this._analyticsService=D(xe),this._breakpointObserver=D(U),this.isDialog=false,this.popupsMap=new Map([[B.LOADING_MORE_NUMBERS,{text:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u043D\u043E\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430",svgIcon:"clock-outline-orange",theme:"warning"}],[B.LOADED_MORE_NUMBERS,{text:"\u041D\u043E\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B",svgIcon:"check-outline",theme:"success"}],[B.BOOKING_NUMBER,{text:"\u0411\u0440\u043E\u043D\u0438\u0440\u0443\u0435\u043C \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",svgIcon:"clock-outline-orange",theme:"warning"}],[B.BOOKED_NUMBER,{text:"\u041D\u043E\u043C\u0435\u0440 \u0437\u0430\u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D \u043D\u0430 60 \u043C\u0438\u043D\u0443\u0442",svgIcon:"check-outline",theme:"success"}],[B.CANCELLING_NUMBER,{text:"\u0423\u0434\u0430\u043B\u044F\u0435\u043C \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",svgIcon:"clock-outline-orange",theme:"warning"}],[B.CANCELLED_NUMBER,{svgIcon:"clock-outline-orange",theme:"warning",closeByMouseUp:false}],[B.MAX_COUNT_SELECTED,{svgIcon:"info-outline",theme:"warning"}],[B.NUMBER_ALREADY_RESERVED,{text:"\u042D\u0442\u043E\u0442 \u043D\u043E\u043C\u0435\u0440 \u0443\u0436\u0435 \u043A\u0442\u043E-\u0442\u043E \u0437\u0430\u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043B",svgIcon:"info-outline",theme:"error"}],[B.NO_MORE_NUMBERS_BY_SEARCH,{text:"\u0411\u043E\u043B\u044C\u0448\u0435 \u0441\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C. \u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E \u0438\u043B\u0438 \u0432\u0432\u0435\u0434\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0446\u0438\u0444\u0440\u044B",svgIcon:"info-outline",theme:"warning"}],[B.NO_MORE_NUMBERS_BY_CATEGORY,{text:"\u0417\u0434\u0435\u0441\u044C \u0431\u043E\u043B\u044C\u0448\u0435 \u043D\u0435\xA0\u043D\u0430\u0448\u043B\u043E\u0441\u044C \u043D\u043E\u043C\u0435\u0440\u043E\u0432.<br/>\u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E",svgIcon:"info-outline",theme:"warning"}],[B.NO_MORE_NUMBERS_AT_ALL,{text:"\u0417\u0434\u0435\u0441\u044C \u0431\u043E\u043B\u044C\u0448\u0435 \u043D\u0435\xA0\u043D\u0430\u0448\u043B\u043E\u0441\u044C \u043D\u043E\u043C\u0435\u0440\u043E\u0432.",svgIcon:"info-outline",theme:"warning"}],[B.COMMON_ERROR,{text:"\u0427\u0442\u043E-\u0442\u043E \u043F\u043E\u0448\u043B\u043E \u043D\u0435 \u0442\u0430\u043A, \u043F\u043E\u0432\u0442\u043E\u0440\u0438 \u043F\u043E\u043F\u044B\u0442\u043A\u0443 \u0435\u0449\u0435 \u0440\u0430\u0437",svgIcon:"info-outline",theme:"error"}],[B.CANCEL_REMOVE_BY_RADIO_MODE,{text:"\u041D\u0435\u043B\u044C\u0437\u044F \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440, \u043D\u043E \u0435\u0433\u043E \u043C\u043E\u0436\u043D\u043E \u0437\u0430\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430 \u0434\u0440\u0443\u0433\u043E\u0439",svgIcon:"info-outline",theme:"warning"}]]);}setMaxCountTemplate(e){let t=this.popupsMap.get(B.MAX_COUNT_SELECTED);t&&this.popupsMap.set(B.MAX_COUNT_SELECTED,x(w$1({},t),{text:`\u0412 \u043E\u0434\u0438\u043D \u0437\u0430\u043A\u0430\u0437 \u043C\u043E\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435 ${e} \u043D\u043E\u043C\u0435\u0440\u043E\u0432`}));}openPopup(e,t){let i=this.popupsMap.get(e);if(!i)return null;switch(e){case B.BOOKED_NUMBER:this._analyticsService.lockNumberSuccess(i.text||"");break;case B.NUMBER_ALREADY_RESERVED:this._analyticsService.lockNumberFailed(i.text||"");break;case B.MAX_COUNT_SELECTED:this._analyticsService.maxCountSelected(i.text||"");break;case B.NO_MORE_NUMBERS_BY_CATEGORY:this._analyticsService.errorSearchPopup(i.text?i.text.replace(/<.*?>/g,""):"");break;case B.CANCELLED_NUMBER:{i.component={type:Fr,inputs:t};break}}return this.isDialog?(i.parentSelector=".select-number-dialog",i.customWrapperClass="select-number-dialog__popups-wrapper"):this._breakpointObserver.isMatched("(max-width: 767px)")||(i.parentSelector=".number-selection",i.customWrapperClass="number-selection__popups-wrapper"),t&&(i.templateContext=t),this._popupService.openPopup(i)}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var De=class r{constructor(){this._dialogService=D(mr),this._popupService=D(Br),this._analyticsService=D(xe),this.searchControl=new W("",{nonNullable:true}),this.loading$=new En$1(false),this.pending$=new En$1(false),this.loadMoreDisabled$=new En$1(false),this.loadMoreHide$=new En$1(false),this.error$=new En$1(null),this.showCaptcha$=new X,this._currentPopup=null,this._phoneNumbers$=new En$1([]),this._phoneNumbersByMask$=new En$1([]),this._lockId$=new En$1(null),this._expirationLockDate$=new En$1(null),this._regionCodeCcm$=new En$1(null),this._selectedPhoneNumbers$=new En$1([]),this._processingNumber$=new En$1(null),this._categories$=new En$1([]),this._offsetAll$=new En$1(0),this._offsetMask$=new En$1(0),this._searchStamp=null;}get config(){return w$1({},this._config)}set config(o){this._config=o;}get phoneNumbers$(){return Zh([this._phoneNumbers$,this._phoneNumbersByMask$,this._categories$.pipe(Uu(()=>{this.loadMoreDisabled$.next(false);})),this.searchControl.valueChanges.pipe(Vu(""),Uu(()=>{this.loadMoreDisabled$.next(false);}))]).pipe(le(([o,e,t,i])=>{if(this.error$.value===de.NUMBERS_EXPIRED)return [];let n=[...o,...e],u=n.map(M=>M.value);n=[...this._selectedPhoneNumbers$.value.filter(M=>!u.includes(M.value)),...n];let x=yt.sortPhoneNumbers(n,t,i||"");return x.length?this.error$.next(null):this.loadMoreDisabled$.value&&this.error$.value!==de.NO_NUMBERS_BY_CATEGORY?this.error$.next(de.NO_NUMBERS_BY_CATEGORY):this.error$.next(de.NO_NUMBERS_BY_SEARCH),this.loadMoreHide$.next(false),x}))}get selectedPhoneNumbers$(){return this._selectedPhoneNumbers$.pipe(le(o=>o.map(e=>({value:e.value,category:e.category}))))}get selectedPhoneNumbers(){return this._selectedPhoneNumbers$.value}get selectedPhoneNumbersLength(){return this._selectedPhoneNumbers$.value.length}get processingNumber$(){return this._processingNumber$}get selectedPhoneNumbersTotal$(){return this._selectedPhoneNumbers$.pipe(le(o=>yt.getTotalCost(o)))}get categories$(){return this._categories$.pipe()}get categories(){return this._categories$.value}get lockId$(){return this._lockId$.pipe()}get lockId(){return this._lockId$.value}get regionCodeCcm$(){return this._regionCodeCcm$.pipe()}get expirationLockDate$(){return this._expirationLockDate$.pipe()}get expirationLockDate(){return this._expirationLockDate$.value}initSelectedNumbers(o){this._selectedPhoneNumbers$.next(o);}openDialog(o){return this.init(o),this._dialogRef=this._dialogService.open(yi,{panelClass:["y-dialog-select-number",R$1()?.name||"chrome"],backdropClass:"y-dialog-backdrop-blurred",disableClose:true,autoFocus:false,hasBackdrop:true,id:"select-number-dialog"}),this._dialogRef.backdropClick().pipe(wt(1)).subscribe(()=>{this._analyticsService.closeDialogManual(this.config.title,"\u0412\u043D\u0435\u0448\u043D\u0438\u0439 \u043A\u043B\u0438\u043A"),this._dialogRef?.close({hasNumbers:!!this._selectedPhoneNumbers$.value.length,closeWay:Et.BACKDROP});}),this._dialogRef}closeDialog(o){this.searchControl.setValue(""),this._dialogRef?.close({hasNumbers:!!this._selectedPhoneNumbers$.value.length,closeWay:o});}init(o){if(this.config=w$1({},o),this._popupService.setMaxCountTemplate(this.config.selectedNumbersMaxCount),this._popupService.isDialog=this.config.isDialog,this.config.selectedNumbers.length||this.config.expiredNumbers.length){let e=new Date;if(this.config.expiredNumbers.length||!this.config.expirationLockDate||e>this.config.expirationLockDate){this._lockId$.next(null),this._expirationLockDate$.next(null),this._regionCodeCcm$.next(null),this.error$.next(de.NUMBERS_EXPIRED),this.loading$.next(false),this._selectedPhoneNumbers$.next(this.config.expiredNumbers);return}}this.reset(),this._selectedPhoneNumbers$.next(this.config.selectedNumbers),this.fetchNumbers();}reset(){this._expirationLockDate$.next(this.config.expirationLockDate||null),this._lockId$.next(this.config.lockId||null),this._selectedPhoneNumbers$.next([]),this._phoneNumbersByMask$.next([]),this._offsetAll$.next(0),this._offsetMask$.next(0),this.searchControl.setValue(""),this.error$.next(null);}fetchNumbers(){this.loading$.next(true),this.config.fetch$({region:this.config.region,searchType:"allNumbers",offset:0}).pipe(wt(1),Fu(()=>this.loading$.next(false)),Li$1(o=>{let e=this._getErrorCode(o),t=this.config.isDialog?de.NO_INTERNET:de.NO_INTERNET_TECHNICAL;switch(e){case 110403:this.error$.next(t),this.showCaptcha$.next(()=>this.fetchNumbers());break;default:this.error$.next(t);break}return og(()=>o)})).subscribe(o=>{if(!o.numbers?.length){this.error$.next(de.NO_NUMBERS_BY_CATEGORY);return}this._offsetAll$.next(o.limit),this._computeCategories(o.numbers),this._phoneNumbers$.next(o.numbers.flatMap(e=>e.phones?.length?e?.phones.flatMap(t=>({value:t.toString(),category:e.classPrice})):[])),this.error$.next(null);});}loadMoreNumbers(){this.pending$.next(true),this._currentPopup?.close();let o={region:this.config.region,searchType:"allNumbers",offset:this._offsetAll$.value};this.searchControl.value?(o.mask=this.searchControl.value,o.searchType="adaptiveSearch",o.mask!==this._searchStamp&&(this._offsetMask$.next(0),this._searchStamp=o.mask),o.offset=this._offsetMask$.value):this._searchStamp=null,this.config.fetch$(o).pipe(wt(1),Fu(()=>{this.pending$.next(false);}),Li$1(e=>{switch(this._getErrorCode(e)){case 110403:this.showCaptcha$.next(()=>this.loadMoreNumbers());break;default:this._currentPopup=this._popupService.openPopup(B.COMMON_ERROR);break}return og(()=>e)})).subscribe(e=>{let t=e?.numbers?.flatMap(x=>x.phones?.length?x?.phones.flatMap(M=>({value:M.toString(),category:x.classPrice})):[])??[],i=this._categories$.value.filter(x=>x.selected),n=i.map(x=>x.value),u=new Set(this._phoneNumbers$.value.map(x=>x.value)),m=yt.sortPhoneNumbers(this._phoneNumbers$.value,i,this._searchStamp||"");if(t=t.filter(x=>!u.has(x.value)),!t.length){this._currentPopup?.close(),m.length&&(n.length&&n.length<this._categories$.value.length?this._currentPopup=this._popupService.openPopup(B.NO_MORE_NUMBERS_BY_CATEGORY):this._currentPopup=this._popupService.openPopup(B.NO_MORE_NUMBERS_AT_ALL)),this.loadMoreDisabled$.next(true),this._searchStamp?this.loadMoreHide$.next(false):this.loadMoreHide$.next(true),this.error$.next(null),this._phoneNumbers$.next(this._phoneNumbers$.value);return}if(this._searchStamp)this._offsetMask$.next(o.offset+e.limit),o.offset?this._phoneNumbersByMask$.next([...this._phoneNumbersByMask$.value,...t]):this._phoneNumbersByMask$.next(t),t.filter(M=>n.includes(M.category)).length?this.loadMoreDisabled$.next(false):(m.length&&(this._currentPopup=this._popupService.openPopup(B.NO_MORE_NUMBERS_BY_CATEGORY)),this.loadMoreDisabled$.next(true));else {this._offsetAll$.next(this._offsetAll$.value+e.limit);let x=t.filter(_=>n.includes(_.category)),M=[...this._phoneNumbers$.value,...t];this._phoneNumbers$.next(M),n.length&&!x.length?(m.length&&(this._currentPopup=this._popupService.openPopup(B.NO_MORE_NUMBERS_BY_CATEGORY)),this.loadMoreDisabled$.next(true)):(this._currentPopup=this._popupService.openPopup(B.LOADED_MORE_NUMBERS),this.loadMoreDisabled$.next(false));}});}continueSelectAfterDateExpired(){this.reset(),this.fetchNumbers();}toggleCategory(o){if(this.pending$.value)return;let e=this._categories$.value,t=e.find(i=>i.value===o);t&&(t.selected=!t.selected,this._categories$.next(e),this.loadMoreDisabled$.next(false));}toggleNumber(o){if(this.pending$.value)return;let e=this._selectedPhoneNumbers$.value;if(e.find(t=>t.value===o.value)){if(this.config.radioMode){this._currentPopup?.close(),this._currentPopup=this._popupService.openPopup(B.CANCEL_REMOVE_BY_RADIO_MODE);return}this._cancelNumber(o);return}if(this.config.radioMode){this._changeNumber(e[0],o);return}if(e.length>=this.config.selectedNumbersMaxCount){this._currentPopup?.close(),this._currentPopup=this._popupService.openPopup(B.MAX_COUNT_SELECTED);return}this._addNumber(o);}initConfig(o){this.config=o,this._popupService.setMaxCountTemplate(this.config.selectedNumbersMaxCount),this._popupService.isDialog=this.config.isDialog,this._selectedPhoneNumbers$.next(o.selectedNumbers),this._lockId$.next(o.lockId||null),this._expirationLockDate$.next(o.expirationLockDate||null);}_addNumber(o){this.pending$.next(true),this._processingNumber$.next(o.value),this._currentPopup?.close();let e={msisdn:[o.value],region:this.config.region.toString()};this._selectedPhoneNumbers$.value.length&&this.config.lockId&&(e.lockId=this.config.lockId),this.config.lock$(e).pipe(wt(1),Fu(()=>{this.pending$.next(false),this._processingNumber$.next(null);}),Li$1(t=>{switch(this._getErrorCode(t)){case 110403:this.showCaptcha$.next(()=>this.toggleNumber(o));break;case 110412:this._currentPopup=this._popupService.openPopup(B.NUMBER_ALREADY_RESERVED),this._deleteNumber(o);break;default:this._currentPopup=this._popupService.openPopup(B.COMMON_ERROR);break}return og(()=>t)})).subscribe(t=>{let i=new Date(t.expirationLockDate);this.config=x(w$1({},this.config),{lockId:t.lockId,expirationLockDate:i}),this._expirationLockDate$.next(i),this._lockId$.next(t.lockId),this._selectedPhoneNumbers$.next([w$1({},o),...this._selectedPhoneNumbers$.value]),this._currentPopup=this._popupService.openPopup(B.BOOKED_NUMBER);});}_cancelNumber(o){this.pending$.next(true),this._processingNumber$.next(o.value),this._currentPopup?.close();let e=this._selectedPhoneNumbers$.value.filter(t=>t.value!==o.value);this.config.cancel$({lockId:this.config.lockId,msisdn:[o.value],region:this.config.region.toString()}).pipe(wt(1),Fu(()=>{this.pending$.next(false),this._processingNumber$.next(null);}),Li$1(t=>{switch(this._getErrorCode(t)){case 110403:this.showCaptcha$.next(()=>this.toggleNumber(o));break;case 110412:this._deleteNumber(o),this._selectedPhoneNumbers$.next(e),this._currentPopup=this._popupService.openPopup(B.NUMBER_ALREADY_RESERVED);break;default:this._currentPopup=this._popupService.openPopup(B.COMMON_ERROR);break}return og(()=>t)})).subscribe(()=>{this._selectedPhoneNumbers$.next(e),this._currentPopup=this._popupService.openPopup(B.CANCELLED_NUMBER,{number:o});});}_changeNumber(o,e,t=false){this.pending$.next(true),this._processingNumber$.next(e.value),this._currentPopup?.close();let i=this.config.lockId,n=this.config.lock$({msisdn:[e.value],region:this.config.region.toString()});t&&(n=Bh({expirationLockDate:$(this._expirationLockDate$.value),lockId:i})),n.pipe(wt(1),Li$1(u=>{switch(this._getErrorCode(u)){case 110403:this.showCaptcha$.next(()=>this._changeNumber(o,e));break;case 110412:this._currentPopup=this._popupService.openPopup(B.NUMBER_ALREADY_RESERVED),this._deleteNumber(e);break;default:this._currentPopup=this._popupService.openPopup(B.COMMON_ERROR);break}return og(()=>u)}),Uu(u=>{let m=new Date(u.expirationLockDate);this.config=x(w$1({},this.config),{lockId:u.lockId,expirationLockDate:m}),this._expirationLockDate$.next(m);}),Ie(()=>this.config.cancel$({msisdn:[o.value],region:this.config.region.toString()}).pipe(Li$1(u=>{switch(this._getErrorCode(u)){case 110403:this.showCaptcha$.next(()=>this._changeNumber(o,e,true));break;case 110412:return this._selectedPhoneNumbers$.next([w$1({},e)]),Bh(void 0);default:this._currentPopup=this._popupService.openPopup(B.COMMON_ERROR);break}return og(()=>u)}))),Ie(()=>{let u={msisdn:e.value,regionId:this.config.region};return this.config.updateNumberInShoppingCart$(u)}),Fu(()=>{this.pending$.next(false),this._processingNumber$.next(null);})).subscribe(()=>{this._selectedPhoneNumbers$.next([w$1({},e)]),this._currentPopup=this._popupService.openPopup(B.BOOKED_NUMBER);});}_deleteNumber(o){this._phoneNumbers$.next(this._phoneNumbers$.value.filter(e=>e.value!==o.value));}_computeCategories(o){let e=[...new Set(o.filter(n=>n.phones?.length).map(n=>n.classPrice))].sort((n,u)=>n-u);e[0]===0&&e.push(e.shift());let t=this._selectedPhoneNumbers$.value,i=e.map((n,u)=>({name:n===0?"\u0411\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u044B\u0435":`${n} \u20BD`,value:n,selected:t.length?!!t.find(m=>m.category===n):u===0}));this._categories$.next(i);}_getErrorCode(o){return typeof o.error=="string"?JSON.parse(o.error).code:o.error.code||""}static{this.\u0275fac=function(e){return new(e||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}};Pb([v$1],De.prototype,"fetchNumbers",null);var Lr=(()=>{class r{constructor(){this.checked=false,this.agreementLink="https://static.yota.ru/upload/public/doc/approve_PD.pdf",this.personalDataLink="https://www.yota.ru/downloads/politics_with_respect_to_personal_data_processing_v6.pdf",this.changed=new at$1;}agreementChange(){this.changed.emit(!this.checked);}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-personal-policy-agreement"]],inputs:{checked:"checked",agreementLink:"agreementLink",personalDataLink:"personalDataLink"},outputs:{changed:"changed"},decls:11,vars:4,consts:[[1,"select-number-dialog__number",3,"click"],[1,"select-number-dialog__number-checkbox"],[1,"select-number-dialog__number-value"],["target","_blank","rel","nofollow noopener noreferrer",1,"y-highlight",3,"click","href"],[1,"star"]],template:function(t,i){t&1&&(Pp(0,"div",0),FE("click",function(){return i.agreementChange()}),EE(1,"div",1),Pp(2,"p",2),PO(3," \u0414\u0430\u044E "),Pp(4,"a",3),FE("click",function(u){return u.stopPropagation()}),PO(5,"\u0441\u043E\u0433\u043B\u0430\u0441\u0438\u0435"),Lp(),PO(6," \u043D\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u043C\u043E\u0438\u0445 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445 \u0432 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 "),Pp(7,"a",3),FE("click",function(u){return u.stopPropagation()}),PO(8,"\u041F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445"),Pp(9,"span",4),PO(10,"*"),Lp()()()()),t&2&&(cE("selected",i.checked),eO(4),aE("href",i.agreementLink,lv),eO(3),aE("href",i.personalDataLink,lv));},styles:["[_nghost-%COMP%]{display:block;max-width:490px}.select-number-dialog__number[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;width:100%;column-gap:12px;align-items:center;transition:all linear .2s}@media (max-width: 484px){.select-number-dialog__number[_ngcontent-%COMP%]{align-items:flex-start}}.select-number-dialog__number-checkbox[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid #ceced5;background:transparent;border-radius:6px;cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:all linear .2s}.select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{content:url(/assets/images/icons/check-bold.svg);transform:translate(40px);height:16px;width:16px;transition:all linear .2s}.select-number-dialog__number-value[_ngcontent-%COMP%]{text-align:left;cursor:pointer;font-size:12px;line-height:18px;font-weight:400;color:#758494}.select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#00aeef;border-color:#00aeef}.select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{transform:translate(0)}.select-number-dialog__number.disabled[_ngcontent-%COMP%]{color:#758494}.select-number-dialog__number.disabled[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#eaeef4;border-color:#ceced5;cursor:not-allowed}.star[_ngcontent-%COMP%]{color:#ff6b6e}"],changeDetection:0});}}return r})();var In=["phoneFieldInputRef"],wn=["nameFieldInputRef"],Tn=["autocompleteComponent"];function kn(r,o){if(r&1&&EE(0,"y-icon",21),r&2){MO(2);let e=kO(3);aE("yotaCustomTooltip",e)("yotaCustomTooltipClass","contact-form__top-tooltip")("yotaCustomTooltipPosition","above")("yotaPointEventNone",false);}}function $n(r,o){if(r&1&&(Pp(0,"y-error"),PO(1),Lp()),r&2){let e=o.ngIf;eO(),$p(" ",e," ");}}function Rn(r,o){if(r&1){let e=_O();Pp(0,"yota-order-autocomplete",22,2),FE("_selectOption",function(i){FR(e);let n=MO(2);return kR(n.citySelected(i))}),Lp();}r&2&&aE("label","\u0413\u043E\u0440\u043E\u0434, \u043F\u043E\u0441\u0435\u043B\u043E\u043A, \u0434\u0435\u0440\u0435\u0432\u043D\u044F");}function An(r,o){if(r&1&&(Pp(0,"y-error"),PO(1),Lp()),r&2){let e=o.ngIf;eO(),$p(" ",e," ");}}function Fn(r,o){if(r&1){let e=_O();Pp(0,"y-form-field-bordered",25)(1,"y-label"),PO(2,"\u0424\u0430\u043C\u0438\u043B\u0438\u044F \u0438 \u0438\u043C\u044F"),Lp(),Pp(3,"input",26,3),FE("input",function(i){FR(e);let n=MO(3);return kR(n.onInputName(i))})("blur",function(){FR(e);let i=MO(3);return kR(i.onBlurName())}),Lp(),Pp(5,"yota-field-state",14),FE("clear",function(){FR(e);let i=MO(3);return kR(i.nameControl.setValue(""))}),Lp(),LI(6,An,2,1,"y-error",15),Lp();}if(r&2){let e=kO(4),t=MO(3);eO(3),aE("formControl",t.nameControl)("required",t.nameRequired),eO(2),aE("state",t.nameControlState)("inputControl",e),eO(),aE("ngIf",t.getNameErrorMessage(t.nameControl.errors));}}function Bn(r,o){if(r&1&&(Pp(0,"y-option-bordered",30)(1,"div",31),PO(2),Lp()()),r&2){let e=o.$implicit;aE("value",e),eO(2),$p(" ",e," ");}}function Ln(r,o){if(r&1){let e=_O();Pp(0,"y-form-field-bordered",27)(1,"y-label"),PO(2,"\u0413\u0440\u0430\u0436\u0434\u0430\u043D\u0441\u0442\u0432\u043E"),Lp(),Pp(3,"y-select-bordered",28),FE("selectionChange",function(){FR(e);let i=MO(3);return kR(i.onCitizenshipChange())}),LI(4,Bn,3,2,"y-option-bordered",29),Lp()();}if(r&2){let e=MO(3);eO(3),aE("formControl",e.citizenshipControl)("required",true),eO(),aE("ngForOf",e.citizenshipList);}}function Vn(r,o){if(r&1&&(Pp(0,"div",11),LI(1,Fn,7,5,"y-form-field-bordered",23)(2,Ln,5,3,"y-form-field-bordered",24),Lp()),r&2){let e=MO(2);eO(),aE("ngIf",e.nameControl),eO(),aE("ngIf",e.isCitizenshipShow);}}function Un(r,o){r&1&&(Pp(0,"div",41),PO(1," \u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 "),Lp());}function Gn(r,o){if(r&1){let e=_O();Pp(0,"div",32)(1,"div",33)(2,"label",34)(3,"a",35),PO(4," \u041F\u0435\u0440\u0435\u0445\u043E\u0434 \u0432 Yota "),Lp(),PO(5," \u0441\u043E \u0441\u0432\u043E\u0438\u043C \u043D\u043E\u043C\u0435\u0440\u043E\u043C "),Lp(),Pp(6,"y-switch",36,4),FE("change",function(){FR(e);let i=MO(2);return kR(i.onMnpChanged())})("click",function(){FR(e);let i=MO(2);return kR(i.onClickMnp())}),Lp()(),LI(8,Un,2,0,"div",37),Pp(9,"div",38)(10,"y-icon",39),PO(11," stroke_info "),Lp(),Pp(12,"span",40),PO(13," \u041E\u043D \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D \u043D\u0430 \u0442\u0435\u0431\u044F "),Lp()()();}if(r&2){let e=MO(2);eO(6),aE("formControl",e.mnpControl)("id","mnp-switch"),eO(2),aE("ngIf",e.showMnpError),eO(),cE("show",e.mnpControl.value);}}function Hn(r,o){if(r&1){let e=_O();Pp(0,"div",6)(1,"form",7)(2,"div",8)(3,"h2",9),PO(4,"\u0414\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F"),Lp(),LI(5,kn,1,4,"y-icon",10),Lp(),Pp(6,"div",11)(7,"y-form-field-bordered",12)(8,"y-label"),PO(9,"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430"),Lp(),Pp(10,"input",13,1),FE("focus",function(){FR(e);let i=MO();return kR(i.onFocusPhoneField())})("paste",function(i){FR(e);let n=MO();return kR(n.onPastePhoneField(i))}),Lp(),Pp(12,"yota-field-state",14),FE("clear",function(){FR(e);let i=MO();return kR(i.setDefaultPhoneField())}),Lp(),LI(13,$n,2,1,"y-error",15),Lp(),Pp(14,"div",16),LI(15,Rn,2,1,"yota-order-autocomplete",17),GO(16,"async"),Lp()(),LI(17,Vn,3,2,"div",18)(18,Gn,14,5,"div",19),Pp(19,"yota-personal-policy-agreement",20),GO(20,"async"),FE("changed",function(i){FR(e);let n=MO();return kR(n.personalDataClick(i))}),Lp()()();}if(r&2){let e=kO(11),t=MO();eO(),aE("formGroup",t.formGroup),eO(4),aE("ngIf",t.isCitizenshipShow),eO(5),aE("formControl",t.phoneControl)("required",true)("unmask",true)("imask",t.phoneMask),eO(2),aE("state",t.phoneControlState)("inputControl",e),eO(),aE("ngIf",t.getPhoneErrorMessage(t.phoneControl.errors)),eO(2),aE("ngIf",ZO(16,13,t.region$)),eO(2),aE("ngIf",t.nameControl||t.isCitizenshipShow),eO(),aE("ngIf",t.mnpVisible),eO(),aE("checked",!!ZO(20,15,t.isPersonalDataAgreed$));}}function Yn(r,o){r&1&&(Pp(0,"p"),PO(1,' \u041F\u043E \u0437\u0430\u043A\u043E\u043D\u0443 "\u041E \u0441\u0432\u044F\u0437\u0438" \u043E\u0442 07.07.2003'),EE(2,"br"),PO(3," \u2116 126-\u0424\u0417 \u0444\u0438\u0437\u043B\u0438\u0446\u043E \u0441 \u0433\u0440\u0430\u0436\u0434\u0430\u043D\u0441\u0442\u0432\u043E\u043C \u0420\u043E\u0441\u0441\u0438\u0438 \u043C\u043E\u0436\u0435\u0442 \u043E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435"),EE(4,"br"),PO(5," 20 \u043D\u043E\u043C\u0435\u0440\u043E\u0432, \u0431\u0435\u0437 \u0433\u0440\u0430\u0436\u0434\u0430\u043D\u0441\u0442\u0432\u0430 \u2014 \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435 10 \u043D\u043E\u043C\u0435\u0440\u043E\u0432 \u0441\u0443\u043C\u043C\u0430\u0440\u043D\u043E \u0443 \u0432\u0441\u0435\u0445 \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u043E\u0432 \u0441\u0432\u044F\u0437\u0438 "),Lp());}var Vr=(()=>{class r extends p{constructor(){super(),this._orderStateService=D(he),this._orderAddressService=D(bt),this._orderDataService=D(ve),this._orderApiService=D(Le),this._regionService=D(ze$2),this._changeDetectorRef=D(ui),this._orderAnalyticsService=D(re),this._cartService=D(Rt),this._route=D(F),this._selectNumberDialogService=D(De),this._popupService=D(pt),this.isBrowser=ru(D(lc)),this.phoneMask=k,this.phoneControl=oe.contactFormGroup.controls.phone,this.mnpControl=oe.contactFormGroup.controls.mnp,this.nameControl=oe.contactFormGroup.controls.name,this.citizenshipControl=oe.contactFormGroup.controls.citizenship,this.formGroup=oe.contactFormGroup,this.cityList=[],this.searchCity=[],this.citizenshipList=["\u0420\u043E\u0441\u0441\u0438\u044F","\u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D","\u0422\u0430\u0434\u0436\u0438\u043A\u0438\u0441\u0442\u0430\u043D","\u041A\u044B\u0440\u0433\u044B\u0437\u0441\u0442\u0430\u043D","\u041A\u0430\u0437\u0430\u0445\u0441\u0442\u0430\u043D","\u0410\u0437\u0435\u0440\u0431\u0430\u0439\u0434\u0436\u0430\u043D","\u0414\u0440\u0443\u0433\u043E\u0435"],this.mnpVisible=false,this.controlState=c,this.nameRequired=this._orderDataService.orderSettings.nameRequired,this.isCitizenshipShow=this._orderDataService.orderSettings.citizenshipShow,this.showMnpError=false,this.forceMnpChange=false,this._previousCitizenship="\u0420\u043E\u0441\u0441\u0438\u044F",this._nameMaxLength=100,this._namePattern=/[^a-zA-Zа-яА-Я\sёЁ-]/g,this._phoneErrorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["restrictedPhone","\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430"]]),this._nameErrorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["maxlength","\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0434\u043B\u0438\u043D\u0430 100 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432"]]),this.orderMetaInfo$=this._orderDataService.orderMetaInfo$,this.region$=this._regionService.getRegion$(),this.phoneFieldState$=new En$1(null),this.popularCountries=[],this.isPersonalDataAgreed$=this._orderStateService.isPersonalDataAgreed$.asObservable(),Zh([this.orderMetaInfo$.pipe(it(Boolean),le(e=>!!e.dmsData.nomenclatures[0]?.mnpAvailable),Uu(()=>this.forceMnpChange=true)),te.beautifulNumberFormGroup.controls.numbers.valueChanges.pipe(Vu(te.beautifulNumberFormGroup.controls.numbers.value),le(e=>!!e.length),Uu(()=>this.showMnpError=false),Ou())]).pipe(Hu(this._onDestroy$)).subscribe(([e,t])=>{if(this.mnpVisible=!!this._orderDataService.orderSettings.mnpVisible&&e,this.forceMnpChange){this.forceMnpChange=false;let i=this._orderDataService.orderSettings.mnpEnabled&&e&&!t;this.mnpControl.setValue(i);}!e||t?(this.mnpControl.setValue(false),this.mnpControl.disable({emitEvent:false})):this.mnpControl.enable({emitEvent:false});}),this.formGroup.valueChanges.pipe(Su(64),Hu(this._onDestroy$)).subscribe(e=>{this._orderDataService.setContactState(w$1({name:Q.CONTACT},e));}),this.phoneControl.valueChanges.pipe(it(()=>this.phoneControl.valid),Hu(this._onDestroy$)).subscribe(()=>{this.isBrowser&&this._orderAnalyticsService.onEnterValidPhone();}),this._orderDataService.orderSettings.nameShow&&this._addNameControl(this.nameRequired);}ngOnInit(){this._changeDetectorRef.markForCheck(),this._init();}fetchMetaInfo(e){if(!this._orderDataService.orderSettings)return Bh(null);let t=this._orderDataService.orderSettings.goodId;return this._orderApiService.getPreOrderInfo$({fiasCode:e?.fiasCode,kladrId:e?.kladrId,goodId:t,legalForm:this._orderDataService.orderSettings.commerceType},e?.dmsData).pipe(wt(1),Uu(i=>{this._orderStateService.resetOrder(),this._orderAddressService.resetAddress();let n;if(!i.dmsData?.nomenclature&&i.dmsData?.nomenclatures?.length>0){let u=i.dmsData.nomenclatures[0];n=w$1({},i),n.dmsData.nomenclature=u;}else n=w$1({},i);e.dmsData?.latitude&&e.dmsData?.longitude&&(n.cityData.city.latitude=e.dmsData?.latitude,n.cityData.city.longitude=e.dmsData?.longitude),this._orderDataService.orderMetaInfo=n,this._orderAnalyticsService.goodId=n.cityData.good.id,this._orderAnalyticsService.goodName=n.cityData.good.name,this._orderAnalyticsService.goodProductType=n.cityData.good.productType,this._orderStateService.calculateTotal$.next(),this._cartService.setInfo({name:n.cityData.good.name,fiasid:n.cityData.city.fiasCode,goodOutsideNumber:n.cityData.good.outsideNumber}),(!n.dmsData.nomenclature||!n.dmsData.nomenclature.deliveryAvailable&&!n.dmsData.nomenclature.pickupAvailable&&!n.dmsData.nomenclature.samokatDelivery)&&this._orderAnalyticsService.orderNoReceivingWay(this._orderDataService.orderRegion,this._orderDataService.orderCity),this._changeDetectorRef.markForCheck();}))}citySelected(e){if(te.beautifulNumberFormGroup.controls.numbers.value.length&&this._orderDataService.orderMetaInfo$.value?.dmsData.greenfieldCode!==e.dmsData?.greenfieldCode){this._openWarningRegionSelectedPopup(),te.beautifulNumberFormGroup.controls.numbers.setValue([]);let t={msisdn:[],expirationLockDate:null,lockId:null};this._cartService.setInfo(t),this._selectNumberDialogService.reset();}this.fetchMetaInfo(e).pipe(Hu(this._onDestroy$)).subscribe();}getPhoneErrorMessage(e){if(e){let t=w$1({},e);for(let i of Object.keys(t)){let n=this._phoneErrorMessages.get(i);if(n)return n}}return ""}getNameErrorMessage(e){if(e){let t=w$1({},e);for(let i of Object.keys(t)){let n=this._nameErrorMessages.get(i);if(n)return n}}return ""}onMnpChanged(){this.mnpControl.disabled||(this._orderAddressService.resetAddressAfterActions(),this._orderAnalyticsService.onMnpControlChecked(this.mnpControl.value));}onFocusPhoneField(){this.phoneControl.value.length>1||this.setDefaultPhoneField();}onClickMnp(){this.showMnpError=this.mnpControl.disabled;}onPastePhoneField(e){let t=e.clipboardData?.getData("text")||"";if(!p$1.IS_PHONE(t))return;e.preventDefault();let i=p$1.CLEAR_PHONE(t);(i[0]==="7"||i[0]==="8")&&(i=i.substring(1)),this.setDefaultPhoneField(),this.phoneControl.setValue(i);}setDefaultPhoneField(){this.phoneControl.setValue("7");}get phoneControlState(){return this.phoneFieldInputRef?this.phoneFieldInputRef.focused&&this.phoneFieldInputRef.value.length>3?c.CLEAR:this.phoneControl.touched?this.phoneControl.errors?c.ERROR:c.SUCCESS:null:null}onInputName(e){if(!this.nameControl)return;let t=e.target,i=w$1({},t).value,n=t.value;n=n.replace(this._namePattern,""),n.length>this._nameMaxLength&&(n=n.slice(0,this._nameMaxLength)),n.trim().length||(n=""),n!==i&&this.nameControl.setValue(n,{emitEvent:false});}onBlurName(){this.nameControl?.value&&this._orderAnalyticsService.onEnteredName();}get isForeignCitizenship(){return this.citizenshipControl.value!=="\u0420\u043E\u0441\u0441\u0438\u044F"}onCitizenshipChange(){if(!this.citizenshipControl)return;let e="\u0420\u043E\u0441\u0441\u0438\u044F";this._previousCitizenship===e&&this.citizenshipControl.value!==e?this._orderAddressService.resetAddressAfterActions(false):this._previousCitizenship!==e&&this.citizenshipControl.value===e&&this._orderAddressService.resetAddressAfterActions(false),this._orderStateService.isForeignCitizenship$.next(this.isForeignCitizenship),this._orderAnalyticsService.onCitizenshipChange(this.citizenshipControl.value),this._previousCitizenship=this.citizenshipControl.value;}get nameControlState(){return !this.nameFieldInputRef||!this.nameControl?null:this.nameFieldInputRef.focused&&this.nameFieldInputRef.value.length?c.CLEAR:!this.nameControl.touched||!this.nameRequired&&!this.nameFieldInputRef.value.length?null:this.nameControl.errors?c.ERROR:c.SUCCESS}_init(e=false){let t=this._regionService.getRegion()?.id||"0c5b244470a04932980cb4dc0d3f02b5",i=!e&&this._cartService.device?.fiasid||t;this.fetchMetaInfo({fiasCode:i}).pipe(Li$1(n=>(n.status===422&&!e&&i===this._cartService.device?.fiasid&&this._init(true),og(()=>n))),Ie(()=>this._route.queryParams.pipe(wt(1),Hu(this._onDestroy$))),Hu(this._onDestroy$)).subscribe(n=>{let u=n.mymsisdn;u&&p$1.IS_PHONE(u)&&(this.phoneControl.setValue(u),this.phoneControl.markAsTouched()),this._orderAnalyticsService.onCitizenshipChange(this.citizenshipControl.value);});}_addNameControl(e){let t=[Ie$1.maxLength(100)];e&&t.push(Ie$1.required),oe.contactFormGroup.addControl("name",new W("",{nonNullable:true,validators:t})),this.nameControl=oe.contactFormGroup.controls.name;}_openWarningRegionSelectedPopup(){let e="\u0423 \u0442\u0435\u0431\u044F \u0441\u043C\u0435\u043D\u0438\u043B\u0441\u044F \u0440\u0435\u0433\u0438\u043E\u043D. \u0412\u044B\u0431\u0435\u0440\u0438 \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 \u0437\u0430\u043D\u043E\u0432\u043E, \u0442.\u043A. \u043E\u043D\u0438 \u0437\u0430\u0432\u0438\u0441\u044F\u0442 \u043E\u0442 \u0440\u0435\u0433\u0438\u043E\u043D\u0430";this._popupService.openPopup({text:e,svgIcon:"info-outline",theme:"warning",timeout:5e3}),this._orderAnalyticsService.onShowPopup(e);}personalDataClick(e){this._orderStateService.isPersonalDataAgreed$.next(e);}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-contact-form"]],viewQuery:function(t,i){if(t&1&&(NO(In,5),NO(wn,5),NO(Tn,5,$i)),t&2){let n;AO(n=RO())&&(i.phoneFieldInputRef=n.first),AO(n=RO())&&(i.nameFieldInputRef=n.first),AO(n=RO())&&(i.autocompleteComponent=n.first);}},inputs:{popularCountries:"popularCountries"},features:[MI],decls:4,vars:3,consts:[["tooltipTemplate",""],["phoneFieldInputRef","yInput"],["autocompleteComponent",""],["nameFieldInputRef","yInput"],["mnpSwitch",""],["class","contact-form",4,"ngIf"],[1,"contact-form"],[3,"formGroup"],[1,"contact-form__top"],[1,"contact-form__title"],["svgIcon","question-circle","class","contact-form__top-icon","yotaTrigger","click",3,"yotaCustomTooltip","yotaCustomTooltipClass","yotaCustomTooltipPosition","yotaPointEventNone",4,"ngIf"],[1,"contact-form__row"],[1,"contact-form__phone"],["yInput","","yotaInputTransformer","","name","phone","type","tel","autocomplete","off",1,"contact-form__input-phone",3,"focus","paste","formControl","required","unmask","imask"],["ySuffix","",3,"clear","state","inputControl"],[4,"ngIf"],[1,"contact-form__region"],[3,"label","_selectOption",4,"ngIf"],["class","contact-form__row",4,"ngIf"],["class","contact-form__mnp-wrapper",4,"ngIf"],[1,"policy-agreement",3,"changed","checked"],["svgIcon","question-circle","yotaTrigger","click",1,"contact-form__top-icon",3,"yotaCustomTooltip","yotaCustomTooltipClass","yotaCustomTooltipPosition","yotaPointEventNone"],[3,"_selectOption","label"],["class","contact-form__name",4,"ngIf"],["class","contact-form__residency",4,"ngIf"],[1,"contact-form__name"],["yInput","","name","name","autocomplete","name",1,"contact-form__input-name",3,"input","blur","formControl","required"],[1,"contact-form__residency"],[3,"selectionChange","formControl","required"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"citizenship"],[1,"contact-form__mnp-wrapper"],[1,"contact-form__mnp"],[1,"contact-form__mnp-label"],["href","/mnp","target","_blank","rel","nofollow noopener noreferrer",1,"y-link-pseudo"],[3,"change","click","formControl","id"],["class","contact-form__mnp-error",4,"ngIf"],[1,"contact-form__hint"],[1,"contact-form__hint-icon","y-primary"],[1,"contact-form__hint-text"],[1,"contact-form__mnp-error"]],template:function(t,i){t&1&&(LI(0,Hn,21,17,"div",5),GO(1,"async"),LI(2,Yn,6,0,"ng-template",null,0,KO)),t&2&&aE("ngIf",ZO(1,1,i.orderMetaInfo$));},dependencies:()=>[Zw,Ih,An$1,Dn$1,Ge,yn$1,Cn$1,ot,Mn$1,Tt,Bt,h,It,x$1,Lr,tC,$i,gd,Ty,gm,zt,ld,ar,ae,Ny,Cd,hd],styles:["[_nghost-%COMP%]     .y-tab-label{width:300px}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{border:none;border-bottom:1px solid #e4e7e9;border-radius:0}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper span.ng-star-inserted, [_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{padding-left:0;padding-top:0}[_nghost-%COMP%]     .y-form-field label.dynamic-control__label{font-size:12px;margin-bottom:5px}[_nghost-%COMP%]     .y-form-field-bordered:not(.contact-form__name) .y-form-field-bordered-wrapper{padding-bottom:16px;transition:all .3s cubic-bezier(.66,0,.34,1)}[_nghost-%COMP%]     .y-form-field-bordered:not(.contact-form__name).y-form-field-bordered-invalid .y-form-field-bordered-wrapper{padding-bottom:22px;margin-bottom:24px}[_nghost-%COMP%]     .y-switch.y-disabled .y-switch-label, [_nghost-%COMP%]     .y-switch.y-disabled .y-switch-thumb-container{cursor:pointer}@media (max-width: 768px){[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:12px;transition:all .3s cubic-bezier(.66,0,.34,1)}[_nghost-%COMP%]     .y-form-field-bordered.y-form-field-bordered-invalid .y-form-field-bordered-wrapper{padding-bottom:22px;margin-bottom:12px}}.contact-form__top[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:8px}.contact-form__top-icon[_ngcontent-%COMP%]{width:24px;height:24px;cursor:pointer}.contact-form__title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-bottom:24px;font-size:16px;line-height:22px;font-weight:600}.contact-form__row[_ngcontent-%COMP%]{display:flex;width:100%;column-gap:32px}.contact-form__input-phone[_ngcontent-%COMP%]::placeholder{all:unset!important;color:#89909c!important}.contact-form__phone[_ngcontent-%COMP%], .contact-form__city[_ngcontent-%COMP%]{width:100%}.contact-form__region[_ngcontent-%COMP%]{width:100%;height:75px}.contact-form__mnp[_ngcontent-%COMP%]{display:flex;max-width:100%;align-items:center;margin-block:2px 14px;column-gap:30px}.contact-form__mnp-label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:400}.contact-form__mnp-error[_ngcontent-%COMP%]{color:#f65252;font-size:14px;line-height:20px;font-weight:400}.contact-form__hint[_ngcontent-%COMP%]{display:none;align-items:center;gap:10px;border-radius:12px;background-color:#f4fbfe;padding:8px 16px 8px 12px;margin-block:-4px 26px;width:fit-content;font-size:16px;line-height:24px;font-weight:400}.contact-form__hint.show[_ngcontent-%COMP%]{display:flex}.contact-form__hint-icon[_ngcontent-%COMP%]{transform:rotate(180deg);font-size:20px}@media (max-width: 768px){.contact-form__title[_ngcontent-%COMP%]{margin-bottom:16px}.contact-form__row[_ngcontent-%COMP%]{flex-direction:column}.contact-form__mnp[_ngcontent-%COMP%]{margin-bottom:0}.contact-form__hint[_ngcontent-%COMP%]{margin-block:24px 0}}@media (max-width: 480px){.contact-form__mnp[_ngcontent-%COMP%]{justify-content:space-between}.contact-form__mnp-label[_ngcontent-%COMP%]{font-size:12px;line-height:14px;font-weight:400}.contact-form__hint[_ngcontent-%COMP%]{width:100%;font-size:12px;line-height:14px;font-weight:400}}.policy-agreement[_ngcontent-%COMP%]{margin-top:32px}@media (max-width: 768px){.policy-agreement[_ngcontent-%COMP%]{margin-top:24px}}  .yota-custom-tooltip.contact-form__top-tooltip{color:#89909c;border-radius:12px;margin-block:12px;padding-inline:12px;font-size:12px;line-height:18px;font-weight:400}  .y-select-bordered-panel:has(.citizenship){max-height:248px!important}  .cdk-overlay-pane:has(.citizenship){margin-bottom:55px}"],changeDetection:0});}}return r})();var oe=class r$1 extends at{static{this.contactFormGroup=new I({phone:new W("",{nonNullable:true,validators:[Ie$1.required,r.restrictedPhone]}),mnp:new W(false,{nonNullable:true}),region:new W(null,[Ie$1.required]),citizenship:new W("\u0420\u043E\u0441\u0441\u0438\u044F",{nonNullable:true})});}constructor(o,e){super(),this._stepState$=o,this._transitions=e,this.component=Vr,this.name=Q.CONTACT,this.title="\u0414\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F",this.stepState$=this._stepState$,this.transitions=this._transitions;}getWriteData(){return new ur().transform(r$1.contactFormGroup.controls.phone.value,n)}showValidateErrors(){r$1.contactFormGroup.valid||(r$1.contactFormGroup.controls.phone.markAsTouched(),r$1.contactFormGroup.controls.phone.updateValueAndValidity(),r$1.contactFormGroup.controls.name?.markAsTouched(),r$1.contactFormGroup.controls.name?.updateValueAndValidity());}setContext(){let o=r$1.contactFormGroup.controls;o.region.value&&typeof o.region.value=="object"&&this.stateContext?.next({city:o.region.value,mnp:o.mnp.value,name:Q.CONTACT,phone:o.phone.value});}getContext(){return this.stateContext?.value}getButtonState(){return we.NEXT}};function Ur({address:r,flat:o,entrance:e}){return r.value&&typeof r.value!="string"?{address:r.value?.value,block:r.value?.block,city:r.value?.city,entrance:e.value,fiasId:r.value?.fiasId,flat:o.value,fullAddress:r.value?.unrestrictedValue,house:r.value?.house,latitude:r.value?.latitude,longitude:r.value?.longitude,settlement:r.value?.settlement,street:r.value?.street}:{}}var ve=(()=>{class r{constructor(){this._orderStateService=D(he),this._orderAnalyticsService=D(re),this._window=D(i$1),this._cartService=D(Rt),this.saveOrderRequest={},this.storeId=null,this.deliveryType$=new En$1(N.Courier),this._orderMetaInfo$=new En$1(null),this._saveOrder$=new En$1(null),this._orderStore$=new En$1({contactState:new En$1(null),paymentState:new En$1(null),receivingState:new En$1(null)});}get orderMetaInfo$(){return this._orderMetaInfo$}set orderMetaInfo(e){this._orderMetaInfo$.next(e);}get contactState$(){return this._orderStore$.value.contactState}get contactState(){return this._orderStore$.value.contactState.value}set saveOrder(e){this._saveOrder$.next(e);}get saveOrder$(){return this._saveOrder$}get orderRegion(){let e=this.orderMetaInfo$.value?.dmsData;return e?e.region:""}get orderCity(){let e=this.orderMetaInfo$.value?.dmsData;return e?e.city??e.settlement:""}setContactState(e){this._orderStore$.value.contactState.next(e);}setPaymentState(e){this._orderStore$.value.paymentState.next(e);}setReceivingState(e){this._orderStore$.value.receivingState.next(e),this._orderAnalyticsService.deliveryType$.next(this.deliveryType$.value);}setSaveOrderRequest(){if(!this.orderSettings||!this.orderMetaInfo$.value)return;let e=G.receivingFormGroup.controls,t=oe.contactFormGroup.controls,i=Je.paymentFormGroup.controls,n=te.beautifulNumberFormGroup.controls,{deliveryFrom:u,deliveryTo:m}=vi(e),x;if(this._orderMetaInfo$.value?.cityData?.city?.timezone&&(x=parseInt(this._orderMetaInfo$.value?.cityData?.city?.timezone,10)),this.saveOrderRequest={orderId:this.saveOrder$.value?.orderId?parseInt(this.saveOrder$.value.orderId):void 0,deliveryAddress:Ur(e),deliveryDetails:{customerComment:e.comment?.value.toString(),deliveryCost:e.timeSlotsTime.value?.minimumDeliveryCost||0,deliveryFrom:u,deliveryTo:m,paymentType:i.paymentMethod.value.toString()},userId:20125,fiasCode:this.orderMetaInfo$.value?.cityData.city.fiasCode,isSet:this.orderMetaInfo$.value?.dmsData.nomenclatures[0].isSet,mnp:t.mnp.value,phone:t.phone.value,receivingWay:e.receivingWay.value,deliveryType:e.receivingWay.value===O.Pickup?null:this.deliveryType$.value,quantity:this._orderStateService.cartFormGroup.controls.productCount.value,salesPointCode:this._orderStateService.pickUpPoint$.value?.code,selfRegistration:false,storeId:this.storeId??void 0,timezone:x,goodId:this.orderSettings.goodId,legalForm:this.orderSettings.commerceType.toLowerCase(),totalCost:this._orderStateService.totalPrice,url:this._window.location.href},this.orderSettings.nameShow){let O=t.name?.value||"",[q,...ue]=O.split(" "),Zr=ue.join(" ");this.saveOrderRequest.firstName=Zr,this.saveOrderRequest.lastName=q;}let M=this._cartService.device?.expirationLockDate||void 0,_=this._cartService.device?.lockId||void 0,T=new Date;M&&new Date(M)>T&&_&&n.numbers.value.length?(this.saveOrderRequest.lockId=_,this.saveOrderRequest.msisdn=n.numbers.value.map(O=>parseInt(O.value))):(this.saveOrderRequest.lockId=void 0,this.saveOrderRequest.msisdn=void 0);}reset(){this._orderMetaInfo$.next(null),this._saveOrder$.next(null),this.deliveryType$.next(N.Courier);}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var Si=(()=>{class r{register(e){this._bottomSheetComponent=e;}openFull(){this._bottomSheetComponent&&(this._bottomSheetComponent.state="open-full",this._bottomSheetComponent.updatePosition(true));}openMin(){this._bottomSheetComponent&&(this._bottomSheetComponent.state="open-min",this._bottomSheetComponent.updatePosition(true));}hide(){this._bottomSheetComponent&&(this._bottomSheetComponent.state="hide",this._bottomSheetComponent.updatePosition());}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var zn=["bottomSheet"],qn=["hiding"],Wn=["*",[["","hiding",""]]],Kn=["*","[hiding]"];function Qn(r,o){if(r&1&&(EE(0,"div",6),GO(1,"async")),r&2){let e=MO();Pc("height",-ZO(1,2,e.currentY$)+4+"px");}}var Gr=(()=>{class r extends p{constructor(e){super(),this._bottomSheetService=e,this.swipeAreaHeight=40,this.animationSpeed=300,this.state="hide",this.startY=0,this.touchStartY=0,this.currentY$=new En$1(0),this.visibleHeight$=new En$1(0),this.isSwiping$=new En$1(false),this._document=D(dr),this._fullHeight=0,this._hidingHeight=0,this._mouseMoveHandler=this.onMoveMouse.bind(this),this._mouseUpHandler=this.onEndMouse.bind(this);}get visibleHeight(){return this.visibleHeight$.value}get isSwiping(){return this.isSwiping$.value}ngOnInit(){this._bottomSheetService.register(this);}ngAfterContentInit(){this._updateHeightValues(),this.contentChanged$?.pipe(Ru(10),Hu(this._onDestroy$)).subscribe(()=>{this._updateHeightValues(),this.updatePosition();});}ngOnDestroy(){this._onDestroy$.next(),this._document.removeEventListener("mousemove",this._mouseMoveHandler),this._document.removeEventListener("mouseup",this._mouseUpHandler);}onStartTouch(e){e.preventDefault(),this.isSwiping$.next(true),this.touchStartY=e.touches[0].clientY,this.bottomSheetEl.nativeElement.style.transition="none";}onStartMouse(e){e.preventDefault(),this.isSwiping$.next(true),this.touchStartY=e.clientY,this.bottomSheetEl.nativeElement.style.transition="none",this._document.body.classList.add("cursor-grabbing"),this._document.addEventListener("mousemove",this._mouseMoveHandler),this._document.addEventListener("mouseup",this._mouseUpHandler);}onMoveTouch(e){e.preventDefault();let t=e.touches[0].clientY;this._handleMove(t);}onMoveMouse(e){if(e.preventDefault(),!this.isSwiping$.value){this.onEndTouch();return}let t=e.clientY;this._handleMove(t);}onEndTouch(){this._handleEnd();}onEndMouse(){this._handleEnd(),this._document.body.classList.remove("cursor-grabbing"),this._document.removeEventListener("mousemove",this._mouseMoveHandler),this._document.removeEventListener("mouseup",this._mouseUpHandler);}updatePosition(e=false){switch(e?this.bottomSheetEl.nativeElement.style.transition=`transform ${this.animationSpeed}ms ease`:this.bottomSheetEl.nativeElement.style.transition="none",this.state){case "open-full":this.bottomSheetEl.nativeElement.style.transform="translateY(0)",this.visibleHeight$.next(this._fullHeight);break;case "open-min":this.bottomSheetEl.nativeElement.style.transform=`translateY(${this._hidingHeight}px)`,this.visibleHeight$.next(this._fullHeight-this._hidingHeight);break;case "hide":this.bottomSheetEl.nativeElement.style.transform="translateY(200%)",this.visibleHeight$.next(0);break;}}_handleMove(e){let t=e-this.touchStartY;this.state==="open-min"&&(t=t+this._hidingHeight),t<0?this.currentY$.next(t*.15):this.currentY$.next(t),this.visibleHeight$.next(this._fullHeight-this.currentY$.value),this.bottomSheetEl.nativeElement.style.transform=`translateY(${this.currentY$.value}px)`;}_handleEnd(){this.startY=this.currentY$.value,this.currentY$.value>0&&this._fullHeight-this.currentY$.value<this._fullHeight-this._hidingHeight?this.state="open-min":this.state="open-full",this.updatePosition(true),this.isSwiping$.next(false);}_updateHeightValues(){this._fullHeight=this.bottomSheetEl.nativeElement.offsetHeight??0,this._hidingHeight=this.hiding.nativeElement.offsetHeight+12||0;}static{this.\u0275fac=function(t){return new(t||r)(k$1(Si))};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-bottom-sheet"]],viewQuery:function(t,i){if(t&1&&(NO(zn,7),NO(qn,7)),t&2){let n;AO(n=RO())&&(i.bottomSheetEl=n.first),AO(n=RO())&&(i.hiding=n.first);}},inputs:{swipeAreaHeight:"swipeAreaHeight",animationSpeed:"animationSpeed",contentChanged$:"contentChanged$"},features:[MI],ngContentSelectors:Kn,decls:11,vars:9,consts:[["bottomSheet",""],["hiding",""],[1,"bottom-sheet"],[1,"bottom-sheet__content"],[1,"bottom-sheet__swipe",3,"touchstart","touchmove","touchend","mousedown"],["class","bottom-sheet__fill",3,"height",4,"ngIf"],[1,"bottom-sheet__fill"]],template:function(t,i){if(t&1){let n=_O();TO(Wn),Pp(0,"div",2,0)(2,"div",3)(3,"div",4),GO(4,"async"),FE("touchstart",function(m){return FR(n),kR(i.onStartTouch(m))})("touchmove",function(m){return FR(n),kR(i.onMoveTouch(m))})("touchend",function(){return FR(n),kR(i.onEndTouch())})("mousedown",function(m){return FR(n),kR(i.onStartMouse(m))}),Lp(),SO(5),Pp(6,"div",null,1),SO(8,1),Lp(),LI(9,Qn,2,4,"div",5),GO(10,"async"),Lp()();}t&2&&(eO(3),Pc("height",i.swipeAreaHeight+"px"),cE("cursor-grabbing",ZO(4,5,i.isSwiping$)),eO(6),aE("ngIf",ZO(10,7,i.currentY$)||false));},dependencies:[Zw,tC],styles:['[_nghost-%COMP%]{--content-padding-top: 18px;--content-padding-inline: 16px;--content-padding-bottom: 12px}.bottom-sheet[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;z-index:3;background:#fff;border-radius:16px 16px 0 0;box-shadow:0 -12px 24px #0000001f;transform:translateY(100%);transition:transform .3s ease;touch-action:none;padding:var(--content-padding-top) var(--content-padding-inline) calc(var(--content-padding-inline))}.bottom-sheet__content[_ngcontent-%COMP%]{position:relative}.bottom-sheet__swipe[_ngcontent-%COMP%]{position:absolute;top:calc(var(--content-padding-top) * -1);left:calc(var(--content-padding-inline) * -1);width:calc(100% + var(--content-padding-inline) * 2);display:flex;justify-content:center;cursor:pointer}.bottom-sheet__swipe[_ngcontent-%COMP%]:before{display:block;width:36px;height:4px;border-radius:100px;margin-top:4px;background:#434c5e33;content:""}.bottom-sheet__fill[_ngcontent-%COMP%]{position:absolute;top:calc(100% + var(--content-padding-top) - 4px);left:calc(var(--content-padding-inline) * -1);width:calc(100% + var(--content-padding-inline) * 2);background:#fff}'],changeDetection:0});}}return r})();var xi=(()=>{class r extends p{constructor(){super(...arguments),this._analyticsService=D(xe),this.buttonText="\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0435\u0449\u0435",this.clickButton=new at$1;}onClick(){this._analyticsService.loadMoreButtonClick(this.buttonText),this.clickButton.emit();}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-load-more-button"]],inputs:{disabled:"disabled"},outputs:{clickButton:"clickButton"},features:[MI],decls:2,vars:2,consts:[["y-button-secondary","","type","button",1,"select-number-load-more-button",3,"click","disabled"]],template:function(t,i){t&1&&(Pp(0,"button",0),FE("click",function(){return i.onClick()}),PO(1),Lp()),t&2&&(aE("disabled",i.disabled),eO(),$p(" ",i.buttonText,`
`));},dependencies:[cn$1],styles:["[_nghost-%COMP%]{display:flex}.select-number-load-more-button[_ngcontent-%COMP%]{text-transform:none;min-height:initial;max-width:initial;background-color:transparent;color:var(--main);border:2px solid var(--main);margin:12px auto 16px;max-width:fit-content;width:auto;padding:10px 30px;font-size:14px;line-height:18px;font-weight:600}.select-number-load-more-button[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:transparent;color:var(--main)}"],changeDetection:0});}}return r})();var Xn=["captchaInputRef"],Jn=["*"];function Zn(r,o){if(r&1&&EE(0,"img",11),r&2){let e=o.ngIf;aE("src",e.img,lv);}}function ea(r,o){if(r&1&&(Pp(0,"y-error"),PO(1),Lp()),r&2){let e=o.ngIf;eO(),$p(" ",e," ");}}var Hr=(()=>{class r extends p{constructor(){super(...arguments),this.label="\u0412\u0432\u0435\u0434\u0438 \u0441\u0438\u043C\u0432\u043E\u043B\u044B \u0441 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",this.captchaControl=new W("",[Ie$1.required]),this.valueChange=new at$1,this.errorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["wrongCaptcha","\u041A\u0430\u043F\u0447\u0430 \u0432\u0432\u0435\u0434\u0435\u043D\u0430 \u043D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E"]]),this.controlState=c,this.captcha$=new En$1(null),this.validateControl$=new En$1(false),this._refreshSubject$=new X;}set wrongCaptcha(e){this.captchaControl.setErrors({wrongCaptcha:e}),e&&(this.refresh(true),setTimeout(()=>{this.validateControl$.next(true);}));}ngOnInit(){this.refresh(),this.captchaControl.valueChanges.pipe(Hu(this._onDestroy$)).subscribe(e=>{this.captcha$.value?.id&&this.valueChange.emit(e?{answer:e,id:this.captcha$.value?.id}:null);}),this.pending$?.pipe(Hu(this._onDestroy$)).subscribe(e=>{e?this.captchaControl.disable():this.captchaControl.enable();});}refresh(e=false){this._refreshSubject$.next(true),this.valueChange.emit(null),this.validateControl$.next(false),this.getCaptcha$.pipe(Hu(this._refreshSubject$)).subscribe(t=>{e||(this.captchaControl.reset(),this.captchaControl.setErrors(null),this.captchaControl.markAsUntouched()),this.captcha$.next(t);});}onBlur(){this.captchaControl.updateValueAndValidity();}getCaptchaErrorMessage(e){if(e){let t=w$1({},e);for(let i of Object.keys(t)){let n=this.errorMessages.get(i);if(n)return n}}return ""}get captchaState(){return this.captchaInputRef?this.captchaInputRef.focused&&this.captchaInputRef.value.length?c.CLEAR:this.captchaControl.touched?this.captchaControl.errors?c.ERROR:c.SUCCESS:null:null}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-captcha"]],viewQuery:function(t,i){if(t&1&&NO(Xn,5),t&2){let n;AO(n=RO())&&(i.captchaInputRef=n.first);}},inputs:{getCaptcha$:"getCaptcha$",label:"label",pending$:"pending$",captchaControl:"captchaControl",wrongCaptcha:"wrongCaptcha"},outputs:{valueChange:"valueChange"},features:[MI],ngContentSelectors:Jn,decls:15,vars:10,consts:[["captchaInputRef","yInput"],[1,"captcha"],[1,"captcha__content"],[1,"captcha__img-wrapper"],["class","captcha__img","alt","captcha",3,"src",4,"ngIf"],[1,"captcha__refresh",3,"click","svgIcon"],[1,"captcha__form"],[1,"captcha__field"],["yInput","","autocomplete","off",3,"blur","formControl","required"],["ySuffix","",3,"clear","state","inputControl"],[4,"ngIf"],["alt","captcha",1,"captcha__img",3,"src"]],template:function(t,i){if(t&1){let n=_O();TO(),Pp(0,"div",1)(1,"div",2)(2,"div",3),LI(3,Zn,1,1,"img",4),GO(4,"async"),Lp(),Pp(5,"y-icon",5),FE("click",function(){return FR(n),kR(i.refresh())}),Lp()(),Pp(6,"div",6)(7,"y-form-field-bordered",7)(8,"y-label"),PO(9),Lp(),Pp(10,"input",8,0),FE("blur",function(){return FR(n),kR(i.onBlur())}),Lp(),Pp(12,"yota-field-state",9),FE("clear",function(){return FR(n),kR(i.captchaControl.setValue(""))}),Lp(),LI(13,ea,2,1,"y-error",10),Lp(),SO(14),Lp()();}if(t&2){let n=kO(11);eO(3),aE("ngIf",ZO(4,8,i.captcha$)),eO(2),aE("svgIcon","refresh-outline"),eO(4),HE(i.label),eO(),aE("formControl",i.captchaControl)("required",true),eO(2),aE("state",i.captchaState)("inputControl",n),eO(),aE("ngIf",i.getCaptchaErrorMessage(i.captchaControl.errors));}},dependencies:[Zw,An$1,Ge,yn$1,ot,Mn$1,Tt,x$1,tC,ld,gd,zt,Ty,ar,hd],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%}.captcha[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.captcha__content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;column-gap:16px}.captcha__refresh[_ngcontent-%COMP%]{width:24px;height:24px;cursor:pointer}.captcha__inner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:250px;width:250px;max-height:40px}.captcha__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;margin-top:40px;padding-bottom:34px;width:100%;max-width:334px}.captcha__label[_ngcontent-%COMP%]{text-align:center}.captcha__img-wrapper[_ngcontent-%COMP%]{width:226px;height:48px;background:linear-gradient(138.75deg,#eef0f2 34.17%,#d9dce1 53.52%);border-radius:16px;overflow:hidden}.captcha__img[_ngcontent-%COMP%]{width:226px;height:48px}"],changeDetection:0});}}return r})();function ta(r,o){r&1&&EE(0,"y-spinner",5),r&2&&aE("diameter",24)("strokeWidth",1);}var Yr=(()=>{class r{constructor(){this._selectNumberService=D(De),this._analyticsService=D(xe),this._dialogRef=D(Oi$1),this.title="\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438, \u0447\u0442\u043E \u0442\u044B \u043D\u0435 \u0440\u043E\u0431\u043E\u0442",this.captchaAnswer=null,this.showCaptcha$=this._selectNumberService.showCaptcha$,this.getCaptcha$=this._selectNumberService.config.captcha$(),this.wrongCaptcha$=new En$1(false),this.pendingCaptcha$=new En$1(false);}ngOnInit(){this._analyticsService.captchaOpen(this.title),this._dialogRef.backdropClick().pipe(wt(1)).subscribe(()=>{this._analyticsService.captchaClose(this.title,"\u0412\u043D\u0435\u0448\u043D\u0438\u0439 \u043A\u043B\u0438\u043A"),this._dialogRef?.close();});}handleCaptcha(e){this.captchaAnswer=e;}confirm(){!this.captchaAnswer?.answer||this.pendingCaptcha$.value||(this.wrongCaptcha$.next(false),this.pendingCaptcha$.next(true),this._analyticsService.captchaConfirm(),this._selectNumberService.config.captchaCheck$({answer:this.captchaAnswer.answer,id:this.captchaAnswer.id}).pipe(wt(1),Fu(()=>{this.pendingCaptcha$.next(false);}),Li$1(e=>{switch(e.error.code||JSON.parse(e.error).code){case 110417:this.wrongCaptcha$.next(true),this._analyticsService.captchaFailed();break}return og(()=>e)})).subscribe(()=>{this._dialogRef?.close(true);}));}close(e){this._dialogRef.close(),this._analyticsService.captchaClose(this.title,e);}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-captcha"]],decls:14,vars:12,consts:[[1,"select-number-captcha__"],["svgIcon","close-light",1,"select-number-captcha__close",3,"click"],[1,"select-number-captcha__container",3,"submit"],[1,"select-number-captcha__title"],[1,"select-number-captcha__captcha",3,"valueChange","getCaptcha$","wrongCaptcha","pending$"],[1,"select-number-captcha__spinner",3,"diameter","strokeWidth"],["y-button","","type","submit",1,"select-number-captcha__confirm",3,"click","disabled"],["y-button","",1,"select-number-captcha__cancel",3,"click"]],template:function(t,i){t&1&&(Pp(0,"div",0)(1,"y-icon",1),FE("click",function(){return i.close("\u041A\u0440\u0435\u0441\u0442\u0438\u043A")}),Lp(),Pp(2,"form",2),FE("submit",function(){return i.confirm()}),Pp(3,"div",3),PO(4),Lp(),Pp(5,"yota-captcha",4),GO(6,"async"),FE("valueChange",function(u){return i.handleCaptcha(u)}),LI(7,ta,1,2,"y-spinner",5),GO(8,"async"),Lp(),Pp(9,"button",6),GO(10,"async"),FE("click",function(){return i.confirm()}),PO(11," \u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C "),Lp(),Pp(12,"button",7),FE("click",function(){return i.close("\u041E\u0442\u043C\u0435\u043D\u0430")}),PO(13," \u041E\u0442\u043C\u0435\u043D\u0430 "),Lp()()()),t&2&&(eO(4),$p(" ",i.title," "),eO(),aE("getCaptcha$",i.getCaptcha$)("wrongCaptcha",ZO(6,6,i.wrongCaptcha$))("pending$",i.pendingCaptcha$),eO(2),EO(ZO(8,8,i.pendingCaptcha$)?7:-1),eO(2),aE("disabled",!i.captchaAnswer||ZO(10,10,i.pendingCaptcha$)));},dependencies:[tC,cn$1,zt,ql,Hr],styles:[".select-number-captcha[_ngcontent-%COMP%]{width:100%;max-width:568px;min-height:322px;display:flex;flex-direction:column;row-gap:16px}.select-number-captcha__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:24px}.select-number-captcha__title[_ngcontent-%COMP%]{text-align:center;font-size:24px;line-height:30px;font-weight:600}.select-number-captcha__spinner[_ngcontent-%COMP%]{position:absolute;bottom:16px;left:0;right:0;margin-inline:auto}.select-number-captcha__close[_ngcontent-%COMP%]{align-self:flex-end;cursor:pointer;width:24px;height:24px;min-width:24px;min-height:24px}.select-number-captcha__button[_ngcontent-%COMP%]{text-transform:none;min-height:initial;max-width:initial;background-color:var(--main);color:var(--base0);border:none;width:auto;padding:15px 32px;font-size:14px;line-height:18px;font-weight:600}.select-number-captcha__button[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:var(--main);color:var(--base0)}.select-number-captcha__button[_ngcontent-%COMP%]:disabled{background-color:#ceced5}.select-number-captcha__cancel[_ngcontent-%COMP%]{text-transform:none;min-height:initial;max-width:initial;background-color:transparent;color:var(--main);border:none;margin-top:16px;width:auto;padding:15px 32px;font-size:14px;line-height:18px;font-weight:600}.select-number-captcha__cancel[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:transparent;color:var(--main)}.select-number-captcha__captcha[_ngcontent-%COMP%]{margin-top:16px}@media (max-width: 768px){.select-number-captcha[_ngcontent-%COMP%]{width:100%}.select-number-captcha-container[_ngcontent-%COMP%]{padding:24px 0}.select-number-captcha-title[_ngcontent-%COMP%]{font-size:18px;line-height:24px;font-weight:600}}"],changeDetection:0});}}return r})();var Ei=(()=>{class r{constructor(){this.clickButton=new at$1;}set buttonText(e){this._buttonText=e||"\u0412\u044B\u0431\u0440\u0430\u0442\u044C";}get buttonText(){return this._buttonText}onClick(){this.clickButton.emit(this.buttonText);}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-confirm"]],inputs:{buttonText:"buttonText",disabled:"disabled"},outputs:{clickButton:"clickButton"},decls:2,vars:3,consts:[["y-button","","type","button",1,"select-number-confirm",3,"click","disabled","tabIndex"]],template:function(t,i){t&1&&(Pp(0,"button",0),FE("click",function(){return i.onClick()}),PO(1),Lp()),t&2&&(aE("disabled",i.disabled)("tabIndex",-1),eO(),$p(" ",i.buttonText,`
`));},dependencies:[cn$1],styles:["[_nghost-%COMP%]{display:flex}.select-number-confirm[_ngcontent-%COMP%]{text-transform:none;min-height:initial;background-color:var(--main);color:var(--base0);border:none;margin-top:24px;max-width:initial;width:100%;padding:15px 24px;font-size:14px;line-height:18px;font-weight:600}.select-number-confirm[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:var(--main);color:var(--base0)}@media (max-width: 992px){.select-number-confirm[_ngcontent-%COMP%]{margin-block:8px;padding-block:15px}}"],changeDetection:0});}}return r})();function ia(r,o){if(r&1){let e=_O();Pp(0,"div",8),PO(1),GO(2,"imask"),Pp(3,"div",9),FE("click",function(){let i=FR(e).$implicit,n=MO(2);return kR(n.onClickRemoveNumber(i))}),EE(4,"y-icon",10),Pp(5,"span"),PO(6,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440"),Lp()()();}if(r&2){let e=o.$implicit,t=MO(2);eO(),$p(" ",YO(2,1,e.value,t.phoneMask)," ");}}function ra(r,o){if(r&1&&(Pp(0,"div",7),CO(1,ia,7,4,"div",8,wO),Lp()),r&2){let e=MO();cE("expanded",e.expandNumbers),eO(),bO(e.selectedNumbers);}}function oa(r,o){if(r&1&&(Pp(0,"span",3),PO(1),Lp()),r&2){let e=MO();eO(),$p(" ",e.config.cartEmptyDescription," ");}}function na(r,o){if(r&1){let e=_O();Pp(0,"div",11),FE("click",function(){FR(e);let i=MO();return kR(i.toggleExpand(i.expandButtonText))}),PO(1),Lp();}if(r&2){let e=MO();cE("expanded",e.expandNumbers),eO(),$p(" ",e.expandButtonText," ");}}function aa(r,o){if(r&1&&(Pp(0,"p",5),PO(1),Lp()),r&2){let e=MO();eO(),$p("",e.totalPrice," \u20BD");}}function sa(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-confirm",12),FE("clickButton",function(i){FR(e);let n=MO();return kR(n.clickConfirmButton.emit(i))}),Lp();}if(r&2){let e=MO();aE("buttonText",(e.config.buttonOrder==null?null:e.config.buttonOrder.text)||"")("disabled",!e.selectedNumbers.length||e.pending||e.hasError);}}var jr=(()=>{class r extends p{constructor(){super(...arguments),this._selectNumberService=D(De),this._analyticsService=D(xe),this.hideOrderButton=false,this.config=this._selectNumberService.config,this.expandNumbers=false,this.phoneMask={mask:"+7 (000) 000-00-00"},this.removeNumber=new at$1,this.toggleExpandAction=new at$1,this.clickConfirmButton=new at$1;}get expandButtonText(){return this.expandNumbers?"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C":this.config.expandMoreText}onClickRemoveNumber(e){this.hasError||this.pending||this.removeNumber.emit(e);}toggleExpand(e){this.expandNumbers=!this.expandNumbers,this.toggleExpandAction.emit(),this._analyticsService.toggleExpand(e);}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-cart"]],inputs:{selectedNumbers:"selectedNumbers",totalPrice:"totalPrice",pending:"pending",hasError:"hasError",hideOrderButton:"hideOrderButton"},outputs:{removeNumber:"removeNumber",toggleExpandAction:"toggleExpandAction",clickConfirmButton:"clickConfirmButton"},features:[MI],decls:8,vars:11,consts:[[1,"select-number-cart"],[1,"select-number-cart__title"],[1,"select-number-cart__numbers",3,"expanded"],[1,"select-number-cart__description"],[1,"select-number-cart__more",3,"expanded"],[1,"select-number-cart__price"],[1,"select-number-cart__button",3,"buttonText","disabled"],[1,"select-number-cart__numbers"],[1,"select-number-cart__number"],[1,"select-number-cart__remove",3,"click"],["svgIcon","close-outline"],[1,"select-number-cart__more",3,"click"],[1,"select-number-cart__button",3,"clickButton","buttonText","disabled"]],template:function(t,i){t&1&&(Pp(0,"div",0)(1,"p",1),PO(2),Lp(),LI(3,ra,3,2,"div",2)(4,oa,2,1,"span",3)(5,na,2,3,"div",4)(6,aa,2,1,"p",5)(7,sa,1,2,"yota-select-number-confirm",6),Lp()),t&2&&(cE("has-numbers",i.selectedNumbers.length)("expandable",i.selectedNumbers.length>1)("pending",i.pending||i.hasError),eO(2),HE(i.config.cartTitle),eO(),EO(i.selectedNumbers.length?3:4),eO(2),EO(i.selectedNumbers.length>1?5:-1),eO(),EO(!i.config.radioMode&&i.selectedNumbers.length?6:-1),eO(),EO(i.hideOrderButton?-1:7));},dependencies:[ur,zt,Ei],styles:['.select-number-cart[_ngcontent-%COMP%]{background:var(--base0);display:flex;flex-direction:column;padding:24px;border-radius:20px;height:fit-content}.select-number-cart__title[_ngcontent-%COMP%]{font-size:16px;line-height:22px;font-weight:600}.select-number-cart__description[_ngcontent-%COMP%]{margin-top:8px;color:var(--content-secondary);font-size:16px;line-height:24px;font-weight:400}.select-number-cart__numbers[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:8px;margin-top:8px}.select-number-cart__number[_ngcontent-%COMP%]{display:grid;grid-template-columns:136px auto;column-gap:8px;align-items:center;white-space:nowrap;width:fit-content;font-size:16px;line-height:22px;font-weight:600}.select-number-cart__more[_ngcontent-%COMP%]{display:none;align-items:center;column-gap:2px;color:var(--main);margin-top:8px;cursor:pointer;font-size:14px;line-height:18px;font-weight:600}.select-number-cart__more[_ngcontent-%COMP%]:after{width:24px;height:24px;content:"";-webkit-mask:url("./media/arrow-outline-VU4W557N.svg") no-repeat 50% 50%;mask:url("./media/arrow-outline-VU4W557N.svg") no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover;background:var(--main);transform:rotate(180deg)}.select-number-cart__more.expanded[_ngcontent-%COMP%]:after{transform:rotate(0)}.select-number-cart__remove[_ngcontent-%COMP%]{display:flex;column-gap:4px;align-items:center;cursor:pointer;font-size:12px;line-height:14px;font-weight:400}.select-number-cart__remove[_ngcontent-%COMP%]   .y-icon[_ngcontent-%COMP%]{width:24px;height:24px;min-width:24px;min-height:24px}.select-number-cart__remove[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.select-number-cart__remove[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{display:initial;color:var(--alert)}.select-number-cart__remove[_ngcontent-%COMP%]:hover     .y-icon svg path{fill:var(--alert)}.select-number-cart__price[_ngcontent-%COMP%]{margin-top:24px;font-size:32px;line-height:42px;font-weight:600}.select-number-cart.pending[_ngcontent-%COMP%]{color:var(--content-secondary);cursor:default}.select-number-cart.pending[_ngcontent-%COMP%]   .select-number-cart__remove[_ngcontent-%COMP%]{cursor:default}.select-number-cart.pending[_ngcontent-%COMP%]   .select-number-cart__remove[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{display:none!important}.select-number-cart.pending[_ngcontent-%COMP%]   .select-number-cart__remove[_ngcontent-%COMP%]     .y-icon svg path{fill:var(--base3)}@media (max-width: 992px){.select-number-cart[_ngcontent-%COMP%]{width:100%;padding:0;margin-bottom:12px}.select-number-cart__title[_ngcontent-%COMP%]{grid-area:title;margin-bottom:4px;font-size:14px;line-height:20px;font-weight:600}.select-number-cart__description[_ngcontent-%COMP%]{margin-top:0;font-size:12px;line-height:24px;font-weight:400}.select-number-cart__button[_ngcontent-%COMP%]{grid-area:order}.select-number-cart__numbers[_ngcontent-%COMP%]{grid-area:numbers;row-gap:4px;margin-block:0;overflow:hidden;max-height:24px}.select-number-cart__numbers.expanded[_ngcontent-%COMP%]{max-height:152px}.select-number-cart__more[_ngcontent-%COMP%]{grid-area:more;display:flex;width:fit-content}.select-number-cart__remove[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{display:none!important}.select-number-cart__price[_ngcontent-%COMP%]{grid-area:price;align-self:center;margin-top:0;font-size:24px;line-height:32px;font-weight:600}.select-number-cart.has-numbers[_ngcontent-%COMP%]{display:grid;grid-template-areas:"title price" "numbers price";grid-template-columns:1fr auto}.select-number-cart.expandable[_ngcontent-%COMP%]{grid-template-areas:"title price" "numbers price" "more price"}}'],changeDetection:0});}}return r})();function la(r,o){if(r&1){let e=_O();Pp(0,"div",2),FE("click",function(){let i=FR(e).$implicit,n=MO();return kR(n.toggleCategory(i))}),PO(1),Lp();}if(r&2){let e=o.$implicit;cE("selected",e.selected),eO(),$p(" ",e.name," ");}}var zr=(()=>{class r{constructor(){this._selectNumberDialogService=D(De),this._analyticsService=D(xe);}toggleCategory(e){this._analyticsService.toggleCategory(e.name,!e.selected),this._selectNumberDialogService.toggleCategory(e.value);}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-categories"]],inputs:{categories:"categories",pending:"pending"},decls:3,vars:2,consts:[[1,"select-number-categories"],[1,"select-number-categories__item",3,"selected"],[1,"select-number-categories__item",3,"click"]],template:function(t,i){t&1&&(Pp(0,"div",0),CO(1,la,2,3,"div",1,wO),Lp()),t&2&&(cE("pending",i.pending),eO(),bO(i.categories));},styles:["[_nghost-%COMP%]{overflow:hidden}.select-number-categories[_ngcontent-%COMP%]{display:flex;column-gap:8px;margin-top:20px;padding-inline:24px;overflow:auto hidden;scroll-snap-type:x mandatory;scroll-padding-left:16px;scrollbar-width:none;-ms-overflow-style:none}.select-number-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.select-number-categories__item[_ngcontent-%COMP%]{background:var(--ss2);border-radius:24px;padding:7px 12px;white-space:nowrap;height:fit-content;-webkit-user-select:none;user-select:none;overflow:hidden;min-width:min-content;cursor:pointer;transition:all .2s ease;scroll-snap-stop:always;scroll-snap-align:start;font-size:14px;line-height:18px;font-weight:500}.select-number-categories__item.selected[_ngcontent-%COMP%]{color:var(--base0);background:var(--main)}.pending[_ngcontent-%COMP%] > .select-number-categories__item[_ngcontent-%COMP%], .pending[_ngcontent-%COMP%] > .select-number-categories__item.selected[_ngcontent-%COMP%]{background:var(--baseX);color:var(--base3);cursor:default}@media (max-width: 992px){.select-number-categories[_ngcontent-%COMP%]{padding-inline:12px;margin-block:0 12px;max-height:32px;transition:max-height ease .3s,margin-bottom ease .3s}.select-number-categories.collapsed[_ngcontent-%COMP%]{padding-block:0;margin-block:0;max-height:0;margin-bottom:0;overflow:hidden}}@media (max-width: 768px){.select-number-categories[_ngcontent-%COMP%]{column-gap:4px}}"],changeDetection:0});}}return r})();function ca(r,o){r&1&&(Pp(0,"h5",2),PO(1),Lp()),r&2&&(eO(),$p(" ",o," "));}function ua(r,o){if(r&1){let e=_O();Pp(0,"button",6),FE("click",function(){let i=FR(e);return kR(i.action())}),PO(1),Lp();}if(r&2){let e=MO();aE("disabled",e.primaryButtonDisabled),eO(),$p(" ",o.text," ");}}function pa(r,o){if(r&1){let e=_O();Pp(0,"button",7),FE("click",function(){let i=FR(e);return kR(i.action())}),PO(1),Lp();}if(r&2){let e=o,t=MO();aE("disabled",!!e.canDisable&&t.secondaryButtonDisabled),eO(),$p(" ",e.text," ");}}var qr=(()=>{class r{constructor(){this.primaryButtonDisabled=false,this.secondaryButtonDisabled=false;}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-error"]],inputs:{data:"data",fromContainer:"fromContainer",primaryButtonDisabled:"primaryButtonDisabled",secondaryButtonDisabled:"secondaryButtonDisabled"},decls:6,vars:9,consts:[[1,"select-number-error"],[1,"select-number-error__image",3,"svgIcon"],[1,"select-number-error__title"],[1,"select-number-error__description",3,"innerHTML"],["y-button","",1,"select-number-error__button",3,"disabled"],["y-button-secondary","",1,"select-number-error__button","select-number-error__button-secondary",3,"disabled"],["y-button","",1,"select-number-error__button",3,"click","disabled"],["y-button-secondary","",1,"select-number-error__button","select-number-error__button-secondary",3,"click","disabled"]],template:function(t,i){if(t&1&&(Pp(0,"div",0),EE(1,"y-icon",1),LI(2,ca,2,1,"h5",2),EE(3,"p",3),LI(4,ua,2,2,"button",4)(5,pa,2,2,"button",5),Lp()),t&2){let n,u,m;cE("has-title",i.data.title)("from-container",i.fromContainer),eO(),aE("svgIcon",i.data.svgIcon||"fail"),eO(),EO((n=i.data.title)?2:-1,n),eO(),aE("innerHTML",i.data.description,YR),eO(),EO((u=i.data.button)?4:-1,u),eO(),EO((m=i.data.buttonSecondary)?5:-1,m);}},dependencies:[cn$1,zt],styles:[".select-number-error[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:64px 32px}.select-number-error__image[_ngcontent-%COMP%]{width:232px;height:232px;min-width:232px;min-height:232px}.select-number-error__title[_ngcontent-%COMP%]{text-align:center;margin-bottom:8px;font-size:24px;line-height:30px;font-weight:600}.select-number-error__description[_ngcontent-%COMP%]{text-align:center;font-size:16px;line-height:18px;font-weight:400}.select-number-error__button[_ngcontent-%COMP%]{text-transform:none;min-height:initial;max-width:initial;background-color:var(--main);color:var(--base0);border:none;margin-top:24px;max-width:324px;width:100%;padding-block:12px;font-size:14px;line-height:18px;font-weight:600}.select-number-error__button[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:var(--main);color:var(--base0)}.select-number-error__button-secondary[_ngcontent-%COMP%]{text-transform:none;min-height:initial;max-width:initial;background-color:var(--base0);color:var(--main);border:2px solid var(--main);margin-top:8px;max-width:324px}.select-number-error__button-secondary[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:var(--base0);color:var(--main)}.select-number-error__description[_ngcontent-%COMP%] + .select-number-error__button-secondary[_ngcontent-%COMP%]{--btn-height: 42px;width:auto;margin-top:16px;min-height:var(--btn-height);height:var(--btn-height)}@media (max-width: 992px){.select-number-error__description[_ngcontent-%COMP%] + .select-number-error__button-secondary[_ngcontent-%COMP%]{--btn-height: 40px;width:100%;margin-top:12px}}.select-number-error.from-container[_ngcontent-%COMP%]{padding-block:0;margin-bottom:24px}.select-number-error.from-container[_ngcontent-%COMP%]   .select-number-error__image[_ngcontent-%COMP%]{width:130px;height:130px;min-width:130px;min-height:130px}.select-number-error.from-container[_ngcontent-%COMP%]   .select-number-error__description[_ngcontent-%COMP%]{margin-top:4px;color:var(--ss5);font-size:16px;line-height:24px;font-weight:400}.select-number-error__title[_ngcontent-%COMP%] + .select-number-error__description[_ngcontent-%COMP%]{color:var(--content-secondary)}@media (max-width: 992px){.select-number-error[_ngcontent-%COMP%]{padding-inline:12px;margin-block:auto}.select-number-error__image[_ngcontent-%COMP%]{margin-bottom:8px;width:182px;height:182px;min-width:182px;min-height:182px}.select-number-error__title[_ngcontent-%COMP%]{font-size:18px;line-height:24px;font-weight:600}.select-number-error__description[_ngcontent-%COMP%]{font-size:16px;line-height:18px;font-weight:400}.select-number-error__button[_ngcontent-%COMP%]{padding-block:13px;max-width:initial;font-size:14px;line-height:18px;font-weight:600}.select-number-error.from-container[_ngcontent-%COMP%]   .select-number-error__image[_ngcontent-%COMP%]{width:94px;height:94px;min-width:94px;min-height:94px}.select-number-error.from-container.has-title[_ngcontent-%COMP%]   .select-number-error__image[_ngcontent-%COMP%]{width:180px;height:180px;min-width:180px;min-height:180px}}"],changeDetection:0});}}return r})();var Wr=(()=>{class r{transform(e,t,i=[],n="y-highlight"){if(!t)return e;let u=[],m=0,x=-1;for(let O=8;O<e.length;O++)/\d/.test(e[O])&&(e[O]===t[m]||i.includes(m)?(m===0&&(x=O),m++,m===t.length&&(u.push({start:x,end:O}),m=0,O=x,x=-1)):(m>0&&(O=x),m=0,x=-1));let M=[];if(t.length>1&&u.length>1){let O=w$1({},u[0]);for(let q=1;q<u.length;q++){let ue=w$1({},u[q]);O.end>=ue.start?(O.end=Math.max(O.end,ue.end),q===u.length-1&&M.push(O)):(M.push(O),O=w$1({},ue));}}else M=[...u];let _="",T=0;return M.forEach(({start:O,end:q})=>{_+=e.slice(T,O),_+=`<span class="${n}">`;for(let ue=O;ue<=q;ue++)!/\d/.test(e[ue])&&ue<q?(_+=`</span>${e[ue]}<span class="${n}">`,ue+1<=q&&/\d/.test(e[ue+1])&&(_+=e[ue+1],ue++)):_+=e[ue];_+="</span>",T=q+1;}),_+=e.slice(T),_}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275pipe=vn$1({name:"phoneNumberHighlight",type:r,pure:true});}}return r})();var Kr=(()=>{class r extends p{constructor(){super(...arguments),this.phoneMask={mask:"+7 (000) 000-00-00"},this.clickItem=new at$1;}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-list-item"]],inputs:{number:"number",selected:"selected",pending:"pending",disabled:"disabled",searchValue:"searchValue",radioMode:"radioMode"},outputs:{clickItem:"clickItem"},features:[MI],decls:8,vars:18,consts:[[1,"select-number-list-item",3,"click"],[1,"select-number-list-item__checkbox"],[1,"select-number-list-item__value",3,"innerHTML"],[1,"select-number-list-item__price"]],template:function(t,i){t&1&&(Pp(0,"div",0),FE("click",function(){return i.clickItem.emit()}),EE(1,"div",1),Pp(2,"p",2),GO(3,"imask"),GO(4,"phoneNumberHighlight"),PO(5),Lp(),Pp(6,"span",3),PO(7),Lp()()),t&2&&(cE("selected",i.selected)("pending",i.pending)("disabled",i.disabled)("radio-mode",i.radioMode),eO(2),aE("innerHTML",QO(4,14,YO(3,11,i.number.value,i.phoneMask),i.searchValue,i.number.replaceIndexes),YR),eO(3),$p(" ",i.number.highlightReplace," "),eO(2),$p(" ",i.number.category?i.number.category+" \u20BD":"\u0411\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"," "));},dependencies:[ur,Wr],styles:['.select-number-list-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;width:100%;border-top:1px solid var(--baseX);padding:16px 8px;column-gap:16px;align-items:center;cursor:pointer;transition:all .2s ease}.select-number-list-item__checkbox[_ngcontent-%COMP%]{border:2px solid var(--base3);background:transparent;border-radius:6px;position:relative;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:all .2s ease;width:24px;height:24px;min-width:24px;min-height:24px}.select-number-list-item__checkbox[_ngcontent-%COMP%]:before{content:url("./media/check-bold-QFDFVZLZ.svg");transform:translate(40px);height:16px;width:16px;transition:all .2s ease}.radio-mode[_ngcontent-%COMP%] > .select-number-list-item__checkbox[_ngcontent-%COMP%]{border-radius:50%}.radio-mode[_ngcontent-%COMP%] > .select-number-list-item__checkbox[_ngcontent-%COMP%]:before{content:initial}.selected[_ngcontent-%COMP%] > .select-number-list-item__checkbox[_ngcontent-%COMP%]{background:var(--main);border-color:var(--main)}.selected[_ngcontent-%COMP%] > .select-number-list-item__checkbox[_ngcontent-%COMP%]:before{transform:translate(0)}.selected.radio-mode[_ngcontent-%COMP%] > .select-number-list-item__checkbox[_ngcontent-%COMP%]{background:var(--base0);border-width:6px}.disabled[_ngcontent-%COMP%] > .select-number-list-item__checkbox[_ngcontent-%COMP%]{background:var(--baseX);border-color:var(--base3);cursor:not-allowed}.select-number-list-item__value[_ngcontent-%COMP%]{text-align:left;white-space:nowrap;font-size:16px;line-height:24px;font-weight:400}.select-number-list-item__price[_ngcontent-%COMP%]{font-size:16px;line-height:22px;font-weight:600}.select-number-list-item.selected[_ngcontent-%COMP%]{background:var(--ss2)}.select-number-list-item.disabled[_ngcontent-%COMP%]{color:var(--content-secondary)}.select-number-list-item.pending[_ngcontent-%COMP%]{background:var(--ss2)}.select-number-list-item.pending.selected[_ngcontent-%COMP%]{background:transparent}@media (max-width: 992px){.select-number-list-item[_ngcontent-%COMP%]:last-child{border-radius:0 0 8px 8px}}'],changeDetection:0});}}return r})();var ma=(r,o)=>o.value;function da(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-list-item",5),FE("clickItem",function(){let i=FR(e).$implicit,n=MO();return kR(n.toggleNumber(i))}),Lp();}if(r&2){let e=o.$implicit,t=MO();aE("number",e)("selected",t.selectedNumberValues.includes(e.value))("pending",e.value===t.processingNumber)("disabled",t.pending||!t.selectedNumberValues.includes(e.value)&&t.selectedNumberValues.length===t.maxCount&&!t.radioMode)("searchValue",t.searchValue)("radioMode",t.radioMode);}}function _a(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-load-more-button",6),FE("clickButton",function(){FR(e);let i=MO();return kR(i.loadMoreClick.emit())}),Lp();}if(r&2){let e=MO();aE("disabled",e.pending||e.loadMoreDisabled);}}var Qr=(()=>{class r extends p{constructor(){super(...arguments),this._selectNumberService=D(De),this._analyticsService=D(xe),this._selectedNumbers=[],this.phoneMask={mask:"+7 (000) 000-00-00"},this.position="top",this._lastScrollTop=0,this.loadMoreClick=new at$1,this.scrollDirectionChanged=new at$1;}set selectedNumbers(e){this._selectedNumbers=e;}get selectedNumbers(){return this._selectedNumbers}get selectedNumberValues(){return this._selectedNumbers.map(e=>e.value)}ngAfterViewInit(){this._initScrollListener();}toggleNumber(e,t=false){if(!t){let i=this._selectNumberService.selectedPhoneNumbers,n=!i.some(u=>u.value===e.value);this._analyticsService.toggleNumber(e.category,n,i.length+(n?1:-1));}this._selectNumberService.toggleNumber(e);}onClickUpButton(){this._analyticsService.clickScrollToTop(),this.scrollbarRef.scrollTo({top:0,duration:500});}_initScrollListener(){this.scrollbarRef&&this.scrollbarRef.scrolled.pipe(Hu(this._onDestroy$)).subscribe(e=>{this._emitScrollPosition(e.target);});}_emitScrollPosition(e){if(!this.scrollbarRef)return;let t=100,i=e.scrollTop,n=e.scrollHeight-e.clientHeight;i>this._lastScrollTop+t?this.scrollDirectionChanged.emit("down"):i<this._lastScrollTop-t&&this.scrollDirectionChanged.emit("up"),Math.abs(i-this._lastScrollTop)>t&&(this._lastScrollTop=i),i<=t?this.position="top":i>=n-t?this.position="bottom":this.position="center";}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-list"]],viewQuery:function(t,i){if(t&1&&NO(mr$1,5),t&2){let n;AO(n=RO())&&(i.scrollbarRef=n.first);}},inputs:{numbers:"numbers",maxCount:"maxCount",processingNumber:"processingNumber",searchValue:"searchValue",pending:"pending",radioMode:"radioMode",isMobile:"isMobile",loadMoreHide:"loadMoreHide",loadMoreDisabled:"loadMoreDisabled",selectedNumbers:"selectedNumbers"},outputs:{loadMoreClick:"loadMoreClick",scrollDirectionChanged:"scrollDirectionChanged"},features:[BO([n$1]),MI],decls:6,vars:4,consts:[[1,"select-number-list",3,"autoHeightDisabled"],[1,"select-number-list__item",3,"number","selected","pending","disabled","searchValue","radioMode"],[3,"disabled"],[1,"select-number-list__up",3,"click"],["svgIcon","arrow-outline"],[1,"select-number-list__item",3,"clickItem","number","selected","pending","disabled","searchValue","radioMode"],[3,"clickButton","disabled"]],template:function(t,i){t&1&&(Pp(0,"ng-scrollbar",0),CO(1,da,1,6,"yota-select-number-list-item",1,ma),LI(3,_a,1,1,"yota-select-number-load-more-button",2),Lp(),Pp(4,"div",3),FE("click",function(){return i.onClickUpButton()}),EE(5,"y-icon",4),Lp()),t&2&&(aE("autoHeightDisabled",false),eO(),bO(i.numbers),eO(2),EO((!i.searchValue||!i.isMobile)&&!i.loadMoreHide?3:-1),eO(),cE("show",i.position==="center"));},dependencies:[zt,Kr,xi,_r,mr$1],styles:["[_nghost-%COMP%]{overflow:hidden;position:relative}[_nghost-%COMP%]     .select-number-list{--scrollbar-size: 4px;--scrollbar-hover-size: 10px;--scrollbar-thumb-color: var(--main);--scrollbar-thumb-hover-color: var(--main);--scrollbar-track-color: var(--baseX);--scrollbar-border-radius: 4px;--scrollbar-padding: 2px;--scrollbar-offset: 4px;--native-scrollbar-size: 0px}[_nghost-%COMP%]     .select-number-list .ng-scroll-content{padding-inline:24px}[_nghost-%COMP%]     .select-number-list .ng-scrollbar-wrapper[deactivated=false][dir=ltr]>scrollbar-y.scrollbar-control{right:8px}[_nghost-%COMP%]     .select-number-list .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control{height:calc(100% - 16px)}[_nghost-%COMP%]     .select-number-list .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track{height:100%}[_nghost-%COMP%]     .select-number-list .ng-scrollbar.vertical{right:var(--scrollbar-offset);width:var(--scrollbar-size)}[_nghost-%COMP%]     .select-number-list .ng-scrollbar.vertical:hover{width:var(--scrollbar-hover-size)}@media (max-width: 992px){[_nghost-%COMP%]     .select-number-list .ng-scroll-content{padding-inline:12px}[_nghost-%COMP%]     .select-number-list .ng-scrollbar-wrapper[deactivated=false][dir=ltr]>scrollbar-y.scrollbar-control{right:2px}[_nghost-%COMP%]     .select-number-list .ng-native-scrollbar-hider.ng-scroll-viewport{right:0!important}}.select-number-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;position:relative}.select-number-list__up[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:7px;background:var(--main);border-radius:50%;position:absolute;z-index:2;right:24px;bottom:16px;transform:translate(56px);cursor:pointer;transition:transform .2s ease}.select-number-list__up[_ngcontent-%COMP%]   .y-icon[_ngcontent-%COMP%]{width:16px;height:16px;min-width:16px;min-height:16px}.select-number-list__up[_ngcontent-%COMP%]   .y-icon[_ngcontent-%COMP%]     svg path{fill:var(--base0)}.select-number-list__up.show[_ngcontent-%COMP%]{transform:translate(0)}@media (max-width: 992px){.select-number-list[_ngcontent-%COMP%]{padding-right:0;width:auto}}"],changeDetection:0});}}return r})();var ha=()=>({mask:"0000000"});function fa(r,o){if(r&1){let e=_O();Pp(0,"yota-field-state",5),FE("clear",function(){FR(e);let i=MO();return kR(i.control.setValue(""))}),Lp();}if(r&2){let e=MO(),t=kO(5);aE("state",e.controlState.CLEAR)("inputControl",t);}}var Xr=(()=>{class r extends p{constructor(){super(...arguments),this.controlState=c,this.focused=VR(),this.blurred=VR(),this.enterPressed=VR();}onEnter(e){if(e.key!=="Enter"||!this.control.value)return;e.preventDefault();let t=e.target;this.enterPressed.emit(t);}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-search"]],inputs:{control:"control"},outputs:{focused:"focused",blurred:"blurred",enterPressed:"enterPressed"},features:[MI],decls:7,vars:5,consts:[["inputRef","yInput"],[1,"select-number-search"],["yPrefix","","svgIcon","search-outline"],["yInput","","type","tel",3,"focus","blur","keydown","formControl","unmask","imask"],["ySuffix","",3,"state","inputControl"],["ySuffix","",3,"clear","state","inputControl"]],template:function(t,i){if(t&1){let n=_O();Pp(0,"y-form-field-bordered",1)(1,"y-label"),PO(2,"\u0412\u0432\u0435\u0434\u0438 \u0446\u0438\u0444\u0440\u044B"),Lp(),EE(3,"y-icon",2),Pp(4,"input",3,0),FE("focus",function(){return FR(n),kR(i.focused.emit())})("blur",function(){return FR(n),kR(i.blurred.emit())})("keydown",function(m){return FR(n),kR(i.onEnter(m))}),Lp(),LI(6,fa,1,2,"yota-field-state",4),Lp();}if(t&2){let n=kO(5);eO(4),aE("formControl",i.control)("unmask",true)("imask",HO(4,ha)),eO(2),EO(n.focused&&n.value?6:-1);}},dependencies:[It,Ty,ar,cd,hd,gd,zt,x$1,An$1,Ge,yn$1,Mn$1,Tt],styles:["[_nghost-%COMP%]{padding-inline:24px;width:100%}@media (max-width: 992px){[_nghost-%COMP%]{padding:0 12px 16px}}[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-subscript-wrapper{display:none}[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-prefix{padding:4px}[_nghost-%COMP%]     .y-form-field-bordered-disabled .y-icon svg path{fill:var(--base3)}[_nghost-%COMP%]     .y-form-field-bordered-disabled .y-form-field-bordered-label{transition:none}"],changeDetection:0});}}return r})();var ga=["bottomSheet"];function Ca(r,o){if(r&1){let e=_O();Pp(0,"y-icon",9),FE("click",function(){FR(e);let i=MO();return kR(i.onClickCloseDialog())}),Lp();}}function va(r,o){if(r&1&&(Pp(0,"div",10),EE(1,"yota-select-number-error",11),GO(2,"async"),GO(3,"async"),GO(4,"async"),Lp()),r&2){let e=MO(2);eO(),aE("data",e.error.data)("secondaryButtonDisabled",!!ZO(2,3,e.loading$)||!!ZO(3,5,e.pending$)||!!ZO(4,7,e.loadMoreDisabled$))("fromContainer",false);}}function ba(r,o){if(r&1&&(EE(0,"yota-select-number-categories",14),GO(1,"async")),r&2){let e=MO(3);aE("categories",o)("pending",!!ZO(1,2,e.pending$));}}function ya(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-list",16),GO(1,"async"),GO(2,"async"),GO(3,"async"),GO(4,"async"),GO(5,"async"),FE("loadMoreClick",function(){FR(e);let i=MO(4);return kR(i.loadMoreNumbers())})("scrollDirectionChanged",function(i){FR(e);let n=MO(4);return kR(n.onChangeListScrollDirection(i))}),Lp();}if(r&2){let e=MO(),t=MO(3);aE("numbers",e)("maxCount",t.config.selectedNumbersMaxCount)("selectedNumbers",t.selectedNumbers)("processingNumber",ZO(1,10,t.processingNumber$))("searchValue",t.searchControl.value)("pending",!!ZO(2,12,t.pending$))("radioMode",!!t.config.radioMode)("isMobile",!!ZO(3,14,t.isMobile$))("loadMoreHide",!!ZO(4,16,t.loadMoreHide$))("loadMoreDisabled",!!ZO(5,18,t.loadMoreDisabled$));}}function Sa(r,o){r&1&&LI(0,ya,6,20,"yota-select-number-list",15),r&2&&EO(o.length?0:-1);}function xa(r,o){if(r&1&&(EE(0,"yota-select-number-error",11),GO(1,"async"),GO(2,"async"),GO(3,"async")),r&2){let e=MO(3);aE("data",e.error.data)("secondaryButtonDisabled",!!ZO(1,3,e.loading$)||!!ZO(2,5,e.pending$)||!!ZO(3,7,e.loadMoreDisabled$))("fromContainer",true);}}function Ea(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-search",12),FE("focused",function(){FR(e);let i=MO(2);return kR(i.onFocusSearch())})("blurred",function(){FR(e);let i=MO(2);return kR(i.onBlurSearch())})("enterPressed",function(i){FR(e);let n=MO(2);return kR(n.onEnterPressedSearch(i))}),Lp(),Pp(1,"div",13),LI(2,ba,2,4,"yota-select-number-categories",14),GO(3,"async"),LI(4,Sa,1,1),GO(5,"async"),LI(6,xa,4,9,"yota-select-number-error",11),Lp();}if(r&2){let e,t,i=MO(2);aE("control",i.searchControl),eO(),cE("collapsed-categories",i.categoriesCollapsed),eO(),EO((e=!i.config.radioMode&&ZO(3,6,i.categories$))?2:-1,e),eO(2),EO((t=ZO(5,8,i.phoneNumbers$))?4:-1,t),eO(2),EO(i.error.state==="data-error"&&i.error.data?6:-1);}}function Ma(r,o){if(r&1&&LI(0,va,5,9,"div",10)(1,Ea,7,10),r&2){let e=MO();EO(e.error.state==="dialog-error"&&e.error.data?0:-1),eO(),EO(e.error.state!=="dialog-error"?1:-1);}}function Da(r,o){r&1&&EE(0,"y-spinner",5),r&2&&aE("strokeWidth",3)("diameter",80);}function Oa(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-load-more-button",17),GO(1,"async"),GO(2,"async"),GO(3,"async"),FE("clickButton",function(){FR(e);let i=MO();return kR(i.loadMoreNumbers())}),Lp();}if(r&2){let e=MO();aE("disabled",!!ZO(1,1,e.loading$)||!!ZO(2,3,e.pending$)||!!ZO(3,5,e.loadMoreDisabled$));}}function Na(r,o){if(r&1){let e=_O();Pp(0,"yota-select-number-cart",18),GO(1,"async"),GO(2,"async"),FE("removeNumber",function(i){FR(e);let n=MO();return kR(n.deleteNumberFromCart(i))})("clickConfirmButton",function(i){FR(e);let n=MO();return kR(n.onClickConfirm(i))}),Lp();}if(r&2){let e=MO();aE("selectedNumbers",e.selectedNumbers)("totalPrice",ZO(1,4,e.selectedPhoneNumbersTotal$))("pending",!!ZO(2,6,e.pending$))("hasError",e.error.state==="dialog-error");}}function Pa(r,o){if(r&1){let e=_O();Pp(0,"div",20)(1,"yota-select-number-confirm",21),GO(2,"async"),GO(3,"async"),FE("clickButton",function(i){FR(e);let n=MO(2);return kR(n.onClickConfirm(i))}),Lp()();}if(r&2){let e=MO(2);eO(),aE("buttonText",(e.config.buttonOrder==null?null:e.config.buttonOrder.text)||"")("disabled",!e.selectedNumbers.length||ZO(2,2,e.loading$)||ZO(3,4,e.pending$));}}function Ia(r,o){if(r&1){let e=_O();Pp(0,"yota-bottom-sheet",8,0)(2,"yota-select-number-cart",19),GO(3,"async"),GO(4,"async"),FE("removeNumber",function(i){FR(e);let n=MO();return kR(n.deleteNumberFromCart(i))})("clickConfirmButton",function(i){FR(e);let n=MO();return kR(n.onClickConfirm(i))})("toggleExpandAction",function(){FR(e);let i=MO();return kR(i.onChangeContent$.next())}),Lp(),LI(5,Pa,4,6,"div",20),Lp();}if(r&2){let e=MO();aE("contentChanged$",e.onChangeContent$),eO(2),aE("selectedNumbers",e.selectedNumbers)("totalPrice",ZO(3,7,e.selectedPhoneNumbersTotal$))("pending",!!ZO(4,9,e.pending$))("hasError",e.error.state==="data-error")("hideOrderButton",true),eO(3),EO(e.error.state!=="dialog-error"?5:-1);}}var yi=(()=>{class r extends p{constructor(){super(...arguments),this._selectNumberService=D(De),this._analyticsService=D(xe),this._bottomSheetService=D(Si),this._breakpointObserver=D(U),this._dialogService=D(mr),this._orderAnalyticsService=D(re),this._orderDataService=D(ve),this._stripHtmlTagsPipe=D(n$1),this._router=D(q),this.config=this._selectNumberService.config,this.searchControl=this._selectNumberService.searchControl,this.selectedNumbers=[],this.categoriesCollapsed=false,this.cartNumbersCollapsed=true,this.bottomSheetWasOpenedByScroll=false,this.loading$=this._selectNumberService.loading$,this.pending$=this._selectNumberService.pending$,this.loadMoreDisabled$=this._selectNumberService.loadMoreDisabled$,this.loadMoreHide$=this._selectNumberService.loadMoreHide$,this.categories$=this._selectNumberService.categories$,this.phoneNumbers$=this._selectNumberService.phoneNumbers$,this.processingNumber$=this._selectNumberService.processingNumber$,this.selectedPhoneNumbers$=this._selectNumberService.selectedPhoneNumbers$,this.selectedPhoneNumbersTotal$=this._selectNumberService.selectedPhoneNumbersTotal$,this.isNumbersEmptyBySearch$=new En$1(false),this.onChangeContent$=new X,this.isMobile$=this._breakpointObserver.observe("(max-width: 992px)").pipe(le(e=>e.matches)),this.errorsMap=new Map([[de.NO_INTERNET,{title:"\u041D\u0435\u0442 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F \u043A\xA0\u0441\u0435\u0442\u0438",description:"\u041F\u0440\u043E\u0432\u0435\u0440\u044C \u0441\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435 \u0438\xA0\u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439 \u0435\u0449\u0435\xA0\u0440\u0430\u0437",hideControls:true,button:{text:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C",action:()=>this._selectNumberService.fetchNumbers()}}],[de.NO_INTERNET_TECHNICAL,{title:"\u041F\u043E\u043A\u0430 \u0432\u044B\u0431\u043E\u0440 \u043D\u043E\u043C\u0435\u0440\u043E\u0432 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D \u043F\u043E \u0442\u0435\u0445\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u043C \u043F\u0440\u0438\u0447\u0438\u043D\u0430\u043C.",description:"\u0422\u044B \u043C\u043E\u0436\u0435\u0448\u044C \u0437\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u0438 \u043F\u043E\u0441\u043B\u0435 \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0441\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440 \u043D\u0430 \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u0432 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u043E\u043C \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0438.",hideControls:true,button:{text:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",action:()=>this._selectNumberService.fetchNumbers()},buttonSecondary:{text:this.config.buttonOrder?.text||"\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C",action:()=>{this._analyticsService.errorTechnicalClickButton(this.config.buttonOrder?.text||"\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C"),this._router.navigate([this.config.buttonOrder?.href||"voice/order-sim"]);}}}],[de.NUMBERS_EXPIRED,{title:"\u0412\u0440\u0435\u043C\u044F \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u043E",description:"\u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u044B \u0438\u0437\xA0\u0442\u0432\u043E\u0435\u0433\u043E \u0441\u043F\u0438\u0441\u043A\u0430. \u0422\u044B \u043C\u043E\u0436\u0435\u0448\u044C \u043E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437 \u0431\u0435\u0437\xA0\u043D\u0438\u0445 \u0438\u043B\u0438\xA0\u0432\u044B\u0431\u0440\u0430\u0442\u044C \u0434\u0440\u0443\u0433\u0438\u0435",hideControls:true,button:{text:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0435\u0449\u0435",action:()=>{this._selectNumberService.continueSelectAfterDateExpired(),this._analyticsService.errorCommonClickButton("\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0435\u0449\u0435");}},buttonSecondary:{text:"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437",action:()=>{this._selectNumberService.reset(),this._selectNumberService.closeDialog(Et.ERROR_BUTTON),this._analyticsService.errorCommonClickButton("\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437");}}}],[de.NO_NUMBERS_BY_SEARCH,{svgIcon:"fail-cat",description:'\u0421\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C. \u041D\u0430\u0436\u043C\u0438 \u043A\u043D\u043E\u043F\u043A\u0443,<br class="g-hidden-mobile"/> \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A',hideControls:false,buttonSecondary:{text:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0440\u0443\u0433\u0438\u0435 \u043D\u043E\u043C\u0435\u0440\u0430",action:()=>{this.loadMoreNumbers(),this._analyticsService.errorSearchClickLoadMore();},canDisable:true,hideOnMobile:true}}],[de.NO_NUMBERS_BY_CATEGORY,{svgIcon:"fail-bottle",title:"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E",description:"\u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E \u0438\u043B\u0438\xA0\u0432\u0432\u0435\u0434\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0446\u0438\u0444\u0440\u044B",hideControls:false}]]),this.showCaptcha$=this._selectNumberService.showCaptcha$,this.isNumbersNotEmpty$=Zh([this.isMobile$,this.isNumbersEmptyBySearch$]).pipe(le(([e,t])=>e&&!t)),this._error$=this._selectNumberService.error$.pipe(Ou(),le(e=>{if(!e)return this.isNumbersEmptyBySearch$.next(false),{state:"no-error"};e===de.NO_NUMBERS_BY_SEARCH&&this.isNumbersEmptyBySearch$.next(true);let t=this.errorsMap.get(e);return {state:t?.hideControls?"dialog-error":"data-error",data:t}}));}ngOnInit(){this._initBottomSheetStateHandler(),this._initCaptchaDialogObserver(),this.selectedPhoneNumbers$.pipe(Hu(this._onDestroy$)).subscribe(e=>{this.selectedNumbers=e;}),this._initErrorAnalyticsObserver(),this._error$.pipe(Hu(this._onDestroy$)).subscribe(e=>{this.error=e;});}ngAfterViewInit(){this._initChangeContentEmitter(),this._initSearchDisableHandler();}toggleCategory(e){this._analyticsService.toggleCategory(e.name,!e.selected),this._selectNumberService.toggleCategory(e.value);}toggleNumber(e,t=false){if(!t){let i=this._selectNumberService.selectedPhoneNumbers,n=!i.some(u=>u.value===e.value);this._analyticsService.toggleNumber(e.category,n,i.length+(n?1:-1));}this._selectNumberService.toggleNumber(e);}loadMoreNumbers(){this._breakpointObserver.isMatched(["(max-width: 992px)"])&&this._bottomSheetService.openMin(),this._selectNumberService.loadMoreNumbers();}deleteNumberFromCart(e){this._analyticsService.deleteNumberFromCart(this._selectNumberService.selectedPhoneNumbersLength-1),this.toggleNumber(e,true);}onClickConfirm(e){if(this.config.isDialog){this._selectNumberService.closeDialog(Et.CONFIRM_BUTTON);return}let t=this._selectNumberService.selectedPhoneNumbers;this._orderAnalyticsService.onConfirmBeautifulNumbers(yt.getTotalCost(t),t.length,e,this._orderDataService.orderMetaInfo$.value),this._router.navigate([this.config.buttonOrder?.href||"voice/order-sim"]);}onFocusSearch(){this._bottomSheetService.hide();}onBlurSearch(){this._breakpointObserver.isMatched(["(max-width: 992px)"])&&(this.config.radioMode?this._bottomSheetService.openFull():this._bottomSheetService.openMin(),this.isNumbersEmptyBySearch$.value&&this.loadMoreNumbers());}onEnterPressedSearch(e){this.loadMoreDisabled$.value||(this.loadMoreNumbers(),this.pending$.pipe(it(t=>!t),wt(1),Hu(this._onDestroy$)).subscribe(()=>{e.focus();}));}onClickCloseDialog(){this._analyticsService.closeDialogManual(this.config.title,"\u041A\u0440\u0435\u0441\u0442\u0438\u043A"),this._selectNumberService.closeDialog(Et.CROSS_BUTTON);}onChangeListScrollDirection(e){this.categoriesCollapsed=e==="down",!(this.bottomSheetWasOpenedByScroll||!this._breakpointObserver.isMatched(["(max-width: 992px)"]))&&(this.openBottomSheetFull(),this.bottomSheetWasOpenedByScroll=true);}openBottomSheetFull(){this._bottomSheetService.openFull();}openCaptchaDialog(e){this._dialogService.open(Yr,{panelClass:"y-dialog-captcha",backdropClass:"y-dialog-backdrop-blurred",disableClose:true,width:"calc(100% - 40px)",maxWidth:"568px",hasBackdrop:true,id:bi.CAPTCHA}).afterClosed().pipe(wt(1),it(Boolean)).subscribe(()=>{e&&e();});}_initBottomSheetStateHandler(){this.isMobile$.pipe(Ru(10),Uu(()=>this.onChangeContent$.next()),Hu(this._onDestroy$)).subscribe(e=>{if(!e){this._bottomSheetService.hide();return}this.cartNumbersCollapsed=true,this.config.radioMode?this._bottomSheetService.openFull():this._bottomSheetService.openMin();});}_initCaptchaDialogObserver(){this.showCaptcha$.pipe(it(()=>!this._dialogService.getDialogById(bi.CAPTCHA)),Hu(this._onDestroy$)).subscribe(e=>{this.openCaptchaDialog(e);});}_initChangeContentEmitter(){Zh([this.categories$,this.selectedPhoneNumbers$,this._selectNumberService.searchControl.valueChanges.pipe(Vu(""))]).pipe(Ru(1),Hu(this._onDestroy$)).subscribe(()=>{this.onChangeContent$.next();});}_initSearchDisableHandler(){this.pending$.pipe(Hu(this._onDestroy$)).subscribe(e=>{e?this.searchControl.disable({emitEvent:false}):this.searchControl.enable({emitEvent:false});});}_initErrorAnalyticsObserver(){this._selectNumberService.error$.pipe(it(Boolean),Ou(),Hu(this._onDestroy$)).subscribe(e=>{let t=this.errorsMap.get(e);if(t)switch(e){case de.NO_NUMBERS_BY_CATEGORY:case de.NO_NUMBERS_BY_SEARCH:{let i=t.title?this._stripHtmlTagsPipe.transform(t.title):null,n=t.description?this._stripHtmlTagsPipe.transform(t.description):null,u=this._selectNumberService.categories.filter(m=>m.selected).map(m=>m.name);this._analyticsService.errorSearch(u,i,n);}break;case de.NO_INTERNET:case de.NUMBERS_EXPIRED:this._analyticsService.errorCommon(t?.title);break;case de.NO_INTERNET_TECHNICAL:this._analyticsService.errorTechnical(t?.title);break;}});}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275cmp=hO({type:r,selectors:[["yota-select-number-dialog"]],viewQuery:function(t,i){if(t&1&&NO(ga,5),t&2){let n;AO(n=RO())&&(i.bottomSheet=n.first);}},features:[BO([n$1]),MI],decls:16,vars:30,consts:[["bottomSheet",""],[1,"select-number-dialog"],["svgIcon","close-light",1,"select-number-dialog__close"],[1,"select-number-dialog__title"],[1,"select-number-dialog__content"],[1,"select-number-dialog__loader",3,"strokeWidth","diameter"],[1,"select-number-dialog__load-more-button",3,"disabled"],[1,"select-number-dialog__cart",3,"selectedNumbers","totalPrice","pending","hasError"],[3,"contentChanged$"],["svgIcon","close-light",1,"select-number-dialog__close",3,"click"],[1,"select-number-dialog__error-wrapper"],[3,"data","secondaryButtonDisabled","fromContainer"],[3,"focused","blurred","enterPressed","control"],[1,"select-number-dialog__container"],[3,"categories","pending"],[3,"numbers","maxCount","selectedNumbers","processingNumber","searchValue","pending","radioMode","isMobile","loadMoreHide","loadMoreDisabled"],[3,"loadMoreClick","scrollDirectionChanged","numbers","maxCount","selectedNumbers","processingNumber","searchValue","pending","radioMode","isMobile","loadMoreHide","loadMoreDisabled"],[1,"select-number-dialog__load-more-button",3,"clickButton","disabled"],[1,"select-number-dialog__cart",3,"removeNumber","clickConfirmButton","selectedNumbers","totalPrice","pending","hasError"],[1,"select-number-dialog__cart",3,"removeNumber","clickConfirmButton","toggleExpandAction","selectedNumbers","totalPrice","pending","hasError","hideOrderButton"],["hiding",""],[3,"clickButton","buttonText","disabled"]],template:function(t,i){t&1&&(Pp(0,"div",1),GO(1,"async"),GO(2,"async"),LI(3,Ca,1,0,"y-icon",2),Pp(4,"h3",3),PO(5),Lp(),Pp(6,"div",4),LI(7,Ma,2,2),GO(8,"async"),LI(9,Da,1,2,"y-spinner",5),Lp(),LI(10,Oa,4,7,"yota-select-number-load-more-button",6),GO(11,"async"),LI(12,Na,3,8,"yota-select-number-cart",7),GO(13,"async"),Lp(),LI(14,Ia,6,11,"yota-bottom-sheet",8),GO(15,"async")),t&2&&(vO("--select-number-bottom-sheet-height: "+((i.bottomSheet==null?null:i.bottomSheet.visibleHeight)||0)+"px;--select-number-content-transition: "+(i.bottomSheet!=null&&i.bottomSheet.isSwiping?"none":"max-height 300ms ease")),cE("loading",ZO(1,18,i.loading$))("pending",ZO(2,20,i.pending$))("hide-controls",i.error.data==null?null:i.error.data.hideControls)("radio-mode",i.config.radioMode)("has-search-value",i.searchControl.value),eO(3),EO(i.config.isDialog?3:-1),eO(2),HE(i.config.title),eO(2),EO(ZO(8,22,i.loading$)===false?7:9),eO(3),EO(i.searchControl.value&&ZO(11,24,i.isNumbersNotEmpty$)?10:-1),eO(2),EO(i.config.isDialog&&ZO(13,26,i.isMobile$)===false||!i.config.isDialog&&!(i.error.data!=null&&i.error.data.hideControls)?12:-1),eO(2),EO(i.config.isDialog&&ZO(15,28,i.isMobile$)?14:-1));},dependencies:[tC,zt,ql,Gr,Xr,jr,zr,Qr,Ei,xi,qr],styles:['@media (max-width: 767px){[_nghost-%COMP%]     yota-popup{margin-inline:0}}.select-number-dialog[_ngcontent-%COMP%]{border-radius:24px;background:var(--base4);padding:40px;width:100%;height:100%;margin-inline:auto;position:relative;display:grid;grid-template-areas:"title title" "content cart";grid-template-columns:1fr 372px;grid-template-rows:auto 1fr;gap:24px}.select-number-dialog__close[_ngcontent-%COMP%]{position:absolute;top:32px;right:40px;cursor:pointer;width:32px;height:32px;min-width:32px;min-height:32px}.select-number-dialog__title[_ngcontent-%COMP%]{grid-area:title;font-size:36px;line-height:46px;font-weight:600}.select-number-dialog__content[_ngcontent-%COMP%]{grid-area:content;background:var(--base0);display:flex;flex-direction:column;padding-top:24px;border-radius:20px;position:relative;overflow:hidden;height:fit-content;max-height:100%}.safari[_ngcontent-%COMP%]   .select-number-dialog__content[_ngcontent-%COMP%]{height:auto!important}.loading[_ngcontent-%COMP%] > .select-number-dialog__content[_ngcontent-%COMP%]{height:100%}.hide-controls[_ngcontent-%COMP%] > .select-number-dialog__content[_ngcontent-%COMP%]{height:100%}.select-number-dialog__container[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr;height:100%;row-gap:24px;overflow:hidden}.radio-mode[_ngcontent-%COMP%]   .select-number-dialog__container[_ngcontent-%COMP%]{margin-top:24px;row-gap:0}.select-number-dialog__loader[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.select-number-dialog__cart[_ngcontent-%COMP%]{grid-area:cart}@media (max-width: 1440px){.select-number-dialog[_ngcontent-%COMP%]{padding-inline:24px}}@media (max-width: 1248px){.select-number-dialog[_ngcontent-%COMP%]{padding:24px;width:auto}.select-number-dialog__close[_ngcontent-%COMP%]{top:24px;right:24px}.select-number-dialog__title[_ngcontent-%COMP%]{font-size:32px;line-height:32px;font-weight:600}}@media (max-width: 992px){.select-number-dialog[_ngcontent-%COMP%]{margin:0;max-height:100%;border-radius:0;background:var(--baseX);display:flex;flex-direction:column;row-gap:16px;padding:24px 16px;overflow:hidden}.select-number-dialog__close[_ngcontent-%COMP%]{top:24px;right:16px;width:24px;height:24px;min-width:24px;min-height:24px}.select-number-dialog__title[_ngcontent-%COMP%]{font-size:18px;line-height:24px;font-weight:600}.select-number-dialog__content[_ngcontent-%COMP%]{padding-block:12px 0;height:100%;max-height:calc(100% - var(--select-number-bottom-sheet-height) - 32px);transition:var(--select-number-content-transition)}.has-search-value[_ngcontent-%COMP%] > .select-number-dialog__content[_ngcontent-%COMP%]{height:auto;max-height:calc(100% - var(--select-number-bottom-sheet-height) - 32px - 64px)}.select-number-dialog__container[_ngcontent-%COMP%]{display:grid;grid-template-rows:44px 1fr;padding-inline:0;row-gap:0;transition:grid-template-rows .2s ease}.select-number-dialog__container.collapsed-categories[_ngcontent-%COMP%]{grid-template-rows:0px 1fr}.select-number-dialog__load-more-button[_ngcontent-%COMP%]     .select-number-load-more-button{margin:0;width:100%;max-width:100%;padding-block:13px}}'],changeDetection:0});}}return r})();var te=class r extends at{static{this.beautifulNumberFormGroup=new I({numbers:new W([],{nonNullable:true})});}constructor(o,e){super(),this._stepState$=o,this._transitions=e,this.component=yi,this.name=Q.BEAUTIFUL_NUMBER,this.title="\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",this.stepState$=this._stepState$,this.transitions=this._transitions;}getWriteData(){let o=r.beautifulNumberFormGroup.controls.numbers.value.length;return o?`<span>${o}</span>`:""}showValidateErrors(){}setContext(){this.stateContext?.next({name:Q.BEAUTIFUL_NUMBER,numbers:r.beautifulNumberFormGroup.controls.numbers.value});}getContext(){return this.stateContext?.value}getButtonState(){return we.NEXT}};var re=(()=>{class r{constructor(){this._analyticsService=D(M),this._storeService=D(D$1),this.goodId="",this.goodName="",this.goodPrice$=new En$1(0),this.goodProductType="",this.orderNumber="",this.receivingWay$=new En$1(O.Delivery),this.deliveryType$=new En$1(""),this.goodCount$=new En$1(1),this.categories$=new En$1([]);}get _isSamokat(){return this.receivingWay$.value===O.Delivery&&this.deliveryType$.value===N.Samokat}getDeliveryInfo(e,t){let i=`${this._getDeliveryType()}/${this._getDeliveryWay()}/${this.goodName}[${this.goodCount$.value}]`;return e&&t&&(i+=`${e}/${t}`),i}onCitizenshipChange(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`${this.getDeliveryInfo()} / ${e}`},O$1.ORDER_FORM_SELECT_CITIZENSHIP);}onConfirmBeautifulNumbers(e,t,i,n){let u={add:{products:this._generateEcommerceProduct(n)}};this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:(e??"0")+" \u20BD / "+t+" / "+i||"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",ecommerce:u},O$1.SELECT_NUMBER_DIALOG_CLICK_CONFIRM);}orderPaymentStep(e,t,i){let n={checkout:{actionField:{step:4,action:"checkout"},products:this._generateEcommerceProduct(e||null)}},u=p$1.isIframe()?`${this.getDeliveryInfo(t,i)}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo(t,i);this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${u}/${this.goodId}`,ecommerce:n},O$1.ORDER_PAYMENT_STEP);}clickDelivery(e){let t={checkout:{actionField:{step:1,action:"checkout"},products:this._generateEcommerceProduct(e)}},i=p$1.isIframe()?`${this.getDeliveryInfo()}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${i}/${this.goodId}`,ecommerce:t},O$1.CLICK_DELIVERY_WAY);}orderNoReceivingWay(e,t){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`\u041D\u0435\u0442 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u0438 \u0441\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437\u0430/${e}/${t}`},O$1.ORDER_NO_RECEIVING_WAY);}orderOtpFailed(e){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:e??"numberNotConfirmed"},O$1.ORDER_OTP_FAILED);}changeOrderAmount(){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()},O$1.CHANGE_ORDER_AMOUNT);}getCategoryNameById(e,t){return e?.find(n=>n.categoryId===t)?.name}clickOrderConfirm(e){let t={checkout:{actionField:{step:2,action:"checkout"},products:this._generateEcommerceProduct(e)}},i=p$1.isIframe()?`${this.getDeliveryInfo()}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${i}/\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437/${this.goodId}`,ecommerce:t},O$1.CLICK_ORDER_CONFIRM);}_generateEcommerceProduct(e){let t=[{id:this.goodId,name:this.goodName,price:this.goodPrice$.value,brand:this.goodName,category:this.getCategoryNameById(this.categories$.value,e?.dmsData.nomenclatures[0].categoryId),quantity:this.goodCount$.value}],i=te.beautifulNumberFormGroup.controls.numbers,n=i.value.reduce((m,x)=>m+x.category,0);return i.value.length&&t.push({id:"999999",name:"\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",price:n,brand:"\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",category:this.getCategoryNameById(this.categories$.value,e?.dmsData.nomenclatures[0].categoryId),quantity:i.value.length}),t}onEnteredName(){let e=this._getDeliveryType(),t=this._getDeliveryWay();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${e} / ${t} / ${this.goodName} [${this.goodCount$.value}]`},O$1.ORDER_ENTER_NAME);}onChooseSearchList(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e===ze.ON_MAP?"\u041D\u0430 \u043A\u0430\u0440\u0442\u0435":"\u0421\u043F\u0438\u0441\u043A\u043E\u043C"},O$1.ORDER_CLICK_PICKUP_LIST_VIEW);}onChoosePaymentType(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:(e===vt.CARD?"\u041A\u0430\u0440\u0442\u043E\u0439":"\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438")+" \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438"},O$1.ORDER_PAYMENT_TYPE);}pickUpHereEvent(e){let t={checkout:{actionField:{step:3,action:"checkout"},products:this._generateEcommerceProduct(e)}};this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()+"/\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C",ecommerce:t},O$1.PICKUP_HERE);}enterFormField(e,t,i,n){let u={checkout:{actionField:{step:3,action:"checkout"},products:this._generateEcommerceProduct(t)}};this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo(i,n),ecommerce:u},e);}onMnpControlChecked(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 Yota \u0441\u043E \u0441\u0432\u043E\u0438\u043C \u043D\u043E\u043C\u0435\u0440\u043E\u043C/${e?"\u0412\u043A\u043B":"\u0412\u044B\u043A\u043B"}`},O$1.ORDER_CLICK_MNP);}onEnterValidPhone(){let e=p$1.isIframe()?`${this.getDeliveryInfo()}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${e}/${this.goodId}`},O$1.PHONE_IS_VALID);}onCaptchaSuccess(){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()},O$1.RECAPTCHA_SUCCESS);}onOTPSuccess(){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()},O$1.CODE_SUCCESS);}onOpenMnpPopup(){this._analyticsService.pushDataLayer({event:E.ACTIONS},O$1.ORDER_MNP_POPUP_OPEN);}onCloseMnpPopup(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u0435\u0440\u0435\u0445\u043E\u0434\u0430 / ${e}`},O$1.ORDER_MNP_POPUP_CLOSE);}onError(e,t,i){if(!this.goodName||!e)return;let n=[this._getDeliveryType(),this._getDeliveryWay(),this.goodName,e,t,i];this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:n.join(" / ")},O$1.ORDER_ERROR);}onPickupError(e,t,i){if(!this.goodName||!e)return;let n=[this._getDeliveryType(),this._getDeliveryWay(),this.goodName,e,t,i];this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:n.join(" / ")},O$1.ORDER_ERROR);}orderDataError(e,t,i){this._analyticsService.pushDataLayer({event:E.NAVIGATIONS,event_param:`/ / / ${e} / ${t} / ${i}`},O$1.ORDER_FORM_OUT_OF_STOCK_ERROR_CLICK_BUTTON);}onClickBeautifulNumberStepButton(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:`\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 / ${e}`},O$1.ORDER_FORM_BEAUTIFUL_NUMBER_STEP_CLICK_BUTTON);}onShowPopup(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.ORDER_FORM_SHOW_POPUP);}onOpenBeautifulNumbersDialog(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.ORDER_FORM_OPEN_BEAUTIFUL_NUMBERS_DIALOG);}onSuccessOrder(e,t,i,n,u,m,x){let M={purchase:{actionField:{id:this.orderNumber,revenue:x},products:this._generateEcommerceProduct(m)}},_=[this._getDeliveryType(),this._getDeliveryWay(),`${this.goodName}[${this.goodCount$.value}]`,this.orderNumber,"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",e,t,i,n,u].filter(Boolean).join(" / ");this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:_,ecommerce:M},O$1.ORDER_SUCCESS);}onClickPersonalPromoButton(e,t,i){let n=[this._getDeliveryType(),this._getDeliveryWay(),`${this.goodName}[${this.goodCount$.value}]`,this.orderNumber,"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",`${e}/${t}`,i].filter(Boolean).join(" / ");this._analyticsService.pushDataLayer({event:E.NAVIGATIONS,event_param:n},O$1.ORDER_FORM_CLICK_PERSONAL_PROMO_BUTTON);}onClickOrderFeedbackButton(e,t,i){let n=[this._getDeliveryType(),this._getDeliveryWay(),`${this.goodName}[${this.goodCount$.value}]`,this.orderNumber,"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",`${e}/${t}`,i].filter(Boolean).join(" / ");this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:n},O$1.ORDER_SUCCESS_FEEDBACK_CLICK);}_getDeliveryType(){return this._isSamokat?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 30 \u043C\u0438\u043D\u0443\u0442":"\u041E\u0431\u044B\u0447\u043D\u0430\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430"}_getDeliveryWay(){return this.receivingWay$.value===O.Delivery?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C":"\u041F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438"}static{this.\u0275fac=function(t){return new(t||r)};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var Jr=(()=>{class r{constructor(e,t){this.config=e,this.http=t;}get rootUrl(){return this._rootUrl||this.config.rootUrl}set rootUrl(e){this._rootUrl=e;}static{this.\u0275fac=function(t){return new(t||r)(K(K$1),K(ve$1))};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac});}}return r})();var Ri=class{encodeKey(o){return encodeURIComponent(o)}encodeValue(o){return encodeURIComponent(o)}decodeKey(o){return decodeURIComponent(o)}decodeValue(o){return decodeURIComponent(o)}},ka=new Ri,Gt=class{constructor(o,e,t,i,n){this.name=o,this.value=e,this.options=t,this.options=t||{},(this.options.style===null||this.options.style===void 0)&&(this.options.style=i),(this.options.explode===null||this.options.explode===void 0)&&(this.options.explode=n);}serializeValue(o,e=","){if(o==null)return "";if(o instanceof Array)return o.map(t=>this.serializeValue(t).split(e).join(encodeURIComponent(e))).join(e);if(typeof o=="object"){let t=[];for(let i of Object.keys(o)){let n=o[i];n!=null&&(n=this.serializeValue(n).split(e).join(encodeURIComponent(e)),this.options.explode?t.push(`${i}=${n}`):(t.push(i),t.push(n)));}return t.join(e)}else return String(o)}},Ai=class extends Gt{constructor(o,e,t){super(o,e,t,"simple",false);}append(o){let e=this.value;e==null&&(e="");let t=this.options.style==="label"?".":"",i=this.options.explode?t===""?",":t:",",n=false;return this.options.style==="matrix"&&(t=`;${this.name}=`,this.options.explode&&typeof e=="object"&&(t=";",e instanceof Array?(e=e.map(u=>`${this.name}=${this.serializeValue(u,";")}`),e=e.join(";"),n=true):(e=this.serializeValue(e,";"),n=true))),e=t+(n?e:this.serializeValue(e,i)),o=o.replace(`{${this.name}}`,e),o=o.replace(`{${t}${this.name}${this.options.explode?"*":""}}`,e),o}serializeValue(o,e=","){var t=typeof o=="string"?encodeURIComponent(o):super.serializeValue(o,e);return t=t.replace(/%3D/g,"="),t=t.replace(/%3B/g,";"),t=t.replace(/%2C/g,","),t}},Fi=class extends Gt{constructor(o,e,t){super(o,e,t,"form",true);}append(o){if(this.value instanceof Array)if(this.options.explode)for(let e of this.value)o=o.append(this.name,this.serializeValue(e));else {let e=this.options.style==="spaceDelimited"?" ":this.options.style==="pipeDelimited"?"|":",";return o.append(this.name,this.serializeValue(this.value,e))}else if(this.value!==null&&typeof this.value=="object")if(this.options.style==="deepObject")for(let e of Object.keys(this.value)){let t=this.value[e];t!=null&&(o=o.append(`${this.name}[${e}]`,this.serializeValue(t)));}else if(this.options.explode)for(let e of Object.keys(this.value)){let t=this.value[e];t!=null&&(o=o.append(e,this.serializeValue(t)));}else {let e=[];for(let t of Object.keys(this.value)){let i=this.value[t];i!=null&&(e.push(t),e.push(i));}o=o.append(this.name,this.serializeValue(e));}else this.value!==null&&this.value!==void 0&&(o=o.append(this.name,this.serializeValue(this.value)));return o}},Bi=class extends Gt{constructor(o,e,t){super(o,e,t,"simple",false);}append(o){if(this.value!==null&&this.value!==void 0)if(this.value instanceof Array)for(let e of this.value)o=o.append(this.name,this.serializeValue(e));else o=o.append(this.name,this.serializeValue(this.value));return o}},qe=class{constructor(o,e,t){this.rootUrl=o,this.operationPath=e,this.method=t,this._path=new Map,this._query=new Map,this._header=new Map;}path(o,e,t){this._path.set(o,new Ai(o,e,t||{}));}query(o,e,t){this._query.set(o,new Fi(o,e,t||{}));}header(o,e,t){this._header.set(o,new Bi(o,e,t||{}));}body(o,e="application/json"){if(o instanceof Blob?this._bodyContentType=o.type:this._bodyContentType=e,this._bodyContentType==="application/x-www-form-urlencoded"&&o!==null&&typeof o=="object"){let t=[];for(let i of Object.keys(o)){let n=o[i];n instanceof Array||(n=[n]);for(let u of n){let m=this.formDataValue(u);m!==null&&t.push([i,m]);}}this._bodyContent=t.map(i=>`${encodeURIComponent(i[0])}=${encodeURIComponent(i[1])}`).join("&");}else if(this._bodyContentType==="multipart/form-data"){let t=new FormData;if(o!=null)for(let i of Object.keys(o)){let n=o[i];if(n instanceof Array)for(let u of n){let m=this.formDataValue(u);m!==null&&t.append(i,m);}else {let u=this.formDataValue(n);u!==null&&t.set(i,u);}}this._bodyContent=t;}else this._bodyContent=o;}formDataValue(o){return o==null?null:o instanceof Blob?o:typeof o=="object"?new Blob([JSON.stringify(o)],{type:"application/json"}):String(o)}build(o){o=o||{};let e=this.operationPath;for(let u of this._path.values())e=u.append(e);let t=this.rootUrl+e,i=new E$1({encoder:ka});for(let u of this._query.values())i=u.append(i);let n=new v;o.accept&&(n=n.append("Accept",o.accept));for(let u of this._header.values())n=u.append(n);return this._bodyContentType&&!(this._bodyContent instanceof FormData)&&(n=n.set("Content-Type",this._bodyContentType)),new A(this.method.toUpperCase(),t,this._bodyContent,{params:i,headers:n,responseType:o.responseType,reportProgress:o.reportProgress,context:o.context})}};function Mi(r,o,e,t){let i=new qe(o,Mi.PATH,"post");return e&&(i.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),i.body(e.body,"application/json")),r.request(i.build({responseType:"text",accept:"*/*",context:t})).pipe(it(n=>n instanceof _),le(n=>n.clone({body:void 0})))}Mi.PATH="/number/cancelLock";function Di(r,o,e,t){let i=new qe(o,Di.PATH,"post");return e&&(i.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),i.body(e.body,"application/json")),r.request(i.build({responseType:"text",accept:"*/*",context:t})).pipe(it(n=>n instanceof _),le(n=>n.clone({body:void 0})))}Di.PATH="/number/captcha";function Oi(r,o,e,t){let i=new qe(o,Oi.PATH,"get");return e&&(i.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),i.query("region",e.region,{}),i.query("searchType",e.searchType,{}),i.query("offset",e.offset,{}),i.query("classId",e.classId,{}),i.query("mask",e.mask,{})),r.request(i.build({responseType:"json",accept:"application/json",context:t})).pipe(it(n=>n instanceof _),le(n=>n))}Oi.PATH="/number/search";function Ni(r,o,e,t){let i=new qe(o,Ni.PATH,"get");return r.request(i.build({responseType:"json",accept:"application/json",context:t})).pipe(it(n=>n instanceof _),le(n=>n))}Ni.PATH="/number/captcha";function Pi(r,o,e,t){let i=new qe(o,Pi.PATH,"post");return e&&(i.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),i.body(e.body,"application/json")),r.request(i.build({responseType:"json",accept:"application/json",context:t})).pipe(it(n=>n instanceof _),le(n=>n))}Pi.PATH="/number/lock";var Li=(()=>{class r extends Jr{constructor(e,t){super(e,t);}static{this.GetBeautifulNumbersPath="/number/search";}getBeautifulNumbers$Response(e,t){return Oi(this.http,this.rootUrl,e,t)}getBeautifulNumbers(e,t){return this.getBeautifulNumbers$Response(e,t).pipe(le(i=>i.body))}static{this.LockBeautifulNumberPath="/number/lock";}lockBeautifulNumber$Response(e,t){return Pi(this.http,this.rootUrl,e,t)}lockBeautifulNumber(e,t){return this.lockBeautifulNumber$Response(e,t).pipe(le(i=>i.body))}static{this.CancelBeautifulNumberPath="/number/cancelLock";}cancelBeautifulNumber$Response(e,t){return Mi(this.http,this.rootUrl,e,t)}cancelBeautifulNumber(e,t){return this.cancelBeautifulNumber$Response(e,t).pipe(le(i=>i.body))}static{this.GetCaptchaPath="/number/captcha";}getCaptcha$Response(e,t){return Ni(this.http,this.rootUrl,e,t)}getCaptcha(e,t){return this.getCaptcha$Response(e,t).pipe(le(i=>i.body))}static{this.CheckCaptchaPath="/number/captcha";}checkCaptcha$Response(e,t){return Di(this.http,this.rootUrl,e,t)}checkCaptcha(e,t){return this.checkCaptcha$Response(e,t).pipe(le(i=>i.body))}static{this.\u0275fac=function(t){return new(t||r)(K(K$1),K(ve$1))};}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();var Le=(()=>{class r extends p{constructor(){super(...arguments),this.isSamokatAvailability$=new En$1(true),this.loadingOrder$=new En$1(false),this.orderError$=new En$1(null),this.confirmOrderData$=new En$1(null),this.globalError$=this.orderError$.pipe(it(e=>e!==t.TimeSlotUnavailable),jr$1()),this._dmsApi=D(je),this._orderApi=D(Pe),this._samokatApi=D(qe$1),this._bigCities=D(de$1),this._dadataApi=D(Te),this._orderDataService=D(ve),this._salePointsService=D(He),this._otpService=D(Ce),this._orderAnalyticsService=D(re),this._phoneNumbersService=D(Li);}searchByPosition$(e){return this._dmsApi.searchByPosition$Json(e)}getTimeSlots$(e){return this._dmsApi.getTimeSlots(e)}getPreOrderInfo$(e,t$1){let i=e.fiasCode;if(!i)return this._returnError$(new Error("fiasCode null"),t.TechnicalError);let n=x(w$1({},e),{fiasCode:i});return e.kladrId&&(n.kladrId=e.kladrId),this.loadingOrder$.next(true),this._orderApi.getPreOrderInfo$Json(n).pipe(Uu(()=>this.loadingOrder$.next(true)),Ie(u=>t$1?Bh({cityData:u,dmsData:t$1}):this.searchByPosition$({goodOutsideNumber:u.good.outsideNumber,latitude:u.city.latitude,longitude:u.city.longitude,legalForm:e.legalForm}).pipe(le(m=>x(w$1({},m),{nomenclature:m.nomenclatures[0]})),le(m=>({cityData:u,dmsData:m})),Li$1(m=>this._returnError$(m,t.TechnicalError)))),Li$1(u=>{let m=u.error.errorCode===t.GeodataNotFound||u.error.errorCode===t.NomenclatureNotFound?u.error.errorCode:t.TechnicalError;return this._returnError$(u,m)}),Uu(()=>this.loadingOrder$.next(false)))}samokatAvailability$(e){return this._samokatApi.samokatAvailability(e)}saveOrder$(e){return this._orderApi.saveOrder({body:e}).pipe(Li$1(t$1=>this._returnError$(t$1,t$1?.error?.errorCode||t.TechnicalError)))}updateOrder$(e){return this._orderApi.updateOrder$Json({body:e}).pipe(Li$1(t$1=>this._returnError$(t$1,t$1?.error?.errorCode||t.TechnicalError)))}confirmOrder$(e){return this._orderDataService.setSaveOrderRequest(),this._orderApi.confirmOrder({body:e}).pipe(Li$1(t=>{throw t}))}searchByName$(e){return this._dmsApi.searchByName(e)}searchByCode$(e){return this._dmsApi.searchByCode(e)}getBigCities$(){return this._bigCities.getBigCities().pipe(le(e=>({items:e})))}getAddresses$(e){return this._dadataApi.getAddresses(e)}getCities$(e){return this._dadataApi.getCities(e)}getSamokatAvailability$(){let e=G.receivingFormGroup.controls.address.value;if(!e||typeof e=="string")return Bh();let t=3;return this._orderDataService.orderMetaInfo$.value?.cityData?.city?.timezone&&(t=parseInt(this._orderDataService.orderMetaInfo$.value?.cityData?.city?.timezone,10)),this.samokatAvailability$({goodId:this._orderDataService.orderSettings.goodId,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),timezone:t}).pipe(le(i=>(this._orderDataService.storeId=i.storeId,this.isSamokatAvailability$.next(i.success),i.success)),Li$1(()=>(this.isSamokatAvailability$.next(false),Bh(false))))}saveOrUpdateOrder$(){return this._orderDataService.setSaveOrderRequest(),Bh(this._orderDataService.saveOrder$.value).pipe(Ie(e=>gg(()=>e===null,this.saveOrder$(this._orderDataService.saveOrderRequest),this.updateOrder$(this._orderDataService.saveOrderRequest))))}getSalesPoints$(e){return this._salePointsService.getOrderSalesPoints(e).pipe(le(t$1=>{if(t$1?.salePoints?.length)return t$1.salePoints;throw new Error(t.SalesPointReceivingFailed)}),Li$1(t$1=>{this._returnError$(t$1,t.SalesPointReceivingFailed);let i=w$1({},this._orderDataService.orderMetaInfo$.value);return i?.dmsData&&(i.dmsData.nomenclature.pickupAvailable=false,this._orderDataService.orderMetaInfo=i),Bh([])}))}getGoodSalesPoints$(e){return this._salePointsService.getGoodSalesPoints(e).pipe(le(t$1=>{if(t$1)return t$1;throw new Error(t.CantPickup)}),Li$1(t$1=>(this._orderAnalyticsService.onPickupError(t.CantPickup??t$1?.message??t$1?.name,this._orderDataService.orderRegion,this._orderDataService.orderCity),og(()=>new Error(t.CantPickup)))))}getCaptcha$(){return this._orderApi.getOrderCaptcha()}getNumbersCaptcha$(){return this._phoneNumbersService.getCaptcha()}checkNumbersCaptcha$(e){return this._phoneNumbersService.checkCaptcha({body:e})}sendOtp(e){return this._otpService.sendOtp(e)}setReturnError(e,t){return this._returnError$(e,t)}reset(){this.isSamokatAvailability$.next(false),this.loadingOrder$.next(false),this.orderError$.next(null),this.confirmOrderData$.next(null);}getBeautifulNumbers$(e){return this._phoneNumbersService.getBeautifulNumbers(e)}lockBeautifulNumber$(e){return this._phoneNumbersService.lockBeautifulNumber({body:e})}cancelBeautifulNumber$(e){return this._phoneNumbersService.cancelBeautifulNumber({body:e})}_returnError$(e,t){return this.orderError$.next(t),this._log.error(e),this._orderAnalyticsService.onError(t??e?.message??e?.name,this._orderDataService.orderRegion,this._orderDataService.orderCity),og(()=>e)}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=jR(r)))(i||r)}})();}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"});}}return r})();export{$i as $,De as D,Et as E,G,Hr as H,Ir as I,Le as L,Q,Rt as R,Vr as V,Rr as a,bt as b,vt as c,Li as d,yi as e,gi as g,he as h,j,ki as k,oe as o,re as r,te as t,ve as v,we as w,yt as y};