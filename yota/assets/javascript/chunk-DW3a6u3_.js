import {g as g$1}from'./chunk-Dhb-4Xex.js';import {l as le,H as He}from'./chunk-ZtpdHrZT.js';import {j,D,az as X,i as i$1,b2 as le$1,X as Uu,r as Hu,aB as Bu,aC as Kh,al as jR,h as hO,aK as tC,a as MI,P as Pp,L as LI,b as Lp,e as eO,ao as EO,bv as _k,aO as K,aP as R,aD as GO,f as MO,aE as ZO,l as EE,c as aE,ad as _O,v as FE,dO as xo,aj as dr,Y as YR,af as FR,ag as kR}from'./main-4LN5YMRF.js';var g=function(t){return t.FAQ_PAGE="faq-page",t}(g||{}),Q=(()=>{class t{constructor(e,i){this._document=i,this._idPrefix="ld+json-",this._renderer=e.createRenderer(null,null);}addFaq(e){let i=JSON.stringify({"@context":"https://schema.org","@type":"FAQPage",mainEntity:e.filter(r=>!!r.title&&!!r.answer).map(r=>({"@type":"Question",name:r.title,acceptedAnswer:{"@type":"Answer",text:r.answer}}))});this._addScriptWithContent(i,g.FAQ_PAGE);}removeFaq(){let e=this._idPrefix+g.FAQ_PAGE;this._removeScript(e);}_addScriptWithContent(e,i){let r=this._idPrefix+i;this._removeScript(r);let o=this._renderer.createElement("script");o.text=e,this._renderer.setProperty(o,"id",r),this._renderer.setProperty(o,"type","application/ld+json"),this._renderer.appendChild(this._document.head,o);}_removeScript(e){try{let i=this._document.head.querySelector(`[id='${e}']`);i&&this._renderer.removeChild(this._document.head,i);}catch(i){_k.error("_addScriptWithContent e: ",i);}}static{this.\u0275fac=function(i){return new(i||t)(K(xo),K(dr))};}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"});}}return t})();function G(t,l){if(t&1&&EE(0,"div",2),t&2){let e=MO(2);aE("innerHtml",e.settings.portletHeader,YR);}}function V(t,l){if(t&1){let e=_O();Pp(0,"yota-article-answers",4),FE("itemToggled",function(){FR(e);let r=MO(2);return kR(r.itemToggled())}),Lp();}t&2&&aE("items",l)("isSubsection",true);}function B(t,l){if(t&1&&(Pp(0,"div",1),LI(1,G,1,1,"div",2)(2,V,1,2,"yota-article-answers",3),GO(3,"async"),Lp()),t&2){let e,i=MO();eO(),EO(i.settings.portletHeader?1:-1),eO(),EO((e=ZO(3,2,i.articles$))?2:-1,e);}}var ae=(()=>{class t extends j{constructor(){super(...arguments),this._supportService=D(le),this._ldJsonService=D(Q),this._frameResizerService=D(g$1),this.settings=null,this._frameResizeTrigger$=new X;}setSettings(e){this.settings=i$1.parse(e);}ngOnInit(){this.settings&&(this._frameResizerService.tryAddScript(),this.articles$=this._supportService.getSubsection(this.settings.folderUuid).pipe(le$1(e=>e.articles),Uu(e=>{this._ldJsonService.addFaq(e??[]),setTimeout(()=>{this._setupResizeHandler();},100);})),this._onDestroy$.pipe(Hu(this._onDestroy$)).subscribe(()=>{this._ldJsonService.removeFaq(),this._frameResizerService.removeScript();}));}itemToggled(){this._frameResizerService.isScriptEnable()&&this._frameResizeTrigger$.next();}_setupResizeHandler(){this._frameResizerService.isScriptEnable()&&this._frameResizeTrigger$.pipe(Bu(()=>Kh(10).pipe(Hu(Kh(500)),Hu(this._frameResizeTrigger$))),Hu(this._onDestroy$)).subscribe(()=>{this._frameResizerService.resize();});}static{this.\u0275fac=(()=>{let e;return function(r){return (e||(e=jR(t)))(r||t)}})();}static{this.\u0275cmp=hO({type:t,selectors:[["yota-support-subsection-wrapper"]],features:[MI],decls:2,vars:1,consts:[[1,"support-subsection"],[1,"support-subsection__wrapper"],[1,"support-subsection__title",3,"innerHtml"],[3,"items","isSubsection"],[3,"itemToggled","items","isSubsection"]],template:function(i,r){i&1&&(Pp(0,"div",0),LI(1,B,4,4,"div",1),Lp()),i&2&&(eO(),EO(r.settings?1:-1));},dependencies:[tC,He],styles:["[_nghost-%COMP%]{display:block;margin-block:60px 100px}@media (max-width: 992px){[_nghost-%COMP%]{margin-block:40px 80px}}@media (max-width: 767px){[_nghost-%COMP%]{margin-block:20px 40px}}.support-subsection__wrapper[_ngcontent-%COMP%]{max-width:808px;margin:auto}.support-subsection__title[_ngcontent-%COMP%]{margin-bottom:40px}"],changeDetection:0});}}return t})();
export{ae as SupportSubsectionWrapperComponent};