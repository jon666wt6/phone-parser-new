import {n,t}from'./chunk-DKWUOuB5.js';import {aM as In$1,az as X,I,a as O,dv as kr,bt as Gh,Y as Au,aA as Lu,aB as ju,bH as Vh,ch as ve,N as Mu,J as ot,Z as Hu,b2 as le,cp as Ru,bG as Pi,s as Et,a1 as x,a2 as w$1,E,O as O$1,o as Vu,dw as p,aP as R,a0 as st,ci as qe$1,cj as rr,ai as i$1,aI as q,B,k,av as Ke,d7 as we$1,F,aj as cr,l as lO,W as Ww,bi as Uo,b as kp,g as DE,c as kI,P as Pp,y as sE,Q as QR,e as iE,M as MO,T as TO,S as SO,dx as qe$2,bZ as Fe,ca as x$1,aO as K,be as tu,dy as mg,bp as Wi,dz as rg,bX as gg,dA as y,dB as A,C as p$1,aH as mr,m as U$1,K as p$2,bB as ge,D as Dh,aK as Jw,aX as my,aZ as Cu,_ as _I,aD as $O,aE as UO,bv as Ik,n as ci,$ as zt,bJ as c,bL as $,bK as a,bo as le$1,A as A$1,aJ as Yw,t as m,aL as cn,ad as EO,v as RE,R as RO,au as AO,w as wO,aW as Xu,bY as or,a9 as zw,ba as nC,cB as gm,q as qO,bR as K$1,b0 as wE,V as VE,G as W,co as c$1,al as kR,a3 as An$1,a4 as Ge$1,a5 as yn$1,a7 as Mn$1,a8 as Tt,cs as x$2,dC as cd,cz as ar,cA as gd,ab as Ty,dD as dg,dE as tb,dF as Cd,aU as Vy,aQ as hd,L as Lp,f as jp,b3 as zO,ae as jO,H as Hp,bk as zI,ax as Ob,ay as v$1,bf as ac,af as AR,ag as RR,u as uv,c1 as ZR,h as WR,aR as cm,b6 as Ye}from'./main-GV3FATOT.js';import {Y,v}from'./chunk-tXvZU7AU.js';function o(r){return typeof r=="boolean"}var P=function(i){return i.COVER="cover-map",i.SP="sales-points",i}(P||{}),f=function(i){return i.MOBILE="mobile",i.INTERNET="internet",i}(f||{});var Jt=new Map([["2g",{index:10,text:"\u0413\u043E\u043B\u043E\u0441 \u0438 2G",tilesUrlParam:"2g",checked:false,type:f.MOBILE,disabled:false,color:"#FF530040"}],["3g",{index:20,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 3G",tilesUrlParam:"3g",checked:false,type:f.MOBILE,disabled:false,color:"#71B0FAA8"}],["4g",{index:30,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 4G",tilesUrlParam:"lte",checked:true,type:f.MOBILE,disabled:false,color:"#3171BEA6"}]]),en=new Map([["i2g",{index:40,text:"\u0413\u043E\u043B\u043E\u0441 \u0438 2G",checked:false,type:f.INTERNET,disabled:true}],["i3g",{index:50,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 3G",checked:false,type:f.INTERNET,disabled:true}],["i4g",{index:60,text:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442 4G",tilesUrlParam:"lte",checked:true,type:f.INTERNET,disabled:false}]]);new Map([["exc",{text:"\u0417\u0430\u043C\u0435\u043D\u0430 \u0441\u0438\u043C-\u043A\u0430\u0440\u0442",checked:false,type:f.MOBILE,disabled:false}],["eexc",{text:"\u0417\u0430\u043C\u0435\u043D\u0430 eSIM",checked:false,type:f.MOBILE,disabled:false}],["edit",{text:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u0430\u0441\u043F\u043E\u0440\u0442\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445",checked:false,type:f.MOBILE,disabled:false}],["corp",{text:"\u041A\u043E\u0440\u043F\u043E\u0440\u0430\u0442\u0438\u0432\u043D\u043E\u0435 \u043E\u0431\u0441\u043B\u0443\u0436\u0438\u0432\u0430\u043D\u0438\u0435",checked:false,type:f.MOBILE,disabled:false}],["connect",{text:"\u041A\u0443\u043F\u0438\u0442\u044C \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443",checked:false,type:f.MOBILE,disabled:false}],["econnect",{text:"\u041A\u0443\u043F\u0438\u0442\u044C eSIM",checked:false,type:f.MOBILE,disabled:false}],["buy",{text:"\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u0438 \u043F\u043E \u0441\u0447\u0435\u0442\u0443",checked:false,type:f.MOBILE,disabled:false}],["mnp",{text:"\u041F\u0435\u0440\u0435\u043D\u043E\u0441 \u043D\u043E\u043C\u0435\u0440\u0430 \u0432 Yota",checked:false,type:f.MOBILE,disabled:false}],["all",{text:"\u041F\u043E \u0432\u0441\u0435\u043C \u0432\u043E\u043F\u0440\u043E\u0441\u0430\u043C",checked:false,type:f.MOBILE,disabled:false}],["confirm",{text:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u043F\u0430\u0441\u043F\u043E\u0440\u0442\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445",checked:false,type:f.MOBILE,disabled:false}]]);new Map([["idiag",{text:"\u0417\u0430\u043C\u0435\u043D\u0430 \u0438 \u0434\u0438\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u043A\u0430",checked:false,type:f.INTERNET,disabled:true}],["iedit",{text:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u0430\u0441\u043F\u043E\u0440\u0442\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445",checked:false,type:f.INTERNET,disabled:true}],["icorp",{text:"\u041A\u043E\u0440\u043F\u043E\u0440\u0430\u0442\u0438\u0432\u043D\u043E\u0435 \u043E\u0431\u0441\u043B\u0443\u0436\u0438\u0432\u0430\u043D\u0438\u0435",checked:false,type:f.INTERNET,disabled:true}],["iconnect",{text:"\u041A\u0443\u043F\u0438\u0442\u044C \u043C\u043E\u0434\u0435\u043C",checked:false,type:f.INTERNET,disabled:true}],["ibuy",{text:"\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u0438 \u043F\u043E \u0441\u0447\u0435\u0442\u0443",checked:false,type:f.INTERNET,disabled:true}],["iall",{text:"\u041F\u043E \u0432\u0441\u0435\u043C \u0432\u043E\u043F\u0440\u043E\u0441\u0430\u043C",checked:false,type:f.INTERNET,disabled:true}]]);var tn=(()=>{class i{constructor(){this._salesPointsService=I(qe$2);}getSalesPoints(e){return this._salesPointsService.getSalesPoints(e).pipe(le(t=>t?.salePoints||[]),Pi(()=>[]))}getFunctions(e){return this._salesPointsService.getFunctions({functionType:e})}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var ze=(()=>{class i{constructor(e,t,n){this._document=t,this._isBrowser=tu(n);let o={lang:"ru_RU"};this._config=w$1(w$1({},o),e);}load(){if(!this._isBrowser)return mg;if(window.ymaps)return Fe(ymaps.ready()).pipe(le(()=>ymaps));this._script||(this._script=this._createScript(),this._document.body.appendChild(this._script));let e=Wi(this._script,"load").pipe(ju(()=>Fe(ymaps.ready())),le(()=>ymaps)),t=Wi(this._script,"error").pipe(ju(rg));return gg(e,t).pipe(Et(1))}_createScript(){let e=this._document.createElement("script");return e.type="text/javascript",e.src=this._getScriptSource(this._config),e.id="yandexMapsApiScript",e.async=true,e.defer=true,e}_getScriptSource(e){let p=e,{enterprise:t,version:n="2.1.15"}=p,o=y(p,["enterprise","version"]),s=this._convertConfigIntoQueryParams(o);return `https://${t?"enterprise.":""}api-maps.yandex.ru/${n}/?${s}`}_convertConfigIntoQueryParams(e){return Object.entries(e).map(([t,n])=>`${t}=${n}`).join("&")}static{this.\u0275fac=function(t){return new(t||i)(K(A,8),K(cr),K(ac))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var on=(()=>{class i{constructor(e,t){this._ngZone=e,this._yaApiLoaderService=t;}geocode(e,t){return this._yaApiLoaderService.load().pipe(ju(()=>Fe(ymaps.geocode(e,t))),ju(n=>new x$1(o=>{this._ngZone.run(()=>{o.next(n),o.complete();});})))}static{this.\u0275fac=function(t){return new(t||i)(K(we$1),K(ze))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var U=(()=>{class i{constructor(){this.currentState$=new In$1({modeTabIndex:0,coverTabIndex:0,salesPointsTabIndex:0,showFilters:false,showListView:false,maxLayerZoom:13,tabMode:true}),this.readyFilters=new In$1(false),this.selectedSalePoint$=new In$1(null),this.showOverlayFilters$=new In$1(false),this._searchSubject$=new X,this._suggestSubject$=new X,this._searchValue$=new In$1(""),this._searchResult$=new In$1([]),this.bannerIntersection$=new In$1(false),this._analyticsFacadeService=I(O),this.sharedSearchValue$=this.searchValue$.pipe(kr()),this.sharedSearchResult$=this.searchResult$.pipe(kr()),this._salesPointsApiService=I(tn),this.boundsChanged$=new X,this.salesPointsResult$=Gh([this.currentState$.pipe(Au((e,t)=>e.modeTabIndex===t.modeTabIndex&&e.salesPointsTabIndex===t.salesPointsTabIndex&&e.yotaPoints===t.yotaPoints&&e.partnerPoints===t.partnerPoints)),this.boundsChanged$.pipe(Lu(null))]).pipe(ju(([e])=>{if(e?.modeTabIndex===1&&this._map?.getBounds()){let[t$1,n$1]=this._map.getBounds(),o=this.salesPointsTabs[e.salesPointsTabIndex].filter,s=e.salesPointsTabIndex===0?n.Voice:n.Modem,p=[...o.values()].filter(u=>u.checked).map(u=>u.id)||[],r=[];e?.yotaPoints&&r.push(t.Yota),e?.partnerPoints&&r.push(t.Partner);let h={upperLatitude:t$1[0],lowerLatitude:n$1[0],upperLongitude:t$1[1],lowerLongitude:n$1[1],functionType:s,types:r,functionIds:p};return this._salesPointsApiService.getSalesPoints(h)}else return Vh([])}),kr()),this._map=null,this._mapLayerIndex=0,this._foundPoint=null,this._coverMobileFilters=Jt,this._coverInternetFilters=en,this._salesPointsMobileFilters=new Map,this._salesPointsInternetFilters=new Map,this.coverTabs=new Array({label:"\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C",filter:this._coverMobileFilters,layers:new Map},{label:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442",filter:this._coverInternetFilters,layers:new Map}),this.salesPointsTabs=new Array({label:"\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C",filter:this._salesPointsMobileFilters,layers:new Map},{label:"\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442",filter:this._salesPointsInternetFilters,layers:new Map}),this.modeTabs=new Array({label:"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F",tabs:this.coverTabs,type:P.COVER,tabsLabel:"\u0424\u0438\u043B\u044C\u0442\u0440 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F"},{label:"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436",tabs:this.salesPointsTabs,type:P.SP,tabsLabel:"\u0424\u0438\u043B\u044C\u0442\u0440\u043E\u0432\u0430\u0442\u044C"}),this.banners$=new In$1([]),this._yaGeocoderService=I(on),this._http=I(ve);}get searchValue$(){return this._searchValue$.pipe(Mu(256),ot(e=>e?.length>1),Hu(e=>{this._suggest(e);}))}set searchValue(e){this._searchValue$.next(e);}get searchResult$(){return this._searchResult$}set searchResult(e){this._searchResult$.next(e);}set map(e){this._map=e,this._mapLayerIndex=this._map.layers.getAll()[0]?.options.get("zIndex"),this.currentState$.value?.modeTabIndex===1&&this.boundsChanged$.next();}getSpFilter(){this._salesPointsApiService.getFunctions(n.Voice).pipe(ju(e=>this._salesPointsApiService.getFunctions(n.Modem).pipe(le(t=>[...e,...t]))),Ru(()=>{this.readyFilters.next(true);}),Pi(e=>Vh([])),Et(1)).subscribe(e=>{e.length&&e.forEach(t=>{let n$1=x(w$1({},t),{type:f.MOBILE,disabled:false,checked:false,text:t.name});t.type===n.Modem?(n$1.type=f.INTERNET,this._salesPointsInternetFilters.set(t.code,n$1)):this._salesPointsMobileFilters.set(t.code,n$1);});});}setFilter(e,t,n=false){let o;n?o=this.salesPointsTabs[this.currentState$.value.salesPointsTabIndex].filter:o=this.coverTabs[this.currentState$.value.coverTabIndex].filter;let s=o.get(t);if(s){s.checked=e.checked;let r=this.getCurrentModeType()==P.COVER?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${r}/${s.text}/${s.checked}`},O$1.FILTERS);}this.updateLayers();}getCurrentModeType(){return this.modeTabs[this.currentState$.value.modeTabIndex].type}getCurrentFilterTab(){let e=this.modeTabs[this.currentState$.value.modeTabIndex],t=e.type===P.COVER?this.currentState$.value.coverTabIndex:this.currentState$.value.salesPointsTabIndex;return e.tabs[t]}changeModeTab(e){let t=this.modeTabs[this.currentState$.value.modeTabIndex].tabs;for(let n of t)this._clearTabLayers(n.layers);this.currentState$.next(x(w$1({},this.currentState$.value),{modeTabIndex:e})),this.updateLayers(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${e===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436"}`},O$1.CLICK_MAP_MODE);}changeFilterTab(e){let t=this.getCurrentFilterTab();this._clearTabLayers(t.layers),this.getCurrentModeType()===P.COVER?this.currentState$.next(x(w$1({},this.currentState$.value),{coverTabIndex:e})):this.currentState$.next(x(w$1({},this.currentState$.value),{salesPointsTabIndex:e})),this.updateLayers();let n=this.getCurrentFilterTab().label,s=this.getCurrentModeType()===P.COVER?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${s}/${n}`},O$1.CLICK_MAP_SERVICE_TYPE);}updateLayers(){if(!this._map||this.getCurrentModeType()!==P.COVER)return;let t=this.getCurrentFilterTab(),n=t.filter,o=[],s=this.currentState$.value.maxLayerZoom??13,p=this._coverMobileFilters.get("4g")?.tilesURL||"",r=this._mapLayerIndex;for(let h of n.values()){let u=h,k=u.checked;!u.disabled&&k&&u.tilesUrlParam&&(o.push(u.tilesUrlParam),r=Math.max(r,this._mapLayerIndex+u.index));}if(o.length>0){let h=o.join(","),u=t.layers.get(h);if(t.layers.forEach((k,Me)=>{Me!==h&&(this._map?.layers.remove(k),t.layers.delete(Me));}),!u){let k=`${p}${h}&yota`;u=this._createLayer(r,k,s),t.layers.set(h,u);}this._map.layers.add(u),u.addedToMap=true;}else this._map.geoObjects.removeAll(),t.layers.forEach(h=>{this._map?.layers.remove(h);}),t.layers.clear();this.boundsChanged$.next();}selectPoint(e){return this._map?(this._map.setCenter([e.latitude,e.longitude],25),this.boundsChanged$.next(),this.salesPointsResult$):Vh([])}_clearTabLayers(e){for(let[,t]of e)t.addedToMap&&(this._map?.layers.remove(t),t.addedToMap=false);}_createLayer(e,t,n){let o=new ymaps.Layer("",{tileTransparent:true,zIndex:e});return o.getTileUrl=(s,p)=>{let r=Math.min(p,n);return t.replace("%z",String(Math.min(r,15))).replace("%x",String(s[0])).replace("%y",String(s[1]))},o.getTileSize=s=>{let p=8;n<s&&(p=8+s-n);let r=Math.pow(2,p);return [r,r]},o}geoSearch(e,t){if(this._searchSubject$.next(true),!e||!e.trim())return;this._foundPoint&&this._map?.geoObjects.remove(this._foundPoint);let n=" \xB7 ";if(e.includes(n)){let o=e.split(n)[1];o&&(e=o);}t=x(w$1({},t),{results:1,boundedBy:this._map?.getBounds()}),this._yaGeocoderService.geocode(e,t).pipe(le(o=>{let s=o?.metaData?.geocoder?.found;if(!s)return [];let p=[];this._foundPoint=o.geoObjects.get(0);for(let r=0;r<s;r++){let h=o.geoObjects.get(r);h&&p.push({name:h.properties.getAll().text,cords:h.geometry.getCoordinates()});}return this._foundPoint&&(this._map?.geoObjects.add(this._foundPoint),this._map?.setBounds(this._foundPoint.properties.get("boundedBy"))),p}),Vu(this._searchSubject$)).subscribe();}getBannerCategory(){let e=this.getCurrentFilterTab().label,t=this.getCurrentModeType();return e==="\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C"&&t===P.COVER?"COVERAGE_MOBILE":e==="\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u0430\u044F \u0441\u0432\u044F\u0437\u044C"&&t===P.SP?"SALES_POINTS_MOBILE":e==="\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442"&&t===P.COVER?"COVERAGE_INTERNET":e==="\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442"&&t===P.SP?"SALES_POINTS_INTERNET":null}_suggest(e){if(this._suggestSubject$.next(true),!e||!e.trim()){this.searchResult=[];return}let t={part:e,ll:this._map?.getCenter().reverse().join()+","||"",search_type:"all",bases:"geo,biz,transit",spn:"2.399139%2C0.624969",results:10,highlight:"0",fullpath:"1",sep:"0",v:9,lang:"ru_RU"};this._yaSuggest(t).pipe(le(n=>{let{results:o}=n,s="business",p=[s,"toponym"];o=o?.filter(u=>p.includes(u.type)&&!u.group&&u.subtitle?.text);let r=o?.map(u=>{let k=u?.subtitle?.text||"";return {type:u?.type,data:u?.type===s?k:u?.text||"",title:u?.title?.text||"",subtitle:k}});return r=((u,k)=>{if(!u)return [];let Me=fe=>fe[k];return [...u.reduce((fe,Ce)=>{let He=Ce==null?Ce:Me(Ce);return fe.has(He)||fe.set(He,Ce),fe},new Map).values()]})(r,"subtitle"),r}),Vu(this._suggestSubject$)).subscribe(n=>this.searchResult=n);}_yaSuggest(e){let t=new p("https://suggest-maps.yandex.ru","/suggest-geo","get");e&&(t.query("lang",e.lang,{}),t.query("bases",e.bases,{}),t.query("search_type",e.search_type,{}),t.query("ll",e.ll,{}),t.query("spn",e.spn,{}),t.query("highlight",e.highlight,{}),t.query("fullpath",e.fullpath,{}),t.query("sep",e.sep,{}),t.query("v",e.v,{}),t.query("results",e.results,{}),t.query("part",e.part,{}));let n=t.build({accept:"application/javascript"});return this._http.jsonp(n.urlWithParams+"&search_type=street","callback").pipe(Pi(()=>this.searchResult=[]))}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var Ze=class{constructor(a){this._ngZone=a,this._pending=[],this._listeners=[],this._targetStream=new In$1(void 0);}getLazyEmitter(a){return this._targetStream.pipe(ju(e=>{let t=new x$1(n=>{if(!e){this._pending.push({observable:t,observer:n});return}let o=p=>{let r={event:p,target:e,ymaps};this._ngZone.run(()=>n.next(r));},s=e.events.add(a,o);return this._listeners.push({name:a,callback:o,manager:s}),()=>s.remove(a,o)});return t}))}setTarget(a){let e=this._targetStream.value;a!==e&&(e&&(this._clearListeners(),this._pending=[]),this._targetStream.next(a),this._pending.forEach(t=>t.observable.subscribe(t.observer)),this._pending=[]);}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete();}_clearListeners(){this._listeners.forEach(a=>{let{name:e,callback:t,manager:n}=a;n.remove(e,t);}),this._listeners=[];}};var an=()=>`f${Date.now().toString(16)}`;var qe=class{constructor(){this._uniqueIds=new WeakMap,this._lastid=0;}get(a){return this._uniqueIds.has(a)||this._uniqueIds.set(a,this._lastid++),this._uniqueIds.get(a)}};var Ue=A$1(K$1());var _n=["desktop"],mn=["mobile"],dn=["mobileImage"];function hn(i,a){i&1&&wE(0);}function un(i,a){i&1&&wE(0);}function gn(i,a){if(i&1){let e=EO();kp(0,"div",18)(1,"a",19),RE("click",function(){AR(e);let n=wO(2);return RR(n.cardClick())}),RO(2),Pp()();}if(i&2){let e=wO(2);QR(),iE("href",e.banner==null?null:e.banner.uri,uv),QR(),VE(e.banner==null?null:e.banner.urlText);}}function bn(i,a){if(i&1){let e=EO();kp(0,"div",12)(1,"div",13)(2,"div",14),RO(3),Pp(),kp(4,"button",10),RE("click",function(){AR(e);let n=wO();return RR(n.closeBanner())}),kp(5,"y-icon",11),RO(6,"cross"),Pp()()(),kp(7,"p",15),RO(8),Pp(),kI(9,gn,3,2,"div",16),DE(10,"img",17),Pp();}if(i&2){let e=wO();QR(3),VE(e.banner==null?null:e.banner.title),QR(5),VE(e.banner==null?null:e.banner.subTitle),QR(),iE("ngIf",e.banner==null?null:e.banner.urlText),QR(),iE("src",e.banner==null?null:e.banner.pictureDesktopUri,uv);}}var ye=class i extends p$1{onGlobalClick(a){this.mobile.nativeElement.contains(a.target)||this._isDesktop()||this.mobileCardOpen&&this.hideMobileCard();}constructor(){super(),this.banner=null,this.analyticsEvents=E,this.analyticsActions=O$1,this._bannerOpened=false,this.mobileCardOpen=false,this._animationDuration=500,this._lifeTime=7,this._mobileImageTranslateX=-120,this._mobileCardTranslateX=-375,this._desktopCardTranslateX=-370,this._localstorageKey="yota_mapBanner_expires",this._yaCombinedService=I(U),this._analyticsFacadeService=I(O),this._breakpointObserver=I(U$1),this._bannersInteractionService=I(c),this._cdr=I(ci),$.isLocalStorageAvailable()&&localStorage.getItem(this._bannersInteractionService.getLocalStorageKey(a.Cookies))&&this._bannersInteractionService.setAvailability(a.Map,true,0);}ngOnInit(){this._initIntersectionBannerLogic();}closeBannerImage(){this._setExpirationDate(),le$1({targets:this.mobileImage.nativeElement,translateX:this._mobileImageTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}}),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/\u041A\u0440\u0435\u0441\u0442\u0438\u043A`},O$1.BANNER_CLOSE);}getBanner(){let a=this._yaCombinedService.getBannerCategory(),e=this._yaCombinedService.banners$.value.find(t=>t.category===a);return e||null}closeBanner(){this.mobileCardOpen=false,this._isDesktop()?le$1({targets:this.desktop.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack"}):le$1({targets:this.mobile.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack"}),this._setExpirationDate(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/\u041A\u0440\u0435\u0441\u0442\u0438\u043A`},O$1.BANNER_CLOSE);}openMobileCard(){this.mobileCardOpen||(this.mobileCardOpen=true,this.mobile.nativeElement.style.transform="translateX(0)",le$1.timeline().add({targets:this.mobileImage.nativeElement,opacity:0,duration:300,easing:"linear",complete:()=>this.mobileImage.nativeElement.style.transform=`translateX(${this._mobileImageTranslateX}px)`}).add({targets:this.mobile.nativeElement,opacity:1,duration:300,easing:"linear"},0),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/icon`},O$1.CLOSED_BANNER_CLICK));}hideMobileCard(){this.mobileCardOpen&&(this.mobileCardOpen=false,this.mobileImage.nativeElement.style.transform="translateX(-0)",le$1.timeline().add({targets:this.mobileImage.nativeElement,opacity:1,duration:300,autoplay:false,easing:"linear",complete:()=>this.mobile.nativeElement.style.transform=`translateX(${this._mobileCardTranslateX}px)`}).add({targets:this.mobile.nativeElement,opacity:0,duration:300,easing:"linear"},0));}cardClick(){this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/${this.banner?.urlText}`},O$1.BANNER_LINK);}_hideBanner(){this._getExpirationDate()&&!this._bannerHidingExpired()||(this._isDesktop()?le$1({targets:this.desktop.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}}):this._hideBannerMobile());}_hideBannerMobile(){let a=this.mobile.nativeElement.style.opacity==="1";this.mobileCardOpen=false,a?le$1({targets:this.mobile.nativeElement,translateX:this._mobileCardTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}}):le$1({targets:this.mobileImage.nativeElement,translateX:this._mobileImageTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=null;}});}_changeBanner(a){this._setLocalStorageKey(a.category),this._isDesktop()?this._changeBannerDesktop(a):this._changeBannerMobile(a);}_changeBannerMobile(a){let e=getComputedStyle(this.mobileImage.nativeElement),o=new WebKitCSSMatrix(e.transform).m41===0,s=this.mobile.nativeElement.style.opacity==="1",p=le$1.timeline({autoplay:false});if(s?(this.mobileCardOpen=false,p.add({targets:this.mobile.nativeElement,translateX:this._mobileCardTranslateX,duration:this._animationDuration,easing:"easeInBack",autoplay:false,complete:()=>{this.banner=a,this.mobile.nativeElement.style.opacity=0,this.mobileImage.nativeElement.style.opacity=1,this._cdr.markForCheck();}})):(this.mobileImage.nativeElement.style.opacity=o?1:0,p.add({targets:this.mobileImage.nativeElement,translateX:this._mobileImageTranslateX,autoplay:false,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=a,this.mobileImage.nativeElement.style.opacity=1,this._cdr.markForCheck();}})),this._bannerHidingExpired()){let r={targets:this.mobileImage.nativeElement,translateX:0,duration:this._animationDuration,easing:"easeOutBack"};p.add(r,"+=400"),localStorage.removeItem(this._localstorageKey),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/icon`},O$1.CLOSED_BANNER_SHOW);}p.play();}_initIntersectionBannerLogic(){Gh([this._yaCombinedService.currentState$.pipe(ju(()=>this._yaCombinedService.bannerIntersection$)),this._bannersInteractionService.getBannerAvailability$(a.Map)]).pipe(Vu(this._onDestroy$)).subscribe(([a,e])=>{if(!a||!e)return;let t=this.getBanner();!(this.banner?.category!==t?.category)||le$1.running?.length>0||(this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{t?this._bannerOpened?this._changeBanner(t):this._showBannerFirstTime(t):this._hideBanner(),this._cdr.markForCheck();},200));});}_changeBannerDesktop(a){let e=getComputedStyle(this.desktop.nativeElement),o=new WebKitCSSMatrix(e.transform).m41===0;this.desktop.nativeElement.style.opacity=o?1:0;let s=le$1.timeline({autoplay:false}).add({targets:this.desktop.nativeElement,translateX:this._desktopCardTranslateX,duration:this._animationDuration,easing:"easeInBack",complete:()=>{this.banner=a,this.desktop.nativeElement.style.opacity=1,this._cdr.markForCheck();}});if(this._bannerHidingExpired()){let p={targets:this.desktop.nativeElement,translateX:0,duration:this._animationDuration,easing:"easeOutBack"};s.add(p,"+=400"),localStorage.removeItem(this._localstorageKey),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}`},O$1.DESKTOP_BANNER_SHOW);}s.play();}_getExpirationDate(){let a=localStorage.getItem(this._localstorageKey);return a?(0, Ue.default)(JSON.parse(a)):null}_setExpirationDate(){let a=(0, Ue.default)().add(this._lifeTime,"day");localStorage.setItem(this._localstorageKey,JSON.stringify(a));}_setLocalStorageKey(a){let e=a||this.banner?.category;this._localstorageKey=`yota_mapBanner_${e}_expires`;}_bannerHidingExpired(){let a=this._getExpirationDate();return a?(0, Ue.default)().isAfter(a):true}_isDesktop(){return this._breakpointObserver.isMatched(["(min-width: 992px)"])}_showBannerFirstTime(a){this.banner=a,this._setLocalStorageKey(),this._bannerHidingExpired()&&(this._isDesktop()?this._showBannerFirstTimeDesktop():this._showBannerFirstTimeMobile(),this._bannerOpened=true);}_showBannerFirstTimeMobile(){le$1.timeline().add({targets:this.mobileImage.nativeElement,translateX:[-120,0],autoplay:false,duration:this._animationDuration,easing:"easeOutBack"}).play(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}/icon`},O$1.CLOSED_BANNER_SHOW);}_showBannerFirstTimeDesktop(){le$1.timeline().add({targets:this.desktop.nativeElement,translateX:[-370,0],autoplay:false,duration:this._animationDuration,easing:"easeOutBack"}).play(),this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${this.banner?.title}/${this.banner?.uri}`},O$1.DESKTOP_BANNER_SHOW);}static{this.\u0275fac=function(e){return new(e||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-map-banner"]],viewQuery:function(e,t){if(e&1&&(MO(_n,7),MO(mn,7),MO(dn,7)),e&2){let n;TO(n=SO())&&(t.desktop=n.first),TO(n=SO())&&(t.mobile=n.first),TO(n=SO())&&(t.mobileImage=n.first);}},hostBindings:function(e,t){e&1&&RE("mousedown",function(o){return t.onGlobalClick(o)},false,ZR);},features:[_I],decls:15,vars:3,consts:[["desktop",""],["mobile",""],["mobileImage",""],["card",""],[1,"desktop-card"],[4,"ngTemplateOutlet"],[1,"mobile-card"],[1,"mobile-image"],[1,"closed"],["alt","banner",1,"closed__image",3,"click","src"],["y-button-icon","","type","button",3,"click"],[1,"close-button"],[1,"card"],[1,"header"],[1,"title"],[1,"text"],["class","action",4,"ngIf"],["alt","banner",1,"image",3,"src"],[1,"action"],["yotaRelativeLinkHandler","",1,"link",3,"click","href"]],template:function(e,t){if(e&1){let n=EO();kp(0,"div",4,0),kI(2,hn,1,0,"ng-container",5),Pp(),kp(3,"div",6,1),kI(5,un,1,0,"ng-container",5),Pp(),kp(6,"div",7,2)(8,"div",8)(9,"img",9),RE("click",function(){return AR(n),RR(t.openMobileCard())}),Pp(),kp(10,"button",10),RE("click",function(){return AR(n),RR(t.closeBannerImage())}),kp(11,"y-icon",11),RO(12,"cross"),Pp()()()(),kI(13,bn,11,4,"ng-template",null,3,qO);}if(e&2){let n=AO(14);QR(2),iE("ngTemplateOutlet",n),QR(3),iE("ngTemplateOutlet",n),QR(4),iE("src",t.banner==null?null:t.banner.pictureMobileUri,uv);}},dependencies:[Yw,Ww,m,cn,zt],styles:["[_nghost-%COMP%]{display:block;width:0;height:100%;position:absolute;bottom:0;left:0}.desktop-card[_ngcontent-%COMP%]{z-index:2;position:absolute;bottom:32px;left:32px;transform:translate(-370px)}.mobile-card[_ngcontent-%COMP%]{position:absolute;top:90px;left:30px;opacity:0;transform:translate(-375px)}.mobile-image[_ngcontent-%COMP%]{z-index:1;position:absolute;left:30px;top:100px;transform:translate(-120px)}.mobile-image[_ngcontent-%COMP%]   .closed[_ngcontent-%COMP%]{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:flex-start;min-width:80px}.mobile-image[_ngcontent-%COMP%]   .closed__image[_ngcontent-%COMP%]{height:84px}.card[_ngcontent-%COMP%]{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;flex-direction:column;width:320px;min-height:167px;border-radius:20px;background:#fff;padding:16px}@media (max-width: 992px){.card[_ngcontent-%COMP%]{width:335px;min-height:132px}}.header[_ngcontent-%COMP%]{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:space-between;align-items:flex-start}.title[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:700}.close-button[_ngcontent-%COMP%]{color:#ceced5}.text[_ngcontent-%COMP%]{max-width:146px;margin-top:4px;font-size:14px;line-height:16px;font-weight:400;color:#434c5e}.action[_ngcontent-%COMP%]{margin-top:auto}.action[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{font-size:14px;line-height:18px;font-weight:500;color:#00aeef}.image[_ngcontent-%COMP%]{width:132px;height:132px;position:absolute;bottom:0;right:16px}@media (max-width: 992px){.image[_ngcontent-%COMP%]{width:100px;height:100px}}"],changeDetection:0});}};Ob([v$1],ye.prototype,"_initIntersectionBannerLogic",null);function yn(i,a){if(i&1){let e=EO();kp(0,"div",1)(1,"div",2),RE("click",function(){AR(e);let n=wO();return RR(n.fullscreen())}),DE(2,"y-icon",3),Pp(),kp(3,"div",4)(4,"div",5),RE("click",function(){AR(e);let n=wO();return RR(n.zoomIn())}),DE(5,"y-icon",6),Pp(),kp(6,"div",5),RE("click",function(){AR(e);let n=wO();return RR(n.zoomOut())}),DE(7,"y-icon",7),Pp()(),kp(8,"div",2),RE("click",function(){AR(e);let n=wO();return RR(n.setLocateUser())}),DE(9,"y-icon",8),Pp()();}if(i&2){let e=wO();QR(),iE("hidden",!e.controls.has("fullscreen")),QR(),iE("svgIcon",e.isFullscreen()?"map-fullscreen-off":"map-fullscreen-on"),QR(),iE("hidden",!e.controls.has("zoom")),QR(5),iE("hidden",!e.controls.has("locate"));}}var sn=(()=>{class i extends p$1{constructor(e,t){super(),this._yaMapComponent=e,this._cdr=t,this.zoomIn$=new st,this.zoomOut$=new st,this.fullscreen$=new st,this.userCoordinates=new st,this._map=null,this._userMarker=void 0,this._userCoordinates=null,this._analyticsFacadeService=I(O),this._yaCombinedService=I(U),this._map$=new X;}set map$(e){this._map$=e;}ngOnInit(){this._map$.pipe(ot(Boolean),Et(1),Vu(this._onDestroy$)).subscribe(e=>{this._map=e,this._cdr.markForCheck();});}zoomIn(){if(this._map){let e=this._map.getZoom()+1;this._map.setZoom(e,{checkZoomRange:true});let t=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${t}/\u0412\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043A\u0430\u0440\u0442\u043E\u0439/\u0423\u0432\u0435\u043B\u0438\u0447\u0438\u0442\u044C`},O$1.CLICK_MAP_CONTROLS);}}zoomOut(){if(this._map){let e=this._map.getZoom()-1;this._map.setZoom(e,{checkZoomRange:true});let t=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${t}/\u0412\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043A\u0430\u0440\u0442\u043E\u0439/\u0423\u043C\u0435\u043D\u044C\u0448\u0438\u0442\u044C`},O$1.CLICK_MAP_CONTROLS);}}fullscreen(){if(this._map){let e=this._map.options.get("isFullscreen");this._map.options.set("isFullscreen",!e),this.fullscreen$.emit(!e);}}isFullscreen(){return !!this._map?.options.get("isFullscreen")}setLocateUser(){let e=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${e}/\u0412\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043A\u0430\u0440\u0442\u043E\u0439/\u0421\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0435 \u043C\u0435\u0441\u0442\u043E\u043F\u043E\u043B\u043E\u0436\u0435\u043D\u0438\u0435`},O$1.CLICK_MAP_CONTROLS),ymaps.geolocation.get({}).then(t=>{this._map&&(this._userMarker&&this._map.geoObjects.remove(this._userMarker),this._userMarker=t.geoObjects.get(0),this._userCoordinates=t.geoObjects.get(0).geometry.getCoordinates(),this.userCoordinates.emit(this._userCoordinates),this._userCoordinates&&(this._userMarker=new ymaps.Placemark(this._userCoordinates,{},{iconLayout:"default#image",iconImageSize:[48,48],iconImageHref:"assets/images/ymap/marker-user.svg"}),this._userMarker.events.add("click",()=>this._moveToCoordinates(this._userCoordinates)),this._map.geoObjects.add(this._userMarker),this._moveToCoordinates(this._userCoordinates)));}).catch(t=>{Ik.error(t);});}_moveToCoordinates(e){this._map&&this._map.setCenter(e,this._map.getZoom(),{duration:300});}static{this.\u0275fac=function(t){return new(t||i)(k(rn),k(ci))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-ya-control"]],inputs:{controls:"controls",map$:"map$"},outputs:{zoomIn$:"zoomIn$",zoomOut$:"zoomOut$",fullscreen$:"fullscreen$",userCoordinates:"userCoordinates"},features:[_I],decls:1,vars:1,consts:[["class","b-map__controls",4,"ngIf"],[1,"b-map__controls"],[1,"b-map__control","scale-edge",3,"click","hidden"],[3,"svgIcon"],[1,"b-map__controls-middle",3,"hidden"],[1,"b-map__control","scale-middle",3,"click"],["svgIcon","map-plus"],["svgIcon","map-minus"],["svgIcon","map-arrow-compass"]],template:function(t,n){t&1&&kI(0,yn,10,4,"div",0),t&2&&iE("ngIf",n.controls);},dependencies:[Ww,zt],styles:[".b-map__controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-between;position:absolute;gap:72px;width:48px;top:calc(50% - 165px);right:38px}.b-map__controls-middle[_ngcontent-%COMP%]{height:90px;width:100%;border:0 solid #ffffff;border-radius:9px;overflow:hidden;box-shadow:0 11px 9px #00000008}.b-map__controls-middle[_ngcontent-%COMP%]   .b-map__control[_ngcontent-%COMP%]{box-shadow:none}.b-map__control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#fff;box-shadow:0 11px 9px #00000008;transition:all .3s ease-in;cursor:pointer}@media (hover: hover){.b-map__control[_ngcontent-%COMP%]:hover{opacity:.8}}@media (hover: none){.b-map__control[_ngcontent-%COMP%]:active{opacity:.8}}.b-map__control[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{width:20px;height:20px}.b-map__control.scale-middle[_ngcontent-%COMP%]{width:48px;height:45px}.b-map__control.scale-middle[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{width:14px;height:14px}.b-map__control.scale-edge[_ngcontent-%COMP%]{width:48px;height:48px;border:0 solid #ffffff;border-radius:50%}"],changeDetection:0});}}return i})();function Cn(i,a){if(i&1){let e=EO();kp(0,"yota-field-state",8),RE("clear",function(){AR(e);let n=wO();return RR(n.clear())}),Pp();}if(i&2){let e=wO(),t=AO(5);iE("state",e.controlState.CLEAR)("inputControl",t);}}function vn(i,a){if(i&1&&(kp(0,"div",12),RO(1),Pp()),i&2){let e=wO().$implicit;QR(),Hp(" ",e.subtitle," ");}}function xn(i,a){if(i&1&&(kp(0,"y-option-bordered",9),DE(1,"div",10),$O(2,"yHighlight"),kI(3,vn,2,1,"div",11),Pp()),i&2){let e=a.$implicit,t=wO();iE("value",e),QR(),iE("innerHtml",zO(2,3,e.title,t.search.value),WR),QR(2),iE("ngIf",e.subtitle);}}var ln=(()=>{class i extends p$1{constructor(){super(...arguments),this.handleSelect=new st,this._yaCombinedService=I(U),this.options$=this._yaCombinedService.sharedSearchResult$,this.search=new W(""),this.controlState=c$1;}ngOnInit(){this.search.valueChanges.pipe(Au(),ot(e=>typeof e=="string"),Vu(this._onDestroy$)).subscribe(e=>{this._yaCombinedService.searchValue=e;}),this._yaCombinedService.sharedSearchValue$.pipe(Vu(this._onDestroy$)).subscribe();}onSelect(e){let t=e.option.value;this.search.setValue(t.title,{emitEvent:false}),this.handleSelect.emit(t),this._yaCombinedService.geoSearch(t.data),this.closePanel();}closePanel(){this.inputRef.nativeElement.blur(),this.autocompleteDirRef?.closePanel();}clear(){this.search.setValue(""),this._yaCombinedService.searchResult=[],setTimeout(()=>this.closePanel());}displayFn(e){return e?.title||""}static{this.\u0275fac=(()=>{let e;return function(n){return (e||(e=kR(i)))(n||i)}})();}static{this.\u0275cmp=lO({type:i,selectors:[["yota-ya-search"]],viewQuery:function(t,n){if(t&1&&(MO(cm,5),MO(Ty,5,Ke)),t&2){let o;TO(o=SO())&&(n.autocompleteDirRef=o.first),TO(o=SO())&&(n.inputRef=o.first);}},outputs:{handleSelect:"handleSelect"},features:[_I],decls:11,vars:7,consts:[["inputRef","yInput"],["autocompleteRef","yAutocompleteBordered"],[1,"yota-ya-search"],["yPrefix","",1,"yota-ya-search-icon",3,"svgIcon"],["yInput","","type","text","id","combined-map-autocomplete",1,"yota-ya-search__autocomplete-input",3,"formControl","yAutocompleteBordered"],["ySuffix","",3,"state","inputControl","clear",4,"ngIf"],[3,"optionSelected"],["class","yota-ya-search__option",3,"value",4,"ngFor","ngForOf"],["ySuffix","",3,"clear","state","inputControl"],[1,"yota-ya-search__option",3,"value"],[1,"yota-ya-search__option-title",3,"innerHtml"],["class","yota-ya-search__option-subtitle y-accent",4,"ngIf"],[1,"yota-ya-search__option-subtitle","y-accent"]],template:function(t,n){if(t&1){let o=EO();kp(0,"y-form-field-bordered",2)(1,"y-label"),RO(2,"\u0412\u0432\u0435\u0434\u0438 \u0433\u043E\u0440\u043E\u0434, \u0430\u0434\u0440\u0435\u0441, \u0440\u0430\u0439\u043E\u043D \u0438\u043B\u0438 \u0422\u0426"),Pp(),DE(3,"y-icon",3)(4,"input",4,0),kI(6,Cn,1,2,"yota-field-state",5),kp(7,"y-autocomplete-bordered",6,1),RE("optionSelected",function(p){return AR(o),RR(n.onSelect(p))}),kI(9,xn,4,6,"y-option-bordered",7),$O(10,"async"),Pp()();}if(t&2){let o=AO(5),s=AO(8);QR(3),iE("svgIcon","search-outline"),QR(),iE("formControl",n.search)("yAutocompleteBordered",s),QR(2),iE("ngIf",o.focused&&o.value),QR(3),iE("ngForOf",UO(10,5,n.options$));}},dependencies:[An$1,Ge$1,yn$1,Mn$1,Tt,Ww,x$2,Dh,Jw,cd,ar,zt,gd,Ty,dg,tb,Cd,Vy,hd],styles:["[_nghost-%COMP%]   .yota-ya-search[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .yota-ya-search__autocomplete-input[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .yota-ya-search__clear-icon[_ngcontent-%COMP%]{font-size:12px}[_nghost-%COMP%]   .yota-ya-search[_ngcontent-%COMP%]     input.yota-ya-search__autocomplete-input::placeholder{all:unset!important;color:#b9c2cb!important}@media (max-width: 480px){[_nghost-%COMP%]   .yota-ya-search[_ngcontent-%COMP%]     input.yota-ya-search__autocomplete-input::placeholder{font-size:14px!important}}[_nghost-%COMP%]   .yota-ya-search-icon[_ngcontent-%COMP%]{width:24px;height:24px}  .y-option.yota-ya-search__option{padding:12px}  .y-option.yota-ya-search__option .y-option-text{display:flex;flex-direction:column;gap:12px}  .y-option.yota-ya-search__option .yota-ya-search__option-subtitle{font-size:12px}"],changeDetection:0});}}return i})();var Sn=["spList"],On=i=>({"b-combined-map__coverage-filter-button_active":i});function wn(i,a){i&1&&wE(0);}function Mn(i,a){if(i&1&&(kp(0,"div",11),kI(1,wn,1,0,"ng-container",12),Pp()),i&2){wO(2);let e=AO(8);QR(),iE("ngTemplateOutlet",e);}}function kn(i,a){i&1&&wE(0);}function In(i,a){if(i&1&&(kp(0,"div",11),kI(1,kn,1,0,"ng-container",12),Pp()),i&2){wO(2);let e=AO(10);QR(),iE("ngTemplateOutlet",e);}}function Pn(i,a){if(i&1&&kI(0,Mn,2,1,"div",10)(1,In,2,1,"div",10),i&2){let e=wO(2).ngIf,t=wO();iE("ngIf",t.modeTabs[e.modeTabIndex].type===t.modeTypes.COVER),QR(),iE("ngIf",t.modeTabs[e.modeTabIndex].type===t.modeTypes.SP);}}function Tn(i,a){if(i&1){let e=EO();kp(0,"div",18)(1,"p"),RO(2),Pp(),kp(3,"y-switch",19),RE("change",function(n){let o=AR(e).$implicit,s=wO(5);return RR(s.setFilter(n,o.key))}),Pp()();}if(i&2){let e=a.$implicit;QR(2),VE(e.value.text),QR(),iE("checked",e.value.checked)("disabled",e.value.disabled)("activeBgColor",e.value.color);}}function En(i,a){if(i&1&&(kp(0,"y-tab",15)(1,"div",16),kI(2,Tn,4,4,"div",17),$O(3,"keyvalue"),Pp()()),i&2){let e=a.$implicit;iE("label",e.label),QR(2),iE("ngForOf",UO(3,2,e.filter));}}function Ln(i,a){if(i&1){let e=EO();kp(0,"y-tab-group",13),RE("selectedTabChange",function(n){AR(e);let o=wO(3);return RR(o.changeFilterTab(n.index))}),kI(1,En,4,4,"y-tab",14),Pp();}if(i&2){let e=wO(2).ngIf,t=wO();iE("selectedIndex",e.coverTabIndex),QR(),iE("ngForOf",t.coverTabs);}}function $n(i,a){if(i&1){let e=EO();kp(0,"div",18)(1,"p"),RO(2),Pp(),kp(3,"y-switch",20),RE("change",function(n){let o=AR(e).$implicit,s=wO(5);return RR(s.setFilter(n,o.key,true))}),Pp()();}if(i&2){let e=a.$implicit;QR(2),VE(e.value.text),QR(),iE("checked",e.value.checked)("disabled",e.value.disabled);}}function Fn(i,a){if(i&1&&(kp(0,"y-tab",15)(1,"div",16),kI(2,$n,4,3,"div",17),$O(3,"keyvalue"),Pp()()),i&2){let e=a.$implicit;iE("label",e.label),QR(2),iE("ngForOf",UO(3,2,e.filter));}}function Bn(i,a){if(i&1){let e=EO();kp(0,"y-tab-group",13),RE("selectedTabChange",function(n){AR(e);let o=wO(3);return RR(o.changeFilterTab(n.index))}),kI(1,Fn,4,4,"y-tab",14),Pp();}if(i&2){let e=wO(2).ngIf,t=wO();iE("selectedIndex",e.salesPointsTabIndex),QR(),iE("ngForOf",t.salesPointsTabs);}}function Yn(i,a){if(i&1){let e=EO();Lp(0),kp(1,"button",6),RE("click",function(){AR(e);let n=wO().ngIf,o=wO();return RR(o.toggleFilter(!n.showFilters))}),kp(2,"span",7),RO(3),Pp(),kp(4,"y-icon",8),RO(5,"angle_down"),Pp()(),kI(6,Pn,2,2,"ng-template",9)(7,Ln,2,2,"ng-template",null,0,qO)(9,Bn,2,2,"ng-template",null,1,qO),jp();}if(i&2){let e=wO().ngIf,t=wO();QR(),iE("ngClass",jO(3,On,e.showFilters)),QR(2),VE(t.modeTabs[e.modeTabIndex].tabsLabel),QR(3),iE("ngIf",e.showFilters);}}function Dn(i,a){if(i&1){let e=EO();kp(0,"button",23),RE("click",function(){AR(e);let n=wO(3);return RR(n.toggleListView(true))}),kp(1,"span",7),RO(2,"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u043F\u0438\u0441\u043A\u043E\u043C"),Pp()();}}function An(i,a){if(i&1&&(kp(0,"div",33),RO(1),Pp()),i&2){let e=wO().$implicit;QR(),Hp(" ",e.address," ");}}function Rn(i,a){if(i&1&&(kp(0,"div",34),RO(1),Pp()),i&2){let e=wO().$implicit;QR(),Hp(" ",e.howToFind," ");}}function Vn(i,a){if(i&1&&(kp(0,"div",35),RO(1),Pp()),i&2){let e=wO().$implicit;QR(),Hp(" ",e.workingTime," ");}}function jn(i,a){if(i&1&&(kp(0,"div",36),RO(1),Pp()),i&2){let e=a.$implicit;QR(),Hp(" ",e.name," ");}}function Nn(i,a){if(i&1){let e=EO();kp(0,"li",26),RE("click",function(){let n=AR(e).$implicit,o=wO(4);return RR(o.selectPoint(n))}),kp(1,"div",27),RO(2),Pp(),kI(3,An,2,1,"div",28)(4,Rn,2,1,"div",29)(5,Vn,2,1,"div",30),kp(6,"div",31),kI(7,jn,2,1,"div",32),Pp()();}if(i&2){let e=a.$implicit;zI("data-code",e.code),QR(2),Hp(" ",e.name," "),QR(),iE("ngIf",e.address),QR(),iE("ngIf",e.howToFind),QR(),iE("ngIf",e.workingTime),QR(2),iE("ngForOf",e.functions);}}function zn(i,a){if(i&1&&(kp(0,"ul",24,2),kI(2,Nn,8,6,"li",25),Pp()),i&2){let e=wO(3);QR(2),iE("ngForOf",e.salePoints);}}function Zn(i,a){if(i&1&&(Lp(0),kI(1,Dn,3,0,"button",21)(2,zn,3,1,"ul",22),jp()),i&2){let e=wO().ngIf;QR(),iE("ngIf",e.showFilters&&!e.showListView),QR(),iE("ngIf",e.showListView);}}function qn(i,a){if(i&1){let e=EO();Lp(0),kp(1,"yota-ya-search",5),RE("handleSelect",function(n){AR(e);let o=wO();return RR(o.handleSelect(n))}),Pp(),kI(2,Yn,11,5,"ng-container",4)(3,Zn,3,2,"ng-container",4),jp();}if(i&2){let e=a.ngIf,t=wO();QR(2),iE("ngIf",e.tabMode),QR(),iE("ngIf",t.modeTabs[e.modeTabIndex].type===t.modeTypes.SP);}}var Ge=(()=>{class i{constructor(e,t,n,o){this._document=e,this._dialogData=t,this._renderer=n,this._cdr=o,this.modeTypes=P,this._yaCombinedService=I(U),this._breakpointObserver=I(U$1),this._analyticsFacadeService=I(O),this._destroy$=new X,this.currentState$=this._yaCombinedService.currentState$,this.modeTabs=this._yaCombinedService.modeTabs,this.coverTabs=this._yaCombinedService.coverTabs,this.salesPointsTabs=this._yaCombinedService.salesPointsTabs,this.salePoints=[],this.isMobile=false,this._yaCombinedService.salesPointsResult$.pipe(Vu(this._destroy$)).subscribe(s=>{this.salePoints=s,this._cdr.markForCheck();}),this._breakpointObserver.observe("(max-width: 950px)").pipe(Vu(this._destroy$)).subscribe(s=>this.isMobile=s.matches);}ngAfterViewInit(){this._dialogData?.isSwiped&&this._initSwipeToDialog();}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete();}changeFilterTab(e){this._yaCombinedService.changeFilterTab(e);}setFilter(e,t,n=false){this._yaCombinedService.setFilter(e,t,n),this._yaCombinedService.boundsChanged$.next();}toggleFilter(e){let t=x(w$1({},this._yaCombinedService.currentState$.value),{showFilters:e});e&&(t.showListView=false),this._yaCombinedService.currentState$.next(t);let n=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${n}/\u0424\u0438\u043B\u044C\u0442\u0440 \u043F\u043E \u0443\u0441\u043B\u0443\u0433\u0430\u043C/${e?"\u041E\u0422\u041A\u0420":"\u0417\u0410\u041A\u0420"}`},O$1.CLICK_MAP_SERVICES_COLLAPSE);}toggleListView(e){let t=this._yaCombinedService.currentState$.value.showFilters;this._yaCombinedService.currentState$.next(x(w$1({},this._yaCombinedService.currentState$.value),{showFilters:e?false:t,showListView:e})),e&&this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F / \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u043F\u0438\u0441\u043A\u043E\u043C"},O$1.CLICK_MAP_SHOW_LIST_BOX);}selectPoint(e){this.isMobile&&(this.toggleFilter(false),this.toggleListView(false));let t=this._yaCombinedService.selectedSalePoint$.getValue();t?.code===e.code||t?.latitude===e.latitude&&t.longitude===e.longitude||this._yaCombinedService.selectPoint(e).pipe(Et(1),Hu(n=>{this.salePoints=n,this._cdr.markForCheck();}),Hu(()=>{this._yaCombinedService.selectedSalePoint$.next(e);})).subscribe(()=>{if(this.spList?.nativeElement){let n=this.spList.nativeElement.querySelector(`[data-code=${e?.code}]`);n&&this.spList.nativeElement.scrollTo({top:n.offsetTop,behavior:"smooth"});}});}_initSwipeToDialog(){this._addSwipeToDialog();}_addSwipeToDialog(){let e=this._document?.querySelector("#y-combined-content"),t=this._createSwipeElement();this._renderer.appendChild(e,t),this._initListeners(t,e);let n=e?.closest(".cdk-global-overlay-wrapper")??null;n&&this._setStyles(n,{"z-index":"999"});}_initListeners(e,t){let n=Wi(e,"touchstart").pipe(Hu(()=>{this._renderer.setStyle(t,"box-shadow","0 -5px 5px rgba(0, 0, 0, 0.1)");}),le(r=>r.touches[0].clientY)),o$1=Wi(e,"touchmove").pipe(Hu(r=>{r.preventDefault();})),s=Wi(e,"touchend").pipe(Hu(()=>{this._renderer.removeStyle(t,"box-shadow");}),le(r=>r.changedTouches[0].clientY)),p=n.pipe(ju(r=>s.pipe(le(h=>r>h+20))));gg(p,o$1).pipe(Mu(100),Vu(this._destroy$)).subscribe(r=>{let h=this.currentState$.value.showListView;o(r)&&!h?this.toggleFilter(r):this.toggleListView(false);});}_setStyles(e,t){for(let n in t)this._renderer.setStyle(e,n,t[n]);}_createSwipeElement(){let e={position:"absolute",top:"0",left:"0",height:"65px",width:"100%",opacity:"0"},t=this._renderer.createElement("div");return this._setStyles(t,e),t}handleSelect(e){let t=this._yaCombinedService.currentState$.value.modeTabIndex===0?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${t}/${e.title}/${e.subtitle}`},O$1.ADDRESS_SELECT);}static{this.\u0275fac=function(t){return new(t||i)(k(cr),k(Xu,8),k(or),k(ci))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-ya-combined-content"]],viewQuery:function(t,n){if(t&1&&MO(Sn,5),t&2){let o;TO(o=SO())&&(n.spList=o.first);}},decls:3,vars:3,consts:[["coverageTabs",""],["spTabs",""],["spList",""],[1,"b-combined-map__mode-content"],[4,"ngIf"],[3,"handleSelect"],["y-button-icon","",1,"y-button-icon","b-combined-map__coverage-filter-button",3,"click","ngClass"],[1,"y-link-pseudo"],["color","primary"],[3,"ngIf"],["class","b-combined-map-coverage-filter__drop-panel",4,"ngIf"],[1,"b-combined-map-coverage-filter__drop-panel"],[4,"ngTemplateOutlet"],["y-stretch-tabs","","animationDuration","0ms",1,"b-combined-map-tabs",3,"selectedTabChange","selectedIndex"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[1,"b-combined-map-tabs__body"],["class","b-combined-map-tabs__tab-content",4,"ngFor","ngForOf"],[1,"b-combined-map-tabs__tab-content"],[1,"trialTariff__toggle",3,"change","checked","disabled","activeBgColor"],[1,"trialTariff__toggle",3,"change","checked","disabled"],["y-button-icon","","class","y-button-icon b-combined-map__coverage-filter-button",3,"click",4,"ngIf"],["class","sp-list",4,"ngIf"],["y-button-icon","",1,"y-button-icon","b-combined-map__coverage-filter-button",3,"click"],[1,"sp-list"],["class","sp-list__item",3,"click",4,"ngFor","ngForOf"],[1,"sp-list__item",3,"click"],[1,"sp-list__item-title"],["class","sp-list__item-address",4,"ngIf"],["class","sp-list__item-description",4,"ngIf"],["class","sp-list__item-work-time",4,"ngIf"],[1,"sp-list__item-functions"],["class","sp-list__item-function",4,"ngFor","ngForOf"],[1,"sp-list__item-address"],[1,"sp-list__item-description"],[1,"sp-list__item-work-time"],[1,"sp-list__item-function"]],template:function(t,n){t&1&&(kp(0,"div",3),kI(1,qn,4,2,"ng-container",4),$O(2,"async"),Pp()),t&2&&(QR(),iE("ngIf",UO(2,1,n.currentState$)));},dependencies:[Ww,ln,zw,Yw,Dh,Jw,nC,cn,zt,my,Cu,gm],styles:["[_nghost-%COMP%]   .b-combined-map__coverage-filter-button[_ngcontent-%COMP%]{display:flex;gap:8px;margin:10px auto}[_nghost-%COMP%]   .b-combined-map__coverage-filter-button[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{will-change:auto;font-size:8px;transition:transform .2ms}[_nghost-%COMP%]   .b-combined-map__coverage-filter-button_active[_ngcontent-%COMP%]   y-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}[_nghost-%COMP%]   .b-combined-map-tabs[_ngcontent-%COMP%]  .y-tab-label{min-width:50%}[_nghost-%COMP%]   .b-combined-map-tabs__body[_ngcontent-%COMP%]{padding-top:35px}[_nghost-%COMP%]   .b-combined-map-tabs__tab-content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;margin-bottom:7px}[_nghost-%COMP%]   .b-combined-map-tabs__tab-content.disabled[_ngcontent-%COMP%]{color:#d9dce1}.sp-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;max-height:356px;margin:0 -24px;position:relative}.sp-list__item[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:15px 24px;gap:12px;cursor:pointer}.sp-list__item[_ngcontent-%COMP%]:hover{background-color:#f4fbfe}.sp-list__item-title[_ngcontent-%COMP%], .sp-list__item-address[_ngcontent-%COMP%], .sp-list__item-work-time[_ngcontent-%COMP%], .sp-list__item-description[_ngcontent-%COMP%]{font-size:16px;font-weight:700;line-height:22px;text-overflow:ellipsis}.sp-list__item-description[_ngcontent-%COMP%]{color:#a1a5ae;text-overflow:ellipsis}.sp-list__item-address[_ngcontent-%COMP%], .sp-list__item-work-time[_ngcontent-%COMP%], .sp-list__item-description[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.sp-list__item-description[_ngcontent-%COMP%]{color:#a1a5ae}.sp-list__item-functions[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:8px}.sp-list__item-function[_ngcontent-%COMP%]{display:inline-flex;padding:0 4px;border-radius:4px;color:#a1a5ae;background-color:#f8f8f8;font-size:12px;line-height:24px;vertical-align:middle}"],changeDetection:0});}}return i})();var Un=["overlayContent"];function Xn(i,a){if(i&1&&DE(0,"y-tab",9),i&2){let e=a.$implicit;iE("label",e.label);}}function Qn(i,a){if(i&1&&(Lp(0),kI(1,Xn,1,1,"y-tab",8),jp()),i&2){let e=wO(2);QR(),iE("ngForOf",e.modeTabs);}}function Gn(i,a){if(i&1&&DE(0,"y-tab",9),i&2){let e=wO().ngIf,t=wO();iE("label",t.modeTabs[e.modeTabIndex].label);}}function Hn(i,a){if(i&1){let e=EO();kp(0,"y-tab-group",6),RE("selectedTabChange",function(n){AR(e);let o=wO();return RR(o.changeModeTab(n.index))}),kI(1,Qn,2,1,"ng-container",7)(2,Gn,1,1,"ng-template",null,0,qO),Pp();}if(i&2){let e=a.ngIf,t=AO(3);sE("solo-tab",e.splitMode),iE("selectedIndex",e.modeTabIndex),QR(),iE("ngIf",!e.splitMode)("ngIfElse",t);}}function Kn(i,a){i&1&&(kp(0,"div",10),DE(1,"yota-ya-combined-content"),Pp());}var we=class i extends p$1{set map$(a){this._map$=a;}constructor(a){super(),this._overlay=a,this._map$=new X,this._dialogService=I(mr),this._yaCombinedService=I(U),this._breakpointObserver=I(U$1),this.currentState$=this._yaCombinedService.currentState$,this.modeTabs=this._yaCombinedService.modeTabs,this.isDesktop$=this._breakpointObserver.observe(["(min-width: 993px)"]).pipe(le(e=>e.matches),Hu(e=>{this._isDesktop=e,e?this._toggleOverlay(e):this._yaCombinedService.showOverlayFilters$.getValue()&&this._dialogRef?.getState()!==0&&this._toggleOverlay(false);})),this.showCombinedPanel=true,this._isDesktop=true,this._yaCombinedService.getSpFilter(),this._yaCombinedService.showOverlayFilters$.pipe(ot(()=>!this._isDesktop),Vu(this._onDestroy$)).subscribe(e=>{this._toggleOverlay(!e);});}ngOnInit(){this._map$.pipe(ot(Boolean),Et(1),Vu(this._onDestroy$)).subscribe(()=>B(this,null,function*(){if(!ymaps.Layer)try{yield ymaps.modules.require(["Layer"],a=>{ymaps.Layer=a;});}catch(a){console.error("ymaps.Layer error: ",a);}this._yaCombinedService.updateLayers();}));}changeModeTab(a){this._yaCombinedService.changeModeTab(a);}_toggleOverlay(a){if(!this.showCombinedPanel||a){p$2.closeDialog(this._dialogRef);return}this._dialogRef=this._dialogService.open(Ge,{id:"y-combined-content",panelClass:["y-dialog-bottom","y-combined-content-dialog"],disableClose:false,hasBackdrop:false,scrollStrategy:this._overlay.scrollStrategies.reposition(),data:{isSwiped:true},restoreFocus:false});}static{this.\u0275fac=function(e){return new(e||i)(k(ge))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-ya-combined"]],viewQuery:function(e,t){if(e&1&&MO(Un,5,Ye),e&2){let n;TO(n=SO())&&(t.overlayContentTemplate=n.first);}},inputs:{map$:"map$",showCombinedPanel:"showCombinedPanel"},features:[_I],decls:7,vars:6,consts:[["soloTab",""],[1,"b-combined-map__wrapper"],[1,"b-combined-map__form"],[1,"b-combined-map__modes-body"],["class","y-background-primary","y-stretch-tabs","","animationDuration","0ms",3,"selectedIndex","solo-tab","selectedTabChange",4,"ngIf"],["class","b-combined-map__modes-content",4,"ngIf"],["y-stretch-tabs","","animationDuration","0ms",1,"y-background-primary",3,"selectedTabChange","selectedIndex"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[1,"b-combined-map__modes-content"]],template:function(e,t){e&1&&(kp(0,"div",1)(1,"div",2)(2,"div",3),kI(3,Hn,4,5,"y-tab-group",4),$O(4,"async"),kI(5,Kn,2,0,"div",5),$O(6,"async"),Pp()()()),e&2&&(QR(3),iE("ngIf",UO(4,2,t.currentState$)),QR(2),iE("ngIf",UO(6,4,t.isDesktop$)));},dependencies:[Ww,Dh,Ge,Jw,my,Cu],styles:["[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-header{width:100%}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-header>.y-tab-label-container>.y-tab-list .y-tab-labels>.y-tab-label{background-color:#00aeef;color:#fff}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-header>.y-tab-label-container>.y-tab-list .y-tab-labels>.y-tab-label-active{background-color:#fff;color:#434c5d}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-body-wrapper, [_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-body-content{overflow:initial}[_nghost-%COMP%]   .y-tab-group[_ngcontent-%COMP%]  .y-tab-body.y-tab-body-active{overflow:initial}[_nghost-%COMP%]     .y-tab-group.solo-tab .y-tab-header .y-tab-label{cursor:default!important}.b-combined-map__wrapper[_ngcontent-%COMP%]{position:absolute;top:calc(20px + -1 * var(--sales-points-margin-top, 0px));left:40px;display:flex;max-height:calc(100% - 40px);overflow:hidden}.b-combined-map__form[_ngcontent-%COMP%]{max-height:100%;width:360px;border-radius:5px;background-color:#fff;box-shadow:0 4px 12px #dbe1eb66;overflow:auto}.b-combined-map__modes-content[_ngcontent-%COMP%]{padding:16px 24px}@media (max-width: 992px){.b-combined-map__wrapper[_ngcontent-%COMP%]{width:calc(100vw - 80px);max-height:48px;overflow:hidden}.b-combined-map__form[_ngcontent-%COMP%]{width:100%}}@media (max-width: 480px){.b-combined-map__wrapper[_ngcontent-%COMP%]{width:calc(100vw - 32px);left:16px}}  .y-combined-content-dialog{transition:transform .2s ease}  body.header-has-under-panel .y-combined-content-dialog{transform:translateY(100%)!important}"],changeDetection:0});}};Ob([v$1],we.prototype,"_toggleOverlay",null);var Wn=["container"];function Jn(i,a){if(i&1&&DE(0,"yota-ya-combined",6),i&2){let e=wO();iE("map$",e.sharedMap$)("hidden",!e.showCombinedPanel)("showCombinedPanel",e.showCombinedPanel);}}function ei(i,a){if(i&1){let e=EO();kp(0,"yota-ya-control",7),RE("fullscreen$",function(n){AR(e);let o=wO();return RR(o.setFullscreen(n))}),Pp();}if(i&2){let e=wO();iE("controls",e.getControls)("map$",e.sharedMap$);}}var rn=(()=>{class i{set balloonOrderUrl(e){this._balloonOrderUrl=e;}set balloonOrderText(e){this._balloonOrderText=e;}constructor(e,t,n,o,s){this._el=e,this._ngZone=t,this._yaApiLoaderService=n,this._document=s,this.map$=new In$1(null),this.isMonochrome=true,this.isFullscreen=false,this.hidePlacemarksWithoutGood=false,this.center=[0,0],this.zoom=10,this.ready=new st,this.showCombined=true,this.showControls=true,this.isCombined=true,this.getControls=new Set(["fullscreen","locate","zoom"]),this.showCombinedPanel=true,this.isBannerOpen=false,this.isOrderMap=false,this.salePointSelected=new st,this._yaCombinedService=I(U),this._sanitizer=I(qe$1),this._iconRegistry=I(rr),this._window=I(i$1),this.sharedMap$=this.map$.pipe(ot(Boolean),Hu(p=>this._yaCombinedService.map=p),kr()),this._destroy$=new X,this._eventManager=new Ze(this._ngZone),this._balloonOrderUrl="voice/order-sim",this._balloonOrderText="\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443",this.actionbegin=this._eventManager.getLazyEmitter("actionbegin"),this.actionbreak=this._eventManager.getLazyEmitter("actionbreak"),this.actionend=this._eventManager.getLazyEmitter("actionend"),this.actiontick=this._eventManager.getLazyEmitter("actiontick"),this.actiontickcomplete=this._eventManager.getLazyEmitter("actiontickcomplete"),this.balloonclose=this._eventManager.getLazyEmitter("balloonclose"),this.balloonopen=this._eventManager.getLazyEmitter("balloonopen"),this.boundschange=this._eventManager.getLazyEmitter("boundschange"),this.yaclick=this._eventManager.getLazyEmitter("click"),this.yacontextmenu=this._eventManager.getLazyEmitter("contextmenu"),this.yadblclick=this._eventManager.getLazyEmitter("dblclick"),this.destroy=this._eventManager.getLazyEmitter("destroy"),this.hintclose=this._eventManager.getLazyEmitter("hintclose"),this.hintopen=this._eventManager.getLazyEmitter("hintopen"),this.marginchange=this._eventManager.getLazyEmitter("marginchange"),this.yamousedown=this._eventManager.getLazyEmitter("mousedown"),this.yamouseenter=this._eventManager.getLazyEmitter("mouseenter"),this.yamouseleave=this._eventManager.getLazyEmitter("mouseleave"),this.yamousemove=this._eventManager.getLazyEmitter("mousemove"),this.yamouseup=this._eventManager.getLazyEmitter("mouseup"),this.multitouchend=this._eventManager.getLazyEmitter("multitouchend"),this.multitouchmove=this._eventManager.getLazyEmitter("multitouchmove"),this.multitouchstart=this._eventManager.getLazyEmitter("multitouchstart"),this.optionschange=this._eventManager.getLazyEmitter("optionschange"),this.sizechange=this._eventManager.getLazyEmitter("sizechange"),this.typechange=this._eventManager.getLazyEmitter("typechange"),this.yawheel=this._eventManager.getLazyEmitter("wheel"),this._salesPointsSubject$=new X,this._placemarkTemplate=`<div class="ya-map__placemark">
          <svg width="26" height="35" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 35s13-14.626 13-21.875C26 5.876 20.18 0 13 0S0 5.876 0 13.125 13 35 13 35z" fill="#00AEEF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13 19a6 6 0 100-12 6 6 0 000 12z" fill="#fff"/></svg>
</div>`,this._placemarkActiveTemplate=`<div class="ya-map__placemark ya-map__placemark_active">
          <svg style="transform: scale(1.5) translateY(-6px)" width="26" height="35" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 35s13-14.626 13-21.875C26 5.876 20.18 0 13 0S0 5.876 0 13.125 13 35 13 35z" fill="#434C5D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13 19a6 6 0 100-12 6 6 0 000 12z" fill="#fff"/></svg>
</div>`,this._functionsTemplate=`
        {% if geoObject.properties.functions %}
        <ul class="ya-map__balloon-pickup__functions">
            {% for function in geoObject.properties.functions %}
                <li class="ya-map__balloon-pickup__function">
                    {{function.name|raw}}
                </li>
            {% endfor %}
        </ul>
        {% endif %}
    `,this._functionsClusterTemplate=`
        {% if geoObject.properties.functions %}
        <ul class="ya-map__balloon-pickup__functions">
            {% for function in geoObject.properties.functions %}
                <li class="ya-map__balloon-pickup__function">
                    {{function.name|raw}}
                </li>
            {% endfor %}
        </ul>
        {% endif %}
    `,this._pickupButton='<button class="y-button-secondary ya-map__balloon-pickup-select">\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C</button>',this._pickupClusterButton='<button class="y-button-secondary ya-map__balloon-pickup-select" data-code="{{geoObject.properties.code}}">\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C</button>',this._pickupError='<div class="ya-map__balloon-pickup-error"><svg class="ya-map__balloon-pickup-error__icon" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 20.5C17.1944 20.5 21 16.6944 21 12C21 7.30558 17.1944 3.5 12.5 3.5C7.80558 3.5 4 7.30558 4 12C4 16.6944 7.80558 20.5 12.5 20.5ZM12.5 22C18.0228 22 22.5 17.5228 22.5 12C22.5 6.47715 18.0228 2 12.5 2C6.97715 2 2.5 6.47715 2.5 12C2.5 17.5228 6.97715 22 12.5 22Z" fill="#00AEEF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 11C13.0523 11 13.5 11.4477 13.5 12V16C13.5 16.5523 13.0523 17 12.5 17C11.9477 17 11.5 16.5523 11.5 16V12C11.5 11.4477 11.9477 11 12.5 11Z" fill="#00AEEF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13.75 8.25C13.75 8.94036 13.1904 9.5 12.5 9.5C11.8096 9.5 11.25 8.94036 11.25 8.25C11.25 7.55964 11.8096 7 12.5 7C13.1904 7 13.75 7.55964 13.75 8.25Z" fill="#00AEEF"/></svg><p class="ya-map__balloon-pickup-error__text">\u0417\u0434\u0435\u0441\u044C \u0442\u043E\u0432\u0430\u0440 \u0443\u0436\u0435 \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0441\u044F, <br> \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443 \u043F\u0440\u043E\u0434\u0430\u0436</p></div>',this._pickupLoader='<div class="ya-map__balloon-ellipsis"><div></div><div></div><div></div><div></div></div>',this._uniqPointsSet=new qe,this._triggerOverlayIntersecting=false,this._mapIntersecting=false,this.intersectionOverlayTriggerId="map-intersection-overlay-trigger",this._scrollZoomByUrl=true,this._maxZoom=18,this._minZoom=6,this._clusterOrderClass="ya-map__balloon ya-map__balloon_cluster ya-map__balloon_list ya-map__balloon_list_order",this._clusterMapClass="ya-map__balloon ya-map__balloon_cluster ya-map__balloon_list",this._analyticsFacadeService=I(O),this._router=I(q),this._initIcons(),this.setFullscreen(JSON.parse(o.snapshot.queryParams.fullscreen||"false")),this._scrollZoomByUrl=this._router.url.includes("e-sim")||this._router.url.includes("modem"),this._yaCombinedService.selectedSalePoint$.pipe(Vu(this._destroy$)).subscribe(p=>{if(!p){this.map$.value?.balloon.close();return}let r=this._clusterer.getGeoObjects().find(u=>u.properties.get("code")===p.code);if(!r)return;let h=this._clusterer.getObjectState(r);if(h.isClustered&&h.cluster)h.cluster.state.set("activeObject",r),this._clusterer.balloon.open(h.cluster);else {if(!r?.balloon||r.balloon.isOpen())return;this.map$.value?.balloon.isOpen&&this.map$.value.balloon.close(),r.balloon?.open(void 0,p,{shadow:true,layout:this._balloonLayout,contentLayout:this._balloonContentLayout,panelMaxMapArea:0});}}),this.yaclick.pipe(Vu(this._destroy$)).subscribe(()=>{this.bannerComponent.hideMobileCard();});}get maxZoom(){return this._maxZoom}set maxZoom(e){e&&(this._maxZoom=e);}get minZoom(){return this._minZoom}set minZoom(e){e&&(this._minZoom=e);}set salePoints(e){e&&this._filterAndDisplaySalePoints(e);}set salePoints$(e){e.pipe(ot(Boolean)).pipe(Vu(this._destroy$)).subscribe(t=>{this._filterAndDisplaySalePoints(t);});}set controls(e){this.getControls=new Set(e);}set fullScreen(e){this.setFullscreen(e);}get _balloonTemplate(){return `<div class="ya-map__balloon-pickup">
                     <div class="ya-map__balloon-pickup__content">
                        <div class="ya-map__balloon-pickup__title">{{geoObject.properties.name|raw}}</div>
                        <div class="ya-map__balloon-pickup__location">
                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.address|raw}}</div>
                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.howToFind|raw}}</div>
                        </div>
                        <div class="ya-map__balloon-pickup__time">{{geoObject.properties.workingTime|raw}}</div>
                        ${this.isCombined?this._functionsTemplate:""}
                        <div class="ya-map__balloon-pickup__actions ya-map__balloon-pickup-select-show">
                        ${this.isCombined?this._combButton:this._pickupButton}
                        </div>

                         ${this._pickupLoader}
                         ${this._pickupError}
                    </div>
                </div>`}get _baloon(){return {template:this._balloonTemplate,layout:`<div class='ya-map__balloon'>
                        {% include options.contentLayout %}
                        <a class="ya-map__balloon-close"></a>
                     </div>`,clusterIconContentLayout:this._getClusterIcon(),tagsTemplate:"<div>Functions</div>"}}get _clusterBalloonTemplate(){return `<div class="ya-map__balloon-pickup">
                     <div class="ya-map__balloon-pickup__content">
                        <div class="ya-map__balloon-pickup__title">{{name|raw}}</div>
                        <div class="ya-map__balloon-pickup__location">
                          <div class="ya-map__balloon-pickup__address">{{address|raw}}</div>
                        </div>
                        <div class="ya-map__balloon-pickup__time">{{workingTime|raw}}</div>
                        ${this.isCombined?this._functionsTemplate:""}
                        <div class="ya-map__balloon-pickup__actions">
                        ${this.isCombined?this._combButton:this._pickupButton}
                        ${this._pickupClusterButton}
                        ${this._pickupLoader}
                        </div>
                    </div>
                </div>`}get _clusterBalloon(){return {template:"<div>TEST</div>",layout:`<div class="${this.isOrderMap?this._clusterOrderClass:this._clusterMapClass}">
                        <div class="${this.isOrderMap?"ya-map__balloon-wrapper ya-map__balloon-wrapper_order":"ya-map__balloon-wrapper"}">
                        <a class="ya-map__balloon-close"></a>
                        <div class="${this.isOrderMap?"ya-map__balloon-box":"ya-map__balloon-box ya-map__balloon-box_map"}">
                            {% for geoObject in properties.geoObjects %}
                                <div class="${this.isOrderMap?"ya-map__balloon-pickup ya-map__balloon-pickup_order":"ya-map__balloon-pickup"}">
                                     <div class="ya-map__balloon-pickup__content">
                                        <div class="ya-map__balloon-pickup__title">{{geoObject.properties.name|raw}}</div>
                                        <div class="ya-map__balloon-pickup__location">
                                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.address|raw}}</div>
                                          <div class="ya-map__balloon-pickup__address">{{geoObject.properties.howToFind|raw}}</div>
                                        </div>
                                        <div class="ya-map__balloon-pickup__time">{{geoObject.properties.workingTime|raw}}</div>
                                        ${this.isCombined?this._functionsClusterTemplate:""}
                                        ${this.isCombined?"":`<div class="ya-map__balloon-pickup__actions">${this._pickupClusterButton}
                                                 </div>`}
                                         ${this.isOrderMap?`${this._pickupLoader}  ${this._pickupError}`:""}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        </div>
                        ${this.isCombined?`<div class=${this.isOrderMap?"ya-map__balloon-pickup__actions ya-map__balloon-pickup__actions_hidden ":"ya-map__balloon-pickup__actions"}>${this._combButton}</div>`:""}
                     </div>`,clusterIconContentLayout:this._getClusterIcon(),clusterActiveIconContentLayout:this._getActiveClusterIcon(),tagsTemplate:"<div>Functions</div>"}}get _combButton(){return `<a href="${this._balloonOrderUrl}" class="${this.isOrderMap?"y-button-secondary ya-map__balloon-pickup-select":"y-button-secondary ya-map__balloon-pickup-select ya-map__balloon-pickup-select_map"}">${this._balloonOrderText}</a>`}ngOnChanges(e){let t=this.map$.value;if(t){let{center:n,zoom:o,state:s,options:p}=e;s&&this._setState(this._combineState(),t),n&&t.setCenter(n.currentValue),o&&t.setZoom(o.currentValue),p&&t.options.set(p.currentValue);}}ngAfterViewInit(){this._yaCombinedService.sharedSearchValue$.pipe(Vu(this._destroy$)).subscribe(e=>{let n=this._yaCombinedService.getCurrentModeType()==P.COVER?"\u041A\u0430\u0440\u0442\u0430 \u043F\u043E\u043A\u0440\u044B\u0442\u0438\u044F":"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436";this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`${n}/${e}`},O$1.FIND_ADRESS);}),this._yaApiLoaderService.load().pipe(Et(1),Vu(this._destroy$)).subscribe(()=>B(this,null,function*(){let e=an(),t=this._createMap(e);if(this._scrollZoomByUrl&&t.behaviors.disable("scrollZoom"),yield this._initTemplateFactory(),this.map$.next(t),this.map$.value){let n,o;this.map$.value.balloon.events.add("open",s=>{s.originalEvent.target?.options?.set("iconLayout",this._placemarkActiveIconLayout),n=s.originalEvent.target;let p;n?.properties?._data?.address?p=n?.properties?._data?.address:p=n.getClusters()[0]?.properties?._data?.geoObjects[0]?.properties?._data?.address,p&&this._analyticsFacadeService.pushDataLayer({event:E.ACTIONS,event_param:`\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436/${p}`},O$1.SELECT_SALE_POINT);let r=n.getClusters(),h=n.balloon.getOverlaySync().getView().getPosition();o=r.find(u=>{let k=u.getOverlaySync().getView().getPosition();return k[0]===h[0]&&k[1]===h[1]}),s.originalEvent.target?.options?.set("iconLayout",this._placemarkActiveIconLayout),o.options?.set("clusterIconLayout",this._clusterActiveIconContentLayout),this._centerBalloon();}).add("close",()=>{o?.options?.set("clusterIconLayout",this._clusterIconContentLayout),n?.options?.set("iconLayout",this._placemarkIconLayout),n=null,o=null;}),this.map$.value.geoObjects.events.add("click",s=>{let r=s.get("target").properties.get("geoObjects");Y(r)&&this.map$.value?.balloon.isOpen()&&this._yaCombinedService.selectedSalePoint$.next(null);});}this._eventManager.setTarget(t),this._ngZone.run(()=>this.ready.emit({ymaps,target:t}));})),this._initIntersectionOverlayTrigger(),this._initBannerIntersectionObserver();}ngOnDestroy(){clearTimeout(this._mapTimeout),this._eventManager.destroy(),this._destroy$.next(),this._destroy$.complete(),this._intersectionObserver?.disconnect();}setFullscreen(e){this.isFullscreen=e,this._router.navigate([],{queryParams:{fullscreen:this.isFullscreen},queryParamsHandling:"merge",skipLocationChange:true}).then(),this._mapTimeout=setTimeout(t=>{this.map$.value?.container.fitToViewport();});}displayBalloon(e){if(!this.map$.value)return;let t=e,n=[+t.latitude,+t.longitude];this.map$.value.balloon.open(n,t,{shadow:true,layout:this._balloonLayout,contentLayout:this._balloonContentLayout,panelMaxMapArea:0}).then(()=>{this._centerBalloon();});}_initTemplateFactory(){return B(this,null,function*(){ymaps.templateLayoutFactory||(yield ymaps.modules.require(["templateLayoutFactory"],e=>{ymaps.templateLayoutFactory=e;})),this._makeTemplate();})}_makeTemplate(){let e=this;e._balloonLayout=ymaps.templateLayoutFactory.createClass(this._baloon.layout,{build:function(){e._balloonLayout.superclass.build.call(this);let t=".ya-map__balloon",n=e._balloonLayout.superclass.getParentElement.call(this).querySelector(t),o=n?.querySelector(`${t}-close`),s=n?.querySelector(`${t}-pickup-select`);o?.addEventListener("click",ymaps.util.bind(this.onCloseClick,this)),s?.addEventListener("click",ymaps.util.bind(this.onSelectClick,this)),this.applyElementOffset();},clear:function(){let t=".ya-map__balloon",n=e._balloonLayout.superclass.getParentElement.call(this).querySelector(t),o=n?.querySelector(`${t}-close`),s=n?.querySelector(`${t}-pickup-select`);o?.removeEventListener("click",ymaps.util.bind(this.onCloseClick,this)),s?.removeEventListener("click",ymaps.util.bind(this.onSelectClick,this)),e._balloonLayout.superclass.clear.call(this);},onCloseClick:function(){this.events.fire("userclose"),e._yaCombinedService.selectedSalePoint$.next(null);},onSelectClick:function(){e._ngZone.run(()=>{e.salePointSelected.emit(this._data?.userData);});},applyElementOffset:function(){let n=e._balloonLayout.superclass.getParentElement.call(this).querySelector(".ya-map__balloon");n.style.left=-(n.offsetWidth/2)+"px",n.style.top=-(n.offsetHeight+14)+"px";}}),e._balloonContentLayout=ymaps.templateLayoutFactory.createClass(e._baloon.template),e._placemarkIconLayout=ymaps.templateLayoutFactory.createClass(e._placemarkTemplate,{build(){e._placemarkIconLayout.superclass.build.call(this),e._placemarkIconLayout.superclass.getParentElement.call(this).querySelector(".ya-map__placemark").setAttribute("data-points-codes",this._data?.properties?._data?.code);},clear(){e._placemarkIconLayout.superclass.clear.call(this);}}),e._placemarkActiveIconLayout=ymaps.templateLayoutFactory.createClass(e._placemarkActiveTemplate),e._clusterIconContentLayout=ymaps.templateLayoutFactory.createClass(e._clusterBalloon.clusterIconContentLayout,{build(){e._clusterIconContentLayout.superclass.build.call(this);let n=e._clusterBalloonLayout.superclass.getParentElement.call(this).querySelector(".ya-map__cluster-icon"),o=this._data?.properties?._data?.geoObjects.map(s=>s?.properties?._data?.code);n.setAttribute("data-points-codes",o?.join(","));},clear(){e._clusterIconContentLayout.superclass.clear.call(this);}}),e._clusterActiveIconContentLayout=ymaps.templateLayoutFactory.createClass(e._clusterBalloon.clusterActiveIconContentLayout,{build(){e._clusterIconContentLayout.superclass.build.call(this);},clear(){e._clusterIconContentLayout.superclass.clear.call(this);}}),e._clusterBalloonLayout=ymaps.templateLayoutFactory.createClass(e._clusterBalloon.layout,{build(){e._clusterBalloonLayout.superclass.build.call(this);let t=".ya-map__balloon",n=e._clusterBalloonLayout.superclass.getParentElement.call(this).querySelector(t),o=n?.querySelector(`${t}-close`),s=n?.querySelectorAll(`${t}-pickup-select`);o?.addEventListener("click",ymaps.util.bind(this.onCloseClick,this)),s.forEach(p=>{p?.addEventListener("click",ymaps.util.bind(this.onSelectClick,this));}),this.applyElementOffset();},clear(){e._clusterBalloonLayout.superclass.clear.call(this);},onSelectClick(t){let n=t.target.getAttribute("data-code");if(n){let o=this._data?.cluster?.properties?._data?.geoObjects.find(s=>s?.properties?._data?.code===n);o&&e.salePointSelected.emit(o.properties._data);}else {let o=this._data?.cluster?.properties?._data?.geoObjects[0]?.properties?._data;e.salePointSelected.emit(o);}},onCloseClick(t){e._ngZone.run(()=>{}),this.events.fire("userclose");},applyElementOffset:function(){let n=e._clusterBalloonLayout.superclass.getParentElement.call(this).querySelector(".ya-map__balloon");n.style.left=-(n.offsetWidth/2)+"px",n.style.top=-(n.offsetHeight+14)+"px";}});}_filterAndDisplaySalePoints(e=[]){let t={},n={};if(this._clusterer?.removeAll(),this._clusterer=this._createVisitedClusterer({clusterIconLayout:this._clusterIconContentLayout,clusterIconPane:"overlaps",minClusterSize:2,offset:[0,0],clusterHideIconOnBalloonOpen:false,geoObjectHideIconOnBalloonOpen:false,clusterOpenBalloonOnClick:true,gridSize:128,clusterDisableClickZoom:false,clusterBalloonLayout:this._clusterBalloonLayout}),e.forEach(o=>{let{code:s}=o;s&&(t[s]=o);}),!v(t)&&this.map$.value){let o=[];for(let p in t){let r=t[p],h=new ymaps.Placemark([r.latitude,r.longitude],r,{iconLayout:this._placemarkIconLayout,iconPane:"overlaps"});h.events.add("click",()=>{this._yaCombinedService.selectedSalePoint$.next(h.balloon.isOpen()?null:r);}),o.push(h),n[r.code]=h;}let s=o.filter(p=>{let r=p.properties.getAll().good;return r===null?true:r.remains!==0});this._clusterer.add(this.hidePlacemarksWithoutGood?s:o),this.map$.value.geoObjects.add(this._clusterer);}}_createVisitedClusterer(e){let t=new ymaps.Clusterer(e),n=t.createCluster.bind(t);return t.createCluster=(o,s)=>{let p=n(o,s);return s.map(h=>this._uniqPointsSet.get(h)).sort((h,u)=>h-u),p},t}_setState(e,t){let{behaviors:n,bounds:o,center:s,controls:p,margin:r,type:h,zoom:u}=e;n&&t.behaviors.enable(n),o&&t.setBounds(o),s&&t.setCenter(s),p&&p.forEach(k=>t.controls.add(k)),r&&t.margin.setDefaultMargin(r),h&&t.setType(h),u&&t.setZoom(u);}_createMap(e){return this.container.nativeElement.setAttribute("id",e),this.options=x(w$1({},this.options),{mapId:e,isMonochrome:this.isMonochrome,isFullscreen:this.isFullscreen,maxZoom:this.maxZoom,minZoom:this.minZoom,yandexMapDisablePoiInteractivity:true}),new ymaps.Map(e,this._combineState(),this.options||{})}_combineState(){let e=this.state||{};return x(w$1({},e),{center:this.center||e.center||[0,0],zoom:this.zoom??e.zoom??10,controls:[]})}_getClusterIcon(){return `<div class="ya-map__cluster-icon"
                    data-codes="1">
                    <svg width="26" height="35" viewBox="0 0 26 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M13 35C13 35 26 20.3737 26 13.125C26 5.87626 20.1797 0 13 0C5.8203 0 0 5.87626 0 13.125C0 20.3737 13 35 13 35Z" fill="#00AEEF"/>
                    </svg>
                    <span class="ya-map__cluster-icon__counter">{{properties.geoObjects.length}}</span>
                </div>`}_getActiveClusterIcon(){return `<div class="ya-map__cluster-icon" style="transform: scale(1.5) translateY(-6px)">
                    <svg width="26" height="35" viewBox="0 0 26 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M13 35C13 35 26 20.3737 26 13.125C26 5.87626 20.1797 0 13 0C5.8203 0 0 5.87626 0 13.125C0 20.3737 13 35 13 35Z" fill="#434C5D"/>
                    </svg>
                    <span class="ya-map__cluster-icon__counter">{{properties.geoObjects.length}}</span>
                </div>`}_createManager(e){let t=new ymaps.GeoObjectCollection;this.map$.value?.geoObjects.add(t);let o=this,s=ymaps.templateLayoutFactory.createClass(this._baloon.layout,{build:function(){s.superclass.build.call(this);let r=".ya-map__balloon";s.superclass.getParentElement.call(this).querySelector(r)?.querySelector(`${r}-close`)?.addEventListener("click",ymaps.util.bind(this.onCloseClick,this));},clear(){s.superclass.clear.call(this);},onCloseClick:function(r){r.preventDefault(),this.events.fire("userclose"),o.salePointSelected.emit(this.getData().properties.getAll());}}),p=ymaps.templateLayoutFactory.createClass(this._baloon.template);for(let r of e){let h=new ymaps.GeoObject({geometry:new ymaps.geometry.Point([+r.latitude,+r.longitude]),properties:r},{balloonLayout:s,balloonContentLayout:p});t.add(h);}}_centerBalloon(){let e=this._document.querySelector(".ya-map__balloon, .ya-map__balloon-cluster");if(!e)return;let t=this.map$.value;if(!t)return;let n=e.getBoundingClientRect(),o={top:n.top+this._window.scrollY,left:n.left+this._window.scrollX},s=o.left+n.width/2,p=o.top+n.height/2,h=t.options.get("projection").fromGlobalPixels(t.converter.pageToGlobal([s,p]),t.getZoom());t.panTo(h,{flying:false,delay:0,duration:250});}_initIntersectionOverlayTrigger(){if(typeof IntersectionObserver<"u"){this._intersectionObserver?.disconnect(),this._intersectionObserver=new IntersectionObserver(t=>{t.forEach(o=>{o.target.id===this.intersectionOverlayTriggerId?this._triggerOverlayIntersecting=o.isIntersecting:this._mapIntersecting=o.isIntersecting;});let n=this._triggerOverlayIntersecting&&this._mapIntersecting;this._yaCombinedService.showOverlayFilters$.next(n);},{threshold:.5}),this._intersectionObserver.observe(this._el.nativeElement);let e=this._document.querySelector(`#${this.intersectionOverlayTriggerId}`);e&&this._intersectionObserver.observe(e);}}_initBannerIntersectionObserver(){typeof IntersectionObserver<"u"&&new IntersectionObserver(t=>{t.forEach(n=>{n.intersectionRatio>.9&&this._yaCombinedService.bannerIntersection$.next(true);});},{threshold:.9}).observe(this._el.nativeElement);}_initIcons(){[{name:"map-plus",path:"assets/images/ymap/plus.svg"},{name:"map-minus",path:"assets/images/ymap/minus.svg"},{name:"map-marker-user",path:"assets/images/ymap/marker-user.svg"},{name:"map-fullscreen-on",path:"assets/images/ymap/fullscreen-on.svg"},{name:"map-fullscreen-off",path:"assets/images/ymap/fullscreen-off.svg"},{name:"map-arrow-compass",path:"assets/images/ymap/arrow-compass.svg"}].forEach(t=>{this._iconRegistry.addSvgIcon(t.name,this._sanitizer.bypassSecurityTrustResourceUrl(t.path));});}static{this.\u0275fac=function(t){return new(t||i)(k(Ke),k(we$1),k(ze),k(F),k(cr))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-map"]],viewQuery:function(t,n){if(t&1&&(MO(Wn,5),MO(ye,5)),t&2){let o;TO(o=SO())&&(n.container=o.first),TO(o=SO())&&(n.bannerComponent=o.first);}},inputs:{isMonochrome:"isMonochrome",isFullscreen:"isFullscreen",hidePlacemarksWithoutGood:"hidePlacemarksWithoutGood",center:"center",zoom:"zoom",state:"state",options:"options",showCombined:"showCombined",showControls:"showControls",isCombined:"isCombined",getControls:"getControls",showCombinedPanel:"showCombinedPanel",balloonOrderUrl:"balloonOrderUrl",balloonOrderText:"balloonOrderText",isOrderMap:"isOrderMap",maxZoom:"maxZoom",minZoom:"minZoom",salePoints:"salePoints",salePoints$:"salePoints$",controls:"controls",fullScreen:"fullScreen"},outputs:{ready:"ready",salePointSelected:"salePointSelected",actionbegin:"actionbegin",actionbreak:"actionbreak",actionend:"actionend",actiontick:"actiontick",actiontickcomplete:"actiontickcomplete",balloonclose:"balloonclose",balloonopen:"balloonopen",boundschange:"boundschange",yaclick:"yaclick",yacontextmenu:"yacontextmenu",yadblclick:"yadblclick",destroy:"destroy",hintclose:"hintclose",hintopen:"hintopen",marginchange:"marginchange",yamousedown:"yamousedown",yamouseenter:"yamouseenter",yamouseleave:"yamouseleave",yamousemove:"yamousemove",yamouseup:"yamouseup",multitouchend:"multitouchend",multitouchmove:"multitouchmove",multitouchstart:"multitouchstart",optionschange:"optionschange",sizechange:"sizechange",typechange:"typechange",yawheel:"yawheel"},features:[Uo],decls:7,vars:9,consts:[["container",""],[1,"b-map"],[3,"id"],[1,"container"],[3,"map$","hidden","showCombinedPanel",4,"ngIf"],[3,"controls","map$","fullscreen$",4,"ngIf"],[3,"map$","hidden","showCombinedPanel"],[3,"fullscreen$","controls","map$"]],template:function(t,n){t&1&&(kp(0,"div",1),DE(1,"div",2)(2,"div",3,0),kI(4,Jn,1,3,"yota-ya-combined",4)(5,ei,1,2,"yota-ya-control",5),DE(6,"yota-map-banner"),Pp()),t&2&&(sE("fullscreen",n.isFullscreen),QR(),iE("id",n.intersectionOverlayTriggerId),QR(),sE("monochrome",n.isMonochrome)("fullscreen",n.isFullscreen),QR(2),iE("ngIf",n.showCombined),QR(),iE("ngIf",n.showControls));},dependencies:[Ww,we,sn,ye],styles:[`[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]{display:block;position:relative;height:100%;width:100%}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]   .container.fullscreen[_ngcontent-%COMP%]{height:100vh;width:100vw}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]  [class*=map-copyrights]{display:none}[_nghost-%COMP%]   .b-map.fullscreen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;width:100vw;z-index:1}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .monochrome [class*=ymaps-2][class*=-inner-panes] [class*=ymaps-2][class*=-ground-pane]>ymaps:first-child{filter:url("data:image/svg+xml;utf8, <svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='matrix' values='0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0'/></filter></svg>#grayscale");-webkit-filter:grayscale(100%)}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon{position:relative;width:327px;background-color:#fff;top:-323.8px;left:-163.5px;border-radius:16px;overflow:hidden;padding:16px 0 16px 16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_cluster{padding:0}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-wrapper{overflow-y:auto;max-height:332px;padding:0 0 16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis{display:none;position:relative;left:50%;bottom:20px;transform:translate(-105%);width:40px;height:40px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis.ya-map__balloon-pickup-loader-show{display:inline-block}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div{position:absolute;top:33px;width:16px;height:16px;border-radius:50%;background:#00aeef;animation-timing-function:cubic-bezier(0,1,1,0);box-sizing:border-box}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(1){left:8px;animation:_ngcontent-%COMP%_lds-ellipsis1 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(2){left:8px;animation:_ngcontent-%COMP%_lds-ellipsis2 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(3){left:32px;animation:_ngcontent-%COMP%_lds-ellipsis2 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-ellipsis div:nth-child(4){left:56px;animation:_ngcontent-%COMP%_lds-ellipsis3 .6s infinite}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon:not(.ya-map__balloon_list){padding:16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list_order{max-height:332px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list .ya-map__balloon-pickup-select{width:100%}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list .ya-map__balloon-pickup-select_map{margin:16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list::-webkit-scrollbar{width:6px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon_list::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box{max-height:332px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box_map{padding:16px 0 16px 16px;overflow-y:unset}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box::-webkit-scrollbar{width:6px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-box::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup{display:flex;flex-direction:column;gap:20px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup_order{padding:16px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error{border-radius:12px;border:1px solid #ff6b6e;padding:8px 12px;display:flex;gap:8px;display:none}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error.ya-map__balloon-pickup-error-show{display:flex}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error__icon{rotate:180deg}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error__icon path{fill:#ff6b6e}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-error__text{color:#ff6b6e;font-size:12px;line-height:18px;font-weight:400}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__title{margin-bottom:4px;padding-right:32px;color:#434c5e;font-size:16px;line-height:22px;font-weight:600}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__location{margin:0 0 16px;padding-right:32px;color:#89909c;font-size:16px;line-height:24px;font-weight:400}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__time{margin:0 0 12px;padding-right:16px;color:#434c5e;font-size:16px;line-height:24px;font-weight:400}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__functions{display:flex;flex-direction:row;flex-wrap:wrap;gap:8px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__function{display:flex;align-items:center;justify-content:center;height:24px;padding:0 4px;border-radius:4px;color:#a1a5ae;background-color:#f8f8f8;font-size:12px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__actions{display:flex;justify-content:center}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__actions_hidden{display:none}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup-select{border:none;display:flex;background-color:#e5f7fd;height:auto;width:100%;min-height:initial;min-width:initial;max-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-close{position:absolute;top:16px;right:16px;display:block;width:24px;height:24px;background:url(/assets/images/icons/close-light.svg) 100% no-repeat;background-size:24px 24px;cursor:pointer}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__cluster-icon{position:relative;display:flex;align-items:center;justify-content:center;width:26px;margin-top:8px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__cluster-icon__counter{position:absolute;top:15%;color:#fff;font-size:12px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__placemark{margin-top:8px}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__placemark_error svg path:first-child{fill:#bdc0c6}[_nghost-%COMP%]   .b-map[_ngcontent-%COMP%]     .ya-map__balloon-pickup__functions+.ya-map__balloon-pickup__actions{margin-top:16px}@keyframes _ngcontent-%COMP%_lds-ellipsis1{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_lds-ellipsis3{0%{transform:scale(1)}to{transform:scale(0)}}@keyframes _ngcontent-%COMP%_lds-ellipsis2{0%{transform:translate(0)}to{transform:translate(24px)}}`],changeDetection:0});}}return i})();
export{U,ln as l,rn as r};