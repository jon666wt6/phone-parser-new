import {l as le,H as He}from'./chunk-Csf5u6XI.js';import {j,I,U as Ue,bY as or,aj as cr,ai as i$1,be as tu,bf as ac,az as X$1,i as i$2,b2 as le$1,Z as Hu,o as Vu,aB as ju,aC as Qh,K as p,bv as Ik,al as kR,l as lO,aK as Jw,W as Ww,_ as _I,b as kp,c as kI,P as Pp,Q as QR,e as iE,aO as K$1,aP as R,aD as $O,w as wO,aE as UO,g as DE,ad as EO,v as RE,dr as Mo,h as WR,af as AR,ag as RR}from'./main-GV3FATOT.js';var y=function(t){return t.FAQ_PAGE="faq-page",t}(y||{}),V=(()=>{class t{constructor(e,r){this._document=r,this._idPrefix="ld+json-",this._renderer=e.createRenderer(null,null);}addFaq(e){let r=JSON.stringify({"@context":"https://schema.org","@type":"FAQPage",mainEntity:e.filter(i=>!!i.title&&!!i.answer).map(i=>({"@type":"Question",name:i.title,acceptedAnswer:{"@type":"Answer",text:i.answer}}))});this._addScriptWithContent(r,y.FAQ_PAGE);}removeFaq(){let e=this._idPrefix+y.FAQ_PAGE;this._removeScript(e);}_addScriptWithContent(e,r){let i=this._idPrefix+r;this._removeScript(i);let a=this._renderer.createElement("script");a.text=e,this._renderer.setProperty(a,"id",i),this._renderer.setProperty(a,"type","application/ld+json"),this._renderer.appendChild(this._document.head,a);}_removeScript(e){try{let r=this._document.head.querySelector(`[id='${e}']`);r&&this._renderer.removeChild(this._document.head,r);}catch(r){Ik.error("_addScriptWithContent e: ",r);}}static{this.\u0275fac=function(r){return new(r||t)(K$1(Mo),K$1(cr))};}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"});}}return t})();function K(t,h){if(t&1&&DE(0,"div",5),t&2){let e=wO(2);iE("innerHtml",e.settings.portletHeader,WR);}}function X(t,h){if(t&1){let e=EO();kp(0,"yota-article-answers",6),RE("itemToggled",function(){AR(e);let i=wO(2);return RR(i.itemToggled())}),Pp();}if(t&2){let e=h.ngIf;iE("items",e)("isSubsection",true);}}function Y(t,h){if(t&1&&(kp(0,"div",2),kI(1,K,1,1,"div",3)(2,X,1,2,"yota-article-answers",4),$O(3,"async"),Pp()),t&2){let e=wO();QR(),iE("ngIf",e.settings.portletHeader),QR(),iE("ngIf",UO(3,2,e.articles$));}}var fe=(()=>{class t extends j{constructor(){super(...arguments),this._supportService=I(le),this._ldJsonService=I(V),this._renderPortletService=I(Ue),this._renderer=I(or),this._document=I(cr),this._window=I(i$1),this._isBrowser=tu(I(ac)),this.settings=null,this._frameResizeTrigger$=new X$1,this._frameResizerScriptId="frame_resizer_faq_yota",this._rootFaqOnlyClass="faq-portlet-only";}setSettings(e){this.settings=i$2.parse(e);}ngOnInit(){this.settings&&(this._addFrameResizerScript(),this.articles$=this._supportService.getSubsection(this.settings.folderUuid).pipe(le$1(e=>e.articles),Hu(e=>{this._ldJsonService.addFaq(e??[]),this._setupResizeHandler();})),this._onDestroy$.pipe(Vu(this._onDestroy$)).subscribe(()=>{this._ldJsonService.removeFaq(),this._removeFrameResizerScript(),this._renderer.removeClass(this._document.documentElement,this._rootFaqOnlyClass);}));}itemToggled(){this._frameActionDisabled()||this._frameResizeTrigger$.next();}_setupResizeHandler(){this._frameActionDisabled()||this._frameResizeTrigger$.pipe(ju(()=>Qh(10).pipe(Vu(Qh(500)),Vu(this._frameResizeTrigger$))),Vu(this._onDestroy$)).subscribe(()=>{this._resizeFrame();});}_addFrameResizerScript(){if(!this._isBrowser||!p.isIframe()||this._hasFrameResizerScript())return;this._renderPortletService.portletsCount===1&&this._renderer.addClass(this._document.documentElement,this._rootFaqOnlyClass);let e=this._renderer.createElement("script");this._renderer.setProperty(e,"id",this._frameResizerScriptId),this._renderer.setProperty(e,"src","https://static.yota.ru/upload/public/js/iframeResizer.contentWindow.min.js"),this._renderer.appendChild(this._document.head,e);}_removeFrameResizerScript(){try{let e=this._hasFrameResizerScript();if(!e)return;this._renderer.removeChild(this._document.head,e);}catch(e){Ik.error("failed remove frame resizer script: ",e);}}_hasFrameResizerScript(){return this._document.head.querySelector(`[id='${this._frameResizerScriptId}']`)}_resizeFrame(){this._frameActionDisabled()||this._window.parentIFrame.size();}_frameActionDisabled(){return !this._isBrowser||!p.isIframe()||!this._window.parentIFrame}static{this.\u0275fac=(()=>{let e;return function(i){return (e||(e=kR(t)))(i||t)}})();}static{this.\u0275cmp=lO({type:t,selectors:[["yota-support-subsection-wrapper"]],features:[_I],decls:2,vars:1,consts:[[1,"support-subsection"],["class","support-subsection__wrapper",4,"ngIf"],[1,"support-subsection__wrapper"],["class","support-subsection__title",3,"innerHtml",4,"ngIf"],[3,"items","isSubsection","itemToggled",4,"ngIf"],[1,"support-subsection__title",3,"innerHtml"],[3,"itemToggled","items","isSubsection"]],template:function(r,i){r&1&&(kp(0,"div",0),kI(1,Y,4,4,"div",1),Pp()),r&2&&(QR(),iE("ngIf",i.settings));},dependencies:[Jw,Ww,He],styles:["[_nghost-%COMP%]{display:block;margin-block:60px 100px}@media (max-width: 992px){[_nghost-%COMP%]{margin-block:40px 80px}}@media (max-width: 767px){[_nghost-%COMP%]{margin-block:20px 40px}}[_nghost-%COMP%]   .support-subsection__wrapper[_ngcontent-%COMP%]{max-width:808px;margin:auto}[_nghost-%COMP%]   .support-subsection__title[_ngcontent-%COMP%]{margin-bottom:40px}"],changeDetection:0});}}return t})();
export{fe as SupportSubsectionWrapperComponent};