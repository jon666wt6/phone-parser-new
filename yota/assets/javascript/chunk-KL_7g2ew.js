import {r as rn,l as ln}from'./chunk-xhbyzJP2.js';import {n,k}from'./chunk-CNoCOKQ_.js';import {r}from'./chunk-DmLImK7O.js';import {D}from'./chunk-Cv7U9r_j.js';import {c as ct}from'./chunk-D5Jyejdx.js';import {m}from'./chunk-hnem0I9a.js';import {_,a,I as I$1}from'./chunk-Bq2asBIt.js';import {I,ai as i$1,aM as In$1,aP as R,C as p,J as ot,dv as kr$1,dU as Re,dV as be,dW as je$1,dX as me,dY as Pe,dx as qe,dZ as Te,a1 as x,a2 as w$1,Z as Hu,c5 as Ie,bH as Vh,b2 as le,bG as Pi$1,d_ as hg,dz as rg,al as kR,aO as K,aH as mr$1,m as U,a as O,G as W,az as X,bt as Gh,aA as Lu,d$ as R$1,s as Et,E,O as O$1,cp as Ru,cO as $,aI as q$1,n as ci$1,co as c,Y as Au,bu as Nu,o as Vu,l as lO,W as Ww,aJ as Yw,a3 as An,ct as Dn$1,a4 as Ge,a5 as yn,cu as Cn,e0 as St$1,a7 as Mn$1,a8 as Tt,cs as x$1,D as Dh,am as d,aK as Jw,$ as zt,cA as gd,ab as Ty,a_ as ql,aL as cn,cz as ar$1,aQ as hd,r as PO,_ as _I,b as kp,aD as $O,c as kI,R as RO,P as Pp,q as qO,y as sE,aE as UO,Q as QR,e as iE,V as VE,aq as hO,M as MO,T as TO,S as SO,cn as I$2,bx as Ie$1,aj as cr$1,K as p$1,bN as ze,c4 as ze$1,F,be as tu,bf as ac,N as Mu,cv as ot$1,cw as Bt,cB as gm,ac as ld,an as ae,e1 as Ny,dF as Cd,k as k$1,bY as or$1,bg as Hn$1,g as DE,ad as EO,cQ as CO,v as RE,ag as RR,af as AR,cW as bO,z as Fc,a0 as st,au as AO,cN as vn,L as Lp,f as jp,w as wO,bn as LO,H as Hp,ae as jO,at as VO,cb as _$1,e2 as G$1,e3 as P,aB as ju,dD as dg,dE as tb,aU as Vy,d1 as Rt,bk as zI,a6 as Jt,c$ as Jg,d0 as Zg,cx as Xc,b0 as wE,cd as E$1,ce as v,cf as A$1,c8 as Dy,b3 as zO,dC as cd,a$ as WO,cP as eC,ax as Ob,ay as v$1,u as uv,h as WR,bL as $$1,e4 as K$1,ch as ve,e5 as f,aR as cm,av as Ke,b6 as Ye$1}from'./main-GV3FATOT.js';import {I as It$1,u as ur$1}from'./chunk-QusFOk1N.js';import {h}from'./chunk-jiUUNBhR.js';import {n as n$1}from'./chunk-BWgEt2Gw.js';import {y}from'./chunk-DpEvSBvS.js';var ri=(()=>{class i{register(e){this._bottomSheetComponent=e;}openFull(){this._bottomSheetComponent&&(this._bottomSheetComponent.state="open-full",this._bottomSheetComponent.updatePosition(true));}openMin(){this._bottomSheetComponent&&(this._bottomSheetComponent.state="open-min",this._bottomSheetComponent.updatePosition(true));}hide(){this._bottomSheetComponent&&(this._bottomSheetComponent.state="hide",this._bottomSheetComponent.updatePosition());}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var Bn=["bottomSheet"],Ln=["hiding"],Vn=["*",[["","hiding",""]]],Un=["*","[hiding]"];function Gn(i,r){if(i&1&&(DE(0,"div",6),$O(1,"async")),i&2){let e=wO();Fc("height",-UO(1,2,e.currentY$)+4+"px");}}var Sn=(()=>{class i extends p{constructor(e){super(),this._bottomSheetService=e,this.swipeAreaHeight=40,this.animationSpeed=300,this.state="hide",this.startY=0,this.touchStartY=0,this.currentY$=new In$1(0),this.visibleHeight$=new In$1(0),this.isSwiping$=new In$1(false),this._document=I(cr$1),this._fullHeight=0,this._hidingHeight=0,this._mouseMoveHandler=this.onMoveMouse.bind(this),this._mouseUpHandler=this.onEndMouse.bind(this);}ngOnInit(){this._bottomSheetService.register(this);}ngAfterContentInit(){this._updateHeightValues(),this.contentChanged$?.pipe(Nu(10),Vu(this._onDestroy$)).subscribe(()=>{this._updateHeightValues(),this.updatePosition();});}ngOnDestroy(){this._onDestroy$.next(),this._document.removeEventListener("mousemove",this._mouseMoveHandler),this._document.removeEventListener("mouseup",this._mouseUpHandler);}onStartTouch(e){e.preventDefault(),this.isSwiping$.next(true),this.touchStartY=e.touches[0].clientY,this.bottomSheetEl.nativeElement.style.transition="none";}onStartMouse(e){e.preventDefault(),this.isSwiping$.next(true),this.touchStartY=e.clientY,this.bottomSheetEl.nativeElement.style.transition="none",this._document.body.classList.add("cursor-grabbing"),this._document.addEventListener("mousemove",this._mouseMoveHandler),this._document.addEventListener("mouseup",this._mouseUpHandler);}onMoveTouch(e){e.preventDefault();let t=e.touches[0].clientY;this._handleMove(t);}onMoveMouse(e){if(e.preventDefault(),!this.isSwiping$.value){this.onEndTouch();return}let t=e.clientY;this._handleMove(t);}onEndTouch(){this._handleEnd();}onEndMouse(){this._handleEnd(),this._document.body.classList.remove("cursor-grabbing"),this._document.removeEventListener("mousemove",this._mouseMoveHandler),this._document.removeEventListener("mouseup",this._mouseUpHandler);}updatePosition(e=false){switch(e?this.bottomSheetEl.nativeElement.style.transition=`transform ${this.animationSpeed}ms ease`:this.bottomSheetEl.nativeElement.style.transition="none",this.state){case "open-full":this.bottomSheetEl.nativeElement.style.transform="translateY(0)",this.visibleHeight$.next(this._fullHeight);break;case "open-min":this.bottomSheetEl.nativeElement.style.transform=`translateY(${this._hidingHeight}px)`,this.visibleHeight$.next(this._fullHeight-this._hidingHeight);break;case "hide":this.bottomSheetEl.nativeElement.style.transform="translateY(200%)",this.visibleHeight$.next(0);break;}}_handleMove(e){let t=e-this.touchStartY;this.state==="open-min"&&(t=t+this._hidingHeight),t<0?this.currentY$.next(t*.15):this.currentY$.next(t),this.visibleHeight$.next(this._fullHeight-this.currentY$.value),this.bottomSheetEl.nativeElement.style.transform=`translateY(${this.currentY$.value}px)`;}_handleEnd(){this.startY=this.currentY$.value,this.currentY$.value>0&&this._fullHeight-this.currentY$.value<this._fullHeight-this._hidingHeight?this.state="open-min":this.state="open-full",this.updatePosition(true),this.isSwiping$.next(false);}_updateHeightValues(){this._fullHeight=this.bottomSheetEl.nativeElement.offsetHeight??0,this._hidingHeight=this.hiding.nativeElement.offsetHeight+12||0;}static{this.\u0275fac=function(t){return new(t||i)(k$1(ri))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-bottom-sheet"]],viewQuery:function(t,n){if(t&1&&(MO(Bn,7),MO(Ln,7)),t&2){let o;TO(o=SO())&&(n.bottomSheetEl=o.first),TO(o=SO())&&(n.hiding=o.first);}},inputs:{swipeAreaHeight:"swipeAreaHeight",animationSpeed:"animationSpeed",contentChanged$:"contentChanged$"},features:[_I],ngContentSelectors:Un,decls:11,vars:9,consts:[["bottomSheet",""],["hiding",""],[1,"bottom-sheet"],[1,"bottom-sheet__content"],[1,"bottom-sheet__swipe",3,"touchstart","touchmove","touchend","mousedown"],["class","bottom-sheet__fill",3,"height",4,"ngIf"],[1,"bottom-sheet__fill"]],template:function(t,n){if(t&1){let o=EO();CO(Vn),kp(0,"div",2,0)(2,"div",3)(3,"div",4),$O(4,"async"),RE("touchstart",function(m){return AR(o),RR(n.onStartTouch(m))})("touchmove",function(m){return AR(o),RR(n.onMoveTouch(m))})("touchend",function(){return AR(o),RR(n.onEndTouch())})("mousedown",function(m){return AR(o),RR(n.onStartMouse(m))}),Pp(),bO(5),kp(6,"div",null,1),bO(8,1),Pp(),kI(9,Gn,2,4,"div",5),$O(10,"async"),Pp()();}t&2&&(QR(3),Fc("height",n.swipeAreaHeight+"px"),sE("cursor-grabbing",UO(4,5,n.isSwiping$)),QR(6),iE("ngIf",UO(10,7,n.currentY$)||false));},dependencies:[Ww,Jw],styles:['[_nghost-%COMP%]{--content-padding-top: 18px;--content-padding-inline: 16px;--content-padding-bottom: 12px}.bottom-sheet[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;z-index:3;background:#fff;border-radius:16px 16px 0 0;box-shadow:0 -12px 24px #0000001f;transform:translateY(100%);transition:transform .3s ease;touch-action:none;padding:var(--content-padding-top) var(--content-padding-inline) calc(var(--content-padding-inline))}.bottom-sheet__content[_ngcontent-%COMP%]{position:relative}.bottom-sheet__swipe[_ngcontent-%COMP%]{position:absolute;top:calc(var(--content-padding-top) * -1);left:calc(var(--content-padding-inline) * -1);width:calc(100% + var(--content-padding-inline) * 2);display:flex;justify-content:center;cursor:pointer}.bottom-sheet__swipe[_ngcontent-%COMP%]:before{display:block;width:36px;height:4px;border-radius:100px;margin-top:4px;background:#434c5e33;content:""}.bottom-sheet__fill[_ngcontent-%COMP%]{position:absolute;top:calc(100% + var(--content-padding-top) - 4px);left:calc(var(--content-padding-inline) * -1);width:calc(100% + var(--content-padding-inline) * 2);background:#fff}'],changeDetection:0});}}return i})();var Hn=["captchaInputRef"],zn=["*"];function Yn(i,r){if(i&1&&DE(0,"img",11),i&2){let e=r.ngIf;iE("src",e.img,uv);}}function jn(i,r){if(i&1&&(kp(0,"y-error"),RO(1),Pp()),i&2){let e=r.ngIf;QR(),Hp(" ",e," ");}}var xn=(()=>{class i extends p{constructor(){super(...arguments),this.label="\u0412\u0432\u0435\u0434\u0438 \u0441\u0438\u043C\u0432\u043E\u043B\u044B \u0441 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",this.captchaControl=new W("",[Ie$1.required]),this.valueChange=new st,this.errorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["wrongCaptcha","\u041A\u0430\u043F\u0447\u0430 \u0432\u0432\u0435\u0434\u0435\u043D\u0430 \u043D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E"]]),this.controlState=c,this.captcha$=new In$1(null),this.validateControl$=new In$1(false),this._refreshSubject$=new X;}set wrongCaptcha(e){this.captchaControl.setErrors({wrongCaptcha:e}),e&&(this.refresh(true),setTimeout(()=>{this.validateControl$.next(true);}));}ngOnInit(){this.refresh(),this.captchaControl.valueChanges.pipe(Vu(this._onDestroy$)).subscribe(e=>{this.captcha$.value?.id&&this.valueChange.emit(e?{answer:e,id:this.captcha$.value?.id}:null);}),this.pending$?.pipe(Vu(this._onDestroy$)).subscribe(e=>{e?this.captchaControl.disable():this.captchaControl.enable();});}refresh(e=false){this._refreshSubject$.next(true),this.valueChange.emit(null),this.validateControl$.next(false),this.getCaptcha$.pipe(Vu(this._refreshSubject$)).subscribe(t=>{e||(this.captchaControl.reset(),this.captchaControl.setErrors(null),this.captchaControl.markAsUntouched()),this.captcha$.next(t);});}onBlur(){this.captchaControl.updateValueAndValidity();}getCaptchaErrorMessage(e){if(e){let t=w$1({},e);for(let n of Object.keys(t)){let o=this.errorMessages.get(n);if(o)return o}}return ""}get captchaState(){return this.captchaInputRef?this.captchaInputRef.focused&&this.captchaInputRef.value.length?c.CLEAR:this.captchaControl.touched?this.captchaControl.errors?c.ERROR:c.SUCCESS:null:null}static{this.\u0275fac=(()=>{let e;return function(n){return (e||(e=kR(i)))(n||i)}})();}static{this.\u0275cmp=lO({type:i,selectors:[["yota-captcha"]],viewQuery:function(t,n){if(t&1&&MO(Hn,5),t&2){let o;TO(o=SO())&&(n.captchaInputRef=o.first);}},inputs:{getCaptcha$:"getCaptcha$",label:"label",pending$:"pending$",captchaControl:"captchaControl",wrongCaptcha:"wrongCaptcha"},outputs:{valueChange:"valueChange"},features:[_I],ngContentSelectors:zn,decls:15,vars:10,consts:[["captchaInputRef","yInput"],[1,"captcha"],[1,"captcha__content"],[1,"captcha__img-wrapper"],["class","captcha__img","alt","captcha",3,"src",4,"ngIf"],[1,"captcha__refresh",3,"click","svgIcon"],[1,"captcha__form"],[1,"captcha__field"],["yInput","","autocomplete","off",3,"blur","formControl","required"],["ySuffix","",3,"clear","state","inputControl"],[4,"ngIf"],["alt","captcha",1,"captcha__img",3,"src"]],template:function(t,n){if(t&1){let o=EO();CO(),kp(0,"div",1)(1,"div",2)(2,"div",3),kI(3,Yn,1,1,"img",4),$O(4,"async"),Pp(),kp(5,"y-icon",5),RE("click",function(){return AR(o),RR(n.refresh())}),Pp()(),kp(6,"div",6)(7,"y-form-field-bordered",7)(8,"y-label"),RO(9),Pp(),kp(10,"input",8,0),RE("blur",function(){return AR(o),RR(n.onBlur())}),Pp(),kp(12,"yota-field-state",9),RE("clear",function(){return AR(o),RR(n.captchaControl.setValue(""))}),Pp(),kI(13,jn,2,1,"y-error",10),Pp(),bO(14),Pp()();}if(t&2){let o=AO(11);QR(3),iE("ngIf",UO(4,8,n.captcha$)),QR(2),iE("svgIcon","refresh-outline"),QR(4),VE(n.label),QR(),iE("formControl",n.captchaControl)("required",true),QR(2),iE("state",n.captchaState)("inputControl",o),QR(),iE("ngIf",n.getCaptchaErrorMessage(n.captchaControl.errors));}},dependencies:[Ww,An,Ge,yn,ot$1,Mn$1,Tt,x$1,Jw,ld,gd,zt,Ty,ar$1,hd],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%}.captcha[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.captcha__content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;column-gap:16px}.captcha__refresh[_ngcontent-%COMP%]{width:24px;height:24px;cursor:pointer}.captcha__inner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:250px;width:250px;max-height:40px}.captcha__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;margin-top:40px;padding-bottom:34px;width:100%;max-width:334px}.captcha__label[_ngcontent-%COMP%]{text-align:center}.captcha__img-wrapper[_ngcontent-%COMP%]{width:226px;height:48px;background:linear-gradient(138.75deg,#eef0f2 34.17%,#d9dce1 53.52%);border-radius:16px;overflow:hidden}.captcha__img[_ngcontent-%COMP%]{width:226px;height:48px}"],changeDetection:0});}}return i})();var rt=class{};var q=function(i){return i.CONTACT="CONTACT",i.RECEIVING="RECEIVING",i.PAYMENT="PAYMENT",i.BEAUTIFUL_NUMBER="BEAUTIFUL_NUMBER",i}(q||{}),G=function(i){return i.DISABLE="DISABLE",i.ACTIVE="ACTIVE",i.WITH_DATA="WITH_DATA",i.HIDDEN="HIDDEN",i}(G||{});var we=function(i){return i[i.HIDDEN=0]="HIDDEN",i[i.NEXT=1]="NEXT",i[i.CONFIRM=2]="CONFIRM",i[i.CONFIRM_ORDER=3]="CONFIRM_ORDER",i}(we||{}),vt=function(i){return i.CARD="CARD_TO_COURIER",i.CASH="CASH",i}(vt||{}),It=function(i){return i.NO_REGION="NO_REGION",i.DEFAULT="DEFAULT",i.INVALID_PHONE="INVALID_PHONE",i.CANT_PICKUP="CANT_PICKUP",i}(It||{});var J=class i extends rt{static{this.beautifulNumberFormGroup=new I$2({numbers:new W([],{nonNullable:true})});}constructor(r,e){super(),this._stepState$=r,this._transitions=e,this.component=oi,this.name=q.BEAUTIFUL_NUMBER,this.title="\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",this.stepState$=this._stepState$,this.transitions=this._transitions;}getWriteData(){let r=i.beautifulNumberFormGroup.controls.numbers.value.length;return r?`<span>${r}</span>`:""}showValidateErrors(){}setContext(){this.stateContext?.next({name:q.BEAUTIFUL_NUMBER,numbers:i.beautifulNumberFormGroup.controls.numbers.value});}getContext(){return this.stateContext?.value}getButtonState(){return we.NEXT}};function qn(i,r){if(i&1&&DE(0,"span",10),i&2){let e=wO(2);iE("innerHTML",e.enabledText,WR);}}function Wn(i,r){if(i&1&&(kp(0,"span",11),RO(1),Pp()),i&2){let e=wO(2);QR(),Hp(" ",e.disableText," ");}}function Kn(i,r){if(i&1&&(kp(0,"span",8),kI(1,qn,1,1,"span",9)(2,Wn,2,1,"ng-template",null,0,qO),Pp()),i&2){let e=AO(3),t=wO();QR(),iE("ngIf",!t.disable)("ngIfElse",e);}}var ai=(()=>{class i extends p{constructor(){super(),this.disable=false;}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-order-radio-button"]],inputs:{label:"label",enabledText:"enabledText",disable:"disable",disableText:"disableText",control:"control",value:"value",id:"id",inputName:"inputName"},exportAs:["order-radio-button"],features:[_I],decls:8,vars:8,consts:[["disabled",""],[1,"order-radio-button"],["type","radio",1,"order-radio-button__input",3,"name","id","value","formControl"],[1,"order-radio-button__wrapper-radio-label",3,"for"],[1,"order-radio-button__top"],[1,"order-radio-button__radio-mark"],[1,"order-radio-button__radio-label"],["class","order-radio-button__sublabel-text",4,"ngIf"],[1,"order-radio-button__sublabel-text"],["class","order-radio-button__enabled-text",3,"innerHTML",4,"ngIf","ngIfElse"],[1,"order-radio-button__enabled-text",3,"innerHTML"],[1,"order-radio-button__disabled-text"]],template:function(t,n){t&1&&(kp(0,"div",1),DE(1,"input",2),kp(2,"label",3)(3,"div",4),DE(4,"span",5),kp(5,"span",6),RO(6),Pp()(),kI(7,Kn,4,2,"span",7),Pp()()),t&2&&(zI("data-disabled",n.disable),QR(),iE("name",n.inputName)("id",n.id)("value",n.value)("formControl",n.control),QR(),iE("for",n.id),QR(4),VE(n.label),QR(),iE("ngIf",n.enabledText));},dependencies:[An,Ge,Rt,yn,Mn$1,Tt,Ww],styles:['.order-radio-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;height:100%}@media (max-width: 768px){.order-radio-button[_ngcontent-%COMP%]{width:100%}}.order-radio-button__input[_ngcontent-%COMP%]{visibility:hidden;display:none}.order-radio-button__input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{border-color:#00aeef}.order-radio-button__input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]   .order-radio-button__radio-mark[_ngcontent-%COMP%]:after{opacity:1}.order-radio-button__top[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:12px}.order-radio-button__wrapper-radio-label[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;height:100%;width:100%;padding:15px 32px;border-radius:16px;border:1px solid rgba(171,186,200,.3);cursor:pointer;row-gap:8px;font-size:16px;line-height:24px;font-weight:600}.order-radio-button__radio-label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:600}.order-radio-button__sublabel-text[_ngcontent-%COMP%]{color:#89909c;font-size:16px;line-height:24px;font-weight:400}.order-radio-button__radio-mark[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:20px;height:20px;border:1px solid #e3e4e7;border-radius:50%;background-color:transparent;flex-shrink:0}.order-radio-button__radio-mark[_ngcontent-%COMP%]:after{display:block;width:8px;height:8px;border-radius:50%;opacity:0;background-color:#00aeef;content:"";transition:opacity .3s ease}.order-radio-button[data-disabled=true][_ngcontent-%COMP%]{cursor:not-allowed;pointer-events:none}.order-radio-button[data-disabled=true][_ngcontent-%COMP%]   .order-radio-button__radio-label[_ngcontent-%COMP%]{color:#bdc0c6}@media (max-width: 768px){.order-radio-button__wrapper-radio-label[_ngcontent-%COMP%]{padding:16px}}'],changeDetection:0});}}return i})();var si=class{static restrictedAddress(r){return r.value?Object.keys(r.value).length<=0?{restrictedAddress:true}:!r.value?.street&&!r.value?.settlement?{restrictedStreetHouse:true}:r.value?.house?null:{restrictedHouse:true}:{restrictedAddress:true}}};function li({timeSlotsTime:i,timeSlotsSearch:r}){let e=i.value?.startTime,t=i.value?.endTime,n=r.value?.date;return n?{deliveryFrom:En(n)+" "+(e??"")+":00",deliveryTo:En(n)+" "+(t??"")+":00"}:{deliveryFrom:"",deliveryTo:""}}function En(i){let r=new Date(i),e=r.toLocaleString("default",{year:"numeric"}),t=r.toLocaleString("default",{month:"2-digit"}),n=r.toLocaleString("default",{day:"2-digit"});return e+"-"+t+"-"+n}var L=class i extends rt{static{this.receivingFormGroup=new I$2({receivingWay:new W(a.Delivery,{nonNullable:true}),address:new W(null,[Ie$1.required,si.restrictedAddress]),entrance:new W("",{nonNullable:true,validators:[Ie$1.maxLength(5)]}),flat:new W("",{nonNullable:true,validators:[Ie$1.maxLength(10)]}),timeSlotsSearch:new W(null),timeSlotsTime:new W(null)});}static{this.foreignCitizenship$=new In$1(false);}constructor(r,e,t){super(),this._stepState$=r,this._transitions=e,this._pickUpPoint$=t,this.component=On,this.title="\u0421\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F",this.name=q.RECEIVING,this.stepState$=this._stepState$,this.transitions=this._transitions;}nextAction(){}getWriteData(){let r,e="";if(i.receivingFormGroup.controls.receivingWay.value===a.Delivery){r="\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430",e+=r;let t=i.receivingFormGroup.controls.flat.value,n=i.receivingFormGroup.controls.address.value;typeof n!="string"&&n?.unrestrictedValue&&(e+=`<span>${n.unrestrictedValue} ${t?"\u043A\u0432."+t:""}</span>`);let o,p=i.receivingFormGroup.controls.timeSlotsSearch.value?.date,m=i.receivingFormGroup.controls.timeSlotsTime.value,b=m?.leftSide,M=m?.rightSide?.replace(/\D*/g,"");if(p){o=new Date(p);let d=new Intl.DateTimeFormat("ru",{month:"long",day:"numeric"});e+=`<span>${d.format(o)}, ${b}, ${M!=="0"?M+" \u20BD":"\u0411\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"}</span>`;}}else {r="\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437",e+=r;let t=this._pickUpPoint$.value;t&&(e+=`<strong>${t.name}</strong>`,e+=`<span>${t.address}</span>`);}return e}showValidateErrors(){i.receivingFormGroup.valid||(i.receivingFormGroup.controls.address.markAsTouched(),i.receivingFormGroup.controls.address.hasError("timeSlots")||i.receivingFormGroup.controls.address.updateValueAndValidity({onlySelf:true}));}setContext(){let r=i.receivingFormGroup.controls,{deliveryFrom:e,deliveryTo:t}=li(r);r.address.value&&typeof r.address.value!="string"&&this.stateContext?.next({address:r.address.value,deliveryFrom:e,deliveryTo:t,deliveryType:r.receivingWay.value,entrance:r.entrance.value,flat:r.entrance.value,name:q.PAYMENT});}getContext(){return this.stateContext?.value}getButtonState(){let r=we.NEXT;return i.receivingFormGroup.controls.receivingWay.value===a.Pickup?this._pickUpPoint$.value?r=we.CONFIRM:r=we.HIDDEN:i.receivingFormGroup.controls.receivingWay.value===a.Delivery&&(i.foreignCitizenship$.value?r=we.HIDDEN:i.receivingFormGroup.controls.timeSlotsTime.value?.isSamokat&&(r=we.CONFIRM_ORDER)),r}};var Pt=(()=>{class i{get device$(){return this._device$}get device(){return this._device$.value}constructor(e){this._localStorageService=e,this.cartDeviceKey="yotaCart-device",this._device$=new In$1(null),this._device$.next(this._localStorageService.getItemParsed(this.cartDeviceKey));}setDeviceId(e){let t=this._device$.getValue();t?this._setDevice(e?x(w$1({},t),{id:e}):null):this._setDevice(e?{id:e}:null);}setInfo(e){let t=this._device$.getValue();t?t=w$1(w$1({},t),e):t=w$1({},e),this._setDevice(t);}_setDevice(e){this._device$.next(e),e?this._localStorageService.setItemParsed(this.cartDeviceKey,e):this._localStorageService.removeItem(this.cartDeviceKey);}static{this.\u0275fac=function(t){return new(t||i)(K($$1))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var Mn=(()=>{class i extends p{constructor(){super(),this._orderAnalyticsService=I(ne),this._orderStateService=I(pe),this._cdr=I(ci$1),this.paymentForm=Qe.paymentFormGroup,this.paymentMethodControl=Qe.paymentFormGroup.controls.paymentMethod,this.paymentMethods=vt,this.availablePaymentTypes=L.receivingFormGroup.controls.timeSlotsTime.value?.availablePaymentTypes,this.radioButtonName="paymentType",this.radioButtonCardId="payment-form__card",this.radioButtonCashId="payment-form__cash",this._orderStateService.paymentStep.stepState$.pipe(ot(e=>e===G.ACTIVE),Vu(this._onDestroy$)).subscribe(()=>this._orderAnalyticsService.onChoosePaymentType(this.paymentMethodControl.value)),this.paymentMethodControl.valueChanges.pipe(ot(e=>this._orderStateService.currentState?.name===q.PAYMENT),Vu(this._onDestroy$)).subscribe(e=>{e&&this._orderAnalyticsService.onChoosePaymentType(e);}),L.receivingFormGroup.controls.timeSlotsTime.valueChanges.pipe(Hu(e=>{this.availablePaymentTypes=e?.availablePaymentTypes;}),Vu(this._onDestroy$)).subscribe(()=>{this._cdr.markForCheck();});}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-payment-form"]],features:[_I],decls:6,vars:13,consts:[[1,"payment-form"],[1,"payment-form__title"],[1,"payment-form__row",3,"formGroup"],[3,"value","control","disable","label","id","inputName"],[3,"value","disable","control","label","id","inputName"]],template:function(t,n){t&1&&(kp(0,"div",0)(1,"h2",1),RO(2,"\u0421\u043F\u043E\u0441\u043E\u0431 \u043E\u043F\u043B\u0430\u0442\u044B"),Pp(),kp(3,"form",2),DE(4,"yota-order-radio-button",3)(5,"yota-order-radio-button",4),Pp()()),t&2&&(QR(3),iE("formGroup",n.paymentForm),QR(),iE("value",n.paymentMethods.CARD)("control",n.paymentMethodControl)("disable",!(n.availablePaymentTypes!=null&&n.availablePaymentTypes.includes(n.paymentMethods.CARD)))("label","\u041A\u0430\u0440\u0442\u043E\u0439 \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438")("id",n.radioButtonCardId)("inputName",n.radioButtonName),QR(),iE("value",n.paymentMethods.CASH)("disable",!(n.availablePaymentTypes!=null&&n.availablePaymentTypes.includes(n.paymentMethods.CASH)))("control",n.paymentMethodControl)("label","\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438 \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438")("id",n.radioButtonCashId)("inputName",n.radioButtonName));},dependencies:[An,Dn$1,Cn,Mn$1,Bt,ai],styles:[".payment-form__title[_ngcontent-%COMP%]{margin-bottom:24px;font-size:16px;line-height:22px;font-weight:600}.payment-form__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;column-gap:32px}@media (max-width: 768px){.payment-form__title[_ngcontent-%COMP%]{margin-bottom:16px}.payment-form__row[_ngcontent-%COMP%]{grid-template-columns:1fr;row-gap:16px}}"],changeDetection:0});}}return i})();var Qe=class i extends rt{static{this.paymentFormGroup=new I$2({paymentMethod:new W(vt.CARD,{nonNullable:true})});}constructor(r,e){super(),this._stepState$=r,this._transition=e,this.component=Mn,this.name=q.PAYMENT,this.title="\u0421\u043F\u043E\u0441\u043E\u0431 \u043E\u043F\u043B\u0430\u0442\u044B",this.stepState$=this._stepState$,this.transitions=this._transition;}nextAction(){}getWriteData(){return i.paymentFormGroup.controls.paymentMethod.value===vt.CASH?"\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438":"\u041A\u0430\u0440\u0442\u043E\u0439"}showValidateErrors(){}setContext(){this.stateContext?.next({name:q.PAYMENT,paymentMethods:i.paymentFormGroup.controls.paymentMethod.value});}getContext(){return this.stateContext?.value}getButtonState(){return we.CONFIRM_ORDER}};function Dn({address:i,flat:r,entrance:e}){return i.value&&typeof i.value!="string"?{address:i.value?.value,block:i.value?.block,city:i.value?.city,entrance:e.value,fiasId:i.value?.fiasId,flat:r.value,fullAddress:i.value?.unrestrictedValue,house:i.value?.house,latitude:i.value?.latitude,longitude:i.value?.longitude,settlement:i.value?.settlement,street:i.value?.street}:{}}var he=(()=>{class i{constructor(){this._orderStateService=I(pe),this._orderAnalyticsService=I(ne),this._window=I(i$1),this._cartService=I(Pt),this.saveOrderRequest={},this.storeId=null,this.deliveryType$=new In$1(_.Courier),this._orderMetaInfo$=new In$1(null),this._saveOrder$=new In$1(null),this._orderStore$=new In$1({contactState:new In$1(null),paymentState:new In$1(null),receivingState:new In$1(null)});}get orderMetaInfo$(){return this._orderMetaInfo$}set orderMetaInfo(e){this._orderMetaInfo$.next(e);}get contactState$(){return this._orderStore$.value.contactState}get contactState(){return this._orderStore$.value.contactState.value}set saveOrder(e){this._saveOrder$.next(e);}get saveOrder$(){return this._saveOrder$}get orderRegion(){let e=this.orderMetaInfo$.value?.dmsData;return e?e.region:""}get orderCity(){let e=this.orderMetaInfo$.value?.dmsData;return e?e.city??e.settlement:""}setContactState(e){this._orderStore$.value.contactState.next(e);}setPaymentState(e){this._orderStore$.value.paymentState.next(e);}setReceivingState(e){this._orderStore$.value.receivingState.next(e),this._orderAnalyticsService.deliveryType$.next(this.deliveryType$.value);}setSaveOrderRequest(){if(!this.orderSettings||!this.orderMetaInfo$.value)return;let e=L.receivingFormGroup.controls,t=re.contactFormGroup.controls,n=Qe.paymentFormGroup.controls,o=J.beautifulNumberFormGroup.controls,{deliveryFrom:p,deliveryTo:m}=li(e),b;if(this._orderMetaInfo$.value?.cityData?.city?.timezone&&(b=parseInt(this._orderMetaInfo$.value?.cityData?.city?.timezone,10)),this.saveOrderRequest={orderId:this.saveOrder$.value?.orderId?parseInt(this.saveOrder$.value.orderId):void 0,deliveryAddress:Dn(e),deliveryDetails:{customerComment:e.comment?.value.toString(),deliveryCost:e.timeSlotsTime.value?.minimumDeliveryCost||0,deliveryFrom:p,deliveryTo:m,paymentType:n.paymentMethod.value.toString()},userId:20125,fiasCode:this.orderMetaInfo$.value?.cityData.city.fiasCode,isSet:this.orderMetaInfo$.value?.dmsData.nomenclatures[0].isSet,isSimMode:!!this.orderSettings.simGoodOutsideNumber,mnp:t.mnp.value,phone:t.phone.value,receivingWay:e.receivingWay.value,deliveryType:e.receivingWay.value===a.Pickup?null:this.deliveryType$.value,quantity:this._orderStateService.cartFormGroup.controls.productCount.value,salesPointCode:this._orderStateService.pickUpPoint$.value?.code,selfRegistration:false,storeId:this.storeId??void 0,timezone:b,goodId:this.orderSettings.goodId,legalForm:this.orderSettings.commerceType.toLowerCase(),totalCost:this._orderStateService.totalPrice,url:this._window.location.href},this.orderSettings.nameShow){let D=t.name?.value||"",[Y,...ce]=D.split(" "),An=ce.join(" ");this.saveOrderRequest.firstName=An,this.saveOrderRequest.lastName=Y;}let M=this._cartService.device?.expirationLockDate||void 0,d=this._cartService.device?.lockId||void 0,N=new Date;M&&new Date(M)>N&&d&&o.numbers.value.length?(this.saveOrderRequest.lockId=d,this.saveOrderRequest.msisdn=o.numbers.value.map(D=>parseInt(D.value))):(this.saveOrderRequest.lockId=void 0,this.saveOrderRequest.msisdn=void 0);}reset(){this._orderMetaInfo$.next(null),this._saveOrder$.next(null),this.deliveryType$.next(_.Courier);}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var In=(()=>{class i{constructor(e,t){this.config=e,this.http=t;}get rootUrl(){return this._rootUrl||this.config.rootUrl}set rootUrl(e){this._rootUrl=e;}static{this.\u0275fac=function(t){return new(t||i)(K(K$1),K(ve))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac});}}return i})();var bi=class{encodeKey(r){return encodeURIComponent(r)}encodeValue(r){return encodeURIComponent(r)}decodeKey(r){return decodeURIComponent(r)}decodeValue(r){return decodeURIComponent(r)}},Jn=new bi,kt=class{constructor(r,e,t,n,o){this.name=r,this.value=e,this.options=t,this.options=t||{},(this.options.style===null||this.options.style===void 0)&&(this.options.style=n),(this.options.explode===null||this.options.explode===void 0)&&(this.options.explode=o);}serializeValue(r,e=","){if(r==null)return "";if(r instanceof Array)return r.map(t=>this.serializeValue(t).split(e).join(encodeURIComponent(e))).join(e);if(typeof r=="object"){let t=[];for(let n of Object.keys(r)){let o=r[n];o!=null&&(o=this.serializeValue(o).split(e).join(encodeURIComponent(e)),this.options.explode?t.push(`${n}=${o}`):(t.push(n),t.push(o)));}return t.join(e)}else return String(r)}},yi=class extends kt{constructor(r,e,t){super(r,e,t,"simple",false);}append(r){let e=this.value;e==null&&(e="");let t=this.options.style==="label"?".":"",n=this.options.explode?t===""?",":t:",",o=false;return this.options.style==="matrix"&&(t=`;${this.name}=`,this.options.explode&&typeof e=="object"&&(t=";",e instanceof Array?(e=e.map(p=>`${this.name}=${this.serializeValue(p,";")}`),e=e.join(";"),o=true):(e=this.serializeValue(e,";"),o=true))),e=t+(o?e:this.serializeValue(e,n)),r=r.replace(`{${this.name}}`,e),r=r.replace(`{${t}${this.name}${this.options.explode?"*":""}}`,e),r}serializeValue(r,e=","){var t=typeof r=="string"?encodeURIComponent(r):super.serializeValue(r,e);return t=t.replace(/%3D/g,"="),t=t.replace(/%3B/g,";"),t=t.replace(/%2C/g,","),t}},Si=class extends kt{constructor(r,e,t){super(r,e,t,"form",true);}append(r){if(this.value instanceof Array)if(this.options.explode)for(let e of this.value)r=r.append(this.name,this.serializeValue(e));else {let e=this.options.style==="spaceDelimited"?" ":this.options.style==="pipeDelimited"?"|":",";return r.append(this.name,this.serializeValue(this.value,e))}else if(this.value!==null&&typeof this.value=="object")if(this.options.style==="deepObject")for(let e of Object.keys(this.value)){let t=this.value[e];t!=null&&(r=r.append(`${this.name}[${e}]`,this.serializeValue(t)));}else if(this.options.explode)for(let e of Object.keys(this.value)){let t=this.value[e];t!=null&&(r=r.append(e,this.serializeValue(t)));}else {let e=[];for(let t of Object.keys(this.value)){let n=this.value[t];n!=null&&(e.push(t),e.push(n));}r=r.append(this.name,this.serializeValue(e));}else this.value!==null&&this.value!==void 0&&(r=r.append(this.name,this.serializeValue(this.value)));return r}},xi=class extends kt{constructor(r,e,t){super(r,e,t,"simple",false);}append(r){if(this.value!==null&&this.value!==void 0)if(this.value instanceof Array)for(let e of this.value)r=r.append(this.name,this.serializeValue(e));else r=r.append(this.name,this.serializeValue(this.value));return r}},Ye=class{constructor(r,e,t){this.rootUrl=r,this.operationPath=e,this.method=t,this._path=new Map,this._query=new Map,this._header=new Map;}path(r,e,t){this._path.set(r,new yi(r,e,t||{}));}query(r,e,t){this._query.set(r,new Si(r,e,t||{}));}header(r,e,t){this._header.set(r,new xi(r,e,t||{}));}body(r,e="application/json"){if(r instanceof Blob?this._bodyContentType=r.type:this._bodyContentType=e,this._bodyContentType==="application/x-www-form-urlencoded"&&r!==null&&typeof r=="object"){let t=[];for(let n of Object.keys(r)){let o=r[n];o instanceof Array||(o=[o]);for(let p of o){let m=this.formDataValue(p);m!==null&&t.push([n,m]);}}this._bodyContent=t.map(n=>`${encodeURIComponent(n[0])}=${encodeURIComponent(n[1])}`).join("&");}else if(this._bodyContentType==="multipart/form-data"){let t=new FormData;if(r!=null)for(let n of Object.keys(r)){let o=r[n];if(o instanceof Array)for(let p of o){let m=this.formDataValue(p);m!==null&&t.append(n,m);}else {let p=this.formDataValue(o);p!==null&&t.set(n,p);}}this._bodyContent=t;}else this._bodyContent=r;}formDataValue(r){return r==null?null:r instanceof Blob?r:typeof r=="object"?new Blob([JSON.stringify(r)],{type:"application/json"}):String(r)}build(r){r=r||{};let e=this.operationPath;for(let p of this._path.values())e=p.append(e);let t=this.rootUrl+e,n=new E$1({encoder:Jn});for(let p of this._query.values())n=p.append(n);let o=new v;r.accept&&(o=o.append("Accept",r.accept));for(let p of this._header.values())o=p.append(o);return this._bodyContentType&&!(this._bodyContent instanceof FormData)&&(o=o.set("Content-Type",this._bodyContentType)),new A$1(this.method.toUpperCase(),t,this._bodyContent,{params:n,headers:o,responseType:r.responseType,reportProgress:r.reportProgress,context:r.context})}};function ci(i,r,e,t){let n=new Ye(r,ci.PATH,"post");return e&&(n.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),n.body(e.body,"application/json")),i.request(n.build({responseType:"text",accept:"*/*",context:t})).pipe(ot(o=>o instanceof _$1),le(o=>o.clone({body:void 0})))}ci.PATH="/number/cancelLock";function pi(i,r,e,t){let n=new Ye(r,pi.PATH,"post");return e&&(n.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),n.body(e.body,"application/json")),i.request(n.build({responseType:"text",accept:"*/*",context:t})).pipe(ot(o=>o instanceof _$1),le(o=>o.clone({body:void 0})))}pi.PATH="/number/captcha";function ui(i,r,e,t){let n=new Ye(r,ui.PATH,"get");return e&&(n.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),n.query("region",e.region,{}),n.query("searchType",e.searchType,{}),n.query("offset",e.offset,{}),n.query("classId",e.classId,{}),n.query("mask",e.mask,{})),i.request(n.build({responseType:"json",accept:"application/json",context:t})).pipe(ot(o=>o instanceof _$1),le(o=>o))}ui.PATH="/number/search";function mi(i,r,e,t){let n=new Ye(r,mi.PATH,"get");return i.request(n.build({responseType:"json",accept:"application/json",context:t})).pipe(ot(o=>o instanceof _$1),le(o=>o))}mi.PATH="/number/captcha";function di(i,r,e,t){let n=new Ye(r,di.PATH,"post");return e&&(n.header("NS-CLIENT-IP",e["NS-CLIENT-IP"],{}),n.body(e.body,"application/json")),i.request(n.build({responseType:"json",accept:"application/json",context:t})).pipe(ot(o=>o instanceof _$1),le(o=>o))}di.PATH="/number/lock";var Ei=(()=>{class i extends In{constructor(e,t){super(e,t);}static{this.GetBeautifulNumbersPath="/number/search";}getBeautifulNumbers$Response(e,t){return ui(this.http,this.rootUrl,e,t)}getBeautifulNumbers(e,t){return this.getBeautifulNumbers$Response(e,t).pipe(le(n=>n.body))}static{this.LockBeautifulNumberPath="/number/lock";}lockBeautifulNumber$Response(e,t){return di(this.http,this.rootUrl,e,t)}lockBeautifulNumber(e,t){return this.lockBeautifulNumber$Response(e,t).pipe(le(n=>n.body))}static{this.CancelBeautifulNumberPath="/number/cancelLock";}cancelBeautifulNumber$Response(e,t){return ci(this.http,this.rootUrl,e,t)}cancelBeautifulNumber(e,t){return this.cancelBeautifulNumber$Response(e,t).pipe(le(n=>n.body))}static{this.GetCaptchaPath="/number/captcha";}getCaptcha$Response(e,t){return mi(this.http,this.rootUrl,e,t)}getCaptcha(e,t){return this.getCaptcha$Response(e,t).pipe(le(n=>n.body))}static{this.CheckCaptchaPath="/number/captcha";}checkCaptcha$Response(e,t){return pi(this.http,this.rootUrl,e,t)}checkCaptcha(e,t){return this.checkCaptcha$Response(e,t).pipe(le(n=>n.body))}static{this.\u0275fac=function(t){return new(t||i)(K(K$1),K(ve))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var Be=(()=>{class i extends p{constructor(){super(...arguments),this.isSamokatAvailability$=new In$1(true),this.loadingOrder$=new In$1(false),this.orderError$=new In$1(null),this.confirmOrderData$=new In$1(null),this.globalError$=this.orderError$.pipe(ot(e=>e!==I$1.TimeSlotUnavailable),kr$1()),this._dmsApi=I(Re),this._orderApi=I(be),this._samokatApi=I(je$1),this._bigCities=I(me),this._dadataApi=I(Pe),this._orderDataService=I(he),this._salePointsService=I(qe),this._otpService=I(Te),this._orderAnalyticsService=I(ne),this._phoneNumbersService=I(Ei);}searchByPosition$(e){return this._dmsApi.searchByPosition$Json(e)}getTimeSlots$(e){return this._dmsApi.getTimeSlots(e)}getPreOrderInfo$(e,t){let n=e.fiasCode;if(!n)return this._returnError$(new Error("fiasCode null"),I$1.TechnicalError);let o=x(w$1({},e),{fiasCode:n});return e.kladrId&&(o.kladrId=e.kladrId),this.loadingOrder$.next(true),this._orderApi.getPreOrderInfo$Json(o).pipe(Hu(()=>this.loadingOrder$.next(true)),Ie(p=>t?Vh({cityData:p,dmsData:t}):this.searchByPosition$({goodOutsideNumber:p.good.outsideNumber,latitude:p.city.latitude,longitude:p.city.longitude,legalForm:e.legalForm}).pipe(le(m=>x(w$1({},m),{nomenclature:m.nomenclatures[0]})),le(m=>({cityData:p,dmsData:m})),Pi$1(m=>this._returnError$(m,I$1.TechnicalError)))),Pi$1(p=>{let m=p.error.errorCode===I$1.GeodataNotFound||p.error.errorCode===I$1.NomenclatureNotFound?p.error.errorCode:I$1.TechnicalError;return this._returnError$(p,m)}),Hu(()=>this.loadingOrder$.next(false)))}samokatAvailability$(e){return this._samokatApi.samokatAvailability(e)}saveOrder$(e){return this._orderApi.saveOrder({body:e}).pipe(Pi$1(t=>this._returnError$(t,t?.error?.errorCode||I$1.TechnicalError)))}updateOrder$(e){return this._orderApi.updateOrder$Json({body:e}).pipe(Pi$1(t=>this._returnError$(t,t?.error?.errorCode||I$1.TechnicalError)))}confirmOrder$(e){return this._orderDataService.setSaveOrderRequest(),this._orderApi.confirmOrder({body:e}).pipe(Pi$1(t=>{throw t}))}searchByName$(e){return this._dmsApi.searchByName(e)}searchByCode$(e){return this._dmsApi.searchByCode(e)}getBigCities$(){return this._bigCities.getBigCities().pipe(le(e=>({items:e})))}getAddresses$(e){return this._dadataApi.getAddresses(e)}getCities$(e){return this._dadataApi.getCities(e)}getSamokatAvailability$(){let e=L.receivingFormGroup.controls.address.value;if(!e||typeof e=="string")return Vh();let t=3;return this._orderDataService.orderMetaInfo$.value?.cityData?.city?.timezone&&(t=parseInt(this._orderDataService.orderMetaInfo$.value?.cityData?.city?.timezone,10)),this.samokatAvailability$({goodId:this._orderDataService.orderSettings.goodId,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),timezone:t}).pipe(le(n=>(this._orderDataService.storeId=n.storeId,this.isSamokatAvailability$.next(n.success),n.success)),Pi$1(()=>(this.isSamokatAvailability$.next(false),Vh(false))))}saveOrUpdateOrder$(){return this._orderDataService.setSaveOrderRequest(),Vh(this._orderDataService.saveOrder$.value).pipe(Ie(e=>hg(()=>e===null,this.saveOrder$(this._orderDataService.saveOrderRequest),this.updateOrder$(this._orderDataService.saveOrderRequest))))}getSalesPoints$(e){return this._salePointsService.getOrderSalesPoints(e).pipe(le(t=>{if(t?.salePoints?.length)return t.salePoints;throw new Error(I$1.SalesPointReceivingFailed)}),Pi$1(t=>{this._returnError$(t,I$1.SalesPointReceivingFailed);let n=w$1({},this._orderDataService.orderMetaInfo$.value);return n?.dmsData&&(n.dmsData.nomenclature.pickupAvailable=false,this._orderDataService.orderMetaInfo=n),Vh([])}))}getGoodSalesPoints$(e){return this._salePointsService.getGoodSalesPoints(e).pipe(le(t=>{if(t)return t;throw new Error(I$1.CantPickup)}),Pi$1(t=>(this._orderAnalyticsService.onPickupError(I$1.CantPickup??t?.message??t?.name,this._orderDataService.orderRegion,this._orderDataService.orderCity),rg(()=>new Error(I$1.CantPickup)))))}getCaptcha$(){return this._orderApi.getOrderCaptcha()}getNumbersCaptcha$(){return this._phoneNumbersService.getCaptcha()}checkNumbersCaptcha$(e){return this._phoneNumbersService.checkCaptcha({body:e})}sendOtp(e){return this._otpService.sendOtp(e)}setReturnError(e,t){return this._returnError$(e,t)}reset(){this.isSamokatAvailability$.next(false),this.loadingOrder$.next(false),this.orderError$.next(null),this.confirmOrderData$.next(null);}getBeautifulNumbers$(e){return this._phoneNumbersService.getBeautifulNumbers(e)}lockBeautifulNumber$(e){return this._phoneNumbersService.lockBeautifulNumber({body:e})}cancelBeautifulNumber$(e){return this._phoneNumbersService.cancelBeautifulNumber({body:e})}_returnError$(e,t){return this.orderError$.next(t),this._log.error(e),this._orderAnalyticsService.onError(t??e?.message??e?.name,this._orderDataService.orderRegion,this._orderDataService.orderCity),rg(()=>e)}static{this.\u0275fac=(()=>{let e;return function(n){return (e||(e=kR(i)))(n||i)}})();}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();function Oi(i,r){let e,t;return G$1(r.date)?(e="\u0421\u0435\u0433\u043E\u0434\u043D\u044F",t=`(${i.transform(r.date,"d MMMM","ru")}, ${i.transform(r.date,"EE","ru")})`):P(r.date)?(e="\u0417\u0430\u0432\u0442\u0440\u0430",t=`(${i.transform(r.date,"d MMMM","ru")}, ${i.transform(r.date,"EE","ru")})`):(e=i.transform(r.date,"d MMMM","ru"),t=i.transform(r.date,"(EE)","ru")),x(w$1({},r),{leftSide:e,rightSide:t,timeSlots:r.timeSlotUiItems?.map(n=>Zn(n))})}function Zn(i){return x(w$1({},i),{leftSide:i.isSamokat?"\u0411\u043B\u0438\u0436\u0430\u0439\u0448\u0438\u0435 30 \u043C\u0438\u043D\u0443\u0442":`${i.startTime} - ${i.endTime}`,rightSide:`(${i.minimumDeliveryCost} \u20BD)`})}var bt=(()=>{class i{constructor(e,t,n){this._orderStateService=e,this._orderApiService=t,this._orderDataService=n,this.addresses$=new In$1([]),this.loadingTimeSlots$=new In$1(false),this.timeSlotSearch$=new In$1([]),this.addressName$=new In$1(""),this.showSamokat$=new In$1(false),this._stores$=new In$1(null),this._storesCache=new Map;}get stores$(){return this._stores$.pipe(kr$1())}fetchAddress$(e){let t=this._orderDataService.orderMetaInfo$.value,n=this._orderDataService.orderSettings;return !t||!n?(this.addresses$.next([]),Vh()):this._orderApiService.getAddresses$({fiasCode:t.cityData.city.fiasCode,address:e}).pipe(le(o=>{this.addresses$.next(o);}),Pi$1(()=>(this.addresses$.next([]),Vh())))}fetchTimeSlots$(e){let t=this._orderDataService.orderMetaInfo$.value,n=this._orderDataService.orderSettings,o=this._orderDataService.contactState,p=J.beautifulNumberFormGroup.controls.numbers.value.length>0;if(!t)return Vh([]);let m=new eC("RU");return this.loadingTimeSlots$.next(true),this.showSamokat$.next(true),this._orderApiService.getTimeSlots$({b2b:n.commerceType==="b2b",count:this._orderStateService.cartFormGroup.controls.productCount.value,fiasId:e,goodOutsideNumber:t.cityData.good.outsideNumber,mnp:!!o?.mnp,sr:false,withPNumbers:p}).pipe(le(b=>{let M=[];if(Array.isArray(b)){let d=[],N;t.dmsData.nomenclatures[0].samokatDelivery&&!p&&!this._orderStateService.isForeignCitizenship$.value&&(N=this._getSamokatTimeSlot()),d=b.sort((Y,ce)=>Y.date>ce.date?1:Y.date<ce.date?-1:0);let D=G$1(b[0]?.date);N&&N?.timeSlotUiItems?.length&&D?d[0].timeSlotUiItems?.unshift(N.timeSlotUiItems[0]):N&&!D&&d?.unshift(N),M=d.map(Y=>Oi(m,Y)),this.timeSlotSearch$.next(M);}return M}),Pi$1(b=>{let M=[],d=[],N;return t.dmsData.nomenclatures[0].samokatDelivery&&!p&&(N=this._getSamokatTimeSlot()),N?(M.push(N),d=M.map(D=>Oi(m,D)),this.timeSlotSearch$.next(d),this.showSamokat$.next(true),Vh(d)):(this.timeSlotSearch$.next([]),this._orderApiService.setReturnError(b,I$1.TimeSlotUnavailable),ze)}))}resetAddress(){this.addresses$.next([]),this.timeSlotSearch$.next([]),this.showSamokat$.next(false);}get isReceivingWayEqualDelivery(){return L.receivingFormGroup.controls.receivingWay.value===a.Delivery}get isNonResident(){return re.contactFormGroup.controls.citizenship.value!=="\u0420\u043E\u0441\u0441\u0438\u044F"&&!!this._orderDataService.orderSettings.nonResidentRestriction}resetAddressAfterActions(e=true){if(e){this._reset();return}let n=!!this._orderDataService.orderMetaInfo$.value?.dmsData?.nomenclatures?.[0]?.samokatDelivery;!e&&n&&this.isReceivingWayEqualDelivery&&this._reset();}_reset(){this.resetAddress(),this._orderStateService.resetAfterActions(),L.receivingFormGroup.reset();}getSalePoints$(e,t,n){let o=this._orderDataService.orderMetaInfo$.value;if(!o?.cityData.good.id)return Vh([]);let p=o.cityData.good.id.toString(),m=o.cityData.city.fiasCode.toString(),b=p+m+e.toString()+t.toString()+n.toString(),M=b+"true";if(this._storesCache.has(b)){let d=this._storesCache.get(b);if(!d?.length){let N=w$1({},this._orderDataService.orderMetaInfo$.value);N?.dmsData&&(N.dmsData.nomenclature.pickupAvailable=false,this._orderDataService.orderMetaInfo=N),this._orderApiService.orderError$.next(I$1.SalesPointReceivingFailed);}return Vh(d||[])}return !n&&this._storesCache.has(M)&&this._storesCache.delete(M),this._orderApiService.getSalesPoints$({goodId:parseInt(p,10),fiasCode:m,withMnpOnly:e,withPNumbers:t,withBIO:n}).pipe(le(d=>d||[]),Hu(d=>{this._storesCache.set(b,d);}))}_getSamokatTimeSlot(){let e=this._orderDataService.contactState;return {date:new Date().toISOString(),timeSlotUiItems:[{minimumDeliveryCost:0,mnp:!!e?.mnp,b2b:false,sr:false,isSamokat:true,availablePaymentTypes:[],itemCountDTOs:[]}]}}static{this.\u0275fac=function(t){return new(t||i)(K(pe),K(Be),K(he))};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();function Di(i){return i?.replace(/-/g,"")}function er(i,r){if(i&1&&(kp(0,"div",11),DE(1,"span",12),$O(2,"yHighlight"),Pp()),i&2){let e=wO().$implicit;wO();let t=AO(4);QR(),iE("innerHTML",zO(2,1,e.value,t.value),WR);}}function tr(i,r){if(i&1&&(kp(0,"y-option-bordered",9),kI(1,er,3,4,"div",10),Pp()),i&2){let e=r.$implicit;iE("value",e),QR(),iE("ngIf",e.value);}}function ir(i,r){if(i&1){let e=EO();kp(0,"y-form-field-bordered",4)(1,"y-label"),RO(2),Pp(),kp(3,"input",5,0),RE("focusin",function(){AR(e);let n=wO();return RR(n.handleFocusIn())})("focusout",function(){AR(e);let n=wO();return RR(n.handleFocusOut())})("keyup.enter",function(){AR(e);let n=wO();return RR(n.handleEnter())}),Pp(),kp(5,"yota-field-state",6),$O(6,"async"),RE("clear",function(){AR(e);let n=wO();return RR(n.clearAutocompleteField())}),Pp(),kp(7,"y-autocomplete-bordered",7,1),RE("optionSelected",function(n){AR(e);let o=wO();return RR(o.onSelect(n))})("closed",function(){AR(e);let n=wO();return RR(n.onClosed())}),kI(9,tr,2,2,"y-option-bordered",8),Pp()();}if(i&2){let e=AO(4),t=AO(8),n=wO();iE("staticLabel",true),QR(2),VE(n.label),QR(),iE("yAutocompleteBordered",t)("formControl",n.regionControl)("yAutocompleteBorderedPosition","below")("required",true),QR(2),iE("state",e.focused&&e.value.length?n.controlState.CLEAR:UO(6,10,n.autocompleteFieldState$))("inputControl",e),QR(2),iE("displayWith",n.displayWith()),QR(2),iE("ngForOf",n.searchCity);}}var Ii=(()=>{class i extends p{constructor(e,t,n,o){super(),this._changeDetectorRef=e,this._orderApiService=t,this._orderDataService=n,this._analyticsFacadeService=o,this.regionControl=re.contactFormGroup.controls.region,this._selectOption=new st,this.searchCity=[],this.selectedCity=null,this.fromFocus=false,this.autocompleteFieldState$=new In$1(null),this.controlState=c,this.autocompleteErrorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]]),this._cityFiasIdChanged$=new X,this._isAutocompleteFocused$=new In$1(false),this.selectedCity=typeof this.regionControl.value=="object"?this.regionControl.value:null,this.regionControl.valueChanges.pipe(le(p=>{if(this.autocompleteFieldState$.next(p?c.SUCCESS:null),typeof p!="string")return "";let m=f.convert(p);return this.regionControl.setValue(m,{emitEvent:false}),this.regionControl.markAsTouched(),this._changeDetectorRef.markForCheck(),m}),Mu(256),Au((p,m)=>this.fromFocus?false:p===m),Hu(()=>this.fromFocus=false),ju(p=>this._orderDataService.orderMetaInfo$.pipe(le(m=>({value:p,fiasCode:m?.cityData?.city?.fiasCode})))),ju(({value:p,fiasCode:m})=>(p=p.trim(),p.length>2&&this._orderDataService.orderSettings&&this._orderDataService.orderMetaInfo$.value?this._orderApiService.getCities$({address:p}).pipe(le(b=>b?.filter(M=>M.fiasId.replaceAll("-","")!==m)),Vu(this._onDestroy$),Pi$1(()=>Vh(new Array))):Vh(new Array))),Vu(this._onDestroy$)).subscribe(p=>{this.searchCity=p?.map(m=>x(w$1({},m),{fiasCode:Di(m.fiasId),name:this.getCityName(m),kladrId:m.kladrId}))??[],this._changeDetectorRef.markForCheck();}),this._cityFiasIdChanged$.pipe(ot(()=>!!this._orderDataService.orderSettings&&!!this._orderDataService.orderMetaInfo$.value),Au(),Ie(p=>this._orderApiService.searchByCode$({code:p,goodOutsideNumber:this._orderDataService.orderMetaInfo$.value.cityData.good.outsideNumber,legalForm:this._orderDataService.orderSettings.commerceType}).pipe(Pi$1(()=>Vh(new Array)))),Vu(this._onDestroy$)).subscribe(p=>{if(p.length){let m={fiasCode:Di(p[0].fiasId),name:this.getCityName(p[0]),kladrId:p[0].kladrId,dmsData:w$1({},p[0])};this.selectedCity=m,this.regionControl.setValue(m),this._selectOption.emit(m),this._changeDetectorRef.markForCheck(),this.closePanel();}}),this._isAutocompleteFocused$.pipe(Mu(512),ot(p=>!p),Vu(this._onDestroy$)).subscribe(()=>{if(!this.regionControl.value||typeof this.regionControl.value=="string"){let p=this._orderDataService.orderMetaInfo$.value?.cityData?.city,m=this._orderDataService.orderMetaInfo$.value?.dmsData,b=this.getCityName(m);this.regionControl.setValue({fiasCode:p?.fiasCode,name:b,fullName:p?.fullName},{emitEvent:false}),this.autocompleteFieldState$.next(c.SUCCESS);}});}onSelect(e){if(!this._orderDataService.orderSettings||!this._orderDataService.orderMetaInfo$.value)return;let t="";this.selectedCity&&(t=`${this.selectedCity?.name} \u043D\u0430 ${e.option.value.name}`),this._analyticsFacadeService.pushDataLayer({event:E.ECOMMERCE,event_param:t},O$1.ORDER_CITY_SELECT),this._cityFiasIdChanged$.next(e.option.value.fiasId);}displayWith(){return e=>typeof e=="string"?e:e?.name?e.name:""}closePanel(){this.inputRef.nativeElement.blur(),this.autocompleteDirRef?.closePanel();}openPanel(){this.inputRef.nativeElement.focus(),this.autocompleteDirRef?.openPanel();}togglePanel(e){e.stopPropagation(),this.autocompleteDirRef.autocomplete.isOpen?this.closePanel():this.openPanel();}ngOnInit(){this._orderDataService.orderMetaInfo$.pipe(ot(Boolean),Et(1),Vu(this._onDestroy$)).subscribe(e=>{if(e){let t={fiasCode:e.cityData.city.fiasCode,name:e.cityData.city.name};this.regionControl.setValue(t),this.selectedCity=t;}this.selectedCity&&this.autocompleteFieldState$.next(c.SUCCESS);});}onClosed(){this.searchCity=[],this.regionControl.setValue(this.selectedCity);}handleFocusIn(){let e=typeof this.regionControl?.value=="string"?this.regionControl?.value:this.regionControl?.value?.name;this.fromFocus=true,this._isAutocompleteFocused$.next(true),this.regionControl.setValue(e||"");}handleFocusOut(){this._isAutocompleteFocused$.next(false);}getCityName(e){let t=e?.settlement?.trim().length?e?.settlement:e?.city,n=e.region;if(t===n)return t;let o;return (e?.area||e?.cityDistrict)&&(o=e?.area||e?.cityDistrict),`${t} (${n}${o?", "+o:""})`}handleEnter(){if(this.searchCity.length){let e=this.searchCity[0];this.onSelect({option:{value:e}});}}getAutocompleteErrorMessage(){let e=w$1({},this.regionControl.errors);if(!e)return "";for(let t of Object.keys(e)){let n=this.autocompleteErrorMessages.get(t);if(n)return n}return ""}clearAutocompleteField(){this.searchCity=[],this.regionControl.setValue("");}static{this.\u0275fac=function(t){return new(t||i)(k$1(ci$1),k$1(Be),k$1(he),k$1(O))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-order-autocomplete"]],viewQuery:function(t,n){if(t&1&&(MO(cm,5),MO(Ty,5,Ke)),t&2){let o;TO(o=SO())&&(n.autocompleteDirRef=o.first),TO(o=SO())&&(n.inputRef=o.first);}},inputs:{label:"label"},outputs:{_selectOption:"_selectOption"},features:[_I],decls:2,vars:1,consts:[["inputRef","yInput"],["autocompleteRef","yAutocompleteBordered"],[1,"order-autocomplete"],["class","order-autocomplete__form-field",3,"staticLabel",4,"ngIf"],[1,"order-autocomplete__form-field",3,"staticLabel"],["type","text","id","order-autocomplete","yInput","",1,"order-autocomplete__input",3,"focusin","focusout","keyup.enter","yAutocompleteBordered","formControl","yAutocompleteBorderedPosition","required"],["ySuffix","",1,"order-autocomplete__state",3,"clear","state","inputControl"],[1,"order-autocomplete__dropdown",3,"optionSelected","closed","displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","order-autocomplete__option",4,"ngIf"],[1,"order-autocomplete__option"],[3,"innerHTML"]],template:function(t,n){t&1&&(kp(0,"div",2),kI(1,ir,10,12,"y-form-field-bordered",3),Pp()),t&2&&(QR(),iE("ngIf",n.regionControl));},dependencies:[Ww,An,Ge,yn,ot$1,Mn$1,Tt,x$1,Dh,Jw,ar$1,gd,Ty,dg,tb,Cd,Vy,hd],styles:["[_nghost-%COMP%]  .y-form-field-bordered.y-form-field-bordered-invalid .y-form-field-bordered-flex{border-color:#eaeef4}[_nghost-%COMP%]  .y-form-field-bordered.y-form-field-bordered-invalid.y-focused .y-form-field-bordered-flex{border-color:#00aeef}  .y-autocomplete-bordered-panel.order-autocomplete__dropdown{max-height:368px}@media (max-width: 768px){  .y-autocomplete-bordered-panel.order-autocomplete__dropdown{max-height:312px}}.order-autocomplete[_ngcontent-%COMP%]{position:relative;margin-bottom:15px;background-color:transparent}.order-autocomplete__form-field[_ngcontent-%COMP%]{width:100%}.order-autocomplete__option[_ngcontent-%COMP%]{display:flex;align-items:center;margin-block:4px;font-size:16px;line-height:24px}"],changeDetection:0});}}return i})();var Pn=(()=>{class i{constructor(){this.checked=false,this.agreementLink="https://static.yota.ru/upload/public/doc/approve_PD.pdf",this.personalDataLink="https://www.yota.ru/downloads/politics_with_respect_to_personal_data_processing_v6.pdf",this.changed=new st;}agreementChange(){this.changed.emit(!this.checked);}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-personal-policy-agreement"]],inputs:{checked:"checked",agreementLink:"agreementLink",personalDataLink:"personalDataLink"},outputs:{changed:"changed"},decls:11,vars:4,consts:[[1,"select-number-dialog__number",3,"click"],[1,"select-number-dialog__number-checkbox"],[1,"select-number-dialog__number-value"],["target","_blank","rel","nofollow noopener noreferrer",1,"y-highlight",3,"click","href"],[1,"star"]],template:function(t,n){t&1&&(kp(0,"div",0),RE("click",function(){return n.agreementChange()}),DE(1,"div",1),kp(2,"p",2),RO(3," \u0414\u0430\u044E "),kp(4,"a",3),RE("click",function(p){return p.stopPropagation()}),RO(5,"\u0441\u043E\u0433\u043B\u0430\u0441\u0438\u0435"),Pp(),RO(6," \u043D\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u043C\u043E\u0438\u0445 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445 \u0432 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 "),kp(7,"a",3),RE("click",function(p){return p.stopPropagation()}),RO(8,"\u041F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445"),kp(9,"span",4),RO(10,"*"),Pp()()()()),t&2&&(sE("selected",n.checked),QR(4),iE("href",n.agreementLink,uv),QR(3),iE("href",n.personalDataLink,uv));},styles:["[_nghost-%COMP%]{display:block;max-width:490px}.select-number-dialog__number[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;width:100%;column-gap:12px;align-items:center;transition:all linear .2s}@media (max-width: 484px){.select-number-dialog__number[_ngcontent-%COMP%]{align-items:flex-start}}.select-number-dialog__number-checkbox[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid #ceced5;background:transparent;border-radius:6px;cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:all linear .2s}.select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{content:url(/assets/images/icons/check-bold.svg);transform:translate(40px);height:16px;width:16px;transition:all linear .2s}.select-number-dialog__number-value[_ngcontent-%COMP%]{text-align:left;cursor:pointer;font-size:12px;line-height:18px;font-weight:400;color:#758494}.select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#00aeef;border-color:#00aeef}.select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{transform:translate(0)}.select-number-dialog__number.disabled[_ngcontent-%COMP%]{color:#758494}.select-number-dialog__number.disabled[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#eaeef4;border-color:#ceced5;cursor:not-allowed}.star[_ngcontent-%COMP%]{color:#ff6b6e}"],changeDetection:0});}}return i})();var nr=["phoneFieldInputRef"],rr=["nameFieldInputRef"],or=["autocompleteComponent"];function ar(i,r){if(i&1&&DE(0,"y-icon",21),i&2){wO(2);let e=AO(3);iE("yotaCustomTooltip",e)("yotaCustomTooltipClass","contact-form__top-tooltip")("yotaCustomTooltipPosition","above")("yotaPointEventNone",false);}}function sr(i,r){if(i&1&&(kp(0,"y-error"),RO(1),Pp()),i&2){let e=r.ngIf;QR(),Hp(" ",e," ");}}function lr(i,r){if(i&1){let e=EO();kp(0,"yota-order-autocomplete",22,2),RE("_selectOption",function(n){AR(e);let o=wO(2);return RR(o.citySelected(n))}),Pp();}i&2&&iE("label","\u0413\u043E\u0440\u043E\u0434, \u043F\u043E\u0441\u0435\u043B\u043E\u043A, \u0434\u0435\u0440\u0435\u0432\u043D\u044F");}function cr(i,r){if(i&1&&(kp(0,"y-error"),RO(1),Pp()),i&2){let e=r.ngIf;QR(),Hp(" ",e," ");}}function pr(i,r){if(i&1){let e=EO();kp(0,"y-form-field-bordered",25)(1,"y-label"),RO(2,"\u0424\u0430\u043C\u0438\u043B\u0438\u044F \u0438 \u0438\u043C\u044F"),Pp(),kp(3,"input",26,3),RE("input",function(n){AR(e);let o=wO(3);return RR(o.onInputName(n))})("blur",function(){AR(e);let n=wO(3);return RR(n.onBlurName())}),Pp(),kp(5,"yota-field-state",14),RE("clear",function(){AR(e);let n=wO(3);return RR(n.nameControl.setValue(""))}),Pp(),kI(6,cr,2,1,"y-error",15),Pp();}if(i&2){let e=AO(4),t=wO(3);QR(3),iE("formControl",t.nameControl)("required",t.nameRequired),QR(2),iE("state",t.nameControlState)("inputControl",e),QR(),iE("ngIf",t.getNameErrorMessage(t.nameControl.errors));}}function ur(i,r){if(i&1&&(kp(0,"y-option-bordered",30)(1,"div",31),RO(2),Pp()()),i&2){let e=r.$implicit;iE("value",e),QR(2),Hp(" ",e," ");}}function mr(i,r){if(i&1){let e=EO();kp(0,"y-form-field-bordered",27)(1,"y-label"),RO(2,"\u0413\u0440\u0430\u0436\u0434\u0430\u043D\u0441\u0442\u0432\u043E"),Pp(),kp(3,"y-select-bordered",28),RE("selectionChange",function(){AR(e);let n=wO(3);return RR(n.onCitizenshipChange())}),kI(4,ur,3,2,"y-option-bordered",29),Pp()();}if(i&2){let e=wO(3);QR(3),iE("formControl",e.citizenshipControl)("required",true),QR(),iE("ngForOf",e.citizenshipList);}}function dr(i,r){if(i&1&&(kp(0,"div",11),kI(1,pr,7,5,"y-form-field-bordered",23)(2,mr,5,3,"y-form-field-bordered",24),Pp()),i&2){let e=wO(2);QR(),iE("ngIf",e.nameControl),QR(),iE("ngIf",e.isCitizenshipShow);}}function _r(i,r){i&1&&(kp(0,"div",41),RO(1," \u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 "),Pp());}function hr(i,r){if(i&1){let e=EO();kp(0,"div",32)(1,"div",33)(2,"label",34)(3,"a",35),RO(4," \u041F\u0435\u0440\u0435\u0445\u043E\u0434 \u0432 Yota "),Pp(),RO(5," \u0441\u043E \u0441\u0432\u043E\u0438\u043C \u043D\u043E\u043C\u0435\u0440\u043E\u043C "),Pp(),kp(6,"y-switch",36,4),RE("change",function(){AR(e);let n=wO(2);return RR(n.onMnpChanged())})("click",function(){AR(e);let n=wO(2);return RR(n.onClickMnp())}),Pp()(),kI(8,_r,2,0,"div",37),kp(9,"div",38)(10,"y-icon",39),RO(11," stroke_info "),Pp(),kp(12,"span",40),RO(13," \u041E\u043D \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D \u043D\u0430 \u0442\u0435\u0431\u044F "),Pp()()();}if(i&2){let e=wO(2);QR(6),iE("formControl",e.mnpControl)("id","mnp-switch"),QR(2),iE("ngIf",e.showMnpError),QR(),sE("show",e.mnpControl.value);}}function gr(i,r){if(i&1){let e=EO();kp(0,"div",6)(1,"form",7)(2,"div",8)(3,"h2",9),RO(4,"\u0414\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F"),Pp(),kI(5,ar,1,4,"y-icon",10),Pp(),kp(6,"div",11)(7,"y-form-field-bordered",12)(8,"y-label"),RO(9,"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430"),Pp(),kp(10,"input",13,1),RE("focus",function(){AR(e);let n=wO();return RR(n.onFocusPhoneField())})("paste",function(n){AR(e);let o=wO();return RR(o.onPastePhoneField(n))}),Pp(),kp(12,"yota-field-state",14),RE("clear",function(){AR(e);let n=wO();return RR(n.setDefaultPhoneField())}),Pp(),kI(13,sr,2,1,"y-error",15),Pp(),kp(14,"div",16),kI(15,lr,2,1,"yota-order-autocomplete",17),$O(16,"async"),Pp()(),kI(17,dr,3,2,"div",18)(18,hr,14,5,"div",19),kp(19,"yota-personal-policy-agreement",20),$O(20,"async"),RE("changed",function(n){AR(e);let o=wO();return RR(o.personalDataClick(n))}),Pp()()();}if(i&2){let e=AO(11),t=wO();QR(),iE("formGroup",t.formGroup),QR(4),iE("ngIf",t.isCitizenshipShow),QR(5),iE("formControl",t.phoneControl)("required",true)("unmask",true)("imask",t.phoneMask),QR(2),iE("state",t.phoneControlState)("inputControl",e),QR(),iE("ngIf",t.getPhoneErrorMessage(t.phoneControl.errors)),QR(2),iE("ngIf",UO(16,13,t.region$)),QR(2),iE("ngIf",t.nameControl||t.isCitizenshipShow),QR(),iE("ngIf",t.mnpVisible),QR(),iE("checked",!!UO(20,15,t.isPersonalDataAgreed$));}}function fr(i,r){i&1&&(kp(0,"p"),RO(1,' \u041F\u043E \u0437\u0430\u043A\u043E\u043D\u0443 "\u041E \u0441\u0432\u044F\u0437\u0438" \u043E\u0442 07.07.2003'),DE(2,"br"),RO(3," \u2116 126-\u0424\u0417 \u0444\u0438\u0437\u043B\u0438\u0446\u043E \u0441 \u0433\u0440\u0430\u0436\u0434\u0430\u043D\u0441\u0442\u0432\u043E\u043C \u0420\u043E\u0441\u0441\u0438\u0438 \u043C\u043E\u0436\u0435\u0442 \u043E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435"),DE(4,"br"),RO(5," 20 \u043D\u043E\u043C\u0435\u0440\u043E\u0432, \u0431\u0435\u0437 \u0433\u0440\u0430\u0436\u0434\u0430\u043D\u0441\u0442\u0432\u0430 \u2014 \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435 10 \u043D\u043E\u043C\u0435\u0440\u043E\u0432 \u0441\u0443\u043C\u043C\u0430\u0440\u043D\u043E \u0443 \u0432\u0441\u0435\u0445 \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u043E\u0432 \u0441\u0432\u044F\u0437\u0438 "),Pp());}var wn=(()=>{class i extends p{constructor(){super(),this._orderStateService=I(pe),this._orderAddressService=I(bt),this._orderDataService=I(he),this._orderApiService=I(Be),this._regionService=I(ze$1),this._changeDetectorRef=I(ci$1),this._orderAnalyticsService=I(ne),this._cartService=I(Pt),this._route=I(F),this._selectNumberDialogService=I(St),this._popupService=I(ct),this.isBrowser=tu(I(ac)),this.phoneMask=k,this.phoneControl=re.contactFormGroup.controls.phone,this.mnpControl=re.contactFormGroup.controls.mnp,this.nameControl=re.contactFormGroup.controls.name,this.citizenshipControl=re.contactFormGroup.controls.citizenship,this.formGroup=re.contactFormGroup,this.cityList=[],this.searchCity=[],this.citizenshipList=["\u0420\u043E\u0441\u0441\u0438\u044F","\u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D","\u0422\u0430\u0434\u0436\u0438\u043A\u0438\u0441\u0442\u0430\u043D","\u041A\u044B\u0440\u0433\u044B\u0437\u0441\u0442\u0430\u043D","\u041A\u0430\u0437\u0430\u0445\u0441\u0442\u0430\u043D","\u0410\u0437\u0435\u0440\u0431\u0430\u0439\u0434\u0436\u0430\u043D","\u0414\u0440\u0443\u0433\u043E\u0435"],this.mnpVisible=false,this.controlState=c,this.nameRequired=this._orderDataService.orderSettings.nameRequired,this.isCitizenshipShow=this._orderDataService.orderSettings.citizenshipShow,this.showMnpError=false,this.forceMnpChange=false,this._previousCitizenship="\u0420\u043E\u0441\u0441\u0438\u044F",this._nameMaxLength=100,this._namePattern=/[^a-zA-Z--\s-]/g,this._phoneErrorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["restrictedPhone","\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430"]]),this._nameErrorMessages=new Map([["required","\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435 \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["maxlength","\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0434\u043B\u0438\u043D\u0430 100 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432"]]),this.orderMetaInfo$=this._orderDataService.orderMetaInfo$,this.region$=this._regionService.getRegion$(),this.phoneFieldState$=new In$1(null),this.popularCountries=[],this.isPersonalDataAgreed$=this._orderStateService.isPersonalDataAgreed$.asObservable(),Gh([this.orderMetaInfo$.pipe(ot(Boolean),le(e=>!!e.dmsData.nomenclatures[0]?.mnpAvailable),Hu(()=>this.forceMnpChange=true)),J.beautifulNumberFormGroup.controls.numbers.valueChanges.pipe(Lu(J.beautifulNumberFormGroup.controls.numbers.value),le(e=>!!e.length),Hu(()=>this.showMnpError=false),Au())]).pipe(Vu(this._onDestroy$)).subscribe(([e,t])=>{if(this.mnpVisible=!!this._orderDataService.orderSettings.mnpVisible&&e,this.forceMnpChange){this.forceMnpChange=false;let n=this._orderDataService.orderSettings.mnpEnabled&&e&&!t;this.mnpControl.setValue(n);}!e||t?(this.mnpControl.setValue(false),this.mnpControl.disable({emitEvent:false})):this.mnpControl.enable({emitEvent:false});}),this.formGroup.valueChanges.pipe(Mu(64),Vu(this._onDestroy$)).subscribe(e=>{this._orderDataService.setContactState(w$1({name:q.CONTACT},e));}),this.phoneControl.valueChanges.pipe(ot(()=>this.phoneControl.valid),Vu(this._onDestroy$)).subscribe(()=>{this.isBrowser&&this._orderAnalyticsService.onEnterValidPhone();}),this._orderDataService.orderSettings.nameShow&&this._addNameControl(this.nameRequired);}ngOnInit(){this._changeDetectorRef.markForCheck(),this._init();}fetchMetaInfo(e){if(!this._orderDataService.orderSettings)return Vh(null);let t=this._orderDataService.orderSettings.goodId;return this._orderApiService.getPreOrderInfo$({fiasCode:e?.fiasCode,kladrId:e?.kladrId,goodId:t,legalForm:this._orderDataService.orderSettings.commerceType},e?.dmsData).pipe(Et(1),Hu(n=>{this._orderStateService.resetOrder(),this._orderAddressService.resetAddress();let o;if(!n.dmsData?.nomenclature&&n.dmsData?.nomenclatures?.length>0){let p=n.dmsData.nomenclatures[0];o=w$1({},n),o.dmsData.nomenclature=p;}else o=w$1({},n);e.dmsData?.latitude&&e.dmsData?.longitude&&(o.cityData.city.latitude=e.dmsData?.latitude,o.cityData.city.longitude=e.dmsData?.longitude),this._orderDataService.orderMetaInfo=o,this._orderAnalyticsService.goodId=o.cityData.good.id,this._orderAnalyticsService.goodName=o.cityData.good.name,this._orderAnalyticsService.goodProductType=o.cityData.good.productType,this._orderStateService.calculateTotal$.next(),this._cartService.setInfo({name:o.cityData.good.name,fiasid:o.cityData.city.fiasCode,goodOutsideNumber:o.cityData.good.outsideNumber}),(!o.dmsData.nomenclature||!o.dmsData.nomenclature.deliveryAvailable&&!o.dmsData.nomenclature.pickupAvailable&&!o.dmsData.nomenclature.samokatDelivery)&&this._orderAnalyticsService.orderNoReceivingWay(this._orderDataService.orderRegion,this._orderDataService.orderCity),this._changeDetectorRef.markForCheck();}))}citySelected(e){if(J.beautifulNumberFormGroup.controls.numbers.value.length&&this._orderDataService.orderMetaInfo$.value?.dmsData.greenfieldCode!==e.dmsData?.greenfieldCode){this._openWarningRegionSelectedPopup(),J.beautifulNumberFormGroup.controls.numbers.setValue([]);let t={msisdn:[],expirationLockDate:null,lockId:null};this._cartService.setInfo(t),this._selectNumberDialogService.reset();}this.fetchMetaInfo(e).pipe(Vu(this._onDestroy$)).subscribe();}getPhoneErrorMessage(e){if(e){let t=w$1({},e);for(let n of Object.keys(t)){let o=this._phoneErrorMessages.get(n);if(o)return o}}return ""}getNameErrorMessage(e){if(e){let t=w$1({},e);for(let n of Object.keys(t)){let o=this._nameErrorMessages.get(n);if(o)return o}}return ""}onMnpChanged(){this.mnpControl.disabled||(this._orderAddressService.resetAddressAfterActions(),this._orderAnalyticsService.onMnpControlChecked(this.mnpControl.value));}onFocusPhoneField(){this.phoneControl.value.length>1||this.setDefaultPhoneField();}onClickMnp(){this.showMnpError=this.mnpControl.disabled;}onPastePhoneField(e){let t=e.clipboardData?.getData("text")||"";if(!p$1.IS_PHONE(t))return;e.preventDefault();let n=p$1.CLEAR_PHONE(t);(n[0]==="7"||n[0]==="8")&&(n=n.substring(1)),this.setDefaultPhoneField(),this.phoneControl.setValue(n);}setDefaultPhoneField(){this.phoneControl.setValue("7");}get phoneControlState(){return this.phoneFieldInputRef?this.phoneFieldInputRef.focused&&this.phoneFieldInputRef.value.length>3?c.CLEAR:this.phoneControl.touched?this.phoneControl.errors?c.ERROR:c.SUCCESS:null:null}onInputName(e){if(!this.nameControl)return;let t=e.target,n=w$1({},t).value,o=t.value;o=o.replace(this._namePattern,""),o.length>this._nameMaxLength&&(o=o.slice(0,this._nameMaxLength)),o.trim().length||(o=""),o!==n&&this.nameControl.setValue(o,{emitEvent:false});}onBlurName(){this.nameControl?.value&&this._orderAnalyticsService.onEnteredName();}get isForeignCitizenship(){return this.citizenshipControl.value!=="\u0420\u043E\u0441\u0441\u0438\u044F"}onCitizenshipChange(){if(!this.citizenshipControl)return;let e="\u0420\u043E\u0441\u0441\u0438\u044F";this._previousCitizenship===e&&this.citizenshipControl.value!==e?this._orderAddressService.resetAddressAfterActions(false):this._previousCitizenship!==e&&this.citizenshipControl.value===e&&this._orderAddressService.resetAddressAfterActions(false),this._orderStateService.isForeignCitizenship$.next(this.isForeignCitizenship),this._orderAnalyticsService.onCitizenshipChange(this.citizenshipControl.value),this._previousCitizenship=this.citizenshipControl.value;}get nameControlState(){return !this.nameFieldInputRef||!this.nameControl?null:this.nameFieldInputRef.focused&&this.nameFieldInputRef.value.length?c.CLEAR:!this.nameControl.touched||!this.nameRequired&&!this.nameFieldInputRef.value.length?null:this.nameControl.errors?c.ERROR:c.SUCCESS}_init(e=false){let t=this._regionService.getRegion()?.id||"0c5b244470a04932980cb4dc0d3f02b5",n=!e&&this._cartService.device?.fiasid||t;this.fetchMetaInfo({fiasCode:n}).pipe(Pi$1(o=>(o.status===422&&!e&&n===this._cartService.device?.fiasid&&this._init(true),rg(()=>o))),Ie(()=>this._route.queryParams.pipe(Et(1),Vu(this._onDestroy$))),Vu(this._onDestroy$)).subscribe(o=>{let p=o.mymsisdn;p&&p$1.IS_PHONE(p)&&(this.phoneControl.setValue(p),this.phoneControl.markAsTouched()),this._orderAnalyticsService.onCitizenshipChange(this.citizenshipControl.value);});}_addNameControl(e){let t=[Ie$1.maxLength(100)];e&&t.push(Ie$1.required),re.contactFormGroup.addControl("name",new W("",{nonNullable:true,validators:t})),this.nameControl=re.contactFormGroup.controls.name;}_openWarningRegionSelectedPopup(){let e="\u0423 \u0442\u0435\u0431\u044F \u0441\u043C\u0435\u043D\u0438\u043B\u0441\u044F \u0440\u0435\u0433\u0438\u043E\u043D. \u0412\u044B\u0431\u0435\u0440\u0438 \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 \u0437\u0430\u043D\u043E\u0432\u043E, \u0442.\u043A. \u043E\u043D\u0438 \u0437\u0430\u0432\u0438\u0441\u044F\u0442 \u043E\u0442 \u0440\u0435\u0433\u0438\u043E\u043D\u0430";this._popupService.openPopup({text:e,svgIcon:"info-outline",theme:"warning",timeout:5e3}),this._orderAnalyticsService.onShowPopup(e);}personalDataClick(e){this._orderStateService.isPersonalDataAgreed$.next(e);}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-contact-form"]],viewQuery:function(t,n){if(t&1&&(MO(nr,5),MO(rr,5),MO(or,5,Ii)),t&2){let o;TO(o=SO())&&(n.phoneFieldInputRef=o.first),TO(o=SO())&&(n.nameFieldInputRef=o.first),TO(o=SO())&&(n.autocompleteComponent=o.first);}},inputs:{popularCountries:"popularCountries"},features:[_I],decls:4,vars:3,consts:[["tooltipTemplate",""],["phoneFieldInputRef","yInput"],["autocompleteComponent",""],["nameFieldInputRef","yInput"],["mnpSwitch",""],["class","contact-form",4,"ngIf"],[1,"contact-form"],[3,"formGroup"],[1,"contact-form__top"],[1,"contact-form__title"],["svgIcon","question-circle","class","contact-form__top-icon","yotaTrigger","click",3,"yotaCustomTooltip","yotaCustomTooltipClass","yotaCustomTooltipPosition","yotaPointEventNone",4,"ngIf"],[1,"contact-form__row"],[1,"contact-form__phone"],["yInput","","yotaInputTransformer","","name","phone","type","tel","autocomplete","off",1,"contact-form__input-phone",3,"focus","paste","formControl","required","unmask","imask"],["ySuffix","",3,"clear","state","inputControl"],[4,"ngIf"],[1,"contact-form__region"],[3,"label","_selectOption",4,"ngIf"],["class","contact-form__row",4,"ngIf"],["class","contact-form__mnp-wrapper",4,"ngIf"],[1,"policy-agreement",3,"changed","checked"],["svgIcon","question-circle","yotaTrigger","click",1,"contact-form__top-icon",3,"yotaCustomTooltip","yotaCustomTooltipClass","yotaCustomTooltipPosition","yotaPointEventNone"],[3,"_selectOption","label"],["class","contact-form__name",4,"ngIf"],["class","contact-form__residency",4,"ngIf"],[1,"contact-form__name"],["yInput","","name","name","autocomplete","name",1,"contact-form__input-name",3,"input","blur","formControl","required"],[1,"contact-form__residency"],[3,"selectionChange","formControl","required"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"citizenship"],[1,"contact-form__mnp-wrapper"],[1,"contact-form__mnp"],[1,"contact-form__mnp-label"],["href","/mnp","target","_blank","rel","nofollow noopener noreferrer",1,"y-link-pseudo"],[3,"change","click","formControl","id"],["class","contact-form__mnp-error",4,"ngIf"],[1,"contact-form__hint"],[1,"contact-form__hint-icon","y-primary"],[1,"contact-form__hint-text"],[1,"contact-form__mnp-error"]],template:function(t,n){t&1&&(kI(0,gr,21,17,"div",5),$O(1,"async"),kI(2,fr,6,0,"ng-template",null,0,qO)),t&2&&iE("ngIf",UO(1,1,n.orderMetaInfo$));},dependencies:()=>[Ww,Dh,An,Dn$1,Ge,yn,Cn,ot$1,Mn$1,Tt,Bt,h,It$1,x$1,Pn,Jw,Ii,gd,Ty,gm,zt,ld,ar$1,ae,Ny,Cd,hd],styles:["[_nghost-%COMP%]     .y-tab-label{width:300px}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{border:none;border-bottom:1px solid #e4e7e9;border-radius:0}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper span.ng-star-inserted, [_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{padding-left:0;padding-top:0}[_nghost-%COMP%]     .y-form-field label.dynamic-control__label{font-size:12px;margin-bottom:5px}[_nghost-%COMP%]     .y-form-field-bordered:not(.contact-form__name) .y-form-field-bordered-wrapper{padding-bottom:16px;transition:all .3s cubic-bezier(.66,0,.34,1)}[_nghost-%COMP%]     .y-form-field-bordered:not(.contact-form__name).y-form-field-bordered-invalid .y-form-field-bordered-wrapper{padding-bottom:22px;margin-bottom:24px}[_nghost-%COMP%]     .y-switch.y-disabled .y-switch-label, [_nghost-%COMP%]     .y-switch.y-disabled .y-switch-thumb-container{cursor:pointer}@media (max-width: 768px){[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:12px;transition:all .3s cubic-bezier(.66,0,.34,1)}[_nghost-%COMP%]     .y-form-field-bordered.y-form-field-bordered-invalid .y-form-field-bordered-wrapper{padding-bottom:22px;margin-bottom:12px}}.contact-form__top[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:8px}.contact-form__top-icon[_ngcontent-%COMP%]{width:24px;height:24px;cursor:pointer}.contact-form__title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-bottom:24px;font-size:16px;line-height:22px;font-weight:600}.contact-form__row[_ngcontent-%COMP%]{display:flex;width:100%;column-gap:32px}.contact-form__input-phone[_ngcontent-%COMP%]::placeholder{all:unset!important;color:#89909c!important}.contact-form__phone[_ngcontent-%COMP%], .contact-form__city[_ngcontent-%COMP%]{width:100%}.contact-form__region[_ngcontent-%COMP%]{width:100%;height:75px}.contact-form__mnp[_ngcontent-%COMP%]{display:flex;max-width:100%;align-items:center;margin-block:2px 14px;column-gap:30px}.contact-form__mnp-label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:400}.contact-form__mnp-error[_ngcontent-%COMP%]{color:#f65252;font-size:14px;line-height:20px;font-weight:400}.contact-form__hint[_ngcontent-%COMP%]{display:none;align-items:center;gap:10px;border-radius:12px;background-color:#f4fbfe;padding:8px 16px 8px 12px;margin-block:-4px 26px;width:fit-content;font-size:16px;line-height:24px;font-weight:400}.contact-form__hint.show[_ngcontent-%COMP%]{display:flex}.contact-form__hint-icon[_ngcontent-%COMP%]{transform:rotate(180deg);font-size:20px}@media (max-width: 768px){.contact-form__title[_ngcontent-%COMP%]{margin-bottom:16px}.contact-form__row[_ngcontent-%COMP%]{flex-direction:column}.contact-form__mnp[_ngcontent-%COMP%]{margin-bottom:0}.contact-form__hint[_ngcontent-%COMP%]{margin-block:24px 0}}@media (max-width: 480px){.contact-form__mnp[_ngcontent-%COMP%]{justify-content:space-between}.contact-form__mnp-label[_ngcontent-%COMP%]{font-size:12px;line-height:14px;font-weight:400}.contact-form__hint[_ngcontent-%COMP%]{width:100%;font-size:12px;line-height:14px;font-weight:400}}.policy-agreement[_ngcontent-%COMP%]{margin-top:32px}@media (max-width: 768px){.policy-agreement[_ngcontent-%COMP%]{margin-top:24px}}  .yota-custom-tooltip.contact-form__top-tooltip{color:#89909c;border-radius:12px;margin-block:12px;padding-inline:12px;font-size:12px;line-height:18px;font-weight:400}  .y-select-bordered-panel:has(.citizenship){max-height:248px!important}  .cdk-overlay-pane:has(.citizenship){margin-bottom:55px}"],changeDetection:0});}}return i})();var re=class i extends rt{static{this.contactFormGroup=new I$2({phone:new W("",{nonNullable:true,validators:[Ie$1.required,r.restrictedPhone]}),mnp:new W(false,{nonNullable:true}),region:new W(null,[Ie$1.required]),citizenship:new W("\u0420\u043E\u0441\u0441\u0438\u044F",{nonNullable:true})});}constructor(r,e){super(),this._stepState$=r,this._transitions=e,this.component=wn,this.name=q.CONTACT,this.title="\u0414\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F",this.stepState$=this._stepState$,this.transitions=this._transitions;}getWriteData(){return new ur$1().transform(i.contactFormGroup.controls.phone.value,n)}showValidateErrors(){i.contactFormGroup.valid||(i.contactFormGroup.controls.phone.markAsTouched(),i.contactFormGroup.controls.phone.updateValueAndValidity(),i.contactFormGroup.controls.name?.markAsTouched(),i.contactFormGroup.controls.name?.updateValueAndValidity());}setContext(){let r=i.contactFormGroup.controls;r.region.value&&typeof r.region.value=="object"&&this.stateContext?.next({city:r.region.value,mnp:r.mnp.value,name:q.CONTACT,phone:r.phone.value});}getContext(){return this.stateContext?.value}getButtonState(){return we.NEXT}};var pe=class i extends p{get state(){return this._state$.getValue()}get currentState(){return this._state$.value.find(r=>r.stepState$.value===G.ACTIVE)}constructor(){super(),this.orderButtonState$=new In$1(we.NEXT),this.pickUpPoint$=new In$1(null),this.changeButtonState$=new X,this.calculateTotal$=new X,this.mnpPopup$=new X,this.openBeautifulPhoneNumberDialog$=new X,this.beautifulNumberStepAvailable$=new In$1(false),this.showExpiredNumbersPopup$=new X,this.expiredNumbers$=new In$1(null),this.isPersonalDataAgreed$=new In$1(false),this.isForeignCitizenship$=new In$1(false),this.cartFormGroup=new I$2({productCount:new W(1,{nonNullable:true,validators:[Ie$1.max(5),Ie$1.required]})}),this.contactStep=new re(new In$1(G.ACTIVE),[{nextState:q.BEAUTIFUL_NUMBER,condition:()=>this.beautifulNumberStepAvailable$.value&&re.contactFormGroup.valid},{nextState:q.RECEIVING,condition:()=>re.contactFormGroup.valid}]),this.beautifulNumberStep=new J(new In$1(G.HIDDEN),[{nextState:q.RECEIVING,condition:()=>J.beautifulNumberFormGroup.valid}]),this.receivingStep=new L(new In$1(G.DISABLE),[{nextState:q.PAYMENT,condition:()=>{if(L.receivingFormGroup.controls.receivingWay.value===a.Delivery){let r=L.receivingFormGroup.get("timeSlotsTime")?.value;return r?r.isSamokat?!L.receivingFormGroup.hasError("samokatNotAvailable"):true:false}return !!this.pickUpPoint$.value}}],this.pickUpPoint$),this.paymentStep=new Qe(new In$1(G.DISABLE),[]),this.totalPrice=0,this._initialState=[this.contactStep,this.beautifulNumberStep,this.receivingStep,this.paymentStep],this._orderAnalyticsService=I(ne),this._cartService=I(Pt),this._storeService=I(D),this._document=I(cr$1),this._state$=new In$1(this._initialState),this.changeButtonState$.pipe(Vu(this._onDestroy$)).subscribe(()=>{this.orderButtonState$.next(this.currentState?.getButtonState()??we.NEXT);}),this.pickUpPoint$.pipe(Vu(this._onDestroy$)).subscribe(()=>{this.changeButtonState$.next();}),this.beautifulNumberStepAvailable$.pipe(Vu(this._onDestroy$)).subscribe(r=>{if(r){let e=this._cartService.device;if(this.beautifulNumberStep.stepState$.next(G.DISABLE),!e?.msisdn?.length){this.expiredNumbers$.next(null);return}let t=new Date;if(!e.expirationLockDate||!e.lockId||t>new Date(e.expirationLockDate)){this.expiredNumbers$.next(e.msisdn);let n={msisdn:[],expirationLockDate:null,lockId:null};this._cartService.setInfo(n),J.beautifulNumberFormGroup.controls.numbers.setValue([]),this.showExpiredNumbersPopup$.next();}else this.expiredNumbers$.next(null),this.beautifulNumberStep.stepState$.next(G.WITH_DATA),J.beautifulNumberFormGroup.controls.numbers.setValue(e.msisdn);}else this.beautifulNumberStep.stepState$.next(G.HIDDEN),J.beautifulNumberFormGroup.controls.numbers.setValue([]),this.expiredNumbers$.next(null);});}_getCategories$(){return this._storeService.fetchCategories$()}nextStep(r,e){let t=this.currentState?.transitions.find(o=>o.condition());if(this.currentState?.showValidateErrors(),!t)return;let n=this.state.find(o=>o.name===t.nextState);if(n&&n.stepState$.value!==G.HIDDEN){if(this._scrollToStep(n.name),n.name===q.RECEIVING&&(re.contactFormGroup.controls.mnp.value&&this.mnpPopup$.next(),setTimeout(()=>{this._scrollToStep(n.name);},750)),(n.name===q.BEAUTIFUL_NUMBER||n.name===q.RECEIVING)&&this._getCategories$().pipe(Vu(this._onDestroy$)).subscribe(o=>{this._orderAnalyticsService.categories$.next(o);}),n.name===q.PAYMENT){let o;typeof L.receivingFormGroup.controls.address.value!="string"&&(o=L.receivingFormGroup.controls.address.value?.value),this._orderAnalyticsService.orderPaymentStep(e,r,o);}this._changeCurrentState(n);}}changeStateByStepName(r){let e=this.state.find(o=>o.name===r),t=this.currentState?.transitions.find(o=>o.condition()),n=this.currentState?.transitions.find(o=>o.nextState===r);if(e)if(n){if(!t){this.currentState?.showValidateErrors();return}re.contactFormGroup.controls.mnp.value&&this.mnpPopup$.next(),this.setStep(e.name),(e.name===q.BEAUTIFUL_NUMBER||e.name===q.RECEIVING)&&this._getCategories$().pipe(Vu(this._onDestroy$)).subscribe(p=>{this._orderAnalyticsService.categories$.next(p);});}else {let o=this.state.findIndex(m=>m.name===this.currentState?.name),p=this.state.findIndex(m=>m.name===e.name);if(o<0||p<0||p>o&&!t)return;if(p<o){this.setStep(e.name);return}e.stepState$.getValue()===G.WITH_DATA&&this.setStep(e.name);}}resetOrder(r){this.pickUpPoint$.next(null),this.paymentStep.stepState$.next(G.DISABLE),this.receivingStep.stepState$.next(G.DISABLE),this.beautifulNumberStep.stepState$.next(this.beautifulNumberStepAvailable$.value?G.DISABLE:G.HIDDEN),L.receivingFormGroup.reset(),Qe.paymentFormGroup.reset(),J.beautifulNumberFormGroup.reset(),r&&(this.contactStep.stepState$.next(G.ACTIVE),re.contactFormGroup.reset(),this.cartFormGroup.reset(),this.changeButtonState$.next()),this.isPersonalDataAgreed$.next(false);}resetAfterActions(){this.pickUpPoint$.next(null),this.paymentStep.stepState$.next(G.DISABLE),this.receivingStep.stepState$.next(G.DISABLE),this.paymentStep.stepState$.next(G.DISABLE),Qe.paymentFormGroup.reset();}setStep(r){let e=this.state.find(t=>t.name===r);e&&e.stepState$.value!==G.HIDDEN&&(this._scrollToStep(e.name),this._changeCurrentState(e));}isValidCurrentStep(){if(!this.currentState?.transitions.length)return  true;let r=this.currentState?.transitions.some(e=>e.condition());return r||this.currentState?.showValidateErrors(),r}_changeCurrentState(r){let e=this.state.filter(t=>t.name===this.currentState?.name);e&&e.map(t=>{t.stepState$.next(G.WITH_DATA);}),r.stepState$.next(G.ACTIVE),this.changeButtonState$.next();}_scrollToStep(r){let e=this._document.querySelector(`[data-step-name="${r}"]`);e&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center"});},0);}static{this.\u0275fac=function(e){return new(e||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}};Ob([v$1],pe.prototype,"_scrollToStep",null);var br=["timeSlotTime"],yr=["timeSlotDate"],Sr=["srInstruction"];function xr(i,r){i&1&&(kp(0,"div",11),DE(1,"y-spinner",12),Pp()),i&2&&(QR(),iE("diameter",40));}function Er(i,r){if(i&1&&(kp(0,"y-option-bordered",23)(1,"span",18),RO(2),Pp(),kp(3,"span",19),RO(4),Pp()()),i&2){let e=r.$implicit;iE("value",e),QR(2),Hp(" ",e.leftSide," "),QR(2),Hp(" ",e.rightSide," ");}}function Or(i,r){if(i&1&&(kp(0,"y-option-bordered",23),RO(1),kp(2,"span",19),RO(3),Pp()()),i&2){let e=r.$implicit;iE("value",e),QR(),Hp(" ",e.leftSide," "),QR(2),Hp(" ",e.rightSide," ");}}function Mr(i,r){if(i&1&&(kp(0,"y-error"),RO(1),Pp()),i&2){let e=r.ngIf;QR(),Hp(" ",e," ");}}function Dr(i,r){if(i&1){let e=EO();kp(0,"y-form-field-bordered",16),RE("click",function(n){AR(e);let o=wO(5);return RR(o.openMobileTimeSlots(n))}),kp(1,"y-label"),RO(2,"\u0412\u0440\u0435\u043C\u044F"),Pp(),kp(3,"div",17),RO(4),kp(5,"span",19),RO(6),Pp()(),kp(7,"y-select-bordered",20),kI(8,Or,4,3,"y-option-bordered",21),Pp(),kI(9,Mr,2,1,"y-error",24),Pp();}if(i&2){let e=r.ngIf,t=wO(5);sE("has-long-error",t.timeSlotTimeControl.errors&&t.timeSlotTimeControl.errors.samokatUnavailable),QR(4),Hp(" ",t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.leftSide," "),QR(2),Hp(" ",t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.rightSide," "),QR(),iE("formControl",t.timeSlotTimeControl)("panelOpenable",!t.isMobile),QR(),iE("ngForOf",e),QR(),iE("ngIf",t.getTimeSlotsTimeErrorMessage(t.timeSlotTimeControl.errors));}}function Ir(i,r){if(i&1){let e=EO();kp(0,"div",15)(1,"y-form-field-bordered",16),RE("click",function(n){AR(e);let o=wO(4);return RR(o.openMobileTimeSlotsSearch(n))}),kp(2,"y-label"),RO(3,"\u0414\u0430\u0442\u0430"),Pp(),kp(4,"div",17)(5,"span",18),RO(6),Pp(),kp(7,"span",19),RO(8),Pp()(),kp(9,"y-select-bordered",20),kI(10,Er,5,3,"y-option-bordered",21),Pp()(),kI(11,Dr,10,8,"y-form-field-bordered",22),Pp();}if(i&2){let e=wO(3).ngIf,t=wO();QR(6),Hp(" ",t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.leftSide," "),QR(2),Hp(" ",t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.rightSide," "),QR(),iE("formControl",t.timeSlotDateControl)("panelOpenable",!t.isMobile),QR(),iE("ngForOf",e),QR(),iE("ngIf",t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.timeSlots);}}function Pr(i,r){if(i&1){let e=EO();kp(0,"div"),RO(1," \u0421\u0430\u043C\u043E\u043A\u0430\u0442 \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E \u0434\u043E\u0441\u0442\u0430\u0432\u0438\u0442 \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u0441 "),kp(2,"a",26),RE("click",function(){AR(e);let n=wO(5);return RR(n.showSRInstruction())}),RO(3,"\u0441\u0430\u043C\u043E\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"),Pp()();}}function wr(i,r){if(i&1&&(kp(0,"div",25),kI(1,Pr,4,0,"div",24),Pp()),i&2){let e=wO(4);QR(),iE("ngIf",e.samokatAvailable);}}function Nr(i,r){if(i&1&&kI(0,Ir,12,6,"div",13)(1,wr,2,1,"div",14),i&2){let e=wO(2).ngIf,t=wO();iE("ngIf",e.length>0),QR(),iE("ngIf",t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.isSamokat);}}function $r(i,r){if(i&1&&(kp(0,"div",7)(1,"div",8)(2,"h2",9),RO(3,"\u0414\u0430\u0442\u0430 \u0438 \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438"),Pp(),kI(4,xr,2,1,"div",10),$O(5,"async"),kI(6,Nr,2,2,"ng-template",null,3,qO),Pp()()),i&2){let e=AO(7),t=wO(2);QR(4),iE("ngIf",UO(5,2,t.loadingTimeSlots$))("ngIfElse",e);}}function Tr(i,r){if(i&1){let e=EO();kp(0,"div",30),RE("click",function(){let n=AR(e).$implicit,o=wO(3);return RR(o.mobileSelectDate(n))}),kp(1,"span",18),RO(2),Pp(),kp(3,"span",19),RO(4),Pp()();}if(i&2){let e=r.$implicit,t=wO(3);sE("time-slots__mobile-dialog-item_selected",(t.timeSlotDateControl.value==null?null:t.timeSlotDateControl.value.leftSide)===e.leftSide),QR(2),Hp(" ",e.leftSide," "),QR(2),Hp(" ",e.rightSide," ");}}function kr(i,r){if(i&1&&(kp(0,"div",27),DE(1,"y-icon",28),kI(2,Tr,5,4,"div",29),Pp()),i&2){let e=wO().ngIf;QR(2),iE("ngForOf",e);}}function Rr(i,r){if(i&1){let e=EO();kp(0,"div",30),RE("click",function(){let n=AR(e).$implicit,o=wO(3);return RR(o.mobileSelectTime(n))}),RO(1),kp(2,"span",19),RO(3),Pp()();}if(i&2){let e=r.$implicit,t=wO(3);sE("time-slots__mobile-dialog-item_selected",(t.timeSlotTimeControl.value==null?null:t.timeSlotTimeControl.value.leftSide)===e.leftSide),QR(),Hp(" ",e.leftSide," "),QR(2),Hp(" ",e.rightSide," ");}}function Ar(i,r){if(i&1&&(kp(0,"div",27),DE(1,"y-icon",28),kI(2,Rr,4,4,"div",29),Pp()),i&2){let e=wO(2);QR(2),iE("ngForOf",e.timeSlotDateControl.value==null?null:e.timeSlotDateControl.value.timeSlots);}}function Fr(i,r){if(i&1&&(kp(0,"div",5),kI(1,$r,8,4,"div",6),$O(2,"async"),kI(3,kr,3,1,"ng-template",null,1,qO)(5,Ar,3,1,"ng-template",null,2,qO),Pp()),i&2){let e=wO();QR(),iE("ngIf",UO(2,1,e.showSamokat$));}}function Br(i,r){i&1&&(RO(0," \u0422\u0430\u043A\u0443\u044E \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u043D\u0443\u0436\u043D\u043E \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u0430\u043C\u043E\u0441\u0442\u043E\u044F\u0442\u0435\u043B\u044C\u043D\u043E \u2014 \u0432\u0441\u0435 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u044B \u043F\u043E\u0434\u043F\u0438\u0441\u044B\u0432\u0430\u044E\u0442\u0441\u044F \u0447\u0435\u0440\u0435\u0437 \u0413\u043E\u0441\u043A\u043B\u044E\u0447 \u0438 \u0413\u043E\u0441\u0443\u0441\u043B\u0443\u0433\u0438. "),DE(1,"br"),RO(2," \u041F\u043E\u043D\u0430\u0434\u043E\u0431\u0438\u0442\u0441\u044F \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u043D\u0430\u044F \u0443\u0447\u0435\u0442\u043D\u0430\u044F \u0437\u0430\u043F\u0438\u0441\u044C. "),DE(3,"br"),RO(4,` \u0415\u0441\u043B\u0438 \u0445\u043E\u0447\u0435\u0448\u044C \u043E\u0431\u044B\u0447\u043D\u0443\u044E \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443, \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u043E\u0439 \u0438\u043D\u0442\u0435\u0440\u0432\u0430\u043B \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u2014 \u043A\u0443\u0440\u044C\u0435\u0440 \u043F\u0440\u0438\u0435\u0434\u0435\u0442 \u0441 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u043C\u0438.
`));}var Nn=(()=>{class i extends p{constructor(e,t,n,o,p,m,b,M){super(),this._orderStateService=e,this._orderDataService=t,this._orderApiService=n,this._dialogService=o,this._addressService=p,this._breakpointObserver=m,this._orderAnalyticsService=b,this._cdr=M,this.samokatPromoCodeAvailable=false,this._document=I(cr$1),this.timeSlotDateControl=L.receivingFormGroup.controls.timeSlotsSearch,this.timeSlotTimeControl=L.receivingFormGroup.controls.timeSlotsTime,this.timeSlotsTimeErrors=new Map([["samokatUnavailable","\u0421\u044E\u0434\u0430 \u0421\u0430\u043C\u043E\u043A\u0430\u0442 \u043D\u0435 \u0434\u043E\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442. \u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u043E\u0435 \u0432\u0440\u0435\u043C\u044F \u0434\u043B\u044F \u043E\u0431\u044B\u0447\u043D\u043E\u0439 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u043B\u0438\u0431\u043E \u0438\u0437\u043C\u0435\u043D\u0438 \u0430\u0434\u0440\u0435\u0441"]]),this.timeSlotSearch$=this._addressService.timeSlotSearch$.pipe(Hu(d=>{this._addressService.loadingTimeSlots$.next(false),d?.length&&d[0]?this.timeSlotDateControl.setValue(d[0]):this.timeSlotDateControl.reset();})),this.loadingTimeSlots$=this._addressService.loadingTimeSlots$.pipe(Hu(()=>{let d=this._document.querySelector(".time-slots__title");d&&setTimeout(()=>{d.scrollIntoView({behavior:"smooth",block:"center"});},0);})),this.showSamokat$=this._addressService.showSamokat$,this.isMobile=false,this.samokatAvailable=false,this._breakpointObserver.observe(["(max-width: 768px)"]).pipe(Vu(this._onDestroy$)).subscribe(d=>{this.isMobile=d.matches;}),Gh([this._orderApiService.isSamokatAvailability$,this.timeSlotTimeControl.valueChanges]).pipe(Vu(this._onDestroy$)).subscribe(([d,N])=>{if(!N)return;let D=N.isSamokat&&d?_.Samokat:_.Courier,Y=N.isSamokat&&d?G.HIDDEN:G.DISABLE;this._orderDataService.deliveryType$.next(D),this._orderAnalyticsService.deliveryType$.next(D),this._orderStateService.paymentStep.stepState$.next(Y),this._orderStateService.changeButtonState$.next(),this._orderStateService.calculateTotal$.next(),!d&&N.isSamokat?this.timeSlotTimeControl.setErrors({samokatUnavailable:true}):this.timeSlotTimeControl.setErrors(null);}),this.timeSlotDateControl.valueChanges.pipe(Au(),Nu(1),Vu(this._onDestroy$)).subscribe(d=>{if(d&&d.timeSlots)this.timeSlotTimeControl.setValue(d?.timeSlots[0]);else {this.timeSlotTimeControl.reset();return}}),this._orderApiService.isSamokatAvailability$.pipe(Nu(1),Vu(this._onDestroy$)).subscribe(d=>{if(this.samokatAvailable=d,this.samokatAvailable){this.timeSlotTimeControl.setErrors(null),this._cdr.detectChanges();return}if(!this.samokatPromoCodeAvailable){let N=this._addressService.timeSlotSearch$.getValue(),D=N.find(Y=>Y.timeSlotUiItems?.some(ce=>ce.isSamokat));if(D){if(D.timeSlotUiItems=D.timeSlotUiItems?.filter(Y=>!Y.isSamokat),D.timeSlots=D.timeSlots?.filter(Y=>!Y.isSamokat),!D.timeSlotUiItems?.length){N=N.filter(Y=>Y.date!==D.date),N.length?(this._addressService.timeSlotSearch$.next(N),this.timeSlotDateControl.setValue(N[0])):(L.receivingFormGroup.controls.address.setErrors({timeSlots:true}),this._addressService.showSamokat$.next(false));return}this._addressService.timeSlotSearch$.next(N),this.timeSlotTimeControl.setValue(this.timeSlotDateControl.value.timeSlots[0]);}return}if(!this.timeSlotTimeControl.value?.isSamokat){this.timeSlotTimeControl.setErrors(null);return}this.timeSlotTimeControl.setErrors({samokatUnavailable:true}),this.timeSlotTimeControl.markAsTouched(),this._cdr.detectChanges();});}ngOnDestroy(){super.ngOnDestroy(),p$1.closeDialog(this._dialogRef);}openMobileTimeSlots(e){e.preventDefault(),this.isMobile&&(this._dialogRef=this._dialogService.open(this._timeDialogRef,{panelClass:["y-dialog-bottom","y-dialog-slim"],data:{panelClassOption:"bottom",panelTitle:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043C\u044F"}}));}openMobileTimeSlotsSearch(e){e.preventDefault(),this.isMobile&&(this._dialogRef=this._dialogService.open(this._dateDialogRef,{panelClass:["y-dialog-bottom","y-dialog-slim"],data:{panelClassOption:"bottom",panelTitle:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043C\u044F"}}));}mobileSelectTime(e){this.timeSlotTimeControl.setValue(e),p$1.closeDialog(this._dialogRef);}mobileSelectDate(e){this.timeSlotDateControl.setValue(e),p$1.closeDialog(this._dialogRef);}showSRInstruction(){this._dialogRef=this._dialogService.open(this._srInstruction);}getTimeSlotsTimeErrorMessage(e){if(e){let t=w$1({},e);for(let n of Object.keys(t)){let o=this.timeSlotsTimeErrors.get(n);if(o)return o}}return ""}static{this.\u0275fac=function(t){return new(t||i)(k$1(pe),k$1(he),k$1(Be),k$1(mr$1),k$1(bt),k$1(U),k$1(ne),k$1(ci$1))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-time-slots"]],viewQuery:function(t,n){if(t&1&&(MO(br,5,Ye$1),MO(yr,5,Ye$1),MO(Sr,5,Ye$1)),t&2){let o;TO(o=SO())&&(n._timeDialogRef=o.first),TO(o=SO())&&(n._dateDialogRef=o.first),TO(o=SO())&&(n._srInstruction=o.first);}},inputs:{samokatPromoCodeAvailable:"samokatPromoCodeAvailable"},features:[_I],decls:4,vars:3,consts:[["srInstruction",""],["timeSlotDate",""],["timeSlotTime",""],["timeSlotsRow",""],["class","time-slots",4,"ngIf"],[1,"time-slots"],["class","time-slots__container",4,"ngIf"],[1,"time-slots__container"],[1,"time-slots__inner"],[1,"time-slots__title"],["class","time-slots__loader",4,"ngIf","ngIfElse"],[1,"time-slots__loader"],[3,"diameter"],["class","time-slots__row",4,"ngIf"],["class","time-slots__samokat",4,"ngIf"],[1,"time-slots__row"],[1,"time-slots__input",3,"click"],[1,"time-slots__time-value"],[1,"time-slots__date"],[1,"time-slots__additional"],[3,"formControl","panelOpenable"],[3,"value",4,"ngFor","ngForOf"],["class","time-slots__input",3,"has-long-error","click",4,"ngIf"],[3,"value"],[4,"ngIf"],[1,"time-slots__samokat"],[1,"y-link-pseudo",3,"click"],[1,"time-slots__mobile-dialog"],["y-dialog-close","","svgIcon","close-light",1,"time-slots__mobile-dialog-close"],["class","time-slots__mobile-dialog-item",3,"time-slots__mobile-dialog-item_selected","click",4,"ngFor","ngForOf"],[1,"time-slots__mobile-dialog-item",3,"click"]],template:function(t,n){t&1&&(kI(0,Fr,7,3,"div",4),$O(1,"async"),kI(2,Br,5,0,"ng-template",null,0,qO)),t&2&&iE("ngIf",UO(1,1,n.timeSlotSearch$));},dependencies:[Ww,An,yn,Mn$1,Tt,Dh,Jw,ql,ar$1,gd,Cd,Ny,zt,Dy,ld],styles:["[_nghost-%COMP%]     .y-select-value{visibility:hidden}[_nghost-%COMP%]     .time-slots__row .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}[_nghost-%COMP%]     .time-slots__row .y-form-field-bordered .y-form-field-bordered-subscript-wrapper{top:100%}  .y-dialog-bottom .y-dialog-container>.time-slots__mobile-dialog-item{display:flex;height:58px;flex-direction:row;align-items:center}  .time-slots__mobile-dialog{min-height:250px}  .time-slots__mobile-dialog-close{width:24px;height:24px;margin-block:18px 20px;align-self:flex-end}  .time-slots__mobile-dialog-item{display:flex;align-items:center;column-gap:4px;padding:12px 8px;border-radius:12px;font-size:16px;line-height:24px;font-weight:400}  .time-slots__mobile-dialog-item_selected{background-color:#e5f7fd}.time-slots__inner[_ngcontent-%COMP%]{margin-top:26px}.time-slots__samokat[_ngcontent-%COMP%]{margin-top:8px;font-size:14px;line-height:18px;font-weight:400}.time-slots__title[_ngcontent-%COMP%]{margin-bottom:16px;font-size:16px;line-height:22px;font-weight:600}.time-slots__loader[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding-block:10px}.time-slots__row[_ngcontent-%COMP%]{display:flex;gap:12px 32px}@media (max-width: 768px){.time-slots__row[_ngcontent-%COMP%]{flex-direction:column}}.time-slots__input[_ngcontent-%COMP%]{width:100%}.time-slots__input.has-long-error[_ngcontent-%COMP%]{margin-bottom:24px}.time-slots__time-value[_ngcontent-%COMP%]{position:absolute;z-index:1}@media (max-width: 480px){.time-slots__input.has-long-error[_ngcontent-%COMP%]{margin-bottom:40px}}"],changeDetection:0});}}return i})();var Lr=["streetFieldInputRef"];function Vr(i,r){if(i&1&&(kp(0,"y-option-bordered",17)(1,"span"),RO(2),Pp()()),i&2){let e=r.$implicit;iE("value",e),QR(2),VE(e.value);}}function Ur(i,r){if(i&1&&(kp(0,"y-error"),RO(1),Pp()),i&2){let e=r.ngIf;QR(),Hp(" ",e," ");}}function Gr(i,r){if(i&1){let e=EO();kp(0,"yota-field-state",7),RE("clear",function(){AR(e);let n=wO();return RR(n.clearEntranceField())}),Pp();}if(i&2){let e=wO(),t=AO(17);iE("state",e.controlState.CLEAR)("inputControl",t);}}function Hr(i,r){if(i&1){let e=EO();kp(0,"yota-field-state",7),RE("clear",function(){AR(e);let n=wO();return RR(n.clearFlatField())}),Pp();}if(i&2){let e=wO(),t=AO(23);iE("state",e.controlState.CLEAR)("inputControl",t);}}function zr(i,r){if(i&1){let e=EO();kp(0,"div",18),RE("click",function(){AR(e);let n=wO();return RR(n.addComment())}),kp(1,"div",19),DE(2,"y-icon",20),Pp(),RO(3,` \u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A\u0443\u0440\u044C\u0435\u0440\u0443
`),Pp();}i&2&&(QR(2),iE("svgIcon","plus-outline"));}function Yr(i,r){if(i&1){let e=EO();kp(0,"yota-field-state",7),RE("clear",function(){AR(e);let n=wO(2);return RR(n.clearCommentField())}),Pp();}if(i&2){wO();let e=AO(4),t=wO();iE("state",t.controlState.CLEAR)("inputControl",e);}}function jr(i,r){if(i&1&&(kp(0,"y-form-field-bordered",21)(1,"y-label"),RO(2,"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A\u0443\u0440\u044C\u0435\u0440\u0443"),Pp(),DE(3,"textarea",22,4),kI(5,Yr,1,2,"yota-field-state",13),Pp()),i&2){let e=AO(4),t=wO();QR(3),iE("maxlength",512)("formControl",t.comment),QR(2),iE("ngIf",e.focused&&e.value);}}var $n=(()=>{class i extends p{constructor(e,t,n,o,p,m,b){super(),this._orderStateService=e,this._addressService=t,this._orderDataService=n,this._orderApiService=o,this._renderer=p,this._orderAnalyticsService=m,this._cdr=b,this.samokatPromoCodeAvailable=false,this.addressControl=L.receivingFormGroup.controls.address,this.flat=L.receivingFormGroup.controls.flat,this.entrance=L.receivingFormGroup.controls.entrance,this.comment=L.receivingFormGroup.controls.comment,this.addressErrors=new Map([["required","\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"],["restrictedStreetHouse","\u0423\u043A\u0430\u0436\u0438 \u0443\u043B\u0438\u0446\u0443 \u0438 \u043D\u043E\u043C\u0435\u0440 \u0434\u043E\u043C\u0430"],["restrictedHouse","\u0423\u043A\u0430\u0436\u0438 \u043D\u043E\u043C\u0435\u0440 \u0434\u043E\u043C\u0430"],["restrictedAddress","\u041F\u043E\u0445\u043E\u0436\u0435, \u0442\u0430\u043A\u043E\u0433\u043E \u0430\u0434\u0440\u0435\u0441\u0430 \u043D\u0435\u0442. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439 \u0434\u0440\u0443\u0433\u043E\u0439 \u0438\u043B\u0438 \u043F\u0435\u0440\u0435\u043F\u0440\u043E\u0432\u0435\u0440\u044C \u0433\u043E\u0440\u043E\u0434"],["timeSlots","\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043F\u043E \u044D\u0442\u043E\u043C\u0443 \u0430\u0434\u0440\u0435\u0441\u0443 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0430, \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u043E\u0439 \u0441\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F"]]),this.showComment$=new In$1(false),this.addresses$=this._addressService.addresses$,this.analyticsActions=O$1,this.controlState=c,this._orderApiService.orderError$.pipe(Vu(this._onDestroy$)).subscribe(M=>{M===I$1.TimeSlotUnavailable&&(this.addressControl.setErrors({timeSlots:true}),this._addressService.showSamokat$.next(false),this._addressService.loadingTimeSlots$.next(false),this._addressService.timeSlotSearch$.next([]),this._cdr.markForCheck());}),this.addressControl.valueChanges.pipe(Mu(300),Au(),ju(M=>!M||typeof M=="string"&&M.length<=2||typeof M!="string"&&!M?.house?(this._addressService.showSamokat$.next(false),this._addressService.timeSlotSearch$.next([]),this._addressService.addresses$.next([]),this._orderStateService.changeButtonState$.next(),Vh(M)):typeof M=="string"?(this._addressService.showSamokat$.next(false),this._addressService.timeSlotSearch$.next([]),this._orderStateService.changeButtonState$.next(),this._addressService.fetchAddress$(M).pipe(le(()=>M))):this._addressService.fetchTimeSlots$(M.fiasId).pipe(ju(d=>{if(d?.length&&d[0].timeSlots){let N=d[0].timeSlots[0].isSamokat,D=J.beautifulNumberFormGroup.controls.numbers.value.length>0,Y=this._orderStateService.isForeignCitizenship$.value;if(N&&!D&&!Y)return this._orderApiService.getSamokatAvailability$().pipe(Hu(()=>{this._addressService.loadingTimeSlots$.next(false);}),le(()=>d))}return this._addressService.loadingTimeSlots$.next(false),Vh(d)}),Hu(()=>{this._addressService.showSamokat$.next(!this.addressControl.hasError("timeSlots")),this._orderStateService.calculateTotal$.next();}),le(()=>M))),Vu(this._onDestroy$)).subscribe();}addComment(){let e=L.receivingFormGroup.controls.address.hasError("timeSlots");L.receivingFormGroup.addControl("comment",new W("",{nonNullable:true})),this.comment=L.receivingFormGroup.controls.comment,this.showComment$.next(true),e&&L.receivingFormGroup.controls.address.setErrors({timeSlots:true}),setTimeout(()=>{this._renderer.selectRootElement("#commentInput")?.focus();},0);}displayAddress(){return e=>e?.value?e?.value:""}selectAddress(e){this.addresses$.next([]);}getAddressErrorMessage(e){if(e){let t=w$1({},e);for(let n of Object.keys(t)){let o=this.addressErrors.get(n);if(o)return o}}return ""}sendAnalytics(e){let t=this._orderDataService.orderMetaInfo$.value;this._orderAnalyticsService.enterFormField(e,t,this._orderDataService.orderRegion,this._orderDataService.orderCity);}handleBlurAddress(){let e=this.addresses$.getValue();e?.length&&typeof this.addressControl.value=="string"&&this.addressControl.setValue(e[0]);}clearStreetField(){this.addressControl.setValue(null);}clearFlatField(){this.flat.setValue(null);}clearEntranceField(){this.entrance.setValue(null);}clearCommentField(){this.comment?.setValue("");}get addressControlState(){return this.streetFieldInputRef?this.streetFieldInputRef.focused&&this.streetFieldInputRef.value.length?c.CLEAR:this.addressControl.touched?this.addressControl.errors?c.ERROR:c.SUCCESS:null:null}static{this.\u0275fac=function(t){return new(t||i)(k$1(pe),k$1(bt),k$1(he),k$1(Be),k$1(or$1),k$1(ne),k$1(ci$1))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-receiving-form-delivery"]],viewQuery:function(t,n){if(t&1&&MO(Lr,5),t&2){let o;TO(o=SO())&&(n.streetFieldInputRef=o.first);}},inputs:{samokatPromoCodeAvailable:"samokatPromoCodeAvailable"},features:[_I],decls:29,vars:23,consts:[["streetInput","","streetFieldInputRef","yInput"],["autocompleteRef","yAutocompleteBordered"],["entranceFieldInputRef","yInput"],["flatFieldInputRef","yInput"],["commentFieldInputRef","yInput"],[1,"receiving-form__field"],["yInput","","type","text",3,"change","focusout","yAutocompleteBordered","formControl","required"],["ySuffix","",3,"clear","state","inputControl"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"receiving-form__row"],["yInput","",1,"receiving-form__input",3,"formControl","maxlength"],["ySuffix","",3,"state","inputControl","clear",4,"ngIf"],["class","receiving-form__add-comment",3,"click",4,"ngIf"],["class","receiving-form__comment",4,"ngIf"],[3,"samokatPromoCodeAvailable"],[3,"value"],[1,"receiving-form__add-comment",3,"click"],[1,"receiving-form__add-comment-button"],[1,"y-primary",3,"svgIcon"],[1,"receiving-form__comment"],["yInput","","id","commentInput","placeholder","\u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440, \u044D\u0442\u0430\u0436 \u0438\u043B\u0438 \u043A\u043E\u0434 \u0434\u043E\u043C\u043E\u0444\u043E\u043D\u0430","cdkTextareaAutosize","","wrap","soft","type","text",1,"receiving-form__input","receiving-form__input_comment",3,"maxlength","formControl"]],template:function(t,n){if(t&1){let o=EO();kp(0,"y-form-field-bordered",5)(1,"y-label"),RO(2,"\u0423\u043B\u0438\u0446\u0430, \u0434\u043E\u043C"),Pp(),kp(3,"input",6,0),RE("change",function(){return AR(o),RR(n.sendAnalytics(n.analyticsActions.ADDRESS_IS_VALID))})("focusout",function(){return AR(o),RR(n.handleBlurAddress())}),Pp(),kp(6,"yota-field-state",7),RE("clear",function(){return AR(o),RR(n.clearStreetField())}),Pp(),kp(7,"y-autocomplete-bordered",8,1),RE("optionSelected",function(m){AR(o);let b=AO(4);return n.selectAddress(m),RR(b.blur())}),kI(9,Vr,3,2,"y-option-bordered",9),$O(10,"async"),Pp(),kI(11,Ur,2,1,"y-error",10),Pp(),kp(12,"div",11)(13,"y-form-field-bordered",5)(14,"y-label"),RO(15,"\u041F\u043E\u0434\u044A\u0435\u0437\u0434"),Pp(),DE(16,"input",12,2),kI(18,Gr,1,2,"yota-field-state",13),Pp(),kp(19,"y-form-field-bordered",5)(20,"y-label"),RO(21,"\u041A\u0432\u0430\u0440\u0442\u0438\u0440\u0430"),Pp(),DE(22,"input",12,3),kI(24,Hr,1,2,"yota-field-state",13),Pp()(),kI(25,zr,4,1,"div",14),$O(26,"async"),kI(27,jr,6,3,"y-form-field-bordered",15),DE(28,"yota-time-slots",16);}if(t&2){let o=AO(5),p=AO(8),m=AO(17),b=AO(23);sE("tall-error",n.addressControl.getError("timeSlots")||n.addressControl.getError("restrictedAddress")&&!n.addressControl.getError("required")),QR(3),iE("yAutocompleteBordered",p)("formControl",n.addressControl)("required",true),QR(3),iE("state",n.addressControlState)("inputControl",o),QR(),iE("displayWith",n.displayAddress()),QR(2),iE("ngForOf",UO(10,19,n.addresses$)),QR(2),iE("ngIf",n.getAddressErrorMessage(n.addressControl.errors)),QR(5),iE("formControl",n.entrance)("maxlength",5),QR(2),iE("ngIf",m.focused&&m.value),QR(4),iE("formControl",n.flat)("maxlength",10),QR(2),iE("ngIf",b.focused&&b.value),QR(),iE("ngIf",UO(26,21,n.showComment$)===false&&!(n.comment!=null&&n.comment.touched)),QR(2),iE("ngIf",n.comment),QR(),iE("samokatPromoCodeAvailable",n.samokatPromoCodeAvailable);}},dependencies:[An,Ge,yn,ot$1,Jt,Mn$1,Tt,x$1,Dh,Ww,Jg,Zg,Nn,Jw,ar$1,gd,Ty,dg,tb,Cd,zt,ld,hd],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]     .receiving-form__comment.y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}[_nghost-%COMP%]     .receiving-form__comment.y-form-field-bordered .y-form-field-bordered-infix{height:auto}[_nghost-%COMP%]     .receiving-form__row .y-input-element{min-width:initial}.receiving-form__row[_ngcontent-%COMP%]{display:flex;column-gap:32px;margin-top:10px}.receiving-form__field[_ngcontent-%COMP%]{width:100%}.receiving-form__field.tall-error[_ngcontent-%COMP%]{padding-bottom:16px}.receiving-form__input_comment[_ngcontent-%COMP%]{resize:none}.receiving-form__add-comment[_ngcontent-%COMP%]{display:flex;align-items:center;width:fit-content;column-gap:12px;margin-top:8px;color:#00aeef;cursor:pointer;font-size:14px;line-height:18px;font-weight:600}.receiving-form__add-comment-button[_ngcontent-%COMP%]{width:24px;height:24px;min-width:24px;min-height:24px}.receiving-form__comment[_ngcontent-%COMP%]{margin-top:8px}@media (max-width: 768px){.receiving-form__row[_ngcontent-%COMP%]{column-gap:12px}}"],changeDetection:0});}}return i})();function qr(i,r){if(i&1){let e=EO();kp(0,"yota-field-state",11),RE("clear",function(){AR(e);let n=wO(2);return RR(n.clearSearchField())}),Pp();}if(i&2){wO();let e=AO(5),t=wO();iE("state",t.controlState.CLEAR)("inputControl",e);}}function Wr(i,r){if(i&1&&(kp(0,"y-form-field-bordered")(1,"y-label"),RO(2,"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u043C\u0435\u0442\u0440\u043E, \u0443\u043B\u0438\u0446\u0435 \u0438 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044E"),Pp(),DE(3,"y-icon",8)(4,"input",9,0),kI(6,qr,1,2,"yota-field-state",10),Pp()),i&2){let e=AO(5),t=wO();QR(3),iE("svgIcon","search-outline"),QR(),iE("formControl",t.searchControl),QR(2),iE("ngIf",e.focused&&e.value);}}function Kr(i,r){i&1&&DE(0,"yota-ya-search");}var hi=(()=>{class i extends p{constructor(){super(),this.listControl=new W(je.ON_MAP),this._orderAnalyticsService=I(ne),this._changeDetectorRef=I(ci$1),this.searchListType=je,this.controlState=c;}ngAfterViewInit(){this.listControl.valueChanges.pipe(Vu(this._onDestroy$)).subscribe(e=>{e&&this._orderAnalyticsService.onChooseSearchList(e),this._changeDetectorRef.markForCheck();});}clearSearchField(){this.searchControl.setValue("");}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-order-choose-point"]],inputs:{searchControl:"searchControl",listControl:"listControl"},features:[_I],decls:11,vars:6,consts:[["searchFieldInputRef","yInput"],[1,"order-choose-point"],[1,"order-choose-point__search"],[4,"ngIf"],[1,"order-choose-point__mode"],[1,"order-choose-point__mode-type"],["type","radio","name","searchListType","id","mapRadio",1,"order-choose-point__radio",3,"formControl","value"],["type","radio","name","searchListType","id","listRadio",1,"order-choose-point__radio",3,"formControl","value"],["yPrefix","",1,"order-choose-point__search-icon",3,"svgIcon"],["yInput","","type","text",3,"formControl"],["ySuffix","",3,"state","inputControl","clear",4,"ngIf"],["ySuffix","",3,"clear","state","inputControl"]],template:function(t,n){t&1&&(kp(0,"div",1)(1,"div",2),kI(2,Wr,7,3,"y-form-field-bordered",3)(3,Kr,1,0,"yota-ya-search",3),Pp(),kp(4,"div",4)(5,"label",5),RO(6,"\u041A\u0430\u0440\u0442\u0430 "),DE(7,"input",6),Pp(),kp(8,"label",5),RO(9,"\u0421\u043F\u0438\u0441\u043E\u043A "),DE(10,"input",7),Pp()()()),t&2&&(QR(2),iE("ngIf",n.listControl.value===n.searchListType.LIST),QR(),iE("ngIf",n.listControl.value===n.searchListType.ON_MAP),QR(4),iE("formControl",n.listControl)("value",n.searchListType.ON_MAP),QR(3),iE("formControl",n.listControl)("value",n.searchListType.LIST));},dependencies:[Ww,An,Ge,Rt,yn,Mn$1,Tt,x$1,ln,ar$1,cd,gd,zt,Ty,hd],styles:['[_nghost-%COMP%]  .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}.order-choose-point[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;align-items:center;column-gap:32px}.order-choose-point__search[_ngcontent-%COMP%]{display:block}.order-choose-point__search-list[_ngcontent-%COMP%]{max-height:540px;padding-right:20px;overflow-y:auto}.order-choose-point__search-icon[_ngcontent-%COMP%]{width:24px;height:24px}.order-choose-point__mode[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:1;position:relative}.order-choose-point__mode[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;width:100%;height:2px;border-radius:12px;background-color:#e2e9f0;z-index:1}.order-choose-point__mode-type[_ngcontent-%COMP%]{white-space:nowrap;padding:16px 12px;position:relative;overflow:hidden;cursor:pointer;font-size:14px;line-height:18px;font-weight:500}.order-choose-point__mode-type[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;width:100%;height:2px;border-radius:12px;right:-100%;background-color:#00aeef;z-index:2;transition:left .15s ease-in,right .15s ease-in}.order-choose-point__mode-type[_ngcontent-%COMP%]:last-child:after{left:-100%}.order-choose-point__mode-type[_ngcontent-%COMP%]:has(.order-choose-point__radio:checked){color:#00aeef}.order-choose-point__mode-type[_ngcontent-%COMP%]:has(.order-choose-point__radio:checked):after{right:0}.order-choose-point__mode-type[_ngcontent-%COMP%]:has(.order-choose-point__radio:checked):last-child:after{left:0}.order-choose-point__radio[_ngcontent-%COMP%]{visibility:hidden;position:absolute}@media (max-width: 768px){.order-choose-point[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:0;padding:8px 16px 0;border-radius:20px;overflow:hidden}.order-choose-point__search[_ngcontent-%COMP%]{width:100%}.order-choose-point__mode[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;width:100%}.order-choose-point__mode-type[_ngcontent-%COMP%]{text-align:center}}'],changeDetection:0});}}return i})();var gi=(()=>{class i{constructor(){this._errorList$=new In$1([]),this.errorList$=this._errorList$.asObservable(),this.errorPlacemarks=new Set,this.showError$=new In$1(false);}get errorList(){return this._errorList$.value}addErrorClusterPlacemarks(e){this.errorPlacemarks.add(e);}setError(e){this._errorList$.next([...this._errorList$.getValue(),e]);}isPlacemarkError(e){return e.length>1?this.errorPlacemarks.has(e.join(",")):this._errorList$.getValue().includes(e[0])}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac});}}return i})();function Xr(i,r){if(i&1&&(DE(0,"p",14),$O(1,"yHighlight")),i&2){let e=wO();iE("innerHTML",zO(1,1,e.store.address,e.searchString),WR);}}function Jr(i,r){if(i&1&&(kp(0,"p",15),RO(1),Pp()),i&2){let e=wO();QR(),Hp(" ",e.store.howToFind," ");}}function Zr(i,r){i&1&&wE(0);}function eo(i,r){if(i&1&&(Lp(0),kI(1,Zr,1,0,"ng-container",16),jp()),i&2){wO();let e=AO(18);QR(),iE("ngTemplateOutlet",e);}}function to(i,r){i&1&&wE(0);}function io(i,r){if(i&1&&(Lp(0),kI(1,to,1,0,"ng-container",16),jp()),i&2){wO(2);let e=AO(20);QR(),iE("ngTemplateOutlet",e);}}function no(i,r){i&1&&wE(0);}function ro(i,r){if(i&1&&(Lp(0),kI(1,no,1,0,"ng-container",16),jp()),i&2){wO(2);let e=AO(22);QR(),iE("ngTemplateOutlet",e);}}function oo(i,r){if(i&1&&(kp(0,"div",17),kI(1,io,2,1,"ng-container",12),$O(2,"async"),kI(3,ro,2,1,"ng-container",12),$O(4,"async"),Pp()),i&2){let e=wO();QR(),iE("ngIf",UO(2,2,e.isLoading$)),QR(2),iE("ngIf",UO(4,4,e.isActionsAvailable$));}}function ao(i,r){i&1&&(kp(0,"div",18),DE(1,"y-icon",19),kp(2,"p",20),RO(3," \u0417\u0434\u0435\u0441\u044C \u0442\u043E\u0432\u0430\u0440 \u0443\u0436\u0435 \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0441\u044F, "),DE(4,"br"),RO(5," \u0432\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443 \u043F\u0440\u043E\u0434\u0430\u0436 "),Pp()()),i&2&&(QR(),iE("svgIcon","info-outline"));}function so(i,r){i&1&&(kp(0,"div",21),DE(1,"div")(2,"div")(3,"div")(4,"div"),Pp());}function lo(i,r){if(i&1){let e=EO();kp(0,"button",24),RE("click",function(){AR(e);let n=wO(2);return RR(n.selectPickUpPoint())}),RO(1," \u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C "),Pp();}}function co(i,r){if(i&1){let e=EO();kp(0,"div",25),RE("click",function(){AR(e);let n=wO(2);return RR(n.changePickUpPoint())}),RO(1," \u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C "),Pp();}}function po(i,r){if(i&1&&kI(0,lo,2,0,"button",22)(1,co,2,0,"div",23),i&2){let e=wO();iE("ngIf",!e.selected),QR(),iE("ngIf",e.selected);}}var fi=(()=>{class i extends p{constructor(){super(...arguments),this.isHidden=false,this.selected=false,this.handleChange=new st,this._orderStateService=I(pe),this._orderAnalyticsService=I(ne),this._orderApiService=I(Be),this._dialogService=I(mr$1),this._orderDataService=I(he),this._breakpointObserver=I(U),this._orderErrorService=I(gi),this._isMobile=false,this.isLoading$=new In$1(false),this.isPickupError$=new In$1(false),this.orderMetaInfo$=this._orderDataService.orderMetaInfo$,this.maxCount=this.orderMetaInfo$.value?.cityData.good.maxOrderCount||5,this.userCartCount=this._orderStateService.cartFormGroup.controls.productCount,this.isActionsAvailable$=Gh([this.isLoading$,this.isPickupError$]).pipe(le(([e,t])=>!e&&!t));}_setError(e){this.isPickupError$.next(true),this._orderErrorService.setError(e?.code||"");}getGoodSalesPoints(e){this.isPickupError$.next(false),this.isLoading$.next(true),this._orderErrorService.showError$.next(false);let t=this._orderDataService.orderMetaInfo$.value;this._orderApiService.getGoodSalesPoints$({goodId:e?.good?.id,codeSalesPoint:e?.code}).pipe(Pi$1(n=>{let o=n.message===It.CANT_PICKUP;return e?.good?.remains===-1||o?(this._setError(e),rg(()=>n)):(this.isLoading$.next(false),Vh(null))}),Ru(()=>{this.isLoading$.next(false);}),Vu(this._onDestroy$)).subscribe(n=>{if(n){if(t&&n?.remains&&t.cityData.good.maxOrderCount!==2&&n.remains>1&&(t.cityData.good.maxOrderCount=2,this._orderDataService.orderMetaInfo=t),n.remains&&n.remains>0&&n.remains<=this.userCartCount.value){t&&(t.cityData.good.maxOrderCount=n.remains,this._orderDataService.orderMetaInfo=t),this.userCartCount.setValue(n.remains),this._orderErrorService.showError$.next(true),this._orderStateService.pickUpPoint$.next(this.store);return}n?.remains&&n?.remains>=this.userCartCount.value&&(this._orderStateService.pickUpPoint$.next(this.store),this._dialogService.closeAllDialogs());}});}selectPickUpPoint(){this.getGoodSalesPoints(this.store),this._sendEcommerceOnSelect();}_sendEcommerceOnSelect(){this._orderAnalyticsService.pickUpHereEvent(this.orderMetaInfo$.value);}changePickUpPoint(){this._orderStateService.pickUpPoint$.next(null),this._isMobile&&this.handleChange.emit();}ngOnInit(){this.selected&&this._breakpointObserver.observe(["(max-width: 768px)"]).pipe(Vu(this._onDestroy$)).subscribe(e=>{this._isMobile=e.matches;}),this._orderErrorService.errorList$.pipe(Vu(this._onDestroy$)).subscribe(e=>{e.includes(this.store?.code)&&this.isPickupError$.next(true);});}static{this.\u0275fac=(()=>{let e;return function(n){return (e||(e=kR(i)))(n||i)}})();}static{this.\u0275cmp=lO({type:i,selectors:[["yota-order-search-list-item"]],inputs:{store:"store",searchString:"searchString",code:"code",isHidden:"isHidden",selected:"selected"},outputs:{handleChange:"handleChange"},features:[_I],decls:23,vars:21,consts:[["pickupError",""],["loader",""],["orderActions",""],[1,"order-search-list-item"],["svgIcon","marker-rounded",1,"order-search-list-item__icon"],[1,"order-search-list-item__content"],[1,"order-search-list-item__title",3,"innerHTML"],[1,"order-search-list-item__location"],["class","order-search-list-item__address",3,"innerHTML",4,"ngIf"],[1,"order-search-list-item__description"],["class","order-search-list-item__hint",4,"ngIf"],[1,"order-search-list-item__time"],[4,"ngIf"],["class","order-search-list-item__action",4,"ngIf"],[1,"order-search-list-item__address",3,"innerHTML"],[1,"order-search-list-item__hint"],[4,"ngTemplateOutlet"],[1,"order-search-list-item__action"],[1,"order-search-list-item__pickup-error"],[1,"order-search-list-item__pickup-error-icon",3,"svgIcon"],[1,"order-search-list-item__pickup-error__text"],[1,"lds-ellipsis"],["class","order-search-list-item__action-select y-button-secondary",3,"click",4,"ngIf"],["class","order-search-list-item__action-change",3,"click",4,"ngIf"],[1,"order-search-list-item__action-select","y-button-secondary",3,"click"],[1,"order-search-list-item__action-change",3,"click"]],template:function(t,n){t&1&&(kp(0,"div",3),DE(1,"y-icon",4),kp(2,"div",5),DE(3,"div",6),$O(4,"yHighlight"),kp(5,"div",7),kI(6,Xr,2,4,"p",8),kp(7,"p",9),RO(8),Pp(),kI(9,Jr,2,1,"p",10),Pp(),kp(10,"div",11),RO(11),Pp(),kI(12,eo,2,1,"ng-container",12),$O(13,"async"),Pp(),kI(14,oo,5,6,"div",13),$O(15,"async"),$O(16,"async"),Pp(),kI(17,ao,6,1,"ng-template",null,0,qO)(19,so,5,0,"ng-template",null,1,qO)(21,po,2,2,"ng-template",null,2,qO)),t&2&&(sE("selected",n.selected)("hidden",n.isHidden),zI("data-code",n.code),QR(3),iE("innerHTML",zO(4,12,n.store.name,n.searchString),WR),QR(3),iE("ngIf",n.store.address),QR(2),VE(n.store.mall),QR(),iE("ngIf",n.store.howToFind),QR(2),VE(n.store.workingTime),QR(),iE("ngIf",UO(13,15,n.isPickupError$)),QR(2),iE("ngIf",UO(15,17,n.isLoading$)||UO(16,19,n.isActionsAvailable$)));},dependencies:[Ww,Yw,Jw,zt,Vy],styles:['.order-search-list-item[_ngcontent-%COMP%]{display:grid;grid-template-areas:"icon content action";grid-template-columns:auto 1fr auto;column-gap:8px;padding-inline:20px}.order-search-list-item__pickup-error[_ngcontent-%COMP%]{border-radius:12px;border:1px solid #ff6b6e;padding:7px 12px;display:flex;gap:8px;max-width:312px}.order-search-list-item__pickup-error-icon[_ngcontent-%COMP%]{rotate:180deg;width:24px;height:24px}.order-search-list-item__pickup-error-icon[_ngcontent-%COMP%]     svg path{fill:#ff6b6e}.order-search-list-item__pickup-error__text[_ngcontent-%COMP%]{color:#ff6b6e;font-size:12px;line-height:18px;font-weight:400}.order-search-list-item.selected[_ngcontent-%COMP%]{padding-inline:0}.order-search-list-item.hidden[_ngcontent-%COMP%]{display:none}.order-search-list-item__icon[_ngcontent-%COMP%]{grid-area:icon;width:24px;height:24px}.order-search-list-item__content[_ngcontent-%COMP%]{grid-area:content;display:flex;flex-direction:column;row-gap:8px}.order-search-list-item__title[_ngcontent-%COMP%]{font-size:16px;line-height:22px;font-weight:600}.order-search-list-item__location[_ngcontent-%COMP%]{color:#89909c;font-size:16px;line-height:24px;font-weight:400}.order-search-list-item__address[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}.order-search-list-item__hint[_ngcontent-%COMP%]:first-letter{text-transform:uppercase}.order-search-list-item__action[_ngcontent-%COMP%]{grid-area:action}.order-search-list-item__action-select[_ngcontent-%COMP%]{min-width:164px;border:none;background-color:#e5f7fd;height:auto;width:auto;min-height:initial;min-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}.order-search-list-item__action-change[_ngcontent-%COMP%]{color:#00aeef;text-decoration:underline dotted;text-decoration-thickness:auto;text-underline-offset:4px;cursor:pointer;font-size:16px;line-height:24px;font-weight:400}@media (max-width: 768px){.order-search-list-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:8px;padding-inline:0}.order-search-list-item.selected[_ngcontent-%COMP%]{display:grid;grid-template-areas:"icon content" "icon action";grid-template-columns:auto 1fr;grid-template-rows:1fr auto}.order-search-list-item[_ngcontent-%COMP%]:not(.selected) > .order-search-list-item__icon[_ngcontent-%COMP%]{display:none}.order-search-list-item__pickup-error[_ngcontent-%COMP%]{margin-bottom:-4px}}.lds-ellipsis[_ngcontent-%COMP%]{display:block;position:relative;margin-inline:50px;width:64px;height:48px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;margin-block:auto;width:16px;height:16px;border-radius:50%;background:#00aeef;animation-timing-function:cubic-bezier(0,1,1,0);animation:_ngcontent-%COMP%_lds-ellipsis-center .6s infinite}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{animation-name:_ngcontent-%COMP%_lds-ellipsis-first}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:0}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:24px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4){left:48px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{animation-name:_ngcontent-%COMP%_lds-ellipsis-last}@media (max-width: 768px){.lds-ellipsis[_ngcontent-%COMP%]{margin-inline:auto}}@keyframes _ngcontent-%COMP%_lds-ellipsis-first{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_lds-ellipsis-center{0%{transform:translate(0)}to{transform:translate(24px)}}@keyframes _ngcontent-%COMP%_lds-ellipsis-last{0%{transform:scale(1)}to{transform:scale(0)}}'],changeDetection:0});}}return i})();var uo=["*"],mo=()=>["name","address"];function _o(i,r){if(i&1&&DE(0,"yota-order-search-list-item",9),i&2){let e=r.$implicit,t=wO(3);iE("searchString",t.searchControl.value)("store",e);}}function ho(i,r){if(i&1&&(kp(0,"div",7),kI(1,_o,1,2,"yota-order-search-list-item",8),Pp()),i&2){let e=r.ngIf;QR(),iE("ngForOf",e);}}function go(i,r){if(i&1&&(Lp(0),kI(1,ho,2,1,"div",6),$O(2,"searchSubstring"),jp()),i&2){let e=wO();QR(),iE("ngIf",WO(2,1,e.stores,LO(5,mo),e.searchControl.value));}}var Tn=(()=>{class i extends p{constructor(){super(),this.stores=[],this._orderAnalyticsService=I(ne),this.searchControl=new W("",{nonNullable:true}),this.listControl=new W(je.ON_MAP),this.searchListType=je,this.controlState=c,this.listControl.valueChanges.pipe(ot(Boolean),Vu(this._onDestroy$)).subscribe(e=>{this._orderAnalyticsService.onChooseSearchList(e);});}clearSearchField(){this.searchControl.setValue("");}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-order-mobile-map"]],inputs:{stores:"stores"},features:[_I],ngContentSelectors:uo,decls:7,vars:5,consts:[[1,"order-mobile-map"],[1,"order-mobile-map__wrapper",3,"hidden"],["y-dialog-close","","svgIcon","close-light",1,"order-mobile-map__close"],[1,"order-mobile-map__search",3,"searchControl","listControl"],[1,"order-mobile-map__stores",3,"hidden"],[4,"ngIf"],["class","order-mobile-map__stores-list",4,"ngIf"],[1,"order-mobile-map__stores-list"],[3,"searchString","store",4,"ngFor","ngForOf"],[3,"searchString","store"]],template:function(t,n){t&1&&(CO(),kp(0,"div",0)(1,"div",1),bO(2),Pp(),DE(3,"y-icon",2)(4,"yota-order-choose-point",3),kp(5,"div",4),kI(6,go,3,6,"ng-container",5),Pp()()),t&2&&(QR(),iE("hidden",n.listControl.value!==n.searchListType.ON_MAP),QR(3),iE("searchControl",n.searchControl)("listControl",n.listControl),QR(),iE("hidden",n.listControl.value!==n.searchListType.LIST),QR(),iE("ngIf",n.stores));},dependencies:[hi,Ww,Dh,fi,y,Dy,zt],styles:["[_nghost-%COMP%]  .order-choose-point{position:relative;background-color:#fff;box-shadow:0 4px 20px #f6f6f6}[_nghost-%COMP%]  .order-mobile-map__stores .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}  .y-dialog-mobile-map .y-dialog-container{padding:16px}  .y-dialog-mobile-map .y-dialog-container .b-map__controls{top:224px;row-gap:36px}.order-mobile-map[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:auto auto 1fr;max-height:100%;height:100%;justify-items:flex-end;background-color:#fff}.order-mobile-map__close[_ngcontent-%COMP%]{width:32px;height:32px;align-self:flex-end;margin-bottom:16px;z-index:1;cursor:pointer}.order-mobile-map__wrapper[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100vh;width:100vw}.order-mobile-map__search[_ngcontent-%COMP%]{width:100%}.order-mobile-map__stores[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;max-height:100%;overflow:hidden;margin-top:16px}.order-mobile-map__stores-title[_ngcontent-%COMP%]{padding-block:18px 20px;text-align:center;font-size:18px;line-height:24px;font-weight:600}.order-mobile-map__stores-close[_ngcontent-%COMP%]{width:24px;height:24px;position:absolute;top:18px;right:0}.order-mobile-map__stores-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:20px;max-height:100%;overflow-y:auto;padding-right:2px}.order-mobile-map__stores-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.order-mobile-map__stores-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}.order-mobile-map__stores-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}.order-mobile-map__search-icon[_ngcontent-%COMP%]{width:24px;height:24px}"],changeDetection:0});}}return i})();var fo=["modalMapComponent"],Co=["map"],vo=()=>["name","address"],bo=(i,r)=>[i,r];function yo(i,r){if(i&1){let e=EO();kp(0,"yota-order-search-list-item",7),RE("handleChange",function(){AR(e);let n=wO();return RR(n.openMobileMap())}),Pp();}if(i&2){let e=r.ngIf;iE("selected",true)("store",e);}}function So(i,r){i&1&&wE(0);}function xo(i,r){if(i&1&&DE(0,"yota-order-search-list-item",20),i&2){let e=r.$implicit,t=wO(5);iE("searchString",t.searchControl.value)("store",e)("code",e.code)("isHidden",(e.good==null?null:e.good.remains)===0);}}function Eo(i,r){if(i&1&&(kp(0,"div",12),kI(1,xo,1,4,"yota-order-search-list-item",19),Pp()),i&2){let e=wO().ngIf,t=wO(3);QR(),iE("ngForOf",e)("ngForTrackBy",t.trackStoreByFn);}}function Oo(i,r){if(i&1&&(kp(0,"div"),kI(1,Eo,2,2,"div",18),Pp()),i&2){let e=r.ngIf;wO();let t=AO(4);QR(),iE("ngIf",e.length)("ngIfElse",t);}}function Mo(i,r){i&1&&(kp(0,"div",21),RO(1," \u041D\u0435 \u043D\u0430\u0448\u043B\u0438 \u043F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438."),DE(2,"br"),RO(3," \u041F\u0440\u043E\u0432\u0435\u0440\u044C, \u0442\u043E\u0442 \u043B\u0438 \u0432\u044B\u0431\u0440\u0430\u043D \u0433\u043E\u0440\u043E\u0434 \u2014 \u0438\u043B\u0438 \u0432\u0432\u0435\u0434\u0438 \u0434\u0440\u0443\u0433\u043E\u0439 \u0430\u0434\u0440\u0435\u0441 "),Pp());}function Do(i,r){if(i&1&&(Lp(0),kI(1,Oo,2,2,"div",17),$O(2,"searchSubstring"),kI(3,Mo,4,0,"ng-template",null,3,qO),jp()),i&2){let e=r.ngIf,t=wO(2);QR(),iE("ngIf",WO(2,1,e,LO(5,vo),t.searchControl.value));}}function Io(i,r){if(i&1){let e=EO();kp(0,"div",8)(1,"button",9),RE("click",function(){AR(e);let n=wO();return RR(n.openMobileMap())}),RO(2," \u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438 "),Pp()(),kp(3,"div",10),DE(4,"yota-order-choose-point",11),kp(5,"div",12),Lp(6,13),kp(7,"div",14),kI(8,So,1,0,"ng-container",15),Pp(),kp(9,"div",16),kI(10,Do,5,6,"ng-container",17),$O(11,"async"),Pp(),jp(),Pp()();}if(i&2){let e=wO(),t=AO(6);QR(4),iE("searchControl",e.searchControl)("listControl",e.listControl),QR(2),iE("ngSwitch",e.listControl.value),QR(),iE("hidden",e.listControl.value!==e.searchListType.ON_MAP),QR(),iE("ngTemplateOutlet",t),QR(),iE("hidden",e.listControl.value!==e.searchListType.LIST),QR(),iE("ngIf",UO(11,7,e.storesCombine$));}}function Po(i,r){if(i&1){let e=EO();kp(0,"yota-map",23,4),$O(2,"async"),RE("ready",function(n){AR(e);let o=wO(2);return RR(o.mapReady$.next(!!n))})("salePointSelected",function(n){AR(e);let o=wO(2);return RR(o.selectPickUpPoint(n))})("balloonopen",function(n){AR(e);let o=AO(1),p=wO(2);return RR(p.onBalloonOpen(n,o))})("balloonclose",function(n){AR(e);let o=wO(2);return RR(o.onBalloonClose(n))})("boundschange",function(){AR(e);let n=wO(2);return RR(n.showErrorPlacemarks())})("actionend",function(){AR(e);let n=wO(2);return RR(n.showErrorPlacemarks())})("yawheel",function(){AR(e);let n=wO(2);return RR(n.showErrorPlacemarks())}),RO(3," >"),Pp();}if(i&2){let e=wO(2);iE("isMonochrome",true)("hidePlacemarksWithoutGood",true)("isOrderMap",true)("center",VO(11,bo,e.meta.cityData.city.latitude,e.meta.cityData.city.longitude))("zoom",12)("controls",e.mapControls)("showCombined",false)("salePoints",UO(2,9,e.storesCombine$))("isCombined",false);}}function wo(i,r){if(i&1&&kI(0,Po,4,14,"yota-map",22),i&2){let e=wO();iE("ngIf",e.meta);}}function No(i,r){i&1&&wE(0);}function $o(i,r){if(i&1&&(kp(0,"yota-order-mobile-map",24),$O(1,"async"),kI(2,No,1,0,"ng-container",15),Pp()),i&2){let e=wO(),t=AO(6);iE("stores",UO(1,2,e.storesCombine$)),QR(2),iE("ngTemplateOutlet",t);}}var kn=(()=>{class i extends p{hidePickupButton(e){if(e===-1)return;let t=this._document.querySelectorAll(".ya-map__balloon-pickup__actions");t.length!==0&&t[e].classList.add("ya-map__balloon-pickup__actions_hidden");}toggleLoader(e){if(e===-1)return;let t=this._document.querySelectorAll(".ya-map__balloon-ellipsis");t.length!==0&&(t[e].classList.contains("ya-map__balloon-pickup-loader-show")?t[e].classList.remove("ya-map__balloon-pickup-loader-show"):t[e].classList.add("ya-map__balloon-pickup-loader-show"));}toggleError(e){if(e===-1)return;let t=this._document.querySelectorAll(".ya-map__balloon-pickup-error");t.length!==0&&(t[e].classList.contains("ya-map__balloon-pickup-error-show")?t[e].classList.remove("ya-map__balloon-pickup-error-show"):t[e].classList.add("ya-map__balloon-pickup-error-show"));}getGoodSalesPoints(e){let t=this.currentOpenPickupCodes.indexOf(e?.code||"");this.hidePickupButton(t),this.toggleLoader(t),this._orderErrorService.showError$.next(false);let n=this._orderDataService.orderMetaInfo$.value;this._orderApiService.getGoodSalesPoints$({goodId:e?.good?.id,codeSalesPoint:e?.code}).pipe(Pi$1(o=>{let p=o.message===It.CANT_PICKUP;return e?.good?.remains===-1||p?(this.toggleError(t),this.currentOpenPickupCodes.length>1&&this._orderErrorService.addErrorClusterPlacemarks(this.currentOpenPickupCodes.join(",")),this._orderErrorService.setError(e?.code||It.CANT_PICKUP),rg(()=>o)):(this.toggleLoader(t),Vh(null))}),Ru(()=>{this.toggleLoader(t);}),Vu(this._onDestroy$)).subscribe(o=>{if(o){if(n&&o.remains&&n.cityData.good.maxOrderCount!==2&&o.remains>1&&(n.cityData.good.maxOrderCount=2,this._orderDataService.orderMetaInfo=n),o.remains&&o.remains>0&&o.remains<=this.userCartCount.value){n&&(n.cityData.good.maxOrderCount=o.remains,this._orderDataService.orderMetaInfo=n),this.userCartCount.setValue(o.remains),this._orderErrorService.showError$.next(true),this._orderStateService.pickUpPoint$.next(e);return}o?.remains&&o?.remains>=this.userCartCount.value&&(this._orderStateService.pickUpPoint$.next(e),p$1.closeDialog(this._mapDialogRef));}});}constructor(e,t,n,o,p,m,b,M){super(),this._orderStateService=e,this._addressService=t,this._orderDataService=n,this._orderApiService=o,this._dialogService=p,this._orderAnalyticsService=m,this._breakpointObserver=b,this._orderErrorService=M,this.searchControl=new W("",{nonNullable:true}),this.listControl=new W(je.ON_MAP),this.searchListType=je,this.isMobile=false,this.orderMetaInfo$=this._orderDataService.orderMetaInfo$,this.maxCount=this.orderMetaInfo$.value?.cityData.good.maxOrderCount||5,this.userCartCount=this._orderStateService.cartFormGroup.controls.productCount,this.currentOpenPickupCodes=[],this.eventDataCode=null,this._document=I(cr$1),this.selectedPickUp$=this._orderStateService.pickUpPoint$.pipe(Hu(d=>{d&&this._orderApiService.loadingOrder$.next(false);})),this.mapControls=["zoom","locate"],this._mnpState$=this._orderDataService.contactState$.pipe(Mu(64),Au((d,N)=>!d?.mnp&&!N?.mnp?false:d?.mnp===N?.mnp),le(d=>d?.mnp)),this.stores$=Gh([this._mnpState$,J.beautifulNumberFormGroup.controls.numbers.valueChanges.pipe(Lu(J.beautifulNumberFormGroup.controls.numbers.value),le(d=>!!d.length),Au()),re.contactFormGroup.controls.citizenship.valueChanges.pipe(Lu(re.contactFormGroup.controls.citizenship.value),Au((d,N)=>{let D=Y=>Y==="\u0420\u043E\u0441\u0441\u0438\u044F";return D(d)===D(N)}))]).pipe(ju(d=>this.mapReady$.pipe(ot(Boolean),le(()=>d))),Hu(()=>this._orderApiService.loadingOrder$.next(true)),ju(([d,N])=>this._addressService.getSalePoints$(!!d,N,this._addressService.isNonResident).pipe(le(D=>D))),Pi$1(()=>Vh([])),Hu(()=>this._orderApiService.loadingOrder$.next(false)),kr$1()),this.storesCombine$=Gh([this._orderAnalyticsService.goodCount$,this.stores$]).pipe(le(([d,N])=>N.filter(D=>!D.good?.remains||D.good?.remains>-1&&D.good?.remains<d?null:x(w$1({},D),{code:D.code})))),this.mapReady$=new In$1(false),this.listControl.valueChanges.pipe(Vu(this._onDestroy$)).subscribe(d=>{d&&this._orderAnalyticsService.onChooseSearchList(d);}),this._breakpointObserver.observe(["(max-width: 768px)"]).pipe(Vu(this._onDestroy$)).subscribe(d=>{this.isMobile=d.matches;});}openMobileMap(){this._mapDialogRef=this._dialogService.open(this.modalMapComponent,{panelClass:["y-dialog-fullscreen","y-dialog-mobile-map"]});}sendAnalytics(e){this._orderAnalyticsService.enterFormField(e,this.orderMetaInfo$.value);}selectPickUpPoint(e){this.eventDataCode=null,this.getGoodSalesPoints(e),this._sendEcommerceOnSelect();}_sendEcommerceOnSelect(){this._orderAnalyticsService.pickUpHereEvent(this.orderMetaInfo$.value);}onBalloonClose(e){setTimeout(()=>{this.eventDataCode=null;let t=e.event.get("target").properties?._data?.code,n=e.event.get("target").balloon._propertiesDataManger?._sourceDataManager?._data.geoObjects.map(m=>m.properties._data.code),o;t?o=`[data-points-codes="${t}"]`:o=`[data-points-codes="${n.join(",")}"]`;let p=this._document.querySelector(o);p&&this._orderErrorService.isPlacemarkError(t?[t]:n)&&p.classList.add("ya-map__placemark_error");},0);}showErrorPlacemarks(){this._orderErrorService.errorList.forEach(e=>{let t=`[data-points-codes="${e}"]`,n=this._document.querySelector(t);n&&this._orderErrorService.isPlacemarkError([e])&&n.classList.add("ya-map__placemark_error");}),setTimeout(()=>{for(let e of this._orderErrorService.errorPlacemarks){let t=`[data-points-codes="${e}"]`,n=this._document.querySelector(t);if(!n)return;n.classList.add("ya-map__placemark_error");}},5);}showPickupActions(){let t=this._document.querySelector(".ya-map__balloon-pickup")?.querySelectorAll(".ya-map__balloon-pickup__actions");t&&t.forEach(n=>{n.classList.add("ya-map__balloon-pickup-select-show");});}onBalloonOpen(e,t){let n=e.event.get("target")?.geometry?.getCoordinates();if(this.eventDataCode||(this.eventDataCode=e.event.get("target")?.properties?._data.code,this.currentOpenPickupCodes=[e.event.get("target").properties?._data.code]),this.eventDataCode||(this.currentOpenPickupCodes=e.event.get("target").balloon._propertiesDataManger?._sourceDataManager?._data.geoObjects.map(d=>d.properties._data.code)),this._orderErrorService.errorList.forEach(d=>{let N=this.currentOpenPickupCodes.indexOf(d);this.hidePickupButton(N),this.toggleError(N);}),!t||!n)return;let o=t.map$.value;if(!o)return;let p=[...n],m=o.getBounds()[0][0],M=o.getBounds()[1][0]-m;p[0]=p[0]+M/2-M/(this.isMobile?10:5),o.panTo(p,{duration:250,timingFunction:"ease-in"});}trackStoreByFn(e,t){return t.code}static{this.\u0275fac=function(t){return new(t||i)(k$1(pe),k$1(bt),k$1(he),k$1(Be),k$1(mr$1),k$1(ne),k$1(U),k$1(gi))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-receiving-form-pickup"]],viewQuery:function(t,n){if(t&1&&(MO(fo,5,Ye$1),MO(Co,5)),t&2){let o;TO(o=SO())&&(n.modalMapComponent=o.first),TO(o=SO())&&(n.mapComponent=o.first);}},inputs:{meta:"meta"},features:[_I],decls:9,vars:4,consts:[["selectedView",""],["orderMap",""],["modalMapComponent",""],["searchEmpty",""],["map",""],[1,"receiving-form__search"],[3,"selected","store","handleChange",4,"ngIf","ngIfElse"],[3,"handleChange","selected","store"],[1,"receiving-form__search-container","receiving-form__search-container_mobile"],["type","button",1,"receiving-form__open-map-button","y-button-secondary",3,"click"],[1,"receiving-form__search-container"],[3,"searchControl","listControl"],[1,"receiving-form__search-list"],[3,"ngSwitch"],[1,"receiving-form__search-map",3,"hidden"],[4,"ngTemplateOutlet"],[3,"hidden"],[4,"ngIf"],["class","receiving-form__search-list",4,"ngIf","ngIfElse"],[3,"searchString","store","code","isHidden",4,"ngFor","ngForOf","ngForTrackBy"],[3,"searchString","store","code","isHidden"],[1,"receiving-form__search-empty"],[3,"isMonochrome","hidePlacemarksWithoutGood","isOrderMap","center","zoom","controls","showCombined","salePoints","isCombined","ready","salePointSelected","balloonopen","balloonclose","boundschange","actionend","yawheel",4,"ngIf"],[3,"ready","salePointSelected","balloonopen","balloonclose","boundschange","actionend","yawheel","isMonochrome","hidePlacemarksWithoutGood","isOrderMap","center","zoom","controls","showCombined","salePoints","isCombined"],[3,"stores"]],template:function(t,n){if(t&1&&(kp(0,"div",5),kI(1,yo,1,2,"yota-order-search-list-item",6),$O(2,"async"),kI(3,Io,12,9,"ng-template",null,0,qO),Pp(),kI(5,wo,1,1,"ng-template",null,1,qO)(7,$o,3,4,"ng-template",null,2,qO)),t&2){let o=AO(4);QR(),iE("ngIf",UO(2,2,n.selectedPickUp$))("ngIfElse",o);}},dependencies:[Ww,fi,hi,Xc,Yw,Dh,rn,Tn,Jw,y],styles:[".receiving-form__search[_ngcontent-%COMP%]{display:block}.receiving-form__search-map[_ngcontent-%COMP%]{height:540px;border-radius:16px;border:1px solid rgba(171,186,200,.3);overflow:hidden}.receiving-form__search-list[_ngcontent-%COMP%]{max-height:540px;min-height:37px;overflow-y:auto;display:flex;flex-direction:column;row-gap:16px}.receiving-form__search-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.receiving-form__search-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#abbac8}.receiving-form__search-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:4px;background:#abbac84d}.receiving-form__search-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:24px}@media (max-width: 768px){.receiving-form__search-container[_ngcontent-%COMP%]{display:none}}.receiving-form__search-container_mobile[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.receiving-form__search-container_mobile[_ngcontent-%COMP%]{display:block}}.receiving-form__open-map-button[_ngcontent-%COMP%]{border:none;background-color:#e5f7fd;height:auto;width:100%;min-height:initial;min-width:initial;max-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}"],changeDetection:0});}}return i})();var To=()=>["/map"],ko=()=>({mode:"sales"});function Ro(i,r){if(i&1&&(kp(0,"div",18),DE(1,"yota-receiving-form-pickup",19),Pp()),i&2){let e=wO(3).ngIf;QR(),iE("meta",e);}}function Ao(i,r){if(i&1&&(Lp(0),kp(1,"div",11)(2,"div",12),DE(3,"yota-order-radio-button",13,1),Pp(),kp(5,"div",12),DE(6,"yota-order-radio-button",14),Pp()(),kp(7,"div",15),DE(8,"yota-receiving-form-delivery",16),Pp(),kI(9,Ro,2,1,"div",17),jp()),i&2){let e=wO(2).ngIf,t=wO();QR(3),iE("value",t.receivingWay.Delivery)("control",t.deliveryTypeControl)("label","\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C")("id",t.radioButtonCourierId)("enabledText",e.cityData.orderDeliveryInfo.shortConditions)("disableText","\u0412 \u044D\u0442\u043E\u043C \u0433\u043E\u0440\u043E\u0434\u0435 \u043F\u043E\u043A\u0430 \u043D\u0435 \u0434\u043E\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u043C. \u041C\u043E\u0436\u0435\u0448\u044C \u0437\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0432 \u043F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438")("inputName",t.radioButtonName)("disable",!(!(e==null||e.dmsData==null||e.dmsData.nomenclature==null)&&e.dmsData.nomenclature.deliveryAvailable)||t.foreignCitizenship),QR(3),iE("value",t.receivingWay.Pickup)("control",t.deliveryTypeControl)("id",t.radioButtonPickUpId)("label","\u041F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438")("enabledText","\u041F\u043E\u0434\u0433\u043E\u0442\u043E\u0432\u0438\u043C \u0437\u0430\u043A\u0430\u0437 \u0447\u0435\u0440\u0435\u0437 30 \u043C\u0438\u043D\u0443\u0442, \u0437\u0430\u0431\u0440\u0430\u0442\u044C \u043C\u043E\u0436\u043D\u043E \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 7 \u0434\u043D\u0435\u0439")("disableText","\u041A \u0441\u043E\u0436\u0430\u043B\u0435\u043D\u0438\u044E, \u0441\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437 \u0432 \u0442\u0432\u043E\u0435\u043C \u0433\u043E\u0440\u043E\u0434\u0435 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D")("inputName",t.radioButtonName)("disable",!(!(e==null||e.dmsData==null||e.dmsData.nomenclature==null)&&e.dmsData.nomenclature.pickupAvailable)),QR(),iE("hidden",t.deliveryTypeControl.value!==t.receivingWay.Delivery),QR(),iE("samokatPromoCodeAvailable",t.samokatPromoCodeAvailable),QR(),iE("ngIf",t.deliveryTypeControl.value===t.receivingWay.Pickup);}}function Fo(i,r){i&1&&(kp(0,"p",20),RO(1," \u041C\u044B \u043F\u043E\u043A\u0430 \u043D\u0435 \u043E\u0444\u043E\u0440\u043C\u043B\u044F\u0435\u043C \u0437\u0430\u043A\u0430\u0437\u044B \u0432 \u0432\u0430\u0448\u0435\u043C \u043D\u0430\u0441\u0435\u043B\u0435\u043D\u043D\u043E\u043C \u043F\u0443\u043D\u043A\u0442\u0435. "),DE(2,"br"),RO(3," \u0412\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0441\u0442\u0438 \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u0432 \u0431\u043B\u0438\u0436\u0430\u0439\u0448\u0435\u0439 \u0442\u043E\u0447\u043A\u0435 \u043F\u0440\u043E\u0434\u0430\u0436. "),Pp(),kp(4,"a",21),RO(5,"\u0422\u043E\u0447\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0436"),Pp()),i&2&&(QR(4),iE("routerLink",LO(2,To))("queryParams",LO(3,ko)));}function Bo(i,r){if(i&1&&(kp(0,"form",9),kI(1,Ao,10,19,"ng-container",10)(2,Fo,6,4,"ng-template",null,0,qO),Pp()),i&2){let e=AO(3),t=wO().ngIf,n=wO();iE("formGroup",n.formGroup),QR(),iE("ngIf",(t==null||t.dmsData==null||t.dmsData.nomenclature==null?null:t.dmsData.nomenclature.deliveryAvailable)&&!n.foreignCitizenship||(t==null||t.dmsData==null||t.dmsData.nomenclature==null?null:t.dmsData.nomenclature.pickupAvailable))("ngIfElse",e);}}function Lo(i,r){if(i&1){let e=EO();kp(0,"div",3)(1,"div",4)(2,"span",5),RO(3,"\u0421\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0432"),Pp(),kp(4,"span",6),RE("click",function(n){return AR(e),wO().changeCity(),RR(n.stopPropagation())}),RO(5),DE(6,"y-icon",7),Pp()(),kI(7,Bo,4,3,"form",8),Pp();}if(i&2){let e=r.ngIf,t=wO();QR(5),Hp(" ",t.getCityName(e)," "),QR(2),iE("ngIf",t.formGroup);}}var je=function(i){return i.ON_MAP="ON_MAP",i.LIST="LIST",i}(je||{}),On=(()=>{class i extends p{constructor(e,t,n,o,p){super(),this._orderStateService=e,this._orderDataService=t,this._renderer=n,this._orderAnalyticsService=o,this._cdr=p,this.samokatPromoCodeAvailable=false,this.foreignCitizenship=false,this.formGroup=L.receivingFormGroup,this.deliveryTypeControl=L.receivingFormGroup.controls.receivingWay,this.analyticsActions=O$1,this.receivingWay=a,this.orderMetaInfo$=this._orderDataService.orderMetaInfo$.pipe(kr$1()),this.hasSelectedBeautifulNumber$=J.beautifulNumberFormGroup.controls.numbers.valueChanges.pipe(Lu([]),le(m=>!!m.length)),this._currentReceivingWay=a.Delivery,this.radioButtonName="deliveryType",this.radioButtonCourierId="receiving-form__delivery-courier",this.radioButtonPickUpId="receiving-form__delivery-pick-up",this._analyticsFacadeService=I(O),this._window=I(i$1),this._orderStateService.receivingStep.stepState$.pipe(ot(m=>m===G.ACTIVE),Nu(100),ot(()=>this.deliveryTypeControl.value===a.Delivery),Vu(this._onDestroy$)).subscribe(()=>{this._orderAnalyticsService.clickDelivery(this._orderDataService.orderMetaInfo$.value);}),Gh([this.orderMetaInfo$.pipe(le(m=>m?.dmsData?.nomenclature),ot(Boolean)),this._orderStateService.receivingStep.stepState$]).pipe(Vu(this._onDestroy$)).subscribe(([m,b])=>{b===G.ACTIVE&&(m.deliveryAvailable&&this.deliveryTypeControl.value===this.receivingWay.Delivery&&!this.foreignCitizenship?this.deliveryTypeControl.setValue(a.Delivery):this.deliveryTypeControl.setValue(a.Pickup));}),this.deliveryTypeControl.valueChanges.pipe(Vu(this._onDestroy$)).subscribe(m=>{if(m===a.Delivery&&!L.receivingFormGroup.controls.timeSlotsTime.value?.isSamokat?this._orderStateService.paymentStep.stepState$.next(G.DISABLE):m===a.Pickup&&this._orderStateService.paymentStep.stepState$.next(G.HIDDEN),this._orderAnalyticsService.receivingWay$.next(m),this._currentReceivingWay!==m){this._currentReceivingWay=m;let b=this._orderDataService.orderMetaInfo$.value;this._orderAnalyticsService.clickDelivery(b);}this._orderStateService.calculateTotal$.next(),this._orderStateService.changeButtonState$.next(),this._cdr.markForCheck();});}getCityName(e){return e?.dmsData?.settlement||e?.dmsData?.city}changeCity(){this._orderStateService.changeStateByStepName(q.CONTACT),setTimeout(()=>{this._renderer.selectRootElement("#order-autocomplete")?.focus();},0);}onClickStoreLink(e){e.preventDefault();let n=L.receivingFormGroup.controls.receivingWay.value,p=[n===a.Delivery&&this._orderDataService.deliveryType$.value===_.Samokat?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 30 \u043C\u0438\u043D\u0443\u0442":"\u041E\u0431\u044B\u0447\u043D\u0430\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430",n===a.Delivery?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C":"\u041F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438",this._orderDataService.orderMetaInfo$.value?.cityData?.good?.name,"\u0438\u043D\u0442\u0435\u0440\u043D\u0435\u0442-\u043C\u0430\u0433\u0430\u0437\u0438\u043D\u0435",this._orderDataService.orderRegion,this._orderDataService.orderCity,this._orderDataService.orderMetaInfo$.value?.cityData?.good?.id];this._analyticsFacadeService.pushDataLayer({event:E.NAVIGATIONS,event_param:p.join("/")},O$1.CLICK_BACK_TO_STORE);let m=e.target.href;p$1.isIframe()?this._window.parent.location.href=m:this._window.location.href=m;}static{this.\u0275fac=function(t){return new(t||i)(k$1(pe),k$1(he),k$1(or$1),k$1(ne),k$1(ci$1))};}static{this.\u0275cmp=lO({type:i,selectors:[["yota-receiving-form"]],inputs:{samokatPromoCodeAvailable:"samokatPromoCodeAvailable",foreignCitizenship:"foreignCitizenship"},features:[_I],decls:2,vars:3,consts:[["notAvailable",""],["courierRadioButton",""],["class","receiving-form",4,"ngIf"],[1,"receiving-form"],[1,"receiving-form__title"],[1,"receiving-form__city-prefix"],[1,"receiving-form__city",3,"click"],["svgIcon","edit-outline",1,"receiving-form__title-icon"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngIf","ngIfElse"],[1,"receiving-form__radio-container"],[1,"receiving-form__radio-button"],[3,"value","control","label","id","enabledText","disableText","inputName","disable"],[3,"value","control","id","label","enabledText","disableText","inputName","disable"],[1,"receiving-form__content",3,"hidden"],[3,"samokatPromoCodeAvailable"],["class","receiving-form__content",4,"ngIf"],[1,"receiving-form__content"],[3,"meta"],[1,"g-text","y-mb-32"],[1,"y-button","y-button-medium","custom-button",3,"routerLink","queryParams"]],template:function(t,n){t&1&&(kI(0,Lo,8,2,"div",2),$O(1,"async")),t&2&&iE("ngIf",UO(1,1,n.orderMetaInfo$));},dependencies:[Ww,An,Dn$1,Cn,Mn$1,Bt,ai,$n,kn,Jw,zt,Hn$1],styles:["[_nghost-%COMP%]     .y-form-field-infix{width:100%}[_nghost-%COMP%]     .y-tab-label{width:300px}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{border:none;border-bottom:1px solid #b9c2cb;border-radius:0}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element:focus{border-bottom:1px solid #00aeef}[_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper span.ng-star-inserted, [_nghost-%COMP%]     .dynamic-control.y-form-field .dynamic-control__wrapper .y-input-element{padding-left:0;padding-top:0}[_nghost-%COMP%]     .y-form-field label.dynamic-control__label{font-size:12px;margin-bottom:5px}.receiving-form__title[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;column-gap:8px;margin-bottom:24px;font-size:16px;line-height:22px;font-weight:600}.receiving-form__title-icon[_ngcontent-%COMP%]{color:#00aeef;cursor:pointer;width:24px;height:24px}.receiving-form__city-prefix[_ngcontent-%COMP%]{white-space:nowrap}.receiving-form__city[_ngcontent-%COMP%]{position:relative;color:#00aeef;cursor:pointer;display:flex;align-items:center;column-gap:8px}.receiving-form__row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:16px}.receiving-form__field[_ngcontent-%COMP%]{width:100%}.receiving-form__input[_ngcontent-%COMP%]{width:100%;padding-bottom:10px}.receiving-form__input_comment[_ngcontent-%COMP%]{resize:none}.receiving-form__content[_ngcontent-%COMP%]{margin-top:40px}.receiving-form__radio-container[_ngcontent-%COMP%]{display:flex;column-gap:32px}.receiving-form__radio-button[_ngcontent-%COMP%]{width:100%}@media (max-width: 768px){.receiving-form__title[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;row-gap:8px}.receiving-form__radio-container[_ngcontent-%COMP%]{flex-direction:column;row-gap:12px}.receiving-form__content[_ngcontent-%COMP%]{margin-top:24px}}.custom-button[_ngcontent-%COMP%]{text-transform:none}"],changeDetection:0});}}return i})();var ne=(()=>{class i{constructor(){this._analyticsService=I(O),this._storeService=I(D),this.goodId="",this.goodName="",this.goodPrice$=new In$1(0),this.goodProductType="",this.orderNumber="",this.receivingWay$=new In$1(a.Delivery),this.deliveryType$=new In$1(""),this.goodCount$=new In$1(1),this.categories$=new In$1([]);}get _isSamokat(){return this.receivingWay$.value===a.Delivery&&this.deliveryType$.value===_.Samokat}getDeliveryInfo(e,t){let n=`${this._getDeliveryType()}/${this._getDeliveryWay()}/${this.goodName}[${this.goodCount$.value}]`;return e&&t&&(n+=`${e}/${t}`),n}onCitizenshipChange(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`${this.getDeliveryInfo()} / ${e}`},O$1.ORDER_FORM_SELECT_CITIZENSHIP);}onConfirmBeautifulNumbers(e,t,n,o){let p={add:{products:this._generateEcommerceProduct(o)}};this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:(e??"0")+" \u20BD / "+t+" / "+n||"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",ecommerce:p},O$1.SELECT_NUMBER_DIALOG_CLICK_CONFIRM);}orderPaymentStep(e,t,n){let o={checkout:{actionField:{step:4,action:"checkout"},products:this._generateEcommerceProduct(e||null)}},p=p$1.isIframe()?`${this.getDeliveryInfo(t,n)}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo(t,n);this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${p}/${this.goodId}`,ecommerce:o},O$1.ORDER_PAYMENT_STEP);}clickDelivery(e){let t={checkout:{actionField:{step:1,action:"checkout"},products:this._generateEcommerceProduct(e)}},n=p$1.isIframe()?`${this.getDeliveryInfo()}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${n}/${this.goodId}`,ecommerce:t},O$1.CLICK_DELIVERY_WAY);}orderNoReceivingWay(e,t){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`\u041D\u0435\u0442 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u0438 \u0441\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437\u0430/${e}/${t}`},O$1.ORDER_NO_RECEIVING_WAY);}orderOtpFailed(e){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:e??"numberNotConfirmed"},O$1.ORDER_OTP_FAILED);}changeOrderAmount(){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()},O$1.CHANGE_ORDER_AMOUNT);}getCategoryNameById(e,t){return e?.find(o=>o.categoryId===t)?.name}clickOrderConfirm(e){let t={checkout:{actionField:{step:2,action:"checkout"},products:this._generateEcommerceProduct(e)}},n=p$1.isIframe()?`${this.getDeliveryInfo()}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${n}/\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437/${this.goodId}`,ecommerce:t},O$1.CLICK_ORDER_CONFIRM);}_generateEcommerceProduct(e){let t=[{id:this.goodId,name:this.goodName,price:this.goodPrice$.value,brand:this.goodName,category:this.getCategoryNameById(this.categories$.value,e?.dmsData.nomenclatures[0].categoryId),quantity:this.goodCount$.value}],n=J.beautifulNumberFormGroup.controls.numbers,o=n.value.reduce((m,b)=>m+b.category,0);return n.value.length&&t.push({id:"999999",name:"\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",price:o,brand:"\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",category:this.getCategoryNameById(this.categories$.value,e?.dmsData.nomenclatures[0].categoryId),quantity:n.value.length}),t}onEnteredName(){let e=this._getDeliveryType(),t=this._getDeliveryWay();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${e} / ${t} / ${this.goodName} [${this.goodCount$.value}]`},O$1.ORDER_ENTER_NAME);}onChooseSearchList(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e===je.ON_MAP?"\u041D\u0430 \u043A\u0430\u0440\u0442\u0435":"\u0421\u043F\u0438\u0441\u043A\u043E\u043C"},O$1.ORDER_CLICK_PICKUP_LIST_VIEW);}onChoosePaymentType(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:(e===vt.CARD?"\u041A\u0430\u0440\u0442\u043E\u0439":"\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438")+" \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438"},O$1.ORDER_PAYMENT_TYPE);}pickUpHereEvent(e){let t={checkout:{actionField:{step:3,action:"checkout"},products:this._generateEcommerceProduct(e)}};this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()+"/\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0437\u0434\u0435\u0441\u044C",ecommerce:t},O$1.PICKUP_HERE);}enterFormField(e,t,n,o){let p={checkout:{actionField:{step:3,action:"checkout"},products:this._generateEcommerceProduct(t)}};this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo(n,o),ecommerce:p},e);}onMnpControlChecked(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 Yota \u0441\u043E \u0441\u0432\u043E\u0438\u043C \u043D\u043E\u043C\u0435\u0440\u043E\u043C/${e?"\u0412\u043A\u043B":"\u0412\u044B\u043A\u043B"}`},O$1.ORDER_CLICK_MNP);}onEnterValidPhone(){let e=p$1.isIframe()?`${this.getDeliveryInfo()}/${document.referrer.split(".")[0]}`:this.getDeliveryInfo();this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`${e}/${this.goodId}`},O$1.PHONE_IS_VALID);}onCaptchaSuccess(){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()},O$1.RECAPTCHA_SUCCESS);}onOTPSuccess(){this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:this.getDeliveryInfo()},O$1.CODE_SUCCESS);}onOpenMnpPopup(){this._analyticsService.pushDataLayer({event:E.ACTIONS},O$1.ORDER_MNP_POPUP_OPEN);}onCloseMnpPopup(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u0435\u0440\u0435\u0445\u043E\u0434\u0430 / ${e}`},O$1.ORDER_MNP_POPUP_CLOSE);}onError(e,t,n){if(!this.goodName||!e)return;let o=[this._getDeliveryType(),this._getDeliveryWay(),this.goodName,e,t,n];this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:o.join(" / ")},O$1.ORDER_ERROR);}onPickupError(e,t,n){if(!this.goodName||!e)return;let o=[this._getDeliveryType(),this._getDeliveryWay(),this.goodName,e,t,n];this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:o.join(" / ")},O$1.ORDER_ERROR);}orderDataError(e,t,n){this._analyticsService.pushDataLayer({event:E.NAVIGATIONS,event_param:`/ / / ${e} / ${t} / ${n}`},O$1.ORDER_FORM_OUT_OF_STOCK_ERROR_CLICK_BUTTON);}onClickBeautifulNumberStepButton(e){this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:`\u041A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 / ${e}`},O$1.ORDER_FORM_BEAUTIFUL_NUMBER_STEP_CLICK_BUTTON);}onShowPopup(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.ORDER_FORM_SHOW_POPUP);}onOpenBeautifulNumbersDialog(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:e},O$1.ORDER_FORM_OPEN_BEAUTIFUL_NUMBERS_DIALOG);}onSuccessOrder(e,t,n,o,p,m,b){let M={purchase:{actionField:{id:this.orderNumber,revenue:b},products:this._generateEcommerceProduct(m)}},d=[this._getDeliveryType(),this._getDeliveryWay(),`${this.goodName}[${this.goodCount$.value}]`,this.orderNumber,"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",e,t,n,o,p].filter(Boolean).join(" / ");this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:d,ecommerce:M},O$1.ORDER_SUCCESS);}onClickPersonalPromoButton(e,t,n){let o=[this._getDeliveryType(),this._getDeliveryWay(),`${this.goodName}[${this.goodCount$.value}]`,this.orderNumber,"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",`${e}/${t}`,n].filter(Boolean).join(" / ");this._analyticsService.pushDataLayer({event:E.NAVIGATIONS,event_param:o},O$1.ORDER_FORM_CLICK_PERSONAL_PROMO_BUTTON);}onClickOrderFeedbackButton(e,t,n){let o=[this._getDeliveryType(),this._getDeliveryWay(),`${this.goodName}[${this.goodCount$.value}]`,this.orderNumber,"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",`${e}/${t}`,n].filter(Boolean).join(" / ");this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:o},O$1.ORDER_SUCCESS_FEEDBACK_CLICK);}_getDeliveryType(){return this._isSamokat?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 30 \u043C\u0438\u043D\u0443\u0442":"\u041E\u0431\u044B\u0447\u043D\u0430\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430"}_getDeliveryWay(){return this.receivingWay$.value===a.Delivery?"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C":"\u041F\u0443\u043D\u043A\u0442 \u0432\u044B\u0434\u0430\u0447\u0438"}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}}return i})();var Vo=["popupCancelled"],Uo=["scrollableList"],Go=["bottomSheet"],Ho=["captchaDialog"],Rn=i=>({$implicit:i}),zo=()=>({mask:"0000000"}),Yo=()=>({$implicit:false}),jo=()=>({$implicit:true}),Pi=(i,r)=>({event:i,event_param:r}),qo=i=>({event:i,event_param:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0435\u0449\u0435"}),Wo=i=>({event:i,event_param:"\u041D\u043E\u043C\u0435\u0440 \u0443\u0434\u0430\u043B\u0435\u043D / \u0412\u0435\u0440\u043D\u0443\u0442\u044C"});function Ko(i,r){if(i&1){let e=EO();kp(0,"y-icon",17),RE("click",function(){AR(e);let n=wO();return RR(n.onClickClose())}),Pp();}}function Qo(i,r){i&1&&wE(0);}function Xo(i,r){if(i&1&&(kp(0,"div",19),kI(1,Qo,1,0,"ng-container",20),Pp()),i&2){let e=wO(2),t=AO(25);QR(),iE("ngTemplateOutlet",t)("ngTemplateOutletContext",jO(2,Rn,e.error.data));}}function Jo(i,r){if(i&1){let e=EO();kp(0,"yota-field-state",27),RE("clear",function(){AR(e);let n=wO(3);return RR(n.searchControl.setValue(""))}),Pp();}if(i&2){wO();let e=AO(6),t=wO(2);iE("state",t.controlState.CLEAR)("inputControl",e);}}function Zo(i,r){if(i&1){let e=EO();kp(0,"div",30),RE("click",function(){let n=AR(e).$implicit,o=wO(4);return RR(o.toggleCategory(n))}),RO(1),Pp();}if(i&2){let e=r.$implicit;sE("selected",e.selected),QR(),Hp(" ",e.name," ");}}function ea(i,r){if(i&1&&(kp(0,"div",28),$O(1,"async"),$O(2,"async"),kI(3,Zo,2,3,"div",29),$O(4,"async"),Pp()),i&2){let e=wO(3);sE("collapsed",UO(1,3,e.scrollableList==null?null:e.scrollableList.position$)!=="top"&&UO(2,5,e.scrollableList==null?null:e.scrollableList.scrollDirection$)==="down"),QR(3),iE("ngForOf",UO(4,7,e.categories$));}}function ta(i,r){if(i&1){let e=EO();kp(0,"div",35),$O(1,"async"),$O(2,"async"),RE("click",function(){let n=AR(e).$implicit,o=wO(5);return RR(o.toggleNumber(n))}),DE(3,"div",36),kp(4,"p",37),$O(5,"imask"),$O(6,"phoneNumberHighlight"),RO(7),Pp(),kp(8,"span",38),RO(9),Pp()();}if(i&2){let e=r.$implicit,t=wO(5);sE("selected",t.selectedNumbers.includes(e.value))("processing",e.value===UO(1,9,t.processingNumber$))("disabled",UO(2,11,t.pending$)||!t.selectedNumbers.includes(e.value)&&t.selectedNumbers.length===t.config.selectedNumbersMaxCount&&!t.config.radioMode),QR(4),iE("innerHTML",WO(6,16,zO(5,13,e.value,t.phoneMask),t.searchControl.value||"",e.replaceIndexes),WR),QR(3),Hp(" ",e.highlightReplace," "),QR(2),Hp(" ",e.category?e.category+" \u20BD":"\u0411\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"," ");}}function ia(i,r){i&1&&wE(0);}function na(i,r){if(i&1&&(Lp(0),kI(1,ia,1,0,"ng-container",39),jp()),i&2){wO(5);let e=AO(21);QR(),iE("ngTemplateOutlet",e);}}function ra(i,r){if(i&1){let e=EO();kp(0,"div",42),RE("click",function(){AR(e);let n=wO(6);return RR(n.onClickUpButton())}),DE(1,"y-icon",43),Pp();}i&2&&(QR(),iE("svgIcon","arrow-outline"));}function oa(i,r){if(i&1&&(kp(0,"div",40),kI(1,ra,2,1,"div",41),$O(2,"async"),Pp()),i&2){wO();let e=AO(1);QR(),iE("ngIf",UO(2,1,e.position$)==="inter");}}function aa(i,r){if(i&1&&(kp(0,"div",32,7),$O(2,"async"),kI(3,ta,10,20,"div",33)(4,na,2,1,"ng-container",13),$O(5,"async"),$O(6,"async"),kI(7,oa,3,3,"div",34),Pp()),i&2){let e=AO(1),t=wO().ngIf,n=wO(3);sE("show-more",UO(2,7,e.position$)==="bottom"),iE("gap",60)("sizeChangeSubject$",n.onChangeContent$),QR(3),iE("ngForOf",t),QR(),iE("ngIf",(!n.searchControl.value||UO(5,9,n.isMobile$)===false)&&UO(6,11,n.loadMoreHide$)===false),QR(3),iE("ngIf",e);}}function sa(i,r){if(i&1&&(Lp(0),kI(1,aa,8,13,"div",31),jp()),i&2){let e=r.ngIf;QR(),iE("ngIf",e.length);}}function la(i,r){i&1&&wE(0);}function ca(i,r){if(i&1&&(Lp(0),kI(1,la,1,0,"ng-container",20),jp()),i&2){let e=wO(3),t=AO(25);QR(),iE("ngTemplateOutlet",t)("ngTemplateOutletContext",jO(2,Rn,e.error.data));}}function pa(i,r){if(i&1){let e=EO();Lp(0),kp(1,"y-form-field-bordered",21)(2,"y-label"),RO(3,"\u0412\u0432\u0435\u0434\u0438 \u0446\u0438\u0444\u0440\u044B"),Pp(),DE(4,"y-icon",22),kp(5,"input",23,6),RE("focus",function(){AR(e);let n=wO(2);return RR(n.onFocusSearch())})("blur",function(){AR(e);let n=wO(2);return RR(n.onBlurSearch())})("keydown",function(n){AR(e);let o=wO(2);return RR(o.onEnter(n))}),Pp(),kI(7,Jo,1,2,"yota-field-state",24),Pp(),kp(8,"div",25),kI(9,ea,5,9,"div",26)(10,sa,2,1,"ng-container",13),$O(11,"async"),kI(12,ca,2,4,"ng-container",13),Pp(),jp();}if(i&2){let e=AO(6),t=wO(2);QR(4),iE("svgIcon","search-outline"),QR(),iE("formControl",t.searchControl)("unmask",true)("imask",LO(10,zo)),QR(2),iE("ngIf",e.focused&&e.value),QR(2),iE("ngIf",!t.config.radioMode),QR(),iE("ngIf",UO(11,8,t.phoneNumbers$)),QR(2),iE("ngIf",t.error.state==="data-error");}}function ua(i,r){if(i&1&&(Lp(0),kI(1,Xo,2,4,"div",18)(2,pa,13,11,"ng-container",13),jp()),i&2){let e=wO();QR(),iE("ngIf",e.error.state==="dialog-error"),QR(),iE("ngIf",e.error.state!=="dialog-error");}}function ma(i,r){i&1&&DE(0,"y-spinner",44),i&2&&iE("strokeWidth",3)("diameter",80);}function da(i,r){i&1&&wE(0);}function _a(i,r){if(i&1&&(kp(0,"div",45),kI(1,da,1,0,"ng-container",39),Pp()),i&2){wO();let e=AO(21);QR(),iE("ngTemplateOutlet",e);}}function ha(i,r){i&1&&wE(0);}function ga(i,r){if(i&1&&(Lp(0),kI(1,ha,1,0,"ng-container",20),jp()),i&2){wO();let e=AO(17);QR(),iE("ngTemplateOutlet",e)("ngTemplateOutletContext",LO(2,Yo));}}function fa(i,r){i&1&&wE(0);}function Ca(i,r){i&1&&wE(0);}function va(i,r){if(i&1&&(kp(0,"div",48),kI(1,Ca,1,0,"ng-container",39),Pp()),i&2){wO(2);let e=AO(19);QR(),iE("ngTemplateOutlet",e);}}function ba(i,r){if(i&1&&(kp(0,"yota-bottom-sheet",46,8),kI(2,fa,1,0,"ng-container",20)(3,va,2,1,"div",47),Pp()),i&2){let e=wO(),t=AO(17);iE("contentChanged$",e.onChangeContent$)("animationSpeed",e.animationSpeed),QR(2),iE("ngTemplateOutlet",t)("ngTemplateOutletContext",LO(5,jo)),QR(),iE("ngIf",e.error.state!=="dialog-error");}}function ya(i,r){if(i&1&&(kp(0,"span",55),RO(1),Pp()),i&2){let e=wO(2);QR(),Hp(" ",e.config.cartEmptyDescription," ");}}function Sa(i,r){if(i&1){let e=EO();kp(0,"div",58),RO(1),$O(2,"imask"),kp(3,"div",59),RE("click",function(){let n=AR(e).$implicit,o=wO(3);return RR(o.error.state!=="dialog-error"?o.onClickNumberInCart(n):null)}),DE(4,"y-icon",43),kp(5,"span"),RO(6,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440"),Pp()()();}if(i&2){let e=r.$implicit,t=wO(3);QR(),Hp(" ",zO(2,2,""+e.value,t.phoneMask)," "),QR(3),iE("svgIcon","close-outline");}}function xa(i,r){if(i&1&&(kp(0,"div",56),kI(1,Sa,7,5,"div",57),$O(2,"async"),Pp()),i&2){let e=wO(2);sE("expanded",e.expandNumbers),QR(),iE("ngForOf",UO(2,3,e.selectedPhoneNumbers$));}}function Ea(i,r){if(i&1){let e=EO();kp(0,"div",60),RE("click",function(){AR(e);let n=wO(2);return RR(n.toggleExpandNumbers())}),RO(1),Pp();}if(i&2){let e=wO(2);sE("expanded",e.expandNumbers),iE("params",VO(5,Pi,e.analyticsEvents.ACTIONS,e.expandNumbers?e.config.expandMoreText:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C"))("action",e.analyticsActions.SELECT_NUMBER_DIALOG_CLICK_EXPAND),QR(),Hp(" ",e.expandNumbers?"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C":e.config.expandMoreText," ");}}function Oa(i,r){if(i&1&&(kp(0,"p",61),RO(1),$O(2,"async"),Pp()),i&2){let e=wO(2);QR(),Hp(" ",UO(2,1,e.selectedPhoneNumbersTotal$)," \u20BD ");}}function Ma(i,r){i&1&&wE(0);}function Da(i,r){if(i&1&&(Lp(0),kI(1,Ma,1,0,"ng-container",39),jp()),i&2){wO(2);let e=AO(19);QR(),iE("ngTemplateOutlet",e);}}function Ia(i,r){if(i&1&&(kp(0,"div",49),$O(1,"async"),$O(2,"async"),kp(3,"p",50),RO(4),Pp(),kI(5,ya,2,1,"span",51)(6,xa,3,5,"div",52)(7,Ea,2,8,"div",53)(8,Oa,3,3,"p",54)(9,Da,2,1,"ng-container",13),Pp()),i&2){let e=r.$implicit,t=wO();sE("has-numbers",t.selectedNumbers.length)("expandable",t.selectedNumbers.length>1)("pending",UO(1,12,t.pending$)||UO(2,14,t.loading$)||t.error.state==="dialog-error"),QR(4),VE(t.config.cartTitle),QR(),iE("ngIf",!t.selectedNumbers.length),QR(),iE("ngIf",t.selectedNumbers.length),QR(),iE("ngIf",t.selectedNumbers.length>1),QR(),iE("ngIf",!t.config.radioMode&&t.selectedNumbers.length),QR(),iE("ngIf",!e);}}function Pa(i,r){if(i&1){let e=EO();kp(0,"button",62),$O(1,"async"),$O(2,"async"),RE("click",function(){AR(e);let n=wO();return RR(n.onClickOrderButton())}),RO(3),Pp();}if(i&2){let e=wO();iE("disabled",!e.selectedNumbers.length||UO(1,3,e.loading$)||UO(2,5,e.pending$)||e.error.state==="dialog-error")("tabIndex",-1),QR(3),Hp(" ",(e.config.buttonOrder==null?null:e.config.buttonOrder.text)||"\u0412\u044B\u0431\u0440\u0430\u0442\u044C"," ");}}function wa(i,r){if(i&1){let e=EO();kp(0,"button",63),$O(1,"async"),$O(2,"async"),$O(3,"async"),RE("click",function(){AR(e);let n=wO();return RR(n.loadMoreNumbers())}),RO(4," \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0435\u0449\u0435 "),Pp();}if(i&2){let e=wO();iE("disabled",!!UO(1,3,e.loading$)||!!UO(2,5,e.pending$)||!!UO(3,7,e.loadMoreDisabled$))("params",jO(9,qo,e.analyticsEvents.CONVERSIONS))("action",e.analyticsActions.SELECT_NUMBER_DIALOG_CLICK_LOAD_MORE);}}function Na(i,r){if(i&1){let e=EO();RO(0," \u041D\u043E\u043C\u0435\u0440 \u0443\u0434\u0430\u043B\u0435\u043D. "),kp(1,"span",64),RE("click",function(){let n=AR(e).number,o=wO();return RR(o.toggleNumber(n))}),RO(2," \u0412\u0435\u0440\u043D\u0443\u0442\u044C "),Pp();}if(i&2){let e=wO();QR(),iE("params",jO(2,Wo,e.analyticsEvents.ACTIONS))("action",e.analyticsActions.SELECT_NUMBER_DIALOG_REVERT_CANCEL);}}function $a(i,r){if(i&1&&(kp(0,"h5",71),RO(1),Pp()),i&2){let e=r.ngIf;QR(),Hp(" ",e," ");}}function Ta(i,r){if(i&1){let e=EO();kp(0,"button",72),RE("click",function(){let n=AR(e).ngIf;return RR(n.action())}),RO(1),Pp();}if(i&2){let e=r.ngIf;QR(),Hp(" ",e.text," ");}}function ka(i,r){if(i&1){let e=EO();kp(0,"button",73),$O(1,"async"),$O(2,"async"),$O(3,"async"),RE("click",function(){let n=AR(e).ngIf;return RR(n.action())}),RO(4),Pp();}if(i&2){let e=r.ngIf,t=wO(2);iE("disabled",e.canDisable&&(!!UO(1,2,t.loading$)||!!UO(2,4,t.pending$)||!!UO(3,6,t.loadMoreDisabled$))),QR(4),Hp(" ",e.text," ");}}function Ra(i,r){if(i&1&&(kp(0,"div",65),DE(1,"y-icon",66),kI(2,$a,2,1,"h5",67),DE(3,"p",68),kI(4,Ta,2,1,"button",69)(5,ka,5,8,"button",70),Pp()),i&2){let e=r.$implicit;sE("has-title",e.title),QR(),iE("svgIcon",e.svgIcon||"fail"),QR(),iE("ngIf",e.title),QR(),iE("innerHTML",e.description,WR),QR(),iE("ngIf",e.button),QR(),iE("ngIf",e.buttonSecondary);}}function Aa(i,r){i&1&&DE(0,"y-spinner",82),i&2&&iE("diameter",24)("strokeWidth",1);}function Fa(i,r){if(i&1){let e=EO();kp(0,"div",74)(1,"y-icon",75),RE("click",function(){AR(e);let n=wO();return RR(n.closeCaptchaDialog())}),Pp(),kp(2,"form",76),RE("submit",function(){AR(e);let n=wO();return RR(n.confirmCaptcha())}),kp(3,"div",77),RO(4),Pp(),kp(5,"yota-captcha",78),$O(6,"async"),RE("valueChange",function(n){AR(e);let o=wO();return RR(o.handleCaptcha(n))}),kI(7,Aa,1,2,"y-spinner",79),$O(8,"async"),Pp(),kp(9,"button",80),$O(10,"async"),RE("click",function(){AR(e);let n=wO();return RR(n.confirmCaptcha())}),RO(11," \u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C "),Pp(),kp(12,"a",81),RE("click",function(){AR(e);let n=wO();return RR(n.closeCaptchaDialog())}),RO(13," \u041E\u0442\u043C\u0435\u043D\u0430 "),Pp()()();}if(i&2){let e=wO();QR(),iE("params",VO(16,Pi,e.analyticsEvents.ACTIONS,e.captchaTitle+" / \u041A\u0440\u0435\u0441\u0442\u0438\u043A"))("action",e.analyticsActions.SELECT_NUMBER_DIALOG_CAPTCHA_CLOSE),QR(3),Hp(" ",e.captchaTitle," "),QR(),iE("getCaptcha$",e.getCaptcha$)("wrongCaptcha",UO(6,10,e.wrongCaptcha$))("pending$",e.pendingCaptcha$),QR(2),iE("ngIf",UO(8,12,e.pendingCaptcha$)),QR(2),iE("disabled",!e.captchaAnswer||UO(10,14,e.pendingCaptcha$)),QR(3),iE("params",VO(19,Pi,e.analyticsEvents.ACTIONS,e.captchaTitle+" / \u041E\u0442\u043C\u0435\u043D\u0430"))("action",e.analyticsActions.SELECT_NUMBER_DIALOG_CAPTCHA_CLOSE);}}var Ba=(()=>{class i{transform(e,t,n=[],o="y-highlight"){if(!t)return e;let p=[],m=0,b=-1;for(let D=8;D<e.length;D++)/\d/.test(e[D])&&(e[D]===t[m]||n.includes(m)?(m===0&&(b=D),m++,m===t.length&&(p.push({start:b,end:D}),m=0,D=b,b=-1)):(m>0&&(D=b),m=0,b=-1));let M=[];if(t.length>1&&p.length>1){let D=w$1({},p[0]);for(let Y=1;Y<p.length;Y++){let ce=w$1({},p[Y]);D.end>=ce.start?(D.end=Math.max(D.end,ce.end),Y===p.length-1&&M.push(D)):(M.push(D),D=w$1({},ce));}}else M=[...p];let d="",N=0;return M.forEach(({start:D,end:Y})=>{d+=e.slice(N,D),d+=`<span class="${o}">`;for(let ce=D;ce<=Y;ce++)!/\d/.test(e[ce])&&ce<Y?(d+=`</span>${e[ce]}<span class="${o}">`,ce+1<=Y&&/\d/.test(e[ce+1])&&(d+=e[ce+1],ce++)):d+=e[ce];d+="</span>",N=Y+1;}),d+=e.slice(N),d}static{this.\u0275fac=function(t){return new(t||i)};}static{this.\u0275pipe=vn({name:"phoneNumberHighlight",type:i,pure:true});}}return i})(),oi=(()=>{class i extends p{constructor(){super(...arguments),this._selectNumberDialogService=I(St),this._bottomSheetService=I(ri),this._breakpointObserver=I(U),this._dialogService=I(mr$1),this._analyticsService=I(O),this._orderAnalyticsService=I(ne),this._orderDataService=I(he),this._stripHtmlTagsPipe=I(n$1),this._router=I(q$1),this._cdr=I(ci$1),this.config=this._selectNumberDialogService.config,this.searchControl=this._selectNumberDialogService.searchControl,this.selectedNumbers=[],this.selectedCategoryNames=[],this.hideCategories=false,this.expandNumbers=false,this.controlState=c,this.analyticsActions=O$1,this.analyticsEvents=E,this.phoneMask={mask:"+7 (000) 000-00-00"},this.animationSpeed=300,this.captchaTitle="\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438, \u0447\u0442\u043E \u0442\u044B \u043D\u0435 \u0440\u043E\u0431\u043E\u0442",this.loading$=this._selectNumberDialogService.loading$,this.pending$=this._selectNumberDialogService.pending$,this.loadMoreDisabled$=this._selectNumberDialogService.loadMoreDisabled$,this.loadMoreHide$=this._selectNumberDialogService.loadMoreHide$,this.categories$=this._selectNumberDialogService.categories$,this.phoneNumbers$=this._selectNumberDialogService.phoneNumbers$,this.processingNumber$=this._selectNumberDialogService.processingNumber$,this.selectedPhoneNumbers$=this._selectNumberDialogService.selectedPhoneNumbers$,this.selectedPhoneNumbersTotal$=this._selectNumberDialogService.selectedPhoneNumbersTotal$,this.isNumbersEmptyBySearch$=new In$1(false),this.onChangeContent$=new X,this.isMobile$=this._breakpointObserver.observe("(max-width: 992px)").pipe(le(e=>e.matches)),this.errorsMap=new Map([[ue.NO_INTERNET,{title:"\u041D\u0435\u0442 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F \u043A\xA0\u0441\u0435\u0442\u0438",description:"\u041F\u0440\u043E\u0432\u0435\u0440\u044C \u0441\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435 \u0438\xA0\u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439 \u0435\u0449\u0435\xA0\u0440\u0430\u0437",hideControls:true,button:{text:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C",action:()=>this._selectNumberDialogService.fetchNumbers()}}],[ue.NO_INTERNET_TECHNICAL,{title:"\u041F\u043E\u043A\u0430 \u0432\u044B\u0431\u043E\u0440 \u043D\u043E\u043C\u0435\u0440\u043E\u0432 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D \u043F\u043E \u0442\u0435\u0445\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u043C \u043F\u0440\u0438\u0447\u0438\u043D\u0430\u043C.",description:"\u0422\u044B \u043C\u043E\u0436\u0435\u0448\u044C \u0437\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u0438\u043C-\u043A\u0430\u0440\u0442\u0443 \u0438 \u043F\u043E\u0441\u043B\u0435 \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0441\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440 \u043D\u0430 \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u0432 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u043E\u043C \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0438.",hideControls:true,button:{text:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",action:()=>this._selectNumberDialogService.fetchNumbers()},buttonSecondary:{text:this.config.buttonOrder?.text||"\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C",action:()=>{this._analyticsService.pushDataLayer({event:E.ECOMMERCE,event_param:`\u041F\u043E\u043A\u0430 \u0432\u044B\u0431\u043E\u0440 \u043D\u043E\u043C\u0435\u0440\u043E\u0432 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D \u043F\u043E \u0442\u0435\u0445\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u043C \u043F\u0440\u0438\u0447\u0438\u043D\u0430\u043C. / ${this.config.buttonOrder?.text||"\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C"}`},O$1.SELECT_NUMBER_DIALOG_TECHNICAL_ERROR_CLICK_BUTTON),this._router.navigate([this.config.buttonOrder?.href||"voice/order-sim"]);}}}],[ue.NUMBERS_EXPIRED,{title:"\u0412\u0440\u0435\u043C\u044F \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u043E",description:"\u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u044B \u0438\u0437\xA0\u0442\u0432\u043E\u0435\u0433\u043E \u0441\u043F\u0438\u0441\u043A\u0430. \u0422\u044B \u043C\u043E\u0436\u0435\u0448\u044C \u043E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437 \u0431\u0435\u0437\xA0\u043D\u0438\u0445 \u0438\u043B\u0438\xA0\u0432\u044B\u0431\u0440\u0430\u0442\u044C \u0434\u0440\u0443\u0433\u0438\u0435",hideControls:true,button:{text:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0435\u0449\u0435",action:()=>{this._selectNumberDialogService.continueSelectAfterDateExpired(),this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:"\u0412\u0440\u0435\u043C\u044F \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u043E / \u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0435\u0449\u0435"},O$1.SELECT_NUMBER_DIALOG_COMMON_ERROR_CLICK_BUTTON);}},buttonSecondary:{text:"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437",action:()=>{this._selectNumberDialogService.reset(),this._selectNumberDialogService.closeDialog(Nt.ERROR_BUTTON),this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:"\u0412\u0440\u0435\u043C\u044F \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u043E / \u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437"},O$1.SELECT_NUMBER_DIALOG_COMMON_ERROR_CLICK_BUTTON);}}}],[ue.NO_NUMBERS_BY_SEARCH,{svgIcon:"fail-cat",description:'\u0421\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C. \u041D\u0430\u0436\u043C\u0438 \u043A\u043D\u043E\u043F\u043A\u0443,<br class="g-hidden-mobile"/> \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A',hideControls:false,buttonSecondary:{text:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0440\u0443\u0433\u0438\u0435 \u043D\u043E\u043C\u0435\u0440\u0430",action:()=>{this.loadMoreNumbers(),this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:"\u0421\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C. \u041D\u0430\u0436\u043C\u0438 \u043A\u043D\u043E\u043F\u043A\u0443, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A / \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0440\u0443\u0433\u0438\u0435 \u043D\u043E\u043C\u0435\u0440\u0430"},O$1.SELECT_NUMBER_DIALOG_CLICK_LOAD_MORE_BY_ERROR);},canDisable:true,hideOnMobile:true}}],[ue.NO_NUMBERS_BY_CATEGORY,{svgIcon:"fail-bottle",title:"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E",description:"\u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E \u0438\u043B\u0438\xA0\u0432\u0432\u0435\u0434\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0446\u0438\u0444\u0440\u044B",hideControls:false}]]),this.captchaAnswer=null,this.showCaptcha$=this._selectNumberDialogService.showCaptcha$,this.wrongCaptcha$=new In$1(false),this.pendingCaptcha$=new In$1(false),this._error$=this._selectNumberDialogService.error$.pipe(Au(),le(e=>{if(!e)return this.isNumbersEmptyBySearch$.next(false),{state:"no-error"};e===ue.NO_NUMBERS_BY_SEARCH&&this.isNumbersEmptyBySearch$.next(true);let t=this.errorsMap.get(e);return {state:t?.hideControls?"dialog-error":"data-error",data:t}})),this.isNumbersNotEmpty$=Gh([this.isMobile$,this.isNumbersEmptyBySearch$]).pipe(le(([e,t])=>e&&!t));}ngOnInit(){this.isMobile$.pipe(Nu(10),Hu(()=>this.onChangeContent$.next()),Vu(this._onDestroy$)).subscribe(e=>{e?(this.expandNumbers=false,this.config.radioMode?this._bottomSheetService.openFull():this._bottomSheetService.openMin()):this._bottomSheetService.hide();}),this.getCaptcha$=this.config.captcha$(),this.showCaptcha$.pipe(ot(()=>!this._captchaDialogRef||this._captchaDialogRef.getState()!==0),Vu(this._onDestroy$)).subscribe(e=>{this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:this.captchaTitle},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_OPEN),this.openCaptchaDialog(e);}),this.selectedPhoneNumbers$.pipe(Vu(this._onDestroy$)).subscribe(e=>{this.selectedNumbers=e.map(t=>t.value);}),this.categories$.pipe(Vu(this._onDestroy$)).subscribe(e=>{this.selectedCategoryNames=e.filter(t=>t.selected).map(t=>t.name);}),this._selectNumberDialogService.error$.pipe(ot(Boolean),Au(),Vu(this._onDestroy$)).subscribe(e=>{let t=this.errorsMap.get(e);if(t)switch(e){case ue.NO_NUMBERS_BY_CATEGORY:case ue.NO_NUMBERS_BY_SEARCH:{let n=[t?.title,t?.description,this.selectedCategoryNames.join(", ")];this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:n.filter(Boolean).map(this._stripHtmlTagsPipe.transform).join(" / ")},O$1.SELECT_NUMBER_DIALOG_SEARCH_ERROR);}break;case ue.NO_INTERNET:case ue.NUMBERS_EXPIRED:this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:t?.title},O$1.SELECT_NUMBER_DIALOG_COMMON_ERROR);break;case ue.NO_INTERNET_TECHNICAL:this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:t?.title},O$1.SELECT_NUMBER_DIALOG_TECHNICAL_ERROR);break;}}),this._error$.pipe(Vu(this._onDestroy$)).subscribe(e=>{this.error=e;});}ngAfterViewInit(){this.loading$.pipe(ot(t=>!t),Et(1),Nu(1),Ie(()=>Gh([this.scrollableList?this.scrollableList.scrollDirection$.pipe(ot(t=>t==="down")):Vh(false),this.isMobile$.pipe(ot(Boolean))]).pipe(Et(1)))).subscribe(()=>{this.openBottomSheetFull();}),Gh([this.categories$,this.selectedPhoneNumbers$,this._selectNumberDialogService.searchControl.valueChanges.pipe(Lu(""))]).pipe(Nu(1),Vu(this._onDestroy$)).subscribe(()=>{this.onChangeContent$.next();}),this.pending$.pipe(Vu(this._onDestroy$)).subscribe(t=>{t?this.searchControl.disable({emitEvent:false}):this.searchControl.enable({emitEvent:false});});let e=R$1()?.name==="safari";this.contentDynamicStyles$=Gh([this.loading$,this._error$,this.isMobile$,this.config.isDialog?this.bottomSheet.visibleHeight$:Vh(0),this.config.isDialog?this.bottomSheet.isSwiping$:Vh(false)]).pipe(le(([t,n,o,p,m])=>`
                        height: ${t||n.state==="dialog-error"?"100%":e?"auto":"fit-content"};
                        max-height: ${o?`calc(100% - ${p}px - 32px - ${this.searchControl.value?"64px":"0px"})`:"100%"};
                        min-height: ${t&&!this.config.isDialog&&o?240:0}px;
                        transition: ${m?"none":`max-height ${this.animationSpeed}ms ease`};
                    `)),this._cdr.detectChanges(),this._selectNumberDialogService.popupCancelledTemplate=this.popupCancelledTemplate;}toggleCategory(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`${e.name} / ${e.selected?"\u0412\u044B\u043A\u043B":"\u0412\u043A\u043B"}`},O$1.SELECT_NUMBER_DIALOG_CLICK_CHIP),this._selectNumberDialogService.toggleCategory(e.value);}toggleNumber(e,t=false){if(!t){let n=this._selectNumberDialogService.selectedPhoneNumbers,o=`${e.category} / \u0412\u043A\u043B / ${n.length+1}`;n.some(p=>p.value===e.value)&&(o=`${e.category} / \u0412\u044B\u043A\u043B / ${n.length-1}`),this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:o},O$1.SELECT_NUMBER_DIALOG_CLICK_NUMBER);}this._selectNumberDialogService.toggleNumber(e);}toggleExpandNumbers(){this.expandNumbers=!this.expandNumbers,this.onChangeContent$.next();}loadMoreNumbers(){this._breakpointObserver.isMatched(["(max-width: 992px)"])&&this._bottomSheetService.openMin(),this.expandNumbers&&this.toggleExpandNumbers(),this._selectNumberDialogService.loadMoreNumbers();}onClickClose(){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`${this.config.title} / \u041A\u0440\u0435\u0441\u0442\u0438\u043A`},O$1.SELECT_NUMBER_DIALOG_CLOSE_MANUAL),this._selectNumberDialogService.closeDialog(Nt.CROSS_BUTTON);}onClickUpButton(){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:"\u0421\u0442\u0440\u0435\u043B\u043A\u0430 \u0432\u0432\u0435\u0440\u0445"},O$1.SELECT_NUMBER_DIALOG_CLICK_UP_BUTTON),this.scrollableList?.scrollToTop();}onClickNumberInCart(e){this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440 / ${this._selectNumberDialogService.selectedPhoneNumbersLength-1}`},O$1.SELECT_NUMBER_DIALOG_DELETE_FROM_CART),this.toggleNumber(e,true);}_sendConfirmBeautifulNumbersAnalytics(e="\u0412\u044B\u0431\u0440\u0430\u0442\u044C"){Gh([this.selectedPhoneNumbers$,this.selectedPhoneNumbersTotal$]).pipe(Vu(this._onDestroy$)).subscribe(([t,n])=>{this._orderAnalyticsService.onConfirmBeautifulNumbers(n,t.length,e,this._orderDataService.orderMetaInfo$.value);});}onClickOrderButton(){if(this.config.isDialog){this._selectNumberDialogService.closeDialog(Nt.CONFIRM_BUTTON);return}else this._sendConfirmBeautifulNumbersAnalytics();this._router.navigate([this.config.buttonOrder?.href||"voice/order-sim"]);}onFocusSearch(){this._bottomSheetService.hide();}onBlurSearch(){this._breakpointObserver.isMatched(["(max-width: 992px)"])&&(this.config.radioMode?this._bottomSheetService.openFull():this._bottomSheetService.openMin(),this.isNumbersEmptyBySearch$.value&&this.loadMoreNumbers());}onEnter(e){if(e.key==="Enter"&&this.searchControl.value&&!this.loadMoreDisabled$.value){e.preventDefault();let t=e.target;this.loadMoreNumbers(),this.pending$.pipe(ot(n=>!n),Et(1),Vu(this._onDestroy$)).subscribe(()=>{t.focus();});}}openBottomSheetFull(){this._bottomSheetService.openFull();}handleCaptcha(e){this.captchaAnswer=e;}confirmCaptcha(){!this.captchaAnswer?.answer||this.pendingCaptcha$.value||(this.wrongCaptcha$.next(false),this.pendingCaptcha$.next(true),this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C"},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_CONFIRM),this.config.captchaCheck$({answer:this.captchaAnswer.answer,id:this.captchaAnswer.id}).pipe(Et(1),Ru(()=>{this.pendingCaptcha$.next(false);}),Pi$1(e=>{switch(e.error.code||JSON.parse(e.error).code){case 110417:this.wrongCaptcha$.next(true),this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:"\u041A\u0430\u043F\u0447\u0430 \u0432\u0432\u0435\u0434\u0435\u043D\u0430 \u043D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E"},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_FAILED);break}return rg(()=>e)})).subscribe(()=>{this._captchaDialogRef?.close(true);}));}openCaptchaDialog(e){this._captchaDialogRef=this._dialogService.open(this.captchaDialog,{panelClass:"y-dialog-captcha",backdropClass:"y-dialog-backdrop-blurred",disableClose:true,width:"calc(100% - 40px)",maxWidth:"568px",hasBackdrop:true}),this._captchaDialogRef.backdropClick().pipe(Et(1)).subscribe(()=>{this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`${this.captchaTitle} / \u0412\u043D\u0435\u0448\u043D\u0438\u0439 \u043A\u043B\u0438\u043A`},O$1.SELECT_NUMBER_DIALOG_CAPTCHA_CLOSE),this._captchaDialogRef?.close();}),this._captchaDialogRef.afterClosed().pipe(Et(1),ot(Boolean)).subscribe(()=>{e&&e();});}closeCaptchaDialog(){this._captchaDialogRef?.close(),this._captchaDialogRef=void 0;}static{this.\u0275fac=(()=>{let e;return function(n){return (e||(e=kR(i)))(n||i)}})();}static{this.\u0275cmp=lO({type:i,selectors:[["yota-select-number-dialog"]],viewQuery:function(t,n){if(t&1&&(MO(Vo,7),MO(Uo,5),MO(Go,5),MO(Ho,5,Ye$1)),t&2){let o;TO(o=SO())&&(n.popupCancelledTemplate=o.first),TO(o=SO())&&(n.scrollableList=o.first),TO(o=SO())&&(n.bottomSheet=o.first),TO(o=SO())&&(n.captchaDialog=o.first);}},features:[PO([n$1]),_I],decls:28,vars:29,consts:[["cart",""],["orderNumberButton",""],["loadMoreNumbersButton",""],["popupCancelled",""],["errorTemplate",""],["captchaDialog",""],["inputRef","yInput"],["scrollableList","yotaHasScroll"],["bottomSheet",""],[1,"select-number-dialog"],["class","select-number-dialog__close","svgIcon","close-light",3,"click",4,"ngIf"],[1,"select-number-dialog__title"],[1,"select-number-dialog__content"],[4,"ngIf"],["class","select-number-dialog__loader",3,"strokeWidth","diameter",4,"ngIf"],["class","select-number-dialog__load-more-wrapper",4,"ngIf"],[3,"contentChanged$","animationSpeed",4,"ngIf"],["svgIcon","close-light",1,"select-number-dialog__close",3,"click"],["class","select-number-dialog__error-wrapper",4,"ngIf"],[1,"select-number-dialog__error-wrapper"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"select-number-dialog__search"],["yPrefix","",3,"svgIcon"],["yInput","","type","tel",3,"focus","blur","keydown","formControl","unmask","imask"],["ySuffix","",3,"state","inputControl","clear",4,"ngIf"],[1,"select-number-dialog__container"],["class","select-number-dialog__chips",3,"collapsed",4,"ngIf"],["ySuffix","",3,"clear","state","inputControl"],[1,"select-number-dialog__chips"],["class","select-number-dialog__chip",3,"selected","click",4,"ngFor","ngForOf"],[1,"select-number-dialog__chip",3,"click"],["class","select-number-dialog__list","yotaHasScroll","",3,"show-more","gap","sizeChangeSubject$",4,"ngIf"],["yotaHasScroll","",1,"select-number-dialog__list",3,"gap","sizeChangeSubject$"],["class","select-number-dialog__number",3,"selected","processing","disabled","click",4,"ngFor","ngForOf"],["class","select-number-dialog__up-wrapper",4,"ngIf"],[1,"select-number-dialog__number",3,"click"],[1,"select-number-dialog__number-checkbox"],[1,"select-number-dialog__number-value",3,"innerHTML"],[1,"select-number-dialog__number-price"],[4,"ngTemplateOutlet"],[1,"select-number-dialog__up-wrapper"],["class","select-number-dialog__up",3,"click",4,"ngIf"],[1,"select-number-dialog__up",3,"click"],[3,"svgIcon"],[1,"select-number-dialog__loader",3,"strokeWidth","diameter"],[1,"select-number-dialog__load-more-wrapper"],[3,"contentChanged$","animationSpeed"],["hiding","",4,"ngIf"],["hiding",""],[1,"select-number-dialog__cart"],[1,"select-number-dialog__cart-title"],["class","select-number-dialog__cart-description",4,"ngIf"],["class","select-number-dialog__cart-numbers",3,"expanded",4,"ngIf"],["class","select-number-dialog__cart-more","yotaAnalytics","","trackOn","click",3,"expanded","params","action","click",4,"ngIf"],["class","select-number-dialog__cart-price",4,"ngIf"],[1,"select-number-dialog__cart-description"],[1,"select-number-dialog__cart-numbers"],["class","select-number-dialog__cart-number",4,"ngFor","ngForOf"],[1,"select-number-dialog__cart-number"],[1,"select-number-dialog__cart-remove",3,"click"],["yotaAnalytics","","trackOn","click",1,"select-number-dialog__cart-more",3,"click","params","action"],[1,"select-number-dialog__cart-price"],["y-button","","type","button",1,"select-number-dialog__cart-button",3,"click","disabled","tabIndex"],["y-button-secondary","","type","button","yotaAnalytics","","trackOn","click",1,"select-number-dialog__load-more-button",3,"click","disabled","params","action"],["yotaAnalytics","","trackOn","click",1,"y-link-pseudo",3,"click","params","action"],[1,"select-number-dialog__error"],[1,"select-number-dialog__error-image",3,"svgIcon"],["class","select-number-dialog__error-title",4,"ngIf"],[1,"select-number-dialog__error-description",3,"innerHTML"],["class","select-number-dialog__error-button","y-button","",3,"click",4,"ngIf"],["class","select-number-dialog__error-button select-number-dialog__error-button-secondary","y-button-secondary","",3,"disabled","click",4,"ngIf"],[1,"select-number-dialog__error-title"],["y-button","",1,"select-number-dialog__error-button",3,"click"],["y-button-secondary","",1,"select-number-dialog__error-button","select-number-dialog__error-button-secondary",3,"click","disabled"],[1,"select-number-dialog__captcha"],["svgIcon","close-light","yotaAnalytics","","trackOn","click",1,"select-number-dialog__captcha-close",3,"click","params","action"],[1,"select-number-dialog__captcha-container",3,"submit"],[1,"select-number-dialog__captcha-title"],[1,"select-number-dialog__captcha-captcha",3,"valueChange","getCaptcha$","wrongCaptcha","pending$"],["class","select-number-dialog__captcha-spinner_captcha",3,"diameter","strokeWidth",4,"ngIf"],["type","submit",1,"y-button","select-number-dialog__captcha-button",3,"click","disabled"],["yotaAnalytics","","trackOn","click",1,"y-link-pseudo","select-number-dialog__captcha-cancel",3,"click","params","action"],[1,"select-number-dialog__captcha-spinner_captcha",3,"diameter","strokeWidth"]],template:function(t,n){t&1&&(kp(0,"div",9),$O(1,"async"),kI(2,Ko,1,0,"y-icon",10),kp(3,"h3",11),RO(4),Pp(),kp(5,"div",12),$O(6,"async"),kI(7,ua,3,2,"ng-container",13),$O(8,"async"),kI(9,ma,1,2,"y-spinner",14),$O(10,"async"),Pp(),kI(11,_a,2,1,"div",15),$O(12,"async"),kI(13,ga,2,3,"ng-container",13),$O(14,"async"),Pp(),kI(15,ba,4,6,"yota-bottom-sheet",16)(16,Ia,10,16,"ng-template",null,0,qO)(18,Pa,4,7,"ng-template",null,1,qO)(20,wa,5,11,"ng-template",null,2,qO)(22,Na,3,4,"ng-template",null,3,qO)(24,Ra,6,7,"ng-template",null,4,qO)(26,Fa,14,22,"ng-template",null,5,qO)),t&2&&(sE("pending",UO(1,17,n.pending$))("inline",!n.config.isDialog)("hide-controls",n.error.data==null?null:n.error.data.hideControls)("radio-mode",n.config.radioMode),QR(2),iE("ngIf",n.config.isDialog),QR(2),VE(n.config.title),QR(),hO(UO(6,19,n.contentDynamicStyles$)),QR(2),iE("ngIf",UO(8,21,n.loading$)===false),QR(2),iE("ngIf",UO(10,23,n.loading$)),QR(2),iE("ngIf",n.searchControl.value&&!!UO(12,25,n.isNumbersNotEmpty$)),QR(2),iE("ngIf",n.config.isDialog&&UO(14,27,n.isMobile$)===false||!n.config.isDialog&&!(n.error.data!=null&&n.error.data.hideControls)),QR(2),iE("ngIf",n.config.isDialog));},dependencies:[Ww,Yw,An,Dn$1,Ge,yn,Cn,St$1,Mn$1,Tt,It$1,x$1,Dh,m,Sn,d,xn,Jw,ur$1,Ba,zt,gd,Ty,ql,cn,ar$1,hd],styles:['[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-wrapper{padding-bottom:0}[_nghost-%COMP%]     .y-form-field-bordered .y-form-field-bordered-subscript-wrapper{display:none}[_nghost-%COMP%]     .select-number-dialog__search.y-form-field-bordered-disabled .y-icon svg path{fill:#ceced5}[_nghost-%COMP%]     .select-number-dialog__search.y-form-field-bordered-disabled .y-form-field-bordered-label{transition:none}[_nghost-%COMP%]     .select-number-dialog__cart-remove:hover .y-icon svg path{fill:#f65252}[_nghost-%COMP%]     .select-number-dialog__up .y-icon svg path{fill:#fff}[_nghost-%COMP%]     .pending .select-number-dialog__chip, [_nghost-%COMP%]     .pending .select-number-dialog__chip.selected{background:#eaeef4;color:#ceced5;cursor:default}[_nghost-%COMP%]     .pending .select-number-dialog__cart-title, [_nghost-%COMP%]     .pending .select-number-dialog__cart-number, [_nghost-%COMP%]     .pending .select-number-dialog__cart-price{color:#758494;cursor:default}[_nghost-%COMP%]     .pending .select-number-dialog__cart-remove{color:#ceced5;cursor:default}[_nghost-%COMP%]     .pending .select-number-dialog__cart-remove:hover span{display:none!important}[_nghost-%COMP%]     .pending .select-number-dialog__cart-remove .y-icon svg path{fill:#ceced5}[_nghost-%COMP%]     .pending .select-number-dialog__cart-more{color:#ceced5}[_nghost-%COMP%]     .pending .select-number-dialog__cart-more:after{background:#ceced5}@media (max-width: 767px){[_nghost-%COMP%]     yota-popup{margin-inline:0}}.select-number-dialog[_ngcontent-%COMP%]{border-radius:24px;background-color:#f7f8fa;padding:40px;width:100%;height:100%;margin-inline:auto;position:relative;display:grid;grid-template-areas:"title title" "content cart";grid-template-columns:1fr 372px;grid-template-rows:auto 1fr;gap:24px}.select-number-dialog.inline[_ngcontent-%COMP%]{row-gap:40px}.select-number-dialog.inline.hide-controls[_ngcontent-%COMP%]{grid-template-areas:"title" "content";grid-template-columns:1fr;grid-template-rows:1fr minmax(452px,auto)}@media (max-width: 576px){.select-number-dialog.inline.hide-controls[_ngcontent-%COMP%]{grid-template-rows:1fr minmax(480px,auto)}}.select-number-dialog__close[_ngcontent-%COMP%]{width:32px;height:32px;position:absolute;top:32px;right:40px;cursor:pointer}.select-number-dialog__title[_ngcontent-%COMP%]{grid-area:title;font-size:36px;line-height:46px;font-weight:600}.inline[_ngcontent-%COMP%]   .select-number-dialog__title[_ngcontent-%COMP%]{text-align:center;font-size:56px;line-height:62px;font-weight:600}.select-number-dialog[_ngcontent-%COMP%]   .select-number-dialog__load-more-button[_ngcontent-%COMP%]{margin:12px auto 0;max-width:fit-content;min-height:initial;width:auto;padding:10px 30px;text-transform:none;background-color:transparent;transition:none;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog[_ngcontent-%COMP%]   .select-number-dialog__load-more-button[_ngcontent-%COMP%]:not(:disabled):hover{background-color:transparent;color:#00aeef}.select-number-dialog__content[_ngcontent-%COMP%]{grid-area:content;background-color:#fff;display:flex;flex-direction:column;padding:24px 0 16px;border-radius:20px;position:relative;overflow:hidden}.safari[_ngcontent-%COMP%]   .select-number-dialog__content[_ngcontent-%COMP%]{height:auto!important}.inline[_ngcontent-%COMP%]   .select-number-dialog__content[_ngcontent-%COMP%]{max-height:596px!important}.inline.hide-controls[_ngcontent-%COMP%]   .select-number-dialog__content[_ngcontent-%COMP%]{background-color:transparent;padding-top:0}.select-number-dialog__load-more-wrapper[_ngcontent-%COMP%]{width:100%}.select-number-dialog__load-more-wrapper[_ngcontent-%COMP%]   .select-number-dialog__load-more-button[_ngcontent-%COMP%]{width:100%;max-width:initial;padding-block:13px;margin-top:0}.select-number-dialog__up[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:7px;background:#00aeef;border-radius:50%;width:fit-content;cursor:pointer;position:absolute;right:0;bottom:0}.select-number-dialog__up-wrapper[_ngcontent-%COMP%]{position:sticky;left:calc(100% - 8px);bottom:0}.select-number-dialog__up[_ngcontent-%COMP%]   .y-icon[_ngcontent-%COMP%]{width:16px;height:16px}.select-number-dialog__search[_ngcontent-%COMP%]{margin-inline:24px;width:auto}.select-number-dialog__container[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr;height:100%;row-gap:24px;padding-inline:24px;overflow:hidden}.radio-mode[_ngcontent-%COMP%]   .select-number-dialog__container[_ngcontent-%COMP%]{margin-top:24px;row-gap:0}.select-number-dialog__chips[_ngcontent-%COMP%]{display:flex;column-gap:8px;margin-top:20px;overflow:auto hidden;scroll-snap-type:x mandatory;scroll-padding-left:16px;scrollbar-width:none;-ms-overflow-style:none}.select-number-dialog__chips[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#00aeef}.select-number-dialog__chips[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:4px;background:#eaeef4}.select-number-dialog__chips[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.select-number-dialog__chip[_ngcontent-%COMP%]{background-color:#e5f7fd;border-radius:24px;padding:7px 12px;white-space:nowrap;height:fit-content;-webkit-user-select:none;user-select:none;overflow:hidden;min-width:min-content;cursor:pointer;transition:all .15s linear;scroll-snap-stop:always;scroll-snap-align:start;font-size:14px;line-height:18px;font-weight:500}.select-number-dialog__chip.selected[_ngcontent-%COMP%]{color:#fff;background-color:#00aeef}.select-number-dialog__list[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;position:relative;width:calc(100% + 10px);padding-right:10px;padding-bottom:2px}.select-number-dialog__list.has-scrollbar[_ngcontent-%COMP%]{width:calc(100% + 14px)}.select-number-dialog__list[_ngcontent-%COMP%]::-webkit-scrollbar{transition:all .2s linear;width:4px}.select-number-dialog__list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;border:none;background:#00aeef;transition:all .2s linear}.select-number-dialog__list[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:4px;background:#eaeef4;transition:all .2s linear}.select-number-dialog__list.show-more[_ngcontent-%COMP%]   .select-number-dialog__list-more[_ngcontent-%COMP%]{display:flex}.select-number-dialog__number[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;width:100%;border-top:1px solid #eaeef4;padding:16px 8px;column-gap:16px;align-items:center;transition:all linear .2s}.select-number-dialog__number-checkbox[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid #ceced5;background:transparent;border-radius:6px;position:relative;display:flex;align-items:center;justify-content:center;overflow:hidden;cursor:pointer;transition:all linear .2s}.select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{content:url("./media/check-bold-QFDFVZLZ.svg");transform:translate(40px);height:16px;width:16px;transition:all linear .2s}.radio-mode[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{border-radius:50%}.radio-mode[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{content:initial}.select-number-dialog__number-value[_ngcontent-%COMP%]{text-align:left;white-space:nowrap;font-size:16px;line-height:24px;font-weight:400}.select-number-dialog__number-price[_ngcontent-%COMP%]{font-size:16px;line-height:22px;font-weight:600}.select-number-dialog__number.selected[_ngcontent-%COMP%]{background:#e5f7fd}.select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#00aeef;border-color:#00aeef}.select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]:before{transform:translate(0)}.radio-mode[_ngcontent-%COMP%]   .select-number-dialog__number.selected[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#fff;border-width:6px}.select-number-dialog__number.disabled[_ngcontent-%COMP%]{color:#758494}.select-number-dialog__number.disabled[_ngcontent-%COMP%]   .select-number-dialog__number-checkbox[_ngcontent-%COMP%]{background:#eaeef4;border-color:#ceced5;cursor:not-allowed}.select-number-dialog__number.processing[_ngcontent-%COMP%]{background:#e5f7fd}.select-number-dialog__number.processing.selected[_ngcontent-%COMP%]{background:transparent}.select-number-dialog__loader[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.select-number-dialog__cart[_ngcontent-%COMP%]{grid-area:cart;background-color:#fff;display:flex;flex-direction:column;padding:24px;border-radius:20px;height:fit-content}.select-number-dialog__cart-title[_ngcontent-%COMP%]{font-size:16px;line-height:22px;font-weight:600}.select-number-dialog__cart-description[_ngcontent-%COMP%]{margin-top:8px;color:#758494;font-size:16px;line-height:24px;font-weight:400}.select-number-dialog__cart-button[_ngcontent-%COMP%]{margin-top:24px;text-transform:none;min-height:initial;max-width:initial;width:100%;padding-block:13px;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog__cart-numbers[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:8px;margin-top:8px}.select-number-dialog__cart-more[_ngcontent-%COMP%]{display:none;align-items:center;column-gap:2px;color:#00aeef;margin-top:8px;cursor:pointer;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog__cart-more[_ngcontent-%COMP%]:after{width:24px;height:24px;content:"";-webkit-mask:url("./media/arrow-outline-VU4W557N.svg") no-repeat 50% 50%;mask:url("./media/arrow-outline-VU4W557N.svg") no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover;background-color:#00aeef;transform:rotate(180deg)}.select-number-dialog__cart-more.expanded[_ngcontent-%COMP%]:after{transform:rotate(0)}.select-number-dialog__cart-number[_ngcontent-%COMP%]{display:grid;grid-template-columns:136px auto;column-gap:8px;align-items:center;white-space:nowrap;width:fit-content;font-size:16px;line-height:22px;font-weight:600}.select-number-dialog__cart-remove[_ngcontent-%COMP%]{display:flex;column-gap:4px;align-items:center;cursor:pointer;font-size:12px;line-height:14px;font-weight:400}.select-number-dialog__cart-remove[_ngcontent-%COMP%]   .y-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.select-number-dialog__cart-remove[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.select-number-dialog__cart-remove[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{display:initial;color:#f65252}.select-number-dialog__cart-price[_ngcontent-%COMP%]{margin-top:24px;font-size:32px;line-height:42px;font-weight:600}.select-number-dialog__error[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:64px 32px}.inline.hide-controls[_ngcontent-%COMP%]   .select-number-dialog__error[_ngcontent-%COMP%]{padding:0}.select-number-dialog__error-wrapper[_ngcontent-%COMP%]{max-width:428px;width:100%;margin-inline:auto}.inline[_ngcontent-%COMP%]   .select-number-dialog__error-wrapper[_ngcontent-%COMP%]{max-width:initial}.select-number-dialog__error-image[_ngcontent-%COMP%]{width:232px;height:232px}.inline[_ngcontent-%COMP%]   .select-number-dialog__error-image[_ngcontent-%COMP%]{width:224px;height:224px;margin-bottom:8px}.select-number-dialog__error-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:8px;font-size:24px;line-height:30px;font-weight:600}.select-number-dialog__error-description[_ngcontent-%COMP%]{text-align:center;font-size:16px;line-height:18px;font-weight:400}.select-number-dialog__error-button[_ngcontent-%COMP%]{margin-top:24px;text-transform:none;min-height:initial;max-width:324px;width:100%;padding-block:10px;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog__error-button-secondary[_ngcontent-%COMP%]{margin-top:8px}.select-number-dialog__error-button-secondary[_ngcontent-%COMP%]:hover:not([disabled]):not([processing]){background-color:#fff;color:#00aeef}.select-number-dialog__error-description[_ngcontent-%COMP%] + .select-number-dialog__error-button-secondary[_ngcontent-%COMP%]{--btn-height: 42px;width:auto;margin-top:16px;min-height:var(--btn-height);height:var(--btn-height)}@media (max-width: 992px){.select-number-dialog__error-description[_ngcontent-%COMP%] + .select-number-dialog__error-button-secondary[_ngcontent-%COMP%]{--btn-height: 40px;width:100%;margin-top:12px}}.select-number-dialog__container[_ngcontent-%COMP%]   .select-number-dialog__error[_ngcontent-%COMP%]{padding-block:0;margin-bottom:8px}.select-number-dialog__container[_ngcontent-%COMP%]   .select-number-dialog__error-image[_ngcontent-%COMP%]{width:130px;height:130px}.inline[_ngcontent-%COMP%]   .select-number-dialog__container[_ngcontent-%COMP%]   .select-number-dialog__error-image[_ngcontent-%COMP%]{width:224px;height:224px}.select-number-dialog__container[_ngcontent-%COMP%]   .select-number-dialog__error-description[_ngcontent-%COMP%]{margin-top:4px;color:#434c5e;font-size:16px;line-height:24px;font-weight:400}.select-number-dialog__error-title[_ngcontent-%COMP%] + .select-number-dialog__error-description[_ngcontent-%COMP%]{color:#758494}.select-number-dialog__captcha[_ngcontent-%COMP%]{width:100%;max-width:568px;min-height:322px;display:flex;flex-direction:column;row-gap:16px}.select-number-dialog__captcha-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:24px}.select-number-dialog__captcha-spinner_captcha[_ngcontent-%COMP%]{position:absolute;bottom:16px;left:0;right:0;margin-inline:auto}.select-number-dialog__captcha-close[_ngcontent-%COMP%]{width:24px;height:24px;align-self:flex-end;cursor:pointer}.select-number-dialog__captcha-cancel[_ngcontent-%COMP%]{margin-top:16px;padding:15px 32px;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog__captcha-button[_ngcontent-%COMP%]{border:none;height:auto;width:auto;min-height:initial;min-width:initial;padding:15px 32px;text-transform:initial;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog__captcha-button[_ngcontent-%COMP%]:disabled{background-color:#ceced5}.select-number-dialog__captcha-captcha[_ngcontent-%COMP%]{margin-top:16px}.select-number-dialog__captcha-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;line-height:30px;font-weight:600}@media (max-width: 768px){.select-number-dialog__captcha[_ngcontent-%COMP%]{width:100%}.select-number-dialog__captcha-container[_ngcontent-%COMP%]{padding:24px 0}.select-number-dialog__captcha-title[_ngcontent-%COMP%]{font-size:18px;line-height:24px;font-weight:600}}@media (max-width: 1440px){.select-number-dialog[_ngcontent-%COMP%]{padding-inline:24px}}@media (max-width: 1248px){.select-number-dialog[_ngcontent-%COMP%]{padding:24px;width:auto}.select-number-dialog.inline[_ngcontent-%COMP%]{width:100%}.select-number-dialog__close[_ngcontent-%COMP%]{top:24px;right:24px}.select-number-dialog__title[_ngcontent-%COMP%]{font-size:32px;line-height:32px;font-weight:600}.inline[_ngcontent-%COMP%]   .select-number-dialog__title[_ngcontent-%COMP%]{font-size:44px;line-height:50px;font-weight:600}}@media (max-width: 992px){.select-number-dialog[_ngcontent-%COMP%]{margin:0;max-height:100%;border-radius:0;background-color:#eaeef4;display:flex;flex-direction:column;row-gap:16px;padding:24px 16px;overflow:hidden}.select-number-dialog.inline[_ngcontent-%COMP%]{border-radius:20px;padding:40px 42px;background-color:#f7f8fa;row-gap:12px}.select-number-dialog.inline.hide-controls[_ngcontent-%COMP%]{display:grid}.select-number-dialog__close[_ngcontent-%COMP%]{width:24px;height:24px;top:24px;right:16px}.select-number-dialog__title[_ngcontent-%COMP%]{font-size:18px;line-height:24px;font-weight:600}.inline[_ngcontent-%COMP%]   .select-number-dialog__title[_ngcontent-%COMP%]{margin-bottom:28px}.select-number-dialog__content[_ngcontent-%COMP%]{padding-block:12px}.select-number-dialog__up[_ngcontent-%COMP%]{right:16px;bottom:16px}.select-number-dialog__search[_ngcontent-%COMP%]{margin-inline:12px;margin-bottom:16px}.select-number-dialog__container[_ngcontent-%COMP%]{padding-inline:0;row-gap:0}.select-number-dialog__chips[_ngcontent-%COMP%]{padding-inline:12px;margin-block:0 12px;max-height:32px;transition:max-height ease .3s,margin-bottom ease .3s}.select-number-dialog__chips.collapsed[_ngcontent-%COMP%]{padding-block:0;margin-block:0;max-height:0;margin-bottom:0;overflow:hidden}.select-number-dialog__list[_ngcontent-%COMP%]{margin-inline:12px;padding-right:0;width:auto}.select-number-dialog__list.has-scrollbar[_ngcontent-%COMP%]{width:calc(100% - 16px);padding-right:4px;margin-right:4px}.select-number-dialog__list[_ngcontent-%COMP%] > .select-number-dialog__list-more[_ngcontent-%COMP%]{padding:9px 24px}.select-number-dialog__number[_ngcontent-%COMP%]:last-child{border-radius:0 0 8px 8px}.select-number-dialog__cart[_ngcontent-%COMP%]{width:100%;padding:0;margin-bottom:12px}.inline[_ngcontent-%COMP%]   .select-number-dialog__cart[_ngcontent-%COMP%]{padding:24px;margin-bottom:0}.select-number-dialog__cart-title[_ngcontent-%COMP%]{grid-area:title;margin-bottom:4px;font-size:14px;line-height:20px;font-weight:600}.select-number-dialog__cart-description[_ngcontent-%COMP%]{margin-top:0;font-size:12px;line-height:24px;font-weight:400}.select-number-dialog__cart-button[_ngcontent-%COMP%]{margin-block:8px;padding-block:13px;grid-area:order;font-size:14px;line-height:18px;font-weight:600}.inline[_ngcontent-%COMP%]   .select-number-dialog__cart-button[_ngcontent-%COMP%]{margin-block:20px 0}.select-number-dialog__cart-numbers[_ngcontent-%COMP%]{grid-area:numbers;row-gap:4px;margin-block:0;overflow:hidden;max-height:24px}.select-number-dialog__cart-numbers.expanded[_ngcontent-%COMP%]{max-height:152px}.select-number-dialog__cart-more[_ngcontent-%COMP%]{grid-area:more;display:flex;width:fit-content}.select-number-dialog__cart-remove[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{display:none!important}.select-number-dialog__cart-price[_ngcontent-%COMP%]{grid-area:price;align-self:center;margin-top:0;font-size:24px;line-height:32px;font-weight:600}.select-number-dialog__cart.has-numbers[_ngcontent-%COMP%]{display:grid;grid-template-areas:"title price" "numbers price";grid-template-columns:1fr auto}.inline[_ngcontent-%COMP%]   .select-number-dialog__cart.has-numbers[_ngcontent-%COMP%]{grid-template-areas:"title price" "numbers price" "order order"}.select-number-dialog__cart.expandable[_ngcontent-%COMP%]{grid-template-areas:"title price" "numbers price" "more price"}.inline[_ngcontent-%COMP%]   .select-number-dialog__cart.expandable[_ngcontent-%COMP%]{grid-template-areas:"title price" "numbers price" "more price" "order order"}.select-number-dialog__error[_ngcontent-%COMP%]{padding-inline:12px;margin-block:auto}.inline[_ngcontent-%COMP%]   .select-number-dialog__error-wrapper[_ngcontent-%COMP%]{margin-inline:0}.select-number-dialog__error-image[_ngcontent-%COMP%]{width:182px;height:182px;margin-bottom:8px}.select-number-dialog__error-title[_ngcontent-%COMP%]{font-size:18px;line-height:24px;font-weight:600}.select-number-dialog__error-description[_ngcontent-%COMP%]{font-size:16px;line-height:18px;font-weight:400}.select-number-dialog__error-button[_ngcontent-%COMP%]{padding-block:13px;max-width:initial;font-size:14px;line-height:18px;font-weight:600}.select-number-dialog__container[_ngcontent-%COMP%]   .select-number-dialog__error-image[_ngcontent-%COMP%]{width:94px;height:94px}.select-number-dialog__container[_ngcontent-%COMP%]   .select-number-dialog__error.has-title[_ngcontent-%COMP%]   .select-number-dialog__error-image[_ngcontent-%COMP%]{width:180px;height:180px}}@media (max-width: 768px){.select-number-dialog.inline[_ngcontent-%COMP%]{padding:24px 12px;row-gap:16px}.inline[_ngcontent-%COMP%]   .select-number-dialog__title[_ngcontent-%COMP%]{margin-bottom:0;font-size:32px;line-height:40px;font-weight:600}.inline[_ngcontent-%COMP%]   .select-number-dialog__content[_ngcontent-%COMP%]{max-height:656px!important}.select-number-dialog__chips[_ngcontent-%COMP%]{column-gap:4px}.inline[_ngcontent-%COMP%]   .select-number-dialog__cart[_ngcontent-%COMP%]{padding:12px 16px 20px}}'],changeDetection:0});}}return i})();var ue=function(i){return i.NO_INTERNET="NO_INTERNET",i.NO_INTERNET_TECHNICAL="NO_INTERNET_TECHNICAL",i.NUMBERS_EXPIRED="NUMBERS_EXPIRED",i.NO_NUMBERS_BY_SEARCH="NO_NUMBERS_BY_SEARCH",i.NO_NUMBERS_BY_CATEGORY="NO_NUMBERS_BY_CATEGORY",i.EMPTY="EMPTY",i}(ue||{}),A=function(i){return i.LOADING_MORE_NUMBERS="LOADING_MORE_NUMBERS",i.LOADED_MORE_NUMBERS="LOADED_MORE_NUMBERS",i.BOOKING_NUMBER="BOOKING_NUMBER",i.BOOKED_NUMBER="BOOKED_NUMBER",i.CANCELLING_NUMBER="CANCELLING_NUMBER",i.CANCELLED_NUMBER="CANCELLED_NUMBER",i.MAX_COUNT_SELECTED="MAX_COUNT_SELECTED",i.NUMBER_ALREADY_RESERVED="NUMBER_ALREADY_RESERVED",i.NO_MORE_NUMBERS_BY_SEARCH="NO_MORE_NUMBERS_BY_SEARCH",i.NO_MORE_NUMBERS_BY_CATEGORY="NO_MORE_NUMBERS_BY_CATEGORY",i.NO_MORE_NUMBERS_AT_ALL="NO_MORE_NUMBERS_AT_ALL",i.COMMON_ERROR="COMMON_ERROR",i.CANCEL_REMOVE_BY_RADIO_MODE="CANCEL_REMOVE_BY_RADIO_MODE",i}(A||{}),Nt=function(i){return i.CONFIRM_BUTTON="CONFIRM_BUTTON",i.CROSS_BUTTON="CROSS_BUTTON",i.BACKDROP="BACKDROP",i.ERROR_BUTTON="ERROR_BUTTON",i}(Nt||{}),St=class i{constructor(){this._dialogService=I(mr$1),this._popupService=I(ct),this._breakpointObserver=I(U),this._analyticsService=I(O),this.searchControl=new W(""),this.loading$=new In$1(false),this.pending$=new In$1(false),this.loadMoreDisabled$=new In$1(false),this.loadMoreHide$=new In$1(false),this.error$=new In$1(null),this.showCaptcha$=new X,this._currentPopup=null,this._phoneNumbers$=new In$1([]),this._phoneNumbersByMask$=new In$1([]),this._lockId$=new In$1(null),this._expirationLockDate$=new In$1(null),this._regionCodeCcm$=new In$1(null),this._selectedPhoneNumbers$=new In$1([]),this._processingNumber$=new In$1(null),this._categories$=new In$1([]),this._offsetAll$=new In$1(0),this._offsetMask$=new In$1(0),this._searchStamp=null,this.popupsMap=new Map([[A.LOADING_MORE_NUMBERS,{text:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u043D\u043E\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430",svgIcon:"clock-outline-orange",theme:"warning"}],[A.LOADED_MORE_NUMBERS,{text:"\u041D\u043E\u0432\u044B\u0435 \u043D\u043E\u043C\u0435\u0440\u0430 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B",svgIcon:"check-outline",theme:"success"}],[A.BOOKING_NUMBER,{text:"\u0411\u0440\u043E\u043D\u0438\u0440\u0443\u0435\u043C \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",svgIcon:"clock-outline-orange",theme:"warning"}],[A.BOOKED_NUMBER,{text:"\u041D\u043E\u043C\u0435\u0440 \u0437\u0430\u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D \u043D\u0430 60 \u043C\u0438\u043D\u0443\u0442",svgIcon:"check-outline",theme:"success"}],[A.CANCELLING_NUMBER,{text:"\u0423\u0434\u0430\u043B\u044F\u0435\u043C \u043A\u0440\u0430\u0441\u0438\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",svgIcon:"clock-outline-orange",theme:"warning"}],[A.CANCELLED_NUMBER,{svgIcon:"clock-outline-orange",theme:"warning",closeByMouseUp:false}],[A.MAX_COUNT_SELECTED,{svgIcon:"info-outline",theme:"warning"}],[A.NUMBER_ALREADY_RESERVED,{text:"\u042D\u0442\u043E\u0442 \u043D\u043E\u043C\u0435\u0440 \u0443\u0436\u0435 \u043A\u0442\u043E-\u0442\u043E \u0437\u0430\u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043B",svgIcon:"info-outline",theme:"error"}],[A.NO_MORE_NUMBERS_BY_SEARCH,{text:"\u0411\u043E\u043B\u044C\u0448\u0435 \u0441\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C. \u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E \u0438\u043B\u0438 \u0432\u0432\u0435\u0434\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0446\u0438\u0444\u0440\u044B",svgIcon:"info-outline",theme:"warning"}],[A.NO_MORE_NUMBERS_BY_CATEGORY,{text:"\u0417\u0434\u0435\u0441\u044C \u0431\u043E\u043B\u044C\u0448\u0435 \u043D\u0435\xA0\u043D\u0430\u0448\u043B\u043E\u0441\u044C \u043D\u043E\u043C\u0435\u0440\u043E\u0432.<br/>\u0412\u044B\u0431\u0435\u0440\u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E",svgIcon:"info-outline",theme:"warning"}],[A.NO_MORE_NUMBERS_AT_ALL,{text:"\u0417\u0434\u0435\u0441\u044C \u0431\u043E\u043B\u044C\u0448\u0435 \u043D\u0435\xA0\u043D\u0430\u0448\u043B\u043E\u0441\u044C \u043D\u043E\u043C\u0435\u0440\u043E\u0432.",svgIcon:"info-outline",theme:"warning"}],[A.COMMON_ERROR,{text:"\u0427\u0442\u043E-\u0442\u043E \u043F\u043E\u0448\u043B\u043E \u043D\u0435 \u0442\u0430\u043A, \u043F\u043E\u0432\u0442\u043E\u0440\u0438 \u043F\u043E\u043F\u044B\u0442\u043A\u0443 \u0435\u0449\u0435 \u0440\u0430\u0437",svgIcon:"info-outline",theme:"error"}],[A.CANCEL_REMOVE_BY_RADIO_MODE,{text:"\u041D\u0435\u043B\u044C\u0437\u044F \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u043C\u0435\u0440, \u043D\u043E \u0435\u0433\u043E \u043C\u043E\u0436\u043D\u043E \u0437\u0430\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430 \u0434\u0440\u0443\u0433\u043E\u0439",svgIcon:"info-outline",theme:"warning"}]]);}get config(){return w$1({},this._config)}set config(r){this._config=r;}get phoneNumbers$(){return Gh([this._phoneNumbers$,this._phoneNumbersByMask$,this._categories$.pipe(Hu(()=>{this.loadMoreDisabled$.next(false);})),this.searchControl.valueChanges.pipe(Lu(""),Hu(()=>{this.loadMoreDisabled$.next(false);}))]).pipe(le(([r,e,t,n])=>{if(this.error$.value===ue.NUMBERS_EXPIRED)return [];let o=[...r,...e],p=o.map(M=>M.value);o=[...this._selectedPhoneNumbers$.value.filter(M=>!p.includes(M.value)),...o];let b=this._sortPhoneNumbers(o,t,n||"");return b.length?this.error$.next(null):this.loadMoreDisabled$.value&&this.error$.value!==ue.NO_NUMBERS_BY_CATEGORY?this.error$.next(ue.NO_NUMBERS_BY_CATEGORY):this.error$.next(ue.NO_NUMBERS_BY_SEARCH),this.loadMoreHide$.next(false),b}))}get selectedPhoneNumbers$(){return this._selectedPhoneNumbers$.pipe(le(r=>r.map(e=>({value:e.value,category:e.category}))))}get selectedPhoneNumbers(){return this._selectedPhoneNumbers$.value}get selectedPhoneNumbersLength(){return this._selectedPhoneNumbers$.value.length}get processingNumber$(){return this._processingNumber$}get selectedPhoneNumbersTotal$(){return this._selectedPhoneNumbers$.pipe(le(r=>this._getPhoneNumbersTotal(r)))}get categories$(){return this._categories$.pipe()}get lockId$(){return this._lockId$.pipe()}get regionCodeCcm$(){return this._regionCodeCcm$.pipe()}get expirationLockDate$(){return this._expirationLockDate$.pipe()}initSelectedNumbers(r){this._selectedPhoneNumbers$.next(r);}openDialog(r){return this.init(r),this._dialogRef=this._dialogService.open(oi,{panelClass:["y-dialog-select-number",R$1()?.name||"chrome"],backdropClass:"y-dialog-backdrop-blurred",disableClose:true,autoFocus:false,hasBackdrop:true}),this._dialogRef.backdropClick().pipe(Et(1)).subscribe(()=>{this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:`${this.config.title} / \u0412\u043D\u0435\u0448\u043D\u0438\u0439 \u043A\u043B\u0438\u043A`},O$1.SELECT_NUMBER_DIALOG_CLOSE_MANUAL),this._dialogRef?.close({hasNumbers:!!this._selectedPhoneNumbers$.value.length,closeWay:Nt.BACKDROP});}),this._dialogRef}closeDialog(r){this.searchControl.setValue(null),this._dialogRef?.close({hasNumbers:!!this._selectedPhoneNumbers$.value.length,closeWay:r});}init(r){this.config=w$1({},r);let e=this.popupsMap.get(A.MAX_COUNT_SELECTED);if(e&&this.popupsMap.set(A.MAX_COUNT_SELECTED,x(w$1({},e),{text:`\u0412 \u043E\u0434\u0438\u043D \u0437\u0430\u043A\u0430\u0437 \u043C\u043E\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435 ${this.config.selectedNumbersMaxCount} \u043D\u043E\u043C\u0435\u0440\u043E\u0432`})),this.config.selectedNumbers.length||this.config.expiredNumbers.length){let t=new Date;if(this.config.expiredNumbers.length||!this.config.expirationLockDate||t>this.config.expirationLockDate){this._lockId$.next(null),this._expirationLockDate$.next(null),this._regionCodeCcm$.next(null),this.error$.next(ue.NUMBERS_EXPIRED),this.loading$.next(false),this._selectedPhoneNumbers$.next(this.config.expiredNumbers);return}}this.reset(),this._selectedPhoneNumbers$.next(this.config.selectedNumbers),this.fetchNumbers();}reset(){this._expirationLockDate$.next(this.config.expirationLockDate||null),this._lockId$.next(this.config.lockId||null),this._selectedPhoneNumbers$.next([]),this._phoneNumbersByMask$.next([]),this._offsetAll$.next(0),this._offsetMask$.next(0),this.searchControl.setValue(null),this.error$.next(null);}fetchNumbers(){this.loading$.next(true),this.config.fetch$({region:this.config.region,searchType:"allNumbers",offset:0}).pipe(Et(1),Ru(()=>this.loading$.next(false)),Pi$1(r=>{let e=this._getErrorCode(r),t=this.config.isDialog?ue.NO_INTERNET:ue.NO_INTERNET_TECHNICAL;switch(e){case 110403:this.error$.next(t),this.showCaptcha$.next(()=>this.fetchNumbers());break;default:this.error$.next(t);break}return rg(()=>r)})).subscribe(r=>{if(!r.numbers?.length){this.error$.next(ue.NO_NUMBERS_BY_CATEGORY);return}this._offsetAll$.next(r.limit),this._computeCategories(r.numbers),this._phoneNumbers$.next(r.numbers.flatMap(e=>e.phones?.length?e?.phones.flatMap(t=>({value:t.toString(),category:e.classPrice})):[])),this.error$.next(null);});}loadMoreNumbers(){this.pending$.next(true),this._currentPopup?.close();let r={region:this.config.region,searchType:"allNumbers",offset:this._offsetAll$.value};this.searchControl.value?(r.mask=this.searchControl.value,r.searchType="adaptiveSearch",r.mask!==this._searchStamp&&(this._offsetMask$.next(0),this._searchStamp=r.mask),r.offset=this._offsetMask$.value):this._searchStamp=null,this.config.fetch$(r).pipe(Et(1),Ru(()=>{this.pending$.next(false);}),Pi$1(e=>{switch(this._getErrorCode(e)){case 110403:this.showCaptcha$.next(()=>this.loadMoreNumbers());break;default:this._currentPopup=this._openPopup(A.COMMON_ERROR);break}return rg(()=>e)})).subscribe(e=>{let t=e?.numbers?.flatMap(b=>b.phones?.length?b?.phones.flatMap(M=>({value:M.toString(),category:b.classPrice})):[])??[],n=this._categories$.value.filter(b=>b.selected),o=n.map(b=>b.value),p=new Set(this._phoneNumbers$.value.map(b=>b.value)),m=this._sortPhoneNumbers(this._phoneNumbers$.value,n,this._searchStamp||"");if(t=t.filter(b=>!p.has(b.value)),!t.length){this._currentPopup?.close(),m.length&&(o.length&&o.length<this._categories$.value.length?this._currentPopup=this._openPopup(A.NO_MORE_NUMBERS_BY_CATEGORY):this._currentPopup=this._openPopup(A.NO_MORE_NUMBERS_AT_ALL)),this.loadMoreDisabled$.next(true),this._searchStamp?this.loadMoreHide$.next(false):this.loadMoreHide$.next(true),this.error$.next(null),this._phoneNumbers$.next(this._phoneNumbers$.value);return}if(this._searchStamp)this._offsetMask$.next(r.offset+e.limit),r.offset?this._phoneNumbersByMask$.next([...this._phoneNumbersByMask$.value,...t]):this._phoneNumbersByMask$.next(t),t.filter(M=>o.includes(M.category)).length?this.loadMoreDisabled$.next(false):(m.length&&(this._currentPopup=this._openPopup(A.NO_MORE_NUMBERS_BY_CATEGORY)),this.loadMoreDisabled$.next(true));else {this._offsetAll$.next(this._offsetAll$.value+e.limit);let b=t.filter(d=>o.includes(d.category)),M=[...this._phoneNumbers$.value,...t];this._phoneNumbers$.next(M),o.length&&!b.length?(m.length&&(this._currentPopup=this._openPopup(A.NO_MORE_NUMBERS_BY_CATEGORY)),this.loadMoreDisabled$.next(true)):(this._currentPopup=this._openPopup(A.LOADED_MORE_NUMBERS),this.loadMoreDisabled$.next(false));}});}continueSelectAfterDateExpired(){this.reset(),this.fetchNumbers();}toggleCategory(r){if(this.pending$.value)return;let e=this._categories$.value,t=e.find(n=>n.value===r);t&&(t.selected=!t.selected,this._categories$.next(e),this.loadMoreDisabled$.next(false));}toggleNumber(r){if(this.pending$.value)return;let e=this._selectedPhoneNumbers$.value;if(e.find(t=>t.value===r.value)){if(this.config.radioMode){this._currentPopup?.close(),this._currentPopup=this._openPopup(A.CANCEL_REMOVE_BY_RADIO_MODE);return}this._cancelNumber(r);return}if(this.config.radioMode){this._changeNumber(e[0],r);return}if(e.length>=this.config.selectedNumbersMaxCount){this._currentPopup?.close(),this._currentPopup=this._openPopup(A.MAX_COUNT_SELECTED);return}this._addNumber(r);}initConfig(r){this.config=r;let e=this.popupsMap.get(A.MAX_COUNT_SELECTED);e&&this.popupsMap.set(A.MAX_COUNT_SELECTED,x(w$1({},e),{text:`\u0412 \u043E\u0434\u0438\u043D \u0437\u0430\u043A\u0430\u0437 \u043C\u043E\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u044C\u0448\u0435 ${this.config.selectedNumbersMaxCount} ${this.config.selectedNumbersMaxCount===1?"\u043D\u043E\u043C\u0435\u0440\u043E\u0432":"\u043D\u043E\u043C\u0435\u0440\u0430"}`})),this._selectedPhoneNumbers$.next(r.selectedNumbers);}_openPopup(r,e){let t=this.popupsMap.get(r);if(!t)return null;switch(r){case A.BOOKED_NUMBER:this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:t.text},O$1.SELECT_NUMBER_DIALOG_LOCK_SUCCESS);break;case A.NUMBER_ALREADY_RESERVED:this._analyticsService.pushDataLayer({event:E.CONVERSIONS,event_param:t.text},O$1.SELECT_NUMBER_DIALOG_LOCK_FAILED);break;case A.MAX_COUNT_SELECTED:this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:t.text},O$1.SELECT_NUMBER_DIALOG_MAX_COUNT_SELECTED);break;case A.NO_MORE_NUMBERS_BY_CATEGORY:this._analyticsService.pushDataLayer({event:E.ACTIONS,event_param:t.text?t.text.replace(/<.*?>/g,""):""},O$1.SELECT_NUMBER_DIALOG_SEARCH_ERROR_POPUP);break;case A.CANCELLED_NUMBER:t.template=this.popupCancelledTemplate;break;}return this.config.isDialog?(t.parentSelector=".select-number-dialog",t.customWrapperClass="select-number-dialog__popups-wrapper"):this._breakpointObserver.isMatched("(max-width: 767px)")||(t.parentSelector=".number-selection",t.customWrapperClass="number-selection__popups-wrapper"),e&&(t.templateContext=e),this._popupService.openPopup(t)}_addNumber(r){this.pending$.next(true),this._processingNumber$.next(r.value),this._currentPopup?.close();let e={msisdn:[r.value],region:this.config.region.toString()};this._selectedPhoneNumbers$.value.length&&this.config.lockId&&(e.lockId=this.config.lockId),this.config.lock$(e).pipe(Et(1),Ru(()=>{this.pending$.next(false),this._processingNumber$.next(null);}),Pi$1(t=>{switch(this._getErrorCode(t)){case 110403:this.showCaptcha$.next(()=>this.toggleNumber(r));break;case 110412:this._currentPopup=this._openPopup(A.NUMBER_ALREADY_RESERVED),this._deleteNumber(r);break;default:this._currentPopup=this._openPopup(A.COMMON_ERROR);break}return rg(()=>t)})).subscribe(t=>{let n=new Date(t.expirationLockDate);this.config=x(w$1({},this.config),{lockId:t.lockId,expirationLockDate:n}),this._expirationLockDate$.next(n),this._lockId$.next(t.lockId),this._selectedPhoneNumbers$.next([w$1({},r),...this._selectedPhoneNumbers$.value]),this._currentPopup=this._openPopup(A.BOOKED_NUMBER);});}_cancelNumber(r){this.pending$.next(true),this._processingNumber$.next(r.value),this._currentPopup?.close();let e=this._selectedPhoneNumbers$.value.filter(t=>t.value!==r.value);this.config.cancel$({lockId:this.config.lockId,msisdn:[r.value],region:this.config.region.toString()}).pipe(Et(1),Ru(()=>{this.pending$.next(false),this._processingNumber$.next(null);}),Pi$1(t=>{switch(this._getErrorCode(t)){case 110403:this.showCaptcha$.next(()=>this.toggleNumber(r));break;case 110412:this._deleteNumber(r),this._selectedPhoneNumbers$.next(e),this._currentPopup=this._openPopup(A.NUMBER_ALREADY_RESERVED);break;default:this._currentPopup=this._openPopup(A.COMMON_ERROR);break}return rg(()=>t)})).subscribe(()=>{this._selectedPhoneNumbers$.next(e),this._currentPopup=this._openPopup(A.CANCELLED_NUMBER,{number:r});});}_changeNumber(r,e,t=false){this.pending$.next(true),this._processingNumber$.next(e.value),this._currentPopup?.close();let n=this.config.lockId,o=this.config.lock$({msisdn:[e.value],region:this.config.region.toString()});t&&(o=Vh({expirationLockDate:$(this._expirationLockDate$.value),lockId:n})),o.pipe(Et(1),Pi$1(p=>{switch(this._getErrorCode(p)){case 110403:this.showCaptcha$.next(()=>this._changeNumber(r,e));break;case 110412:this._currentPopup=this._openPopup(A.NUMBER_ALREADY_RESERVED),this._deleteNumber(e);break;default:this._currentPopup=this._openPopup(A.COMMON_ERROR);break}return rg(()=>p)}),Hu(p=>{let m=new Date(p.expirationLockDate);this.config=x(w$1({},this.config),{lockId:p.lockId,expirationLockDate:m}),this._expirationLockDate$.next(m);}),Ie(()=>this.config.cancel$({msisdn:[r.value],region:this.config.region.toString()}).pipe(Pi$1(p=>{switch(this._getErrorCode(p)){case 110403:this.showCaptcha$.next(()=>this._changeNumber(r,e,true));break;case 110412:return this._selectedPhoneNumbers$.next([w$1({},e)]),Vh(void 0);default:this._currentPopup=this._openPopup(A.COMMON_ERROR);break}return rg(()=>p)}))),Ie(()=>{let p={msisdn:e.value,regionId:this.config.region};return this.config.updateNumberInShoppingCart$(p)}),Ru(()=>{this.pending$.next(false),this._processingNumber$.next(null);})).subscribe(()=>{this._selectedPhoneNumbers$.next([w$1({},e)]),this._currentPopup=this._openPopup(A.BOOKED_NUMBER);});}_deleteNumber(r){this._phoneNumbers$.next(this._phoneNumbers$.value.filter(e=>e.value!==r.value));}_computeCategories(r){let e=[...new Set(r.filter(o=>o.phones?.length).map(o=>o.classPrice))].sort((o,p)=>o-p);e[0]===0&&e.push(e.shift());let t=this._selectedPhoneNumbers$.value,n=e.map((o,p)=>({name:o===0?"\u0411\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u044B\u0435":`${o} \u20BD`,value:o,selected:t.length?!!t.find(m=>m.category===o):p===0}));this._categories$.next(n);}_sortPhoneNumbers(r,e,t,n=2){let o=[],p={},m=e.filter(d=>d.selected).map(d=>d.value),b=r.filter(d=>m.length?m.includes(d.category):true);if(t.length>4){let d=b.length;for(;d--;){let N=b[d],D=this._isSubsequenceWithMismatch(N.value.substring(3),t);D.match?N.replaceIndexes=D.replaceIndexes:b.splice(d,1);}}else b=b.filter(d=>d.value.substring(3).includes(t)),b.forEach(d=>d.replaceIndexes=[]);for(let d of b)p[d.category]||(p[d.category]=[]),p[d.category].push(d);let M=true;for(;M;){M=false;for(let d of e){if(!d.selected&&m.length)continue;let N=p[d.value]||[];for(let D=0;D<n;D++)N.length>0&&(o.push(N.shift()),M=M||N.length>0);}}return o}_getPhoneNumbersTotal(r){return r.reduce((e,t)=>e+t.category,0)}_getErrorCode(r){return typeof r.error=="string"?JSON.parse(r.error).code:r.error.code||""}_isSubsequenceWithMismatch(r,e){let t=r.length,n=e.length,o=n>=6?2:1;for(let p=0;p<=t-n;p++){let m=r.substring(p,p+n);if(this._levenshteinDistance(m,e)<=o){let M=[];for(let d=0;d<m.length;d++)m[d]!=e[d]&&M.push(d);return {match:true,startIndex:p,endIndex:p+n-1,replaceIndexes:M}}}return {match:false}}_levenshteinDistance(r,e){let t=Array.from({length:r.length+1},()=>Array(e.length+1).fill(0));for(let n=0;n<=r.length;n++)t[n][0]=n;for(let n=0;n<=e.length;n++)t[0][n]=n;for(let n=1;n<=r.length;n++)for(let o=1;o<=e.length;o++){let p=r[n-1]===e[o-1]?0:1;t[n][o]=Math.min(t[n-1][o]+1,t[n][o-1]+1,t[n-1][o-1]+p);}return t[r.length][e.length]}static{this.\u0275fac=function(e){return new(e||i)};}static{this.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});}};Ob([v$1],St.prototype,"fetchNumbers",null);export{Be as B,Di as D,Ei as E,G,Ii as I,J,L,Mn as M,Nt as N,On as O,Pt as P,St as S,we as a,bt as b,gi as g,he as h,ne as n,oi as o,pe as p,q,re as r,vt as v,wn as w,xn as x};